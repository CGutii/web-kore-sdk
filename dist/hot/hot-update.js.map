{"version":3,"file":"hot/hot-update.js","mappings":"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","sources":["webpack://kore-web-sdk/./src/plugins/agentDesktop/agentdesktop.ts","webpack://kore-web-sdk/webpack/runtime/getFullHash"],"sourcesContent":["import AgentDesktopPluginScript from './agentdesktop-script';\n\n\n /** @ignore */\n class AgentDesktopPlugin {\n    name: any = 'AgentDesktopPlugin';\n    config: any = {};\n    agentDesktopInfo: any;\n    $: any;\n    constructor(config?: any) {\n        this.config = {\n            ...this.config,\n            ...config\n        }\n\n    }\n    onHostCreate() {\n        let me: any = this;\n        let cwInstance = me.hostInstance;\n\n        cwInstance.on(\"jwtGrantSuccess\", (response: any) => {\n            if (!this.agentDesktopInfo) {\n                me.onInit();\n                this.config = me.extend(me, response)\n                //me.AgentDesktop(response.userInfo.userId, response);\n                 /** @ignore */\n                this.agentDesktopInfo = new AgentDesktopPluginScript(this.config);\n            }\n        });\n\n    }\n    onInit() {\n        let me: any = this;\n        this.$ = me.hostInstance.$;\n        this.appendVideoAudioElemnts()\n\n        // agent connected and disconnected events\n        me.hostInstance.on('onWSMessage', (event: any) => {\n            if (event.messageData?.message?.type === 'agent_connected') {\n                localStorage.setItem(\"kr-agent-status\", \"connected\")\n            } else if (event.messageData?.message?.type === 'agent_disconnected') {\n                localStorage.setItem(\"kr-agent-status\", \"disconneted\")\n            }\n        });\n\n        // sent event style setting in user chat \n        me.hostInstance.on('afterRenderMessage', (event: any) => {\n\n            if (localStorage.getItem(\"kr-agent-status\") != \"connected\") return;\n\n            if (event.msgData?.type === \"currentUser\") {\n                const msg = event.msgData.message;\n                if (!event.messageHtml.children('.sentIndicator').length) {\n                    event.messageHtml.append('<div class=\"sentIndicator\">Sent</div>');\n\n                    me.hostInstance.bot.on('message', (message: any) => {\n                        var tempData = JSON.parse(message.data);\n                        if (!tempData) return;\n                        if (tempData.from === \"bot\" && tempData.type === \"events\" && tempData.message.clientMessageId === msg[0].clientMessageId) {\n\n                            if (tempData.message.type === \"message_delivered\") {\n                                if (this.$(\"#\" + tempData.message.clientMessageId + \" .sentIndicator\").text() !== 'Read') {\n                                    this.$(\"#\" + tempData.message.clientMessageId + \" .sentIndicator\").text(\"Delivered\");\n                                }\n                            } else if (tempData.message.type === \"message_read\") {\n                                this.$(\"#\" + tempData.message.clientMessageId + \" .sentIndicator\").text(\"Read\");\n                            }\n\n                        }\n                    });\n                }\n            } else {\n                // send read event from user to agent \n                if (event.msgData?.message[0]?.component?.payload?.template_type == 'live_agent') {\n                    const messageToBot: any = {};\n                    \n                    const msgId = event.msgData.messageId;\n                    messageToBot[\"event\"] = \"message_delivered\";\n                    messageToBot[\"message\"] = {\n                        \"body\": \"\",\n                        \"type\": \"\"\n                    }\n                    messageToBot[\"resourceid\"] = \"/bot.message\";\n                    me.hostInstance.bot.sendMessage(messageToBot, (err: any) => {});\n\n                    if (this.$('#' + msgId).is(':visible')) {\n                        messageToBot.event = 'message_read'\n                        me.hostInstance.bot.sendMessage(messageToBot, (err: any) => {});\n                    }\n\n                }\n            }\n        });\n\n    }\n\n    appendVideoAudioElemnts() {\n        let me: any = this;\n        let cwInstance = me.hostInstance;\n        let chatEle = cwInstance.chatEle;\n        let localVideoElement = '<video id=\"kore_local_video\" autoplay=\"autoplay\" playsinline style=\"width:0px;height:0px\"></video>';\n        let remoteVideoElement = '<video id=\"kore_remote_video\" autoplay=\"autoplay\" playsinline style=\"width:0px;height:0px\"></video>';\n        chatEle.append(localVideoElement);\n        chatEle.append(remoteVideoElement);\n    }\n\n    extend(target: any, source: any) {\n        let me: any = this;\n        for (var prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                if (target[prop] && typeof source[prop] === 'object') {\n                    me.extend(target[prop], source[prop]);\n                }\n                else {\n                    target[prop] = source[prop];\n                }\n            }\n        }\n        return target;\n    }\n}\nexport default AgentDesktopPlugin;","__webpack_require__.h = () => (\"9439ff90731c33f5a9f8\")"],"names":[],"sourceRoot":""}