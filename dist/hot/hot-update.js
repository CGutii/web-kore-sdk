self["webpackHotUpdatekore_web_sdk"]("esm",{

/***/ "./src/plugins/agentDesktop/ac_webrtc.js":
/*!***********************************************!*\
  !*** ./src/plugins/agentDesktop/ac_webrtc.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AudioCodesUA": () => (/* binding */ AudioCodesUA)
/* harmony export */ });
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e34){throw _e34;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e35){didErr=true;err=_e35;},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]();}finally{if(didErr)throw err;}}};}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}/*
 * JsSIP v3.7.5
 * the Javascript SIP library
 * Copyright: 2012-2021 José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)
 * Homepage: https://jssip.net
 * License: MIT
 */ // ("use strict");
/*
 * AudioCodes WebRTC API v1.14.1
 * © 2021 AudioCodes Ltd. All rights reserved.
 *
 */var AudioCodesUA=/*#__PURE__*/function(){function AudioCodesUA(){_classCallCheck(this,AudioCodesUA);this.JsSipInit.call(window);this._isInitialized=!1,this.serverConfig={},this.account={user:null,userAuth:null,displayName:null,password:null,registerExpires:600,useSessionTimer:!1},this.constraints={chrome:{audio:!0,video:!0},firefox:{audio:!0,video:!0},safari:{audio:!0,video:!0},ios_safari:{audio:!0,video:!0},other:{audio:!0,video:!0}},this.chromiumBased=[{n:"Edge",s:"edg/"},{n:"Opera",s:"opr/"},{n:"Samsung",s:"samsungbrowser/"},{n:"Yandex",s:"yabrowser/"}],this.modes={video_call_audio_answer_firefox_fix:!0,video_call_audio_answer_safari_fix:!0,ice_timeout_fix:2e3,chrome_rtp_timeout_fix:13,sbc_ha_pairs_mode:void 0,ringing_header_mode:void 0},this.listeners={},this.registerExtraHeaders=null,this.jssipUA=null,this.browser="",this.browserVersion=0,this.browserName="",this.reconnectMin=2,this.reconnectMax=30,this.u17=void 0,this.activeCalls=0,this.wsSocket=null,this.wsOnMessage=null,this.wsPingMs=0,this.wsOrigPingMs=0,this.wsThrottlingPingMs=0,this.wsVisibility=!1,this.wsCall=!1,this.wsLog=0,this.wsPongTimeout=!0,this.wsIsThrottling=!1,this.wsPingJob=null,this.wsPingTime=null,this.wsNextPingTime=null,this.wsPongReceived=!1,this.wsPongSupported=null,this.wsPongTimeoutTime=null,this.wsPongDelays=null,this.wsPongDelaysIx=0,this.wsPongReport=0,this.wsPongReportCounter=0,this.wsPongDist=!1,this.dtmfUseWebRTC=!0,this.dtmfDuration=250,this.dtmfInterToneGap=250,this.enableAddVideo=!1,this.oauthToken=null,this.oauthTokenUseInInvite=!0,this.networkPriority=void 0,AudioCodesUA.ac_log=console.log,void 0===AudioCodesUA.instance&&(AudioCodesUA.instance=this),this._detectBrowser(),this.webrtcapi=AudioCodesWebRTCWrapper,this.replacedCall=null,this.AUDIO=Symbol("audio"),this.VIDEO=Symbol("video"),this.RECVONLY_VIDEO=Symbol("recvonly_video"),AudioCodesUA.instance;}_createClass(AudioCodesUA,[{key:"JsSipInit",value:// static JsSIP= 
/*
 * JsSIP v3.9.1
 * the Javascript SIP library
 * Copyright: 2012-2022 
 * Homepage: https://jssip.net
 * License: MIT
 */function JsSipInit(){!function(e){if(false){}else if(false){}else{("undefined"!=typeof window?window:"undefined"!=typeof __webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:this).JsSIP=e();}}(function(){return function e(t,n,r){function s(o,l){if(!n[o]){if(!t[o]){var u=undefined;if(!l&&u)return require(o,!0);if(i)return i(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a;}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return s(t[o][1][e]||e);},c,c.exports,e,t,n,r);}return n[o].exports;}for(var i=undefined,o=0;o<r.length;o++){s(r[o]);}return s;}({1:[function(e,t,n){"use strict";function r(e,t){var _n2;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n2=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t);}(e))||t&&e&&"number"==typeof e.length){_n2&&(e=_n2);var r=0,i=function i(){};return{s:i,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e2){throw _e2;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,l=!0,u=!1;return{s:function s(){_n2=e[Symbol.iterator]();},n:function n(){var e=_n2.next();return l=e.done,e;},e:function e(_e3){u=!0,o=_e3;},f:function f(){try{l||null==_n2["return"]||_n2["return"]();}finally{if(u)throw o;}}};}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}var i=e("./Utils"),o=e("./Constants"),l=e("./Grammar"),u=e("./URI"),a=e("./Socket"),c=e("./Exceptions");n.settings={authorization_user:null,password:null,realm:null,ha1:null,authorization_jwt:null,display_name:null,uri:null,contact_uri:null,instance_id:null,use_preloaded_route:!1,session_timers:!0,session_timers_refresh_method:o.UPDATE,session_timers_force_refresher:!1,no_answer_timeout:60,register:!0,register_expires:600,registrar_server:null,sockets:null,connection_recovery_max_interval:o.CONNECTION_RECOVERY_MAX_INTERVAL,connection_recovery_min_interval:o.CONNECTION_RECOVERY_MIN_INTERVAL,via_host:"".concat(i.createRandomToken(12),".invalid")};var h={mandatory:{sockets:function sockets(e){var t=[];if(a.isSocket(e))t.push({socket:e});else{if(!Array.isArray(e)||!e.length)return;var n,s=r(e);try{for(s.s();!(n=s.n()).done;){var i=n.value;Object.prototype.hasOwnProperty.call(i,"socket")&&a.isSocket(i.socket)?t.push(i):a.isSocket(i)&&t.push({socket:i});}}catch(e){s.e(e);}finally{s.f();}}return t;},uri:function uri(e){/^sip:/i.test(e)||(e="".concat(o.SIP,":").concat(e));var t=u.parse(e);return t&&t.user?t:void 0;}},optional:{authorization_user:function authorization_user(e){return-1===l.parse('"'.concat(e,'"'),"quoted_string")?void 0:e;},authorization_jwt:function authorization_jwt(e){if("string"==typeof e)return e;},user_agent:function user_agent(e){if("string"==typeof e)return e;},connection_recovery_max_interval:function connection_recovery_max_interval(e){if(i.isDecimal(e)){var t=Number(e);if(t>0)return t;}},connection_recovery_min_interval:function connection_recovery_min_interval(e){if(i.isDecimal(e)){var t=Number(e);if(t>0)return t;}},contact_uri:function contact_uri(e){if("string"==typeof e){var t=l.parse(e,"SIP_URI");if(-1!==t)return t;}},display_name:function display_name(e){return e;},instance_id:function instance_id(e){return /^uuid:/i.test(e)&&(e=e.substr(5)),-1===l.parse(e,"uuid")?void 0:e;},no_answer_timeout:function no_answer_timeout(e){if(i.isDecimal(e)){var t=Number(e);if(t>0)return t;}},session_timers:function session_timers(e){if("boolean"==typeof e)return e;},session_timers_refresh_method:function session_timers_refresh_method(e){if("string"==typeof e&&((e=e.toUpperCase())===o.INVITE||e===o.UPDATE))return e;},session_timers_force_refresher:function session_timers_force_refresher(e){if("boolean"==typeof e)return e;},password:function password(e){return String(e);},realm:function realm(e){return String(e);},ha1:function ha1(e){return String(e);},register:function register(e){if("boolean"==typeof e)return e;},register_expires:function register_expires(e){if(i.isDecimal(e)){var t=Number(e);if(t>0)return t;}},registrar_server:function registrar_server(e){/^sip:/i.test(e)||(e="".concat(o.SIP,":").concat(e));var t=u.parse(e);return t?t.user?void 0:t:void 0;},use_preloaded_route:function use_preloaded_route(e){if("boolean"==typeof e)return e;}}};n.load=function(e,t){for(var n in h.mandatory){if(!t.hasOwnProperty(n))throw new c.ConfigurationError(n);var r=t[n],s=h.mandatory[n](r);if(void 0===s)throw new c.ConfigurationError(n,r);e[n]=s;}for(var o in h.optional){if(t.hasOwnProperty(o)){var l=t[o];if(i.isEmpty(l))continue;var u=h.optional[o](l);if(void 0===u)throw new c.ConfigurationError(o,l);e[o]=u;}}};},{"./Constants":2,"./Exceptions":6,"./Grammar":7,"./Socket":20,"./URI":25,"./Utils":26}],2:[function(e,t,n){"use strict";var r=e("../package.json");t.exports={USER_AGENT:"".concat(r.title," ").concat(r.version),SIP:"sip",SIPS:"sips",causes:{CONNECTION_ERROR:"Connection Error",REQUEST_TIMEOUT:"Request Timeout",SIP_FAILURE_CODE:"SIP Failure Code",INTERNAL_ERROR:"Internal Error",BUSY:"Busy",REJECTED:"Rejected",REDIRECTED:"Redirected",UNAVAILABLE:"Unavailable",NOT_FOUND:"Not Found",ADDRESS_INCOMPLETE:"Address Incomplete",INCOMPATIBLE_SDP:"Incompatible SDP",MISSING_SDP:"Missing SDP",AUTHENTICATION_ERROR:"Authentication Error",BYE:"Terminated",WEBRTC_ERROR:"WebRTC Error",CANCELED:"Canceled",NO_ANSWER:"No Answer",EXPIRES:"Expires",NO_ACK:"No ACK",DIALOG_ERROR:"Dialog Error",USER_DENIED_MEDIA_ACCESS:"User Denied Media Access",BAD_MEDIA_DESCRIPTION:"Bad Media Description",RTP_TIMEOUT:"RTP Timeout"},SIP_ERROR_CAUSES:{REDIRECTED:[300,301,302,305,380],BUSY:[486,600],REJECTED:[403,603],NOT_FOUND:[404,604],UNAVAILABLE:[480,410,408,430],ADDRESS_INCOMPLETE:[484,424],INCOMPATIBLE_SDP:[488,606],AUTHENTICATION_ERROR:[401,407]},ACK:"ACK",BYE:"BYE",CANCEL:"CANCEL",INFO:"INFO",INVITE:"INVITE",MESSAGE:"MESSAGE",NOTIFY:"NOTIFY",OPTIONS:"OPTIONS",REGISTER:"REGISTER",REFER:"REFER",UPDATE:"UPDATE",SUBSCRIBE:"SUBSCRIBE",DTMF_TRANSPORT:{INFO:"INFO",RFC2833:"RFC2833"},REASON_PHRASE:{100:"Trying",180:"Ringing",181:"Call Is Being Forwarded",182:"Queued",183:"Session Progress",199:"Early Dialog Terminated",200:"OK",202:"Accepted",204:"No Notification",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",305:"Use Proxy",380:"Alternative Service",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",410:"Gone",412:"Conditional Request Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Unsupported URI Scheme",417:"Unknown Resource-Priority",420:"Bad Extension",421:"Extension Required",422:"Session Interval Too Small",423:"Interval Too Brief",424:"Bad Location Information",428:"Use Identity Header",429:"Provide Referrer Identity",430:"Flow Failed",433:"Anonymity Disallowed",436:"Bad Identity-Info",437:"Unsupported Certificate",438:"Invalid Identity Header",439:"First Hop Lacks Outbound Support",440:"Max-Breadth Exceeded",469:"Bad Info Package",470:"Consent Needed",478:"Unresolvable Destination",480:"Temporarily Unavailable",481:"Call/Transaction Does Not Exist",482:"Loop Detected",483:"Too Many Hops",484:"Address Incomplete",485:"Ambiguous",486:"Busy Here",487:"Request Terminated",488:"Not Acceptable Here",489:"Bad Event",491:"Request Pending",493:"Undecipherable",494:"Security Agreement Required",500:"JsSIP Internal Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Server Time-out",505:"Version Not Supported",513:"Message Too Large",580:"Precondition Failure",600:"Busy Everywhere",603:"Decline",604:"Does Not Exist Anywhere",606:"Not Acceptable"},ALLOWED_METHODS:"INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO,NOTIFY",ACCEPTED_BODY_TYPES:"application/sdp, application/dtmf-relay",MAX_FORWARDS:69,SESSION_EXPIRES:90,MIN_SESSION_EXPIRES:60,CONNECTION_RECOVERY_MAX_INTERVAL:30,CONNECTION_RECOVERY_MIN_INTERVAL:2};},{"../package.json":38}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var i=e("./SIPMessage"),o=e("./Constants"),l=e("./Transactions"),u=e("./Dialog/RequestSender"),a=e("./Utils"),c=e("debug")("JsSIP:Dialog"),h={STATUS_EARLY:1,STATUS_CONFIRMED:2};t.exports=function(){function e(t,n,s){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.STATUS_CONFIRMED;if(r(this,e),this._owner=t,this._ua=t._ua,this._uac_pending_reply=!1,this._uas_pending_reply=!1,!n.hasHeader("contact"))return{error:"unable to create a Dialog without Contact header field"};n instanceof i.IncomingResponse&&(o=n.status_code<200?h.STATUS_EARLY:h.STATUS_CONFIRMED);var l=n.parseHeader("contact");"UAS"===s?(this._id={call_id:n.call_id,local_tag:n.to_tag,remote_tag:n.from_tag,toString:function toString(){return this.call_id+this.local_tag+this.remote_tag;}},this._state=o,this._remote_seqnum=n.cseq,this._local_uri=n.parseHeader("to").uri,this._remote_uri=n.parseHeader("from").uri,this._remote_target=l.uri,this._route_set=n.getHeaders("record-route"),this._ack_seqnum=this._remote_seqnum):"UAC"===s&&(this._id={call_id:n.call_id,local_tag:n.from_tag,remote_tag:n.to_tag,toString:function toString(){return this.call_id+this.local_tag+this.remote_tag;}},this._state=o,this._local_seqnum=n.cseq,this._local_uri=n.parseHeader("from").uri,this._remote_uri=n.parseHeader("to").uri,this._remote_target=l.uri,this._route_set=n.getHeaders("record-route").reverse(),this._ack_seqnum=null),this._ua.newDialog(this),c("new ".concat(s," dialog created with status ").concat(this._state===h.STATUS_EARLY?"EARLY":"CONFIRMED"));}var t,n,f;return t=e,f=[{key:"C",get:function get(){return h;}}],(n=[{key:"id",get:function get(){return this._id;}},{key:"local_seqnum",get:function get(){return this._local_seqnum;},set:function set(e){this._local_seqnum=e;}},{key:"owner",get:function get(){return this._owner;}},{key:"uac_pending_reply",get:function get(){return this._uac_pending_reply;},set:function set(e){this._uac_pending_reply=e;}},{key:"uas_pending_reply",get:function get(){return this._uas_pending_reply;}},{key:"update",value:function value(e,t){this._state=h.STATUS_CONFIRMED,c("dialog ".concat(this._id.toString(),"  changed to CONFIRMED state")),"UAC"===t&&(this._route_set=e.getHeaders("record-route").reverse());}},{key:"terminate",value:function value(){c("dialog ".concat(this._id.toString()," deleted")),this._ua.destroyDialog(this);}},{key:"sendRequest",value:function value(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a.cloneArray(n.extraHeaders),s=a.cloneObject(n.eventHandlers),i=n.body||null,o=this._createRequest(e,r,i);s.onAuthenticated=function(){t._local_seqnum+=1;};var l=new u(this,o,s);return l.send(),o;}},{key:"receiveRequest",value:function value(e){this._checkInDialogRequest(e)&&(e.method===o.ACK&&null!==this._ack_seqnum?this._ack_seqnum=null:e.method===o.INVITE&&(this._ack_seqnum=e.cseq),this._owner.receiveRequest(e));}},{key:"_createRequest",value:function value(e,t,n){t=a.cloneArray(t),this._local_seqnum||(this._local_seqnum=Math.floor(1e4*Math.random()));var r=e===o.CANCEL||e===o.ACK?this._local_seqnum:this._local_seqnum+=1;return new i.OutgoingRequest(e,this._remote_target,this._ua,{cseq:r,call_id:this._id.call_id,from_uri:this._local_uri,from_tag:this._id.local_tag,to_uri:this._remote_uri,to_tag:this._id.remote_tag,route_set:this._route_set},t,n);}},{key:"_checkInDialogRequest",value:function value(e){var t=this;if(this._remote_seqnum){if(e.cseq<this._remote_seqnum){if(e.method!==o.ACK)return e.reply(500),!1;if(null===this._ack_seqnum||e.cseq!==this._ack_seqnum)return!1;}else e.cseq>this._remote_seqnum&&(this._remote_seqnum=e.cseq);}else this._remote_seqnum=e.cseq;if(e.method===o.INVITE||e.method===o.UPDATE&&e.body){if(!0===this._uac_pending_reply)e.reply(491);else{if(!0===this._uas_pending_reply){var n=1+(10*Math.random()|0);return e.reply(500,null,["Retry-After:".concat(n)]),!1;}this._uas_pending_reply=!0,e.server_transaction.on("stateChanged",function n(){e.server_transaction.state!==l.C.STATUS_ACCEPTED&&e.server_transaction.state!==l.C.STATUS_COMPLETED&&e.server_transaction.state!==l.C.STATUS_TERMINATED||(e.server_transaction.removeListener("stateChanged",n),t._uas_pending_reply=!1);});}e.hasHeader("contact")&&e.server_transaction.on("stateChanged",function(){e.server_transaction.state===l.C.STATUS_ACCEPTED&&(t._remote_target=e.parseHeader("contact").uri);});}else e.method===o.NOTIFY&&e.hasHeader("contact")&&e.server_transaction.on("stateChanged",function(){e.server_transaction.state===l.C.STATUS_COMPLETED&&(t._remote_target=e.parseHeader("contact").uri);});return!0;}}])&&s(t.prototype,n),f&&s(t,f),e;}();},{"./Constants":2,"./Dialog/RequestSender":4,"./SIPMessage":19,"./Transactions":22,"./Utils":26,debug:29}],4:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var s=e("../Constants"),i=e("../Transactions"),o=e("../RTCSession"),l=e("../RequestSender"),u={onRequestTimeout:function onRequestTimeout(){},onTransportError:function onTransportError(){},onSuccessResponse:function onSuccessResponse(){},onErrorResponse:function onErrorResponse(){},onAuthenticated:function onAuthenticated(){},onDialogError:function onDialogError(){}};t.exports=function(){function e(t,n,r){for(var s in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this._dialog=t,this._ua=t._ua,this._request=n,this._eventHandlers=r,this._reattempt=!1,this._reattemptTimer=null,u){Object.prototype.hasOwnProperty.call(u,s)&&(this._eventHandlers[s]||(this._eventHandlers[s]=u[s]));}}var t,n,a;return t=e,(n=[{key:"request",get:function get(){return this._request;}},{key:"send",value:function value(){var e=this,t=new l(this._ua,this._request,{onRequestTimeout:function onRequestTimeout(){e._eventHandlers.onRequestTimeout();},onTransportError:function onTransportError(){e._eventHandlers.onTransportError();},onAuthenticated:function onAuthenticated(t){e._eventHandlers.onAuthenticated(t);},onReceiveResponse:function onReceiveResponse(t){e._receiveResponse(t);}});t.send(),(this._request.method===s.INVITE||this._request.method===s.UPDATE&&this._request.body)&&t.clientTransaction.state!==i.C.STATUS_TERMINATED&&(this._dialog.uac_pending_reply=!0,t.clientTransaction.on("stateChanged",function n(){t.clientTransaction.state!==i.C.STATUS_ACCEPTED&&t.clientTransaction.state!==i.C.STATUS_COMPLETED&&t.clientTransaction.state!==i.C.STATUS_TERMINATED||(t.clientTransaction.removeListener("stateChanged",n),e._dialog.uac_pending_reply=!1);}));}},{key:"_receiveResponse",value:function value(e){var t=this;408===e.status_code||481===e.status_code?this._eventHandlers.onDialogError(e):e.method===s.INVITE&&491===e.status_code?this._reattempt?e.status_code>=200&&e.status_code<300?this._eventHandlers.onSuccessResponse(e):e.status_code>=300&&this._eventHandlers.onErrorResponse(e):(this._request.cseq=this._dialog.local_seqnum+=1,this._reattemptTimer=setTimeout(function(){t._dialog.owner.status!==o.C.STATUS_TERMINATED&&(t._reattempt=!0,t._request_sender.send());},1e3)):e.status_code>=200&&e.status_code<300?this._eventHandlers.onSuccessResponse(e):e.status_code>=300&&this._eventHandlers.onErrorResponse(e);}}])&&r(t.prototype,n),a&&r(t,a),e;}();},{"../Constants":2,"../RTCSession":12,"../RequestSender":18,"../Transactions":22}],5:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var s=e("./Utils"),i=e("debug")("JsSIP:DigestAuthentication"),o=e("debug")("JsSIP:ERROR:DigestAuthentication");o.log=console.warn.bind(console),t.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this._credentials=t,this._cnonce=null,this._nc=0,this._ncHex="00000000",this._algorithm=null,this._realm=null,this._nonce=null,this._opaque=null,this._stale=null,this._qop=null,this._method=null,this._uri=null,this._ha1=null,this._response=null;}var t,n,l;return t=e,(n=[{key:"get",value:function value(e){switch(e){case"realm":return this._realm;case"ha1":return this._ha1;default:return void o('get() | cannot get "%s" parameter',e);}}},{key:"authenticate",value:function value(e,t){var n=e.method,r=e.ruri,l=e.body,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this._algorithm=t.algorithm,this._realm=t.realm,this._nonce=t.nonce,this._opaque=t.opaque,this._stale=t.stale,this._algorithm){if("MD5"!==this._algorithm)return o('authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted'),!1;}else this._algorithm="MD5";if(!this._nonce)return o("authenticate() | challenge without Digest nonce, authentication aborted"),!1;if(!this._realm)return o("authenticate() | challenge without Digest realm, authentication aborted"),!1;if(!this._credentials.password){if(!this._credentials.ha1)return o("authenticate() | no plain SIP password nor ha1 provided, authentication aborted"),!1;if(this._credentials.realm!==this._realm)return o('authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]',this._credentials.realm,this._realm),!1;}if(t.qop){if(t.qop.indexOf("auth-int")>-1)this._qop="auth-int";else{if(!(t.qop.indexOf("auth")>-1))return o('authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted'),!1;this._qop="auth";}}else this._qop=null;this._method=n,this._uri=r,this._cnonce=u||s.createRandomToken(12),this._nc+=1;var a,c,h=Number(this._nc).toString(16);return this._ncHex="00000000".substr(0,8-h.length)+h,4294967296===this._nc&&(this._nc=1,this._ncHex="00000001"),this._credentials.password?this._ha1=s.calculateMD5("".concat(this._credentials.username,":").concat(this._realm,":").concat(this._credentials.password)):this._ha1=this._credentials.ha1,"auth"===this._qop?(a="".concat(this._method,":").concat(this._uri),c=s.calculateMD5(a),i('authenticate() | using qop=auth [a2:"%s"]',a),this._response=s.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth:").concat(c))):"auth-int"===this._qop?(a="".concat(this._method,":").concat(this._uri,":").concat(s.calculateMD5(l||"")),c=s.calculateMD5(a),i('authenticate() | using qop=auth-int [a2:"%s"]',a),this._response=s.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(this._ncHex,":").concat(this._cnonce,":auth-int:").concat(c))):null===this._qop&&(a="".concat(this._method,":").concat(this._uri),c=s.calculateMD5(a),i('authenticate() | using qop=null [a2:"%s"]',a),this._response=s.calculateMD5("".concat(this._ha1,":").concat(this._nonce,":").concat(c))),i("authenticate() | response generated"),!0;}},{key:"toString",value:function value(){var e=[];if(!this._response)throw new Error("response field does not exist, cannot generate Authorization header");return e.push("algorithm=".concat(this._algorithm)),e.push('username="'.concat(this._credentials.username,'"')),e.push('realm="'.concat(this._realm,'"')),e.push('nonce="'.concat(this._nonce,'"')),e.push('uri="'.concat(this._uri,'"')),e.push('response="'.concat(this._response,'"')),this._opaque&&e.push('opaque="'.concat(this._opaque,'"')),this._qop&&(e.push("qop=".concat(this._qop)),e.push('cnonce="'.concat(this._cnonce,'"')),e.push("nc=".concat(this._ncHex))),"Digest ".concat(e.join(", "));}}])&&r(t.prototype,n),l&&r(t,l),e;}();},{"./Utils":26,debug:29}],6:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t);}function o(e){var t=c();return function(){var n,r=f(e);if(t){var s=f(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return l(this,n);};}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function u(e){var t="function"==typeof Map?new Map():void 0;return(u=function u(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r);}function r(){return a(e,arguments,f(this).constructor);}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,e);})(e);}function a(e,t,n){return(a=c()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var s=new(Function.bind.apply(e,r))();return n&&h(s,n.prototype),s;}).apply(null,arguments);}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var d=function(e){i(n,e);var t=o(n);function n(e,r){var i;return s(this,n),(i=t.call(this)).code=1,i.name="CONFIGURATION_ERROR",i.parameter=e,i.value=r,i.message=i.value?"Invalid value ".concat(JSON.stringify(i.value),' for parameter "').concat(i.parameter,'"'):"Missing parameter: ".concat(i.parameter),i;}return n;}(u(Error)),_=function(e){i(n,e);var t=o(n);function n(e){var r;return s(this,n),(r=t.call(this)).code=2,r.name="INVALID_STATE_ERROR",r.status=e,r.message="Invalid status: ".concat(e),r;}return n;}(u(Error)),p=function(e){i(n,e);var t=o(n);function n(e){var r;return s(this,n),(r=t.call(this)).code=3,r.name="NOT_SUPPORTED_ERROR",r.message=e,r;}return n;}(u(Error)),m=function(e){i(n,e);var t=o(n);function n(e){var r;return s(this,n),(r=t.call(this)).code=4,r.name="NOT_READY_ERROR",r.message=e,r;}return n;}(u(Error));t.exports={ConfigurationError:d,InvalidStateError:_,NotSupportedError:p,NotReadyError:m};},{}],7:[function(e,t,n){"use strict";t.exports=function(){function t(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"';}var n={parse:function parse(n,r){var s={CRLF:a,DIGIT:c,ALPHA:h,HEXDIG:f,WSP:d,OCTET:_,DQUOTE:p,SP:m,HTAB:v,alphanum:g,reserved:y,unreserved:T,mark:C,escaped:S,LWS:E,SWS:A,HCOLON:b,TEXT_UTF8_TRIM:R,TEXT_UTF8char:w,UTF8_NONASCII:I,UTF8_CONT:O,LHEX:function LHEX(){var e;null===(e=c())&&(/^[a-f]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[a-f]")));return e;},token:k,token_nodot:N,separators:function separators(){var e;40===n.charCodeAt(i)?(e="(",i++):(e=null,u('"("'));null===e&&(41===n.charCodeAt(i)?(e=")",i++):(e=null,u('")"')),null===e&&(60===n.charCodeAt(i)?(e="<",i++):(e=null,u('"<"')),null===e&&(62===n.charCodeAt(i)?(e=">",i++):(e=null,u('">"')),null===e&&(64===n.charCodeAt(i)?(e="@",i++):(e=null,u('"@"')),null===e&&(44===n.charCodeAt(i)?(e=",",i++):(e=null,u('","')),null===e&&(59===n.charCodeAt(i)?(e=";",i++):(e=null,u('";"')),null===e&&(58===n.charCodeAt(i)?(e=":",i++):(e=null,u('":"')),null===e&&(92===n.charCodeAt(i)?(e="\\",i++):(e=null,u('"\\\\"')),null===e&&null===(e=p())&&(47===n.charCodeAt(i)?(e="/",i++):(e=null,u('"/"')),null===e&&(91===n.charCodeAt(i)?(e="[",i++):(e=null,u('"["')),null===e&&(93===n.charCodeAt(i)?(e="]",i++):(e=null,u('"]"')),null===e&&(63===n.charCodeAt(i)?(e="?",i++):(e=null,u('"?"')),null===e&&(61===n.charCodeAt(i)?(e="=",i++):(e=null,u('"="')),null===e&&(123===n.charCodeAt(i)?(e="{",i++):(e=null,u('"{"')),null===e&&(125===n.charCodeAt(i)?(e="}",i++):(e=null,u('"}"')),null===e&&null===(e=m())&&(e=v()))))))))))))))));return e;},word:U,STAR:x,SLASH:P,EQUAL:D,LPAREN:M,RPAREN:q,RAQUOT:L,LAQUOT:H,COMMA:F,SEMI:j,COLON:G,LDQUOT:B,RDQUOT:W,comment:function e(){var t,n,r,s;if(s=i,null!==(t=M())){for(n=[],null===(r=V())&&null===(r=J())&&(r=e());null!==r;){n.push(r),null===(r=V())&&null===(r=J())&&(r=e());}null!==n&&null!==(r=q())?t=[t,n,r]:(t=null,i=s);}else t=null,i=s;return t;},ctext:V,quoted_string:K,quoted_string_clean:Y,qdtext:z,quoted_pair:J,SIP_URI_noparams:$,SIP_URI:X,uri_scheme:Q,uri_scheme_sips:Z,uri_scheme_sip:ee,userinfo:te,user:ne,user_unreserved:re,password:se,hostport:ie,host:oe,hostname:le,domainlabel:ue,toplabel:ae,IPv6reference:ce,IPv6address:he,h16:fe,ls32:de,IPv4address:_e,dec_octet:pe,port:me,uri_parameters:ve,uri_parameter:ge,transport_param:ye,user_param:Te,method_param:Ce,ttl_param:Se,maddr_param:Ee,lr_param:Ae,other_param:be,pname:Re,pvalue:we,paramchar:Ie,param_unreserved:Oe,headers:ke,header:Ne,hname:Ue,hvalue:xe,hnv_unreserved:Pe,Request_Response:function Request_Response(){var e;null===(e=ct())&&(e=De());return e;},Request_Line:De,Request_URI:Me,absoluteURI:qe,hier_part:Le,net_path:He,abs_path:Fe,opaque_part:je,uric:Ge,uric_no_slash:Be,path_segments:We,segment:Ve,param:Ke,pchar:Ye,scheme:ze,authority:Je,srvr:$e,reg_name:Xe,query:Qe,SIP_Version:Ze,INVITEm:et,ACKm:tt,OPTIONSm:nt,BYEm:rt,CANCELm:st,REGISTERm:it,SUBSCRIBEm:ot,NOTIFYm:lt,REFERm:ut,Method:at,Status_Line:ct,Status_Code:ht,extension_code:ft,Reason_Phrase:dt,Allow_Events:function Allow_Events(){var e,t,n,r,s,o;if(s=i,null!==(e=qt())){for(t=[],o=i,null!==(n=F())&&null!==(r=qt())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=F())&&null!==(r=qt())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},Call_ID:function Call_ID(){var e,t,r,s,o,l;s=i,o=i,null!==(e=U())?(l=i,64===n.charCodeAt(i)?(t="@",i++):(t=null,u('"@"')),null!==t&&null!==(r=U())?t=[t,r]:(t=null,i=l),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=o)):(e=null,i=o);null!==e&&(e=function(e){Fn=n.substring(i,e);}(s));null===e&&(i=s);return e;},Contact:function Contact(){var e,t,n,r,s,o,l;if(s=i,null===(e=x()))if(o=i,null!==(e=_t())){for(t=[],l=i,null!==(n=F())&&null!==(r=_t())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=F())&&null!==(r=_t())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;null!==e&&(e=function(e){var t,n;for(n=Fn.multi_header.length,t=0;t<n;t++){if(null===Fn.multi_header[t].parsed){Fn=null;break;}}Fn=null!==Fn?Fn.multi_header:-1;}());null===e&&(i=s);return e;},contact_param:_t,name_addr:pt,display_name:mt,contact_params:vt,c_p_q:gt,c_p_expires:yt,delta_seconds:Tt,qvalue:Ct,generic_param:St,gen_value:Et,Content_Disposition:function Content_Disposition(){var e,t,n,r,s,o;if(s=i,null!==(e=At())){for(t=[],o=i,null!==(n=j())&&null!==(r=bt())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=j())&&null!==(r=bt())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},disp_type:At,disp_param:bt,handling_param:Rt,Content_Encoding:function Content_Encoding(){var e,t,n,r,s,o;if(s=i,null!==(e=k())){for(t=[],o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},Content_Length:function Content_Length(){var e,t,n;if(n=i,null!==(t=c()))for(e=[];null!==t;){e.push(t),t=c();}else e=null;null!==e&&(e=void(Fn=parseInt(e.join(""))));null===e&&(i=n);return e;},Content_Type:function Content_Type(){var e,t;t=i,null!==(e=wt())&&(e=function(e){Fn=n.substring(i,e);}(t));null===e&&(i=t);return e;},media_type:wt,m_type:It,discrete_type:Ot,composite_type:kt,extension_token:Nt,x_token:Ut,m_subtype:xt,m_parameter:Pt,m_value:Dt,CSeq:function CSeq(){var e,t,n,r;r=i,null!==(e=Mt())&&null!==(t=E())&&null!==(n=at())?e=[e,t,n]:(e=null,i=r);return e;},CSeq_value:Mt,Expires:function Expires(){var e,t;t=i,null!==(e=Tt())&&(e=void(Fn=e));null===e&&(i=t);return e;},Event:function Event(){var e,t,n,r,s,o,l;if(s=i,o=i,null!==(e=qt())){for(t=[],l=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;null!==e&&(u=e[0],e=void(Fn.event=u.join("").toLowerCase()));var u;null===e&&(i=s);return e;},event_type:qt,From:function From(){var e,t,n,r,s,o,l;s=i,o=i,null===(e=$())&&(e=pt());if(null!==e){for(t=[],l=i,null!==(n=j())&&null!==(r=Lt())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=j())&&null!==(r=Lt())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;null!==e&&(e=function(e){var t=Fn.tag;try{Fn=new Hn(Fn.uri,Fn.display_name,Fn.params),t&&Fn.setParam("tag",t);}catch(e){Fn=-1;}}());null===e&&(i=s);return e;},from_param:Lt,tag_param:Ht,Max_Forwards:function Max_Forwards(){var e,t,n;if(n=i,null!==(t=c()))for(e=[];null!==t;){e.push(t),t=c();}else e=null;null!==e&&(e=void(Fn=parseInt(e.join(""))));null===e&&(i=n);return e;},Min_Expires:function Min_Expires(){var e,t;t=i,null!==(e=Tt())&&(e=void(Fn=e));null===e&&(i=t);return e;},Name_Addr_Header:function Name_Addr_Header(){var e,t,n,r,s,o,l,u,a,c;u=i,a=i,e=[],t=mt();for(;null!==t;){e.push(t),t=mt();}if(null!==e){if(null!==(t=H())){if(null!==(n=X())){if(null!==(r=L())){for(s=[],c=i,null!==(o=j())&&null!==(l=St())?o=[o,l]:(o=null,i=c);null!==o;){s.push(o),c=i,null!==(o=j())&&null!==(l=St())?o=[o,l]:(o=null,i=c);}null!==s?e=[e,t,n,r,s]:(e=null,i=a);}else e=null,i=a;}else e=null,i=a;}else e=null,i=a;}else e=null,i=a;null!==e&&(e=function(e){try{Fn=new Hn(Fn.uri,Fn.display_name,Fn.params);}catch(e){Fn=-1;}}());null===e&&(i=u);return e;},Proxy_Authenticate:function Proxy_Authenticate(){return Ft();},challenge:Ft,other_challenge:jt,auth_param:Gt,digest_cln:Bt,realm:Wt,realm_value:Vt,domain:Kt,URI:Yt,nonce:zt,nonce_value:Jt,opaque:$t,stale:Xt,algorithm:Qt,qop_options:Zt,qop_value:en,Proxy_Require:function Proxy_Require(){var e,t,n,r,s,o;if(s=i,null!==(e=k())){for(t=[],o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},Record_Route:function Record_Route(){var e,t,n,r,s,o,l;if(s=i,o=i,null!==(e=tn())){for(t=[],l=i,null!==(n=F())&&null!==(r=tn())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=F())&&null!==(r=tn())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;null!==e&&(e=function(e){var t,n;for(n=Fn.multi_header.length,t=0;t<n;t++){if(null===Fn.multi_header[t].parsed){Fn=null;break;}}Fn=null!==Fn?Fn.multi_header:-1;}());null===e&&(i=s);return e;},rec_route:tn,Reason:function Reason(){var e,t,r,s,o,l,a;o=i,l=i,"sip"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"SIP"'));null===e&&(e=k());if(null!==e){for(t=[],a=i,null!==(r=j())&&null!==(s=nn())?r=[r,s]:(r=null,i=a);null!==r;){t.push(r),a=i,null!==(r=j())&&null!==(s=nn())?r=[r,s]:(r=null,i=a);}null!==t?e=[e,t]:(e=null,i=l);}else e=null,i=l;null!==e&&(e=function(e,t){if(Fn.protocol=t.toLowerCase(),Fn.params||(Fn.params={}),Fn.params.text&&'"'===Fn.params.text[0]){var n=Fn.params.text;Fn.text=n.substring(1,n.length-1),delete Fn.params.text;}}(0,e[0]));null===e&&(i=o);return e;},reason_param:nn,reason_cause:rn,Require:function Require(){var e,t,n,r,s,o;if(s=i,null!==(e=k())){for(t=[],o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},Route:function Route(){var e,t,n,r,s,o;if(s=i,null!==(e=sn())){for(t=[],o=i,null!==(n=F())&&null!==(r=sn())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=F())&&null!==(r=sn())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},route_param:sn,Subscription_State:function Subscription_State(){var e,t,n,r,s,o;if(s=i,null!==(e=on())){for(t=[],o=i,null!==(n=j())&&null!==(r=ln())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=j())&&null!==(r=ln())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},substate_value:on,subexp_params:ln,event_reason_value:un,Subject:function Subject(){var e;return e=null!==(e=R())?e:"";},Supported:function Supported(){var e,t,n,r,s,o;if(s=i,null!==(e=k())){for(t=[],o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=F())&&null!==(r=k())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e=null!==e?e:"";},To:function To(){var e,t,n,r,s,o,l;s=i,o=i,null===(e=$())&&(e=pt());if(null!==e){for(t=[],l=i,null!==(n=j())&&null!==(r=an())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=j())&&null!==(r=an())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;null!==e&&(e=function(e){var t=Fn.tag;try{Fn=new Hn(Fn.uri,Fn.display_name,Fn.params),t&&Fn.setParam("tag",t);}catch(e){Fn=-1;}}());null===e&&(i=s);return e;},to_param:an,Via:function Via(){var e,t,n,r,s,o;if(s=i,null!==(e=cn())){for(t=[],o=i,null!==(n=F())&&null!==(r=cn())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=F())&&null!==(r=cn())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},via_param:cn,via_params:hn,via_ttl:fn,via_maddr:dn,via_received:_n,via_branch:pn,response_port:mn,rport:vn,sent_protocol:gn,protocol_name:yn,transport:Tn,sent_by:Cn,via_host:Sn,via_port:En,ttl:An,WWW_Authenticate:function WWW_Authenticate(){return Ft();},Session_Expires:function Session_Expires(){var e,t,n,r,s,o;if(s=i,null!==(e=bn())){for(t=[],o=i,null!==(n=j())&&null!==(r=Rn())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=j())&&null!==(r=Rn())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},s_e_expires:bn,s_e_params:Rn,s_e_refresher:wn,extension_header:function extension_header(){var e,t,n,r;r=i,null!==(e=k())&&null!==(t=b())&&null!==(n=In())?e=[e,t,n]:(e=null,i=r);return e;},header_value:In,message_body:function message_body(){var e,t;e=[],t=_();for(;null!==t;){e.push(t),t=_();}return e;},uuid_URI:function uuid_URI(){var e,t,r;r=i,"uuid:"===n.substr(i,5)?(e="uuid:",i+=5):(e=null,u('"uuid:"'));null!==e&&null!==(t=On())?e=[e,t]:(e=null,i=r);return e;},uuid:On,hex4:kn,hex8:Nn,hex12:Un,Refer_To:function Refer_To(){var e,t,n,r,s,o,l;s=i,o=i,null===(e=$())&&(e=pt());if(null!==e){for(t=[],l=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;null!==e&&(e=function(e){try{Fn=new Hn(Fn.uri,Fn.display_name,Fn.params);}catch(e){Fn=-1;}}());null===e&&(i=s);return e;},Replaces:function Replaces(){var e,t,n,r,s,o;if(s=i,null!==(e=xn())){for(t=[],o=i,null!==(n=j())&&null!==(r=Pn())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=j())&&null!==(r=Pn())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;},call_id:xn,replaces_param:Pn,to_tag:Dn,from_tag:Mn,early_flag:qn};if(void 0!==r){if(void 0===s[r])throw new Error("Invalid rule name: "+t(r)+".");}else r="CRLF";var i=0,o=0,l=[];function u(e){i<o||(i>o&&(o=i,l=[]),l.push(e));}function a(){var e;return"\r\n"===n.substr(i,2)?(e="\r\n",i+=2):(e=null,u('"\\r\\n"')),e;}function c(){var e;return /^[0-9]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[0-9]")),e;}function h(){var e;return /^[a-zA-Z]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[a-zA-Z]")),e;}function f(){var e;return /^[0-9a-fA-F]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[0-9a-fA-F]")),e;}function d(){var e;return null===(e=m())&&(e=v()),e;}function _(){var e;return /^[\0-\xFF]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[\\0-\\xFF]")),e;}function p(){var e;return /^["]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u('["]')),e;}function m(){var e;return 32===n.charCodeAt(i)?(e=" ",i++):(e=null,u('" "')),e;}function v(){var e;return 9===n.charCodeAt(i)?(e="\t",i++):(e=null,u('"\\t"')),e;}function g(){var e;return /^[a-zA-Z0-9]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[a-zA-Z0-9]")),e;}function y(){var e;return 59===n.charCodeAt(i)?(e=";",i++):(e=null,u('";"')),null===e&&(47===n.charCodeAt(i)?(e="/",i++):(e=null,u('"/"')),null===e&&(63===n.charCodeAt(i)?(e="?",i++):(e=null,u('"?"')),null===e&&(58===n.charCodeAt(i)?(e=":",i++):(e=null,u('":"')),null===e&&(64===n.charCodeAt(i)?(e="@",i++):(e=null,u('"@"')),null===e&&(38===n.charCodeAt(i)?(e="&",i++):(e=null,u('"&"')),null===e&&(61===n.charCodeAt(i)?(e="=",i++):(e=null,u('"="')),null===e&&(43===n.charCodeAt(i)?(e="+",i++):(e=null,u('"+"')),null===e&&(36===n.charCodeAt(i)?(e="$",i++):(e=null,u('"$"')),null===e&&(44===n.charCodeAt(i)?(e=",",i++):(e=null,u('","'))))))))))),e;}function T(){var e;return null===(e=g())&&(e=C()),e;}function C(){var e;return 45===n.charCodeAt(i)?(e="-",i++):(e=null,u('"-"')),null===e&&(95===n.charCodeAt(i)?(e="_",i++):(e=null,u('"_"')),null===e&&(46===n.charCodeAt(i)?(e=".",i++):(e=null,u('"."')),null===e&&(33===n.charCodeAt(i)?(e="!",i++):(e=null,u('"!"')),null===e&&(126===n.charCodeAt(i)?(e="~",i++):(e=null,u('"~"')),null===e&&(42===n.charCodeAt(i)?(e="*",i++):(e=null,u('"*"')),null===e&&(39===n.charCodeAt(i)?(e="'",i++):(e=null,u('"\'"')),null===e&&(40===n.charCodeAt(i)?(e="(",i++):(e=null,u('"("')),null===e&&(41===n.charCodeAt(i)?(e=")",i++):(e=null,u('")"')))))))))),e;}function S(){var e,t,r,s,o;return s=i,o=i,37===n.charCodeAt(i)?(e="%",i++):(e=null,u('"%"')),null!==e&&null!==(t=f())&&null!==(r=f())?e=[e,t,r]:(e=null,i=o),null!==e&&(e=e.join("")),null===e&&(i=s),e;}function E(){var e,t,n,r,s,o;for(r=i,s=i,o=i,e=[],t=d();null!==t;){e.push(t),t=d();}if(null!==e&&null!==(t=a())?e=[e,t]:(e=null,i=o),null!==(e=null!==e?e:"")){if(null!==(n=d()))for(t=[];null!==n;){t.push(n),n=d();}else t=null;null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return null!==e&&(e=" "),null===e&&(i=r),e;}function A(){var e;return e=null!==(e=E())?e:"";}function b(){var e,t,r,s,o;for(s=i,o=i,e=[],null===(t=m())&&(t=v());null!==t;){e.push(t),null===(t=m())&&(t=v());}return null!==e?(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=":"),null===e&&(i=s),e;}function R(){var e,t,r,s,o,l,u;if(o=i,l=i,null!==(t=w()))for(e=[];null!==t;){e.push(t),t=w();}else e=null;if(null!==e){for(t=[],u=i,r=[],s=E();null!==s;){r.push(s),s=E();}for(null!==r&&null!==(s=w())?r=[r,s]:(r=null,i=u);null!==r;){for(t.push(r),u=i,r=[],s=E();null!==s;){r.push(s),s=E();}null!==r&&null!==(s=w())?r=[r,s]:(r=null,i=u);}null!==t?e=[e,t]:(e=null,i=l);}else e=null,i=l;return null!==e&&(e=function(e){return n.substring(i,e);}(o)),null===e&&(i=o),e;}function w(){var e;return /^[!-~]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[!-~]")),null===e&&(e=I()),e;}function I(){var e;return /^[\x80-\uFFFF]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[\\x80-\\uFFFF]")),e;}function O(){var e;return /^[\x80-\xBF]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[\\x80-\\xBF]")),e;}function k(){var e,t,r;if(r=i,null===(t=g())&&(45===n.charCodeAt(i)?(t="-",i++):(t=null,u('"-"')),null===t&&(46===n.charCodeAt(i)?(t=".",i++):(t=null,u('"."')),null===t&&(33===n.charCodeAt(i)?(t="!",i++):(t=null,u('"!"')),null===t&&(37===n.charCodeAt(i)?(t="%",i++):(t=null,u('"%"')),null===t&&(42===n.charCodeAt(i)?(t="*",i++):(t=null,u('"*"')),null===t&&(95===n.charCodeAt(i)?(t="_",i++):(t=null,u('"_"')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(96===n.charCodeAt(i)?(t="`",i++):(t=null,u('"`"')),null===t&&(39===n.charCodeAt(i)?(t="'",i++):(t=null,u('"\'"')),null===t&&(126===n.charCodeAt(i)?(t="~",i++):(t=null,u('"~"')))))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=g())&&(45===n.charCodeAt(i)?(t="-",i++):(t=null,u('"-"')),null===t&&(46===n.charCodeAt(i)?(t=".",i++):(t=null,u('"."')),null===t&&(33===n.charCodeAt(i)?(t="!",i++):(t=null,u('"!"')),null===t&&(37===n.charCodeAt(i)?(t="%",i++):(t=null,u('"%"')),null===t&&(42===n.charCodeAt(i)?(t="*",i++):(t=null,u('"*"')),null===t&&(95===n.charCodeAt(i)?(t="_",i++):(t=null,u('"_"')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(96===n.charCodeAt(i)?(t="`",i++):(t=null,u('"`"')),null===t&&(39===n.charCodeAt(i)?(t="'",i++):(t=null,u('"\'"')),null===t&&(126===n.charCodeAt(i)?(t="~",i++):(t=null,u('"~"'))))))))))));}else e=null;return null!==e&&(e=function(e){return n.substring(i,e);}(r)),null===e&&(i=r),e;}function N(){var e,t,r;if(r=i,null===(t=g())&&(45===n.charCodeAt(i)?(t="-",i++):(t=null,u('"-"')),null===t&&(33===n.charCodeAt(i)?(t="!",i++):(t=null,u('"!"')),null===t&&(37===n.charCodeAt(i)?(t="%",i++):(t=null,u('"%"')),null===t&&(42===n.charCodeAt(i)?(t="*",i++):(t=null,u('"*"')),null===t&&(95===n.charCodeAt(i)?(t="_",i++):(t=null,u('"_"')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(96===n.charCodeAt(i)?(t="`",i++):(t=null,u('"`"')),null===t&&(39===n.charCodeAt(i)?(t="'",i++):(t=null,u('"\'"')),null===t&&(126===n.charCodeAt(i)?(t="~",i++):(t=null,u('"~"'))))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=g())&&(45===n.charCodeAt(i)?(t="-",i++):(t=null,u('"-"')),null===t&&(33===n.charCodeAt(i)?(t="!",i++):(t=null,u('"!"')),null===t&&(37===n.charCodeAt(i)?(t="%",i++):(t=null,u('"%"')),null===t&&(42===n.charCodeAt(i)?(t="*",i++):(t=null,u('"*"')),null===t&&(95===n.charCodeAt(i)?(t="_",i++):(t=null,u('"_"')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(96===n.charCodeAt(i)?(t="`",i++):(t=null,u('"`"')),null===t&&(39===n.charCodeAt(i)?(t="'",i++):(t=null,u('"\'"')),null===t&&(126===n.charCodeAt(i)?(t="~",i++):(t=null,u('"~"')))))))))));}else e=null;return null!==e&&(e=function(e){return n.substring(i,e);}(r)),null===e&&(i=r),e;}function U(){var e,t,r;if(r=i,null===(t=g())&&(45===n.charCodeAt(i)?(t="-",i++):(t=null,u('"-"')),null===t&&(46===n.charCodeAt(i)?(t=".",i++):(t=null,u('"."')),null===t&&(33===n.charCodeAt(i)?(t="!",i++):(t=null,u('"!"')),null===t&&(37===n.charCodeAt(i)?(t="%",i++):(t=null,u('"%"')),null===t&&(42===n.charCodeAt(i)?(t="*",i++):(t=null,u('"*"')),null===t&&(95===n.charCodeAt(i)?(t="_",i++):(t=null,u('"_"')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(96===n.charCodeAt(i)?(t="`",i++):(t=null,u('"`"')),null===t&&(39===n.charCodeAt(i)?(t="'",i++):(t=null,u('"\'"')),null===t&&(126===n.charCodeAt(i)?(t="~",i++):(t=null,u('"~"')),null===t&&(40===n.charCodeAt(i)?(t="(",i++):(t=null,u('"("')),null===t&&(41===n.charCodeAt(i)?(t=")",i++):(t=null,u('")"')),null===t&&(60===n.charCodeAt(i)?(t="<",i++):(t=null,u('"<"')),null===t&&(62===n.charCodeAt(i)?(t=">",i++):(t=null,u('">"')),null===t&&(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null===t&&(92===n.charCodeAt(i)?(t="\\",i++):(t=null,u('"\\\\"')),null===t&&null===(t=p())&&(47===n.charCodeAt(i)?(t="/",i++):(t=null,u('"/"')),null===t&&(91===n.charCodeAt(i)?(t="[",i++):(t=null,u('"["')),null===t&&(93===n.charCodeAt(i)?(t="]",i++):(t=null,u('"]"')),null===t&&(63===n.charCodeAt(i)?(t="?",i++):(t=null,u('"?"')),null===t&&(123===n.charCodeAt(i)?(t="{",i++):(t=null,u('"{"')),null===t&&(125===n.charCodeAt(i)?(t="}",i++):(t=null,u('"}"')))))))))))))))))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=g())&&(45===n.charCodeAt(i)?(t="-",i++):(t=null,u('"-"')),null===t&&(46===n.charCodeAt(i)?(t=".",i++):(t=null,u('"."')),null===t&&(33===n.charCodeAt(i)?(t="!",i++):(t=null,u('"!"')),null===t&&(37===n.charCodeAt(i)?(t="%",i++):(t=null,u('"%"')),null===t&&(42===n.charCodeAt(i)?(t="*",i++):(t=null,u('"*"')),null===t&&(95===n.charCodeAt(i)?(t="_",i++):(t=null,u('"_"')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(96===n.charCodeAt(i)?(t="`",i++):(t=null,u('"`"')),null===t&&(39===n.charCodeAt(i)?(t="'",i++):(t=null,u('"\'"')),null===t&&(126===n.charCodeAt(i)?(t="~",i++):(t=null,u('"~"')),null===t&&(40===n.charCodeAt(i)?(t="(",i++):(t=null,u('"("')),null===t&&(41===n.charCodeAt(i)?(t=")",i++):(t=null,u('")"')),null===t&&(60===n.charCodeAt(i)?(t="<",i++):(t=null,u('"<"')),null===t&&(62===n.charCodeAt(i)?(t=">",i++):(t=null,u('">"')),null===t&&(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null===t&&(92===n.charCodeAt(i)?(t="\\",i++):(t=null,u('"\\\\"')),null===t&&null===(t=p())&&(47===n.charCodeAt(i)?(t="/",i++):(t=null,u('"/"')),null===t&&(91===n.charCodeAt(i)?(t="[",i++):(t=null,u('"["')),null===t&&(93===n.charCodeAt(i)?(t="]",i++):(t=null,u('"]"')),null===t&&(63===n.charCodeAt(i)?(t="?",i++):(t=null,u('"?"')),null===t&&(123===n.charCodeAt(i)?(t="{",i++):(t=null,u('"{"')),null===t&&(125===n.charCodeAt(i)?(t="}",i++):(t=null,u('"}"'))))))))))))))))))))))));}else e=null;return null!==e&&(e=function(e){return n.substring(i,e);}(r)),null===e&&(i=r),e;}function x(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(42===n.charCodeAt(i)?(t="*",i++):(t=null,u('"*"')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e="*"),null===e&&(i=s),e;}function P(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(47===n.charCodeAt(i)?(t="/",i++):(t=null,u('"/"')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e="/"),null===e&&(i=s),e;}function D(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e="="),null===e&&(i=s),e;}function M(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(40===n.charCodeAt(i)?(t="(",i++):(t=null,u('"("')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e="("),null===e&&(i=s),e;}function q(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(41===n.charCodeAt(i)?(t=")",i++):(t=null,u('")"')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=")"),null===e&&(i=s),e;}function L(){var e,t,r,s;return r=i,s=i,62===n.charCodeAt(i)?(e=">",i++):(e=null,u('">"')),null!==e&&null!==(t=A())?e=[e,t]:(e=null,i=s),null!==e&&(e=">"),null===e&&(i=r),e;}function H(){var e,t,r,s;return r=i,s=i,null!==(e=A())?(60===n.charCodeAt(i)?(t="<",i++):(t=null,u('"<"')),null!==t?e=[e,t]:(e=null,i=s)):(e=null,i=s),null!==e&&(e="<"),null===e&&(i=r),e;}function F(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(44===n.charCodeAt(i)?(t=",",i++):(t=null,u('","')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=","),null===e&&(i=s),e;}function j(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(59===n.charCodeAt(i)?(t=";",i++):(t=null,u('";"')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=";"),null===e&&(i=s),e;}function G(){var e,t,r,s,o;return s=i,o=i,null!==(e=A())?(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=A())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=":"),null===e&&(i=s),e;}function B(){var e,t,n,r;return n=i,r=i,null!==(e=A())&&null!==(t=p())?e=[e,t]:(e=null,i=r),null!==e&&(e='"'),null===e&&(i=n),e;}function W(){var e,t,n,r;return n=i,r=i,null!==(e=p())&&null!==(t=A())?e=[e,t]:(e=null,i=r),null!==e&&(e='"'),null===e&&(i=n),e;}function V(){var e;return /^[!-']/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[!-']")),null===e&&(/^[*-[]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[*-[]")),null===e&&(/^[\]-~]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[\\]-~]")),null===e&&null===(e=I())&&(e=E()))),e;}function K(){var e,t,r,s,o,l;if(o=i,l=i,null!==(e=A())){if(null!==(t=p())){for(r=[],null===(s=z())&&(s=J());null!==s;){r.push(s),null===(s=z())&&(s=J());}null!==r&&null!==(s=p())?e=[e,t,r,s]:(e=null,i=l);}else e=null,i=l;}else e=null,i=l;return null!==e&&(e=function(e){return n.substring(i,e);}(o)),null===e&&(i=o),e;}function Y(){var e,t,r,s,o,l;if(o=i,l=i,null!==(e=A())){if(null!==(t=p())){for(r=[],null===(s=z())&&(s=J());null!==s;){r.push(s),null===(s=z())&&(s=J());}null!==r&&null!==(s=p())?e=[e,t,r,s]:(e=null,i=l);}else e=null,i=l;}else e=null,i=l;return null!==e&&(e=function(e){var t=n.substring(i,e).trim();return t.substring(1,t.length-1).replace(/\\([\x00-\x09\x0b-\x0c\x0e-\x7f])/g,"$1");}(o)),null===e&&(i=o),e;}function z(){var e;return null===(e=E())&&(33===n.charCodeAt(i)?(e="!",i++):(e=null,u('"!"')),null===e&&(/^[#-[]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[#-[]")),null===e&&(/^[\]-~]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[\\]-~]")),null===e&&(e=I())))),e;}function J(){var e,t,r;return r=i,92===n.charCodeAt(i)?(e="\\",i++):(e=null,u('"\\\\"')),null!==e?(/^[\0-\t]/.test(n.charAt(i))?(t=n.charAt(i),i++):(t=null,u("[\\0-\\t]")),null===t&&(/^[\x0B-\f]/.test(n.charAt(i))?(t=n.charAt(i),i++):(t=null,u("[\\x0B-\\f]")),null===t&&(/^[\x0E-]/.test(n.charAt(i))?(t=n.charAt(i),i++):(t=null,u("[\\x0E-]")))),null!==t?e=[e,t]:(e=null,i=r)):(e=null,i=r),e;}function $(){var e,t,r,s,o,l;return o=i,l=i,null!==(e=Q())?(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=null!==(r=te())?r:"")&&null!==(s=ie())?e=[e,t,r,s]:(e=null,i=l)):(e=null,i=l),null!==e&&(e=function(e){try{Fn.uri=new Ln(Fn.scheme,Fn.user,Fn.host,Fn.port),delete Fn.scheme,delete Fn.user,delete Fn.host,delete Fn.host_type,delete Fn.port;}catch(e){Fn=-1;}}()),null===e&&(i=o),e;}function X(){var e,t,s,o,l,a,c,h;return c=i,h=i,null!==(e=Q())?(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(s=null!==(s=te())?s:"")&&null!==(o=ie())&&null!==(l=ve())&&null!==(a=null!==(a=ke())?a:"")?e=[e,t,s,o,l,a]:(e=null,i=h)):(e=null,i=h),null!==e&&(e=function(e){try{Fn.uri=new Ln(Fn.scheme,Fn.user,Fn.host,Fn.port,Fn.uri_params,Fn.uri_headers),delete Fn.scheme,delete Fn.user,delete Fn.host,delete Fn.host_type,delete Fn.port,delete Fn.uri_params,"SIP_URI"===r&&(Fn=Fn.uri);}catch(e){Fn=-1;}}()),null===e&&(i=c),e;}function Q(){var e;return null===(e=Z())&&(e=ee()),e;}function Z(){var e,t,r;return t=i,"sips"===n.substr(i,4).toLowerCase()?(e=n.substr(i,4),i+=4):(e=null,u('"sips"')),null!==e&&(r=e,e=void(Fn.scheme=r.toLowerCase())),null===e&&(i=t),e;}function ee(){var e,t,r;return t=i,"sip"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"sip"')),null!==e&&(r=e,e=void(Fn.scheme=r.toLowerCase())),null===e&&(i=t),e;}function te(){var e,t,r,s,o,l;return s=i,o=i,null!==(e=ne())?(l=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=se())?t=[t,r]:(t=null,i=l),null!==(t=null!==t?t:"")?(64===n.charCodeAt(i)?(r="@",i++):(r=null,u('"@"')),null!==r?e=[e,t,r]:(e=null,i=o)):(e=null,i=o)):(e=null,i=o),null!==e&&(e=function(e){Fn.user=decodeURIComponent(n.substring(i-1,e));}(s)),null===e&&(i=s),e;}function ne(){var e,t;if(null===(t=T())&&null===(t=S())&&(t=re()),null!==t)for(e=[];null!==t;){e.push(t),null===(t=T())&&null===(t=S())&&(t=re());}else e=null;return e;}function re(){var e;return 38===n.charCodeAt(i)?(e="&",i++):(e=null,u('"&"')),null===e&&(61===n.charCodeAt(i)?(e="=",i++):(e=null,u('"="')),null===e&&(43===n.charCodeAt(i)?(e="+",i++):(e=null,u('"+"')),null===e&&(36===n.charCodeAt(i)?(e="$",i++):(e=null,u('"$"')),null===e&&(44===n.charCodeAt(i)?(e=",",i++):(e=null,u('","')),null===e&&(59===n.charCodeAt(i)?(e=";",i++):(e=null,u('";"')),null===e&&(63===n.charCodeAt(i)?(e="?",i++):(e=null,u('"?"')),null===e&&(47===n.charCodeAt(i)?(e="/",i++):(e=null,u('"/"'))))))))),e;}function se(){var e,t,r;for(r=i,e=[],null===(t=T())&&null===(t=S())&&(38===n.charCodeAt(i)?(t="&",i++):(t=null,u('"&"')),null===t&&(61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(36===n.charCodeAt(i)?(t="$",i++):(t=null,u('"$"')),null===t&&(44===n.charCodeAt(i)?(t=",",i++):(t=null,u('","')))))));null!==t;){e.push(t),null===(t=T())&&null===(t=S())&&(38===n.charCodeAt(i)?(t="&",i++):(t=null,u('"&"')),null===t&&(61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')),null===t&&(36===n.charCodeAt(i)?(t="$",i++):(t=null,u('"$"')),null===t&&(44===n.charCodeAt(i)?(t=",",i++):(t=null,u('","')))))));}return null!==e&&(e=function(e){Fn.password=n.substring(i,e);}(r)),null===e&&(i=r),e;}function ie(){var e,t,r,s,o;return s=i,null!==(e=oe())?(o=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=me())?t=[t,r]:(t=null,i=o),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=s)):(e=null,i=s),e;}function oe(){var e,t;return t=i,null===(e=le())&&null===(e=_e())&&(e=ce()),null!==e&&(e=function(e){return Fn.host=n.substring(i,e).toLowerCase(),Fn.host;}(t)),null===e&&(i=t),e;}function le(){var e,t,r,s,o,l;for(s=i,o=i,e=[],l=i,null!==(t=ue())?(46===n.charCodeAt(i)?(r=".",i++):(r=null,u('"."')),null!==r?t=[t,r]:(t=null,i=l)):(t=null,i=l);null!==t;){e.push(t),l=i,null!==(t=ue())?(46===n.charCodeAt(i)?(r=".",i++):(r=null,u('"."')),null!==r?t=[t,r]:(t=null,i=l)):(t=null,i=l);}return null!==e&&null!==(t=ae())?(46===n.charCodeAt(i)?(r=".",i++):(r=null,u('"."')),null!==(r=null!==r?r:"")?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=function(e){return Fn.host_type="domain",n.substring(i,e);}(s)),null===e&&(i=s),e;}function ue(){var e,t,r,s;if(s=i,null!==(e=g())){for(t=[],null===(r=g())&&(45===n.charCodeAt(i)?(r="-",i++):(r=null,u('"-"')),null===r&&(95===n.charCodeAt(i)?(r="_",i++):(r=null,u('"_"'))));null!==r;){t.push(r),null===(r=g())&&(45===n.charCodeAt(i)?(r="-",i++):(r=null,u('"-"')),null===r&&(95===n.charCodeAt(i)?(r="_",i++):(r=null,u('"_"'))));}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;}function ae(){var e,t,r,s;if(s=i,null!==(e=h())){for(t=[],null===(r=g())&&(45===n.charCodeAt(i)?(r="-",i++):(r=null,u('"-"')),null===r&&(95===n.charCodeAt(i)?(r="_",i++):(r=null,u('"_"'))));null!==r;){t.push(r),null===(r=g())&&(45===n.charCodeAt(i)?(r="-",i++):(r=null,u('"-"')),null===r&&(95===n.charCodeAt(i)?(r="_",i++):(r=null,u('"_"'))));}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;}function ce(){var e,t,r,s,o;return s=i,o=i,91===n.charCodeAt(i)?(e="[",i++):(e=null,u('"["')),null!==e&&null!==(t=he())?(93===n.charCodeAt(i)?(r="]",i++):(r=null,u('"]"')),null!==r?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=function(e){return Fn.host_type="IPv6",n.substring(i,e);}(s)),null===e&&(i=s),e;}function he(){var e,t,r,s,o,l,a,c,h,f,d,_,p,m,v,g;return m=i,v=i,null!==(e=fe())?(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?(58===n.charCodeAt(i)?(s=":",i++):(s=null,u('":"')),null!==s&&null!==(o=fe())?(58===n.charCodeAt(i)?(l=":",i++):(l=null,u('":"')),null!==l&&null!==(a=fe())?(58===n.charCodeAt(i)?(c=":",i++):(c=null,u('":"')),null!==c&&null!==(h=fe())?(58===n.charCodeAt(i)?(f=":",i++):(f=null,u('":"')),null!==f&&null!==(d=fe())?(58===n.charCodeAt(i)?(_=":",i++):(_=null,u('":"')),null!==_&&null!==(p=de())?e=[e,t,r,s,o,l,a,c,h,f,d,_,p]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,"::"===n.substr(i,2)?(e="::",i+=2):(e=null,u('"::"')),null!==e&&null!==(t=fe())?(58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?(58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=fe())?(58===n.charCodeAt(i)?(a=":",i++):(a=null,u('":"')),null!==a&&null!==(c=fe())?(58===n.charCodeAt(i)?(h=":",i++):(h=null,u('":"')),null!==h&&null!==(f=fe())?(58===n.charCodeAt(i)?(d=":",i++):(d=null,u('":"')),null!==d&&null!==(_=de())?e=[e,t,r,s,o,l,a,c,h,f,d,_]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,"::"===n.substr(i,2)?(e="::",i+=2):(e=null,u('"::"')),null!==e&&null!==(t=fe())?(58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?(58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=fe())?(58===n.charCodeAt(i)?(a=":",i++):(a=null,u('":"')),null!==a&&null!==(c=fe())?(58===n.charCodeAt(i)?(h=":",i++):(h=null,u('":"')),null!==h&&null!==(f=de())?e=[e,t,r,s,o,l,a,c,h,f]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,"::"===n.substr(i,2)?(e="::",i+=2):(e=null,u('"::"')),null!==e&&null!==(t=fe())?(58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?(58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=fe())?(58===n.charCodeAt(i)?(a=":",i++):(a=null,u('":"')),null!==a&&null!==(c=de())?e=[e,t,r,s,o,l,a,c]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,"::"===n.substr(i,2)?(e="::",i+=2):(e=null,u('"::"')),null!==e&&null!==(t=fe())?(58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?(58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=de())?e=[e,t,r,s,o,l]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,"::"===n.substr(i,2)?(e="::",i+=2):(e=null,u('"::"')),null!==e&&null!==(t=fe())?(58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=de())?e=[e,t,r,s]:(e=null,i=v)):(e=null,i=v),null===e&&(v=i,"::"===n.substr(i,2)?(e="::",i+=2):(e=null,u('"::"')),null!==e&&null!==(t=de())?e=[e,t]:(e=null,i=v),null===e&&(v=i,"::"===n.substr(i,2)?(e="::",i+=2):(e=null,u('"::"')),null!==e&&null!==(t=fe())?e=[e,t]:(e=null,i=v),null===e&&(v=i,null!==(e=fe())?("::"===n.substr(i,2)?(t="::",i+=2):(t=null,u('"::"')),null!==t&&null!==(r=fe())?(58===n.charCodeAt(i)?(s=":",i++):(s=null,u('":"')),null!==s&&null!==(o=fe())?(58===n.charCodeAt(i)?(l=":",i++):(l=null,u('":"')),null!==l&&null!==(a=fe())?(58===n.charCodeAt(i)?(c=":",i++):(c=null,u('":"')),null!==c&&null!==(h=fe())?(58===n.charCodeAt(i)?(f=":",i++):(f=null,u('":"')),null!==f&&null!==(d=de())?e=[e,t,r,s,o,l,a,c,h,f,d]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,null!==(e=fe())?(g=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?t=[t,r]:(t=null,i=g),null!==(t=null!==t?t:"")?("::"===n.substr(i,2)?(r="::",i+=2):(r=null,u('"::"')),null!==r&&null!==(s=fe())?(58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=fe())?(58===n.charCodeAt(i)?(a=":",i++):(a=null,u('":"')),null!==a&&null!==(c=fe())?(58===n.charCodeAt(i)?(h=":",i++):(h=null,u('":"')),null!==h&&null!==(f=de())?e=[e,t,r,s,o,l,a,c,h,f]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,null!==(e=fe())?(g=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?t=[t,r]:(t=null,i=g),null!==(t=null!==t?t:"")?(g=i,58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?r=[r,s]:(r=null,i=g),null!==(r=null!==r?r:"")?("::"===n.substr(i,2)?(s="::",i+=2):(s=null,u('"::"')),null!==s&&null!==(o=fe())?(58===n.charCodeAt(i)?(l=":",i++):(l=null,u('":"')),null!==l&&null!==(a=fe())?(58===n.charCodeAt(i)?(c=":",i++):(c=null,u('":"')),null!==c&&null!==(h=de())?e=[e,t,r,s,o,l,a,c,h]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,null!==(e=fe())?(g=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?t=[t,r]:(t=null,i=g),null!==(t=null!==t?t:"")?(g=i,58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?r=[r,s]:(r=null,i=g),null!==(r=null!==r?r:"")?(g=i,58===n.charCodeAt(i)?(s=":",i++):(s=null,u('":"')),null!==s&&null!==(o=fe())?s=[s,o]:(s=null,i=g),null!==(s=null!==s?s:"")?("::"===n.substr(i,2)?(o="::",i+=2):(o=null,u('"::"')),null!==o&&null!==(l=fe())?(58===n.charCodeAt(i)?(a=":",i++):(a=null,u('":"')),null!==a&&null!==(c=de())?e=[e,t,r,s,o,l,a,c]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,null!==(e=fe())?(g=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?t=[t,r]:(t=null,i=g),null!==(t=null!==t?t:"")?(g=i,58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?r=[r,s]:(r=null,i=g),null!==(r=null!==r?r:"")?(g=i,58===n.charCodeAt(i)?(s=":",i++):(s=null,u('":"')),null!==s&&null!==(o=fe())?s=[s,o]:(s=null,i=g),null!==(s=null!==s?s:"")?(g=i,58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=fe())?o=[o,l]:(o=null,i=g),null!==(o=null!==o?o:"")?("::"===n.substr(i,2)?(l="::",i+=2):(l=null,u('"::"')),null!==l&&null!==(a=de())?e=[e,t,r,s,o,l,a]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,null!==(e=fe())?(g=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?t=[t,r]:(t=null,i=g),null!==(t=null!==t?t:"")?(g=i,58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?r=[r,s]:(r=null,i=g),null!==(r=null!==r?r:"")?(g=i,58===n.charCodeAt(i)?(s=":",i++):(s=null,u('":"')),null!==s&&null!==(o=fe())?s=[s,o]:(s=null,i=g),null!==(s=null!==s?s:"")?(g=i,58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=fe())?o=[o,l]:(o=null,i=g),null!==(o=null!==o?o:"")?(g=i,58===n.charCodeAt(i)?(l=":",i++):(l=null,u('":"')),null!==l&&null!==(a=fe())?l=[l,a]:(l=null,i=g),null!==(l=null!==l?l:"")?("::"===n.substr(i,2)?(a="::",i+=2):(a=null,u('"::"')),null!==a&&null!==(c=fe())?e=[e,t,r,s,o,l,a,c]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v),null===e&&(v=i,null!==(e=fe())?(g=i,58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?t=[t,r]:(t=null,i=g),null!==(t=null!==t?t:"")?(g=i,58===n.charCodeAt(i)?(r=":",i++):(r=null,u('":"')),null!==r&&null!==(s=fe())?r=[r,s]:(r=null,i=g),null!==(r=null!==r?r:"")?(g=i,58===n.charCodeAt(i)?(s=":",i++):(s=null,u('":"')),null!==s&&null!==(o=fe())?s=[s,o]:(s=null,i=g),null!==(s=null!==s?s:"")?(g=i,58===n.charCodeAt(i)?(o=":",i++):(o=null,u('":"')),null!==o&&null!==(l=fe())?o=[o,l]:(o=null,i=g),null!==(o=null!==o?o:"")?(g=i,58===n.charCodeAt(i)?(l=":",i++):(l=null,u('":"')),null!==l&&null!==(a=fe())?l=[l,a]:(l=null,i=g),null!==(l=null!==l?l:"")?(g=i,58===n.charCodeAt(i)?(a=":",i++):(a=null,u('":"')),null!==a&&null!==(c=fe())?a=[a,c]:(a=null,i=g),null!==(a=null!==a?a:"")?("::"===n.substr(i,2)?(c="::",i+=2):(c=null,u('"::"')),null!==c?e=[e,t,r,s,o,l,a,c]:(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v)):(e=null,i=v))))))))))))))),null!==e&&(e=function(e){return Fn.host_type="IPv6",n.substring(i,e);}(m)),null===e&&(i=m),e;}function fe(){var e,t,n,r,s;return s=i,null!==(e=f())&&null!==(t=null!==(t=f())?t:"")&&null!==(n=null!==(n=f())?n:"")&&null!==(r=null!==(r=f())?r:"")?e=[e,t,n,r]:(e=null,i=s),e;}function de(){var e,t,r,s;return s=i,null!==(e=fe())?(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t&&null!==(r=fe())?e=[e,t,r]:(e=null,i=s)):(e=null,i=s),null===e&&(e=_e()),e;}function _e(){var e,t,r,s,o,l,a,c,h;return c=i,h=i,null!==(e=pe())?(46===n.charCodeAt(i)?(t=".",i++):(t=null,u('"."')),null!==t&&null!==(r=pe())?(46===n.charCodeAt(i)?(s=".",i++):(s=null,u('"."')),null!==s&&null!==(o=pe())?(46===n.charCodeAt(i)?(l=".",i++):(l=null,u('"."')),null!==l&&null!==(a=pe())?e=[e,t,r,s,o,l,a]:(e=null,i=h)):(e=null,i=h)):(e=null,i=h)):(e=null,i=h),null!==e&&(e=function(e){return Fn.host_type="IPv4",n.substring(i,e);}(c)),null===e&&(i=c),e;}function pe(){var e,t,r,s;return s=i,"25"===n.substr(i,2)?(e="25",i+=2):(e=null,u('"25"')),null!==e?(/^[0-5]/.test(n.charAt(i))?(t=n.charAt(i),i++):(t=null,u("[0-5]")),null!==t?e=[e,t]:(e=null,i=s)):(e=null,i=s),null===e&&(s=i,50===n.charCodeAt(i)?(e="2",i++):(e=null,u('"2"')),null!==e?(/^[0-4]/.test(n.charAt(i))?(t=n.charAt(i),i++):(t=null,u("[0-4]")),null!==t&&null!==(r=c())?e=[e,t,r]:(e=null,i=s)):(e=null,i=s),null===e&&(s=i,49===n.charCodeAt(i)?(e="1",i++):(e=null,u('"1"')),null!==e&&null!==(t=c())&&null!==(r=c())?e=[e,t,r]:(e=null,i=s),null===e&&(s=i,/^[1-9]/.test(n.charAt(i))?(e=n.charAt(i),i++):(e=null,u("[1-9]")),null!==e&&null!==(t=c())?e=[e,t]:(e=null,i=s),null===e&&(e=c())))),e;}function me(){var e,t,n,r,s,o,l,u;return o=i,l=i,null!==(e=null!==(e=c())?e:"")&&null!==(t=null!==(t=c())?t:"")&&null!==(n=null!==(n=c())?n:"")&&null!==(r=null!==(r=c())?r:"")&&null!==(s=null!==(s=c())?s:"")?e=[e,t,n,r,s]:(e=null,i=l),null!==e&&(u=e,u=parseInt(u.join("")),Fn.port=u,e=u),null===e&&(i=o),e;}function ve(){var e,t,r,s;for(e=[],s=i,59===n.charCodeAt(i)?(t=";",i++):(t=null,u('";"')),null!==t&&null!==(r=ge())?t=[t,r]:(t=null,i=s);null!==t;){e.push(t),s=i,59===n.charCodeAt(i)?(t=";",i++):(t=null,u('";"')),null!==t&&null!==(r=ge())?t=[t,r]:(t=null,i=s);}return e;}function ge(){var e;return null===(e=ye())&&null===(e=Te())&&null===(e=Ce())&&null===(e=Se())&&null===(e=Ee())&&null===(e=Ae())&&(e=be()),e;}function ye(){var e,t,r,s,o;return r=i,s=i,"transport="===n.substr(i,10).toLowerCase()?(e=n.substr(i,10),i+=10):(e=null,u('"transport="')),null!==e?("udp"===n.substr(i,3).toLowerCase()?(t=n.substr(i,3),i+=3):(t=null,u('"udp"')),null===t&&("tcp"===n.substr(i,3).toLowerCase()?(t=n.substr(i,3),i+=3):(t=null,u('"tcp"')),null===t&&("sctp"===n.substr(i,4).toLowerCase()?(t=n.substr(i,4),i+=4):(t=null,u('"sctp"')),null===t&&("tls"===n.substr(i,3).toLowerCase()?(t=n.substr(i,3),i+=3):(t=null,u('"tls"')),null===t&&(t=k())))),null!==t?e=[e,t]:(e=null,i=s)):(e=null,i=s),null!==e&&(o=e[1],Fn.uri_params||(Fn.uri_params={}),e=void(Fn.uri_params.transport=o.toLowerCase())),null===e&&(i=r),e;}function Te(){var e,t,r,s,o;return r=i,s=i,"user="===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"user="')),null!==e?("phone"===n.substr(i,5).toLowerCase()?(t=n.substr(i,5),i+=5):(t=null,u('"phone"')),null===t&&("ip"===n.substr(i,2).toLowerCase()?(t=n.substr(i,2),i+=2):(t=null,u('"ip"')),null===t&&(t=k())),null!==t?e=[e,t]:(e=null,i=s)):(e=null,i=s),null!==e&&(o=e[1],Fn.uri_params||(Fn.uri_params={}),e=void(Fn.uri_params.user=o.toLowerCase())),null===e&&(i=r),e;}function Ce(){var e,t,r,s,o;return r=i,s=i,"method="===n.substr(i,7).toLowerCase()?(e=n.substr(i,7),i+=7):(e=null,u('"method="')),null!==e&&null!==(t=at())?e=[e,t]:(e=null,i=s),null!==e&&(o=e[1],Fn.uri_params||(Fn.uri_params={}),e=void(Fn.uri_params.method=o)),null===e&&(i=r),e;}function Se(){var e,t,r,s,o;return r=i,s=i,"ttl="===n.substr(i,4).toLowerCase()?(e=n.substr(i,4),i+=4):(e=null,u('"ttl="')),null!==e&&null!==(t=An())?e=[e,t]:(e=null,i=s),null!==e&&(o=e[1],Fn.params||(Fn.params={}),e=void(Fn.params.ttl=o)),null===e&&(i=r),e;}function Ee(){var e,t,r,s,o;return r=i,s=i,"maddr="===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"maddr="')),null!==e&&null!==(t=oe())?e=[e,t]:(e=null,i=s),null!==e&&(o=e[1],Fn.uri_params||(Fn.uri_params={}),e=void(Fn.uri_params.maddr=o)),null===e&&(i=r),e;}function Ae(){var e,t,r,s,o,l;return s=i,o=i,"lr"===n.substr(i,2).toLowerCase()?(e=n.substr(i,2),i+=2):(e=null,u('"lr"')),null!==e?(l=i,61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null!==t&&null!==(r=k())?t=[t,r]:(t=null,i=l),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=o)):(e=null,i=o),null!==e&&(Fn.uri_params||(Fn.uri_params={}),e=void(Fn.uri_params.lr=void 0)),null===e&&(i=s),e;}function be(){var e,t,r,s,o,l,a,c;return s=i,o=i,null!==(e=Re())?(l=i,61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null!==t&&null!==(r=we())?t=[t,r]:(t=null,i=l),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=o)):(e=null,i=o),null!==e&&(a=e[0],c=e[1],Fn.uri_params||(Fn.uri_params={}),c=void 0===c?void 0:c[1],e=void(Fn.uri_params[a.toLowerCase()]=c)),null===e&&(i=s),e;}function Re(){var e,t,n;if(n=i,null!==(t=Ie()))for(e=[];null!==t;){e.push(t),t=Ie();}else e=null;return null!==e&&(e=e.join("")),null===e&&(i=n),e;}function we(){var e,t,n;if(n=i,null!==(t=Ie()))for(e=[];null!==t;){e.push(t),t=Ie();}else e=null;return null!==e&&(e=e.join("")),null===e&&(i=n),e;}function Ie(){var e;return null===(e=Oe())&&null===(e=T())&&(e=S()),e;}function Oe(){var e;return 91===n.charCodeAt(i)?(e="[",i++):(e=null,u('"["')),null===e&&(93===n.charCodeAt(i)?(e="]",i++):(e=null,u('"]"')),null===e&&(47===n.charCodeAt(i)?(e="/",i++):(e=null,u('"/"')),null===e&&(58===n.charCodeAt(i)?(e=":",i++):(e=null,u('":"')),null===e&&(38===n.charCodeAt(i)?(e="&",i++):(e=null,u('"&"')),null===e&&(43===n.charCodeAt(i)?(e="+",i++):(e=null,u('"+"')),null===e&&(36===n.charCodeAt(i)?(e="$",i++):(e=null,u('"$"')))))))),e;}function ke(){var e,t,r,s,o,l,a;if(l=i,63===n.charCodeAt(i)?(e="?",i++):(e=null,u('"?"')),null!==e){if(null!==(t=Ne())){for(r=[],a=i,38===n.charCodeAt(i)?(s="&",i++):(s=null,u('"&"')),null!==s&&null!==(o=Ne())?s=[s,o]:(s=null,i=a);null!==s;){r.push(s),a=i,38===n.charCodeAt(i)?(s="&",i++):(s=null,u('"&"')),null!==s&&null!==(o=Ne())?s=[s,o]:(s=null,i=a);}null!==r?e=[e,t,r]:(e=null,i=l);}else e=null,i=l;}else e=null,i=l;return e;}function Ne(){var e,t,r,s,o,l,a;return s=i,o=i,null!==(e=Ue())?(61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null!==t&&null!==(r=xe())?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(l=e[0],a=e[2],l=l.join("").toLowerCase(),a=a.join(""),Fn.uri_headers||(Fn.uri_headers={}),e=void(Fn.uri_headers[l]?Fn.uri_headers[l].push(a):Fn.uri_headers[l]=[a])),null===e&&(i=s),e;}function Ue(){var e,t;if(null===(t=Pe())&&null===(t=T())&&(t=S()),null!==t)for(e=[];null!==t;){e.push(t),null===(t=Pe())&&null===(t=T())&&(t=S());}else e=null;return e;}function xe(){var e,t;for(e=[],null===(t=Pe())&&null===(t=T())&&(t=S());null!==t;){e.push(t),null===(t=Pe())&&null===(t=T())&&(t=S());}return e;}function Pe(){var e;return 91===n.charCodeAt(i)?(e="[",i++):(e=null,u('"["')),null===e&&(93===n.charCodeAt(i)?(e="]",i++):(e=null,u('"]"')),null===e&&(47===n.charCodeAt(i)?(e="/",i++):(e=null,u('"/"')),null===e&&(63===n.charCodeAt(i)?(e="?",i++):(e=null,u('"?"')),null===e&&(58===n.charCodeAt(i)?(e=":",i++):(e=null,u('":"')),null===e&&(43===n.charCodeAt(i)?(e="+",i++):(e=null,u('"+"')),null===e&&(36===n.charCodeAt(i)?(e="$",i++):(e=null,u('"$"')))))))),e;}function De(){var e,t,n,r,s,o;return o=i,null!==(e=at())&&null!==(t=m())&&null!==(n=Me())&&null!==(r=m())&&null!==(s=Ze())?e=[e,t,n,r,s]:(e=null,i=o),e;}function Me(){var e;return null===(e=X())&&(e=qe()),e;}function qe(){var e,t,r,s;return s=i,null!==(e=ze())?(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null!==t?(null===(r=Le())&&(r=je()),null!==r?e=[e,t,r]:(e=null,i=s)):(e=null,i=s)):(e=null,i=s),e;}function Le(){var e,t,r,s,o;return s=i,null===(e=He())&&(e=Fe()),null!==e?(o=i,63===n.charCodeAt(i)?(t="?",i++):(t=null,u('"?"')),null!==t&&null!==(r=Qe())?t=[t,r]:(t=null,i=o),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=s)):(e=null,i=s),e;}function He(){var e,t,r,s;return s=i,"//"===n.substr(i,2)?(e="//",i+=2):(e=null,u('"//"')),null!==e&&null!==(t=Je())&&null!==(r=null!==(r=Fe())?r:"")?e=[e,t,r]:(e=null,i=s),e;}function Fe(){var e,t,r;return r=i,47===n.charCodeAt(i)?(e="/",i++):(e=null,u('"/"')),null!==e&&null!==(t=We())?e=[e,t]:(e=null,i=r),e;}function je(){var e,t,n,r;if(r=i,null!==(e=Be())){for(t=[],n=Ge();null!==n;){t.push(n),n=Ge();}null!==t?e=[e,t]:(e=null,i=r);}else e=null,i=r;return e;}function Ge(){var e;return null===(e=y())&&null===(e=T())&&(e=S()),e;}function Be(){var e;return null===(e=T())&&null===(e=S())&&(59===n.charCodeAt(i)?(e=";",i++):(e=null,u('";"')),null===e&&(63===n.charCodeAt(i)?(e="?",i++):(e=null,u('"?"')),null===e&&(58===n.charCodeAt(i)?(e=":",i++):(e=null,u('":"')),null===e&&(64===n.charCodeAt(i)?(e="@",i++):(e=null,u('"@"')),null===e&&(38===n.charCodeAt(i)?(e="&",i++):(e=null,u('"&"')),null===e&&(61===n.charCodeAt(i)?(e="=",i++):(e=null,u('"="')),null===e&&(43===n.charCodeAt(i)?(e="+",i++):(e=null,u('"+"')),null===e&&(36===n.charCodeAt(i)?(e="$",i++):(e=null,u('"$"')),null===e&&(44===n.charCodeAt(i)?(e=",",i++):(e=null,u('","'))))))))))),e;}function We(){var e,t,r,s,o,l;if(o=i,null!==(e=Ve())){for(t=[],l=i,47===n.charCodeAt(i)?(r="/",i++):(r=null,u('"/"')),null!==r&&null!==(s=Ve())?r=[r,s]:(r=null,i=l);null!==r;){t.push(r),l=i,47===n.charCodeAt(i)?(r="/",i++):(r=null,u('"/"')),null!==r&&null!==(s=Ve())?r=[r,s]:(r=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;return e;}function Ve(){var e,t,r,s,o,l;for(o=i,e=[],t=Ye();null!==t;){e.push(t),t=Ye();}if(null!==e){for(t=[],l=i,59===n.charCodeAt(i)?(r=";",i++):(r=null,u('";"')),null!==r&&null!==(s=Ke())?r=[r,s]:(r=null,i=l);null!==r;){t.push(r),l=i,59===n.charCodeAt(i)?(r=";",i++):(r=null,u('";"')),null!==r&&null!==(s=Ke())?r=[r,s]:(r=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;return e;}function Ke(){var e,t;for(e=[],t=Ye();null!==t;){e.push(t),t=Ye();}return e;}function Ye(){var e;return null===(e=T())&&null===(e=S())&&(58===n.charCodeAt(i)?(e=":",i++):(e=null,u('":"')),null===e&&(64===n.charCodeAt(i)?(e="@",i++):(e=null,u('"@"')),null===e&&(38===n.charCodeAt(i)?(e="&",i++):(e=null,u('"&"')),null===e&&(61===n.charCodeAt(i)?(e="=",i++):(e=null,u('"="')),null===e&&(43===n.charCodeAt(i)?(e="+",i++):(e=null,u('"+"')),null===e&&(36===n.charCodeAt(i)?(e="$",i++):(e=null,u('"$"')),null===e&&(44===n.charCodeAt(i)?(e=",",i++):(e=null,u('","'))))))))),e;}function ze(){var e,t,r,s,o;if(s=i,o=i,null!==(e=h())){for(t=[],null===(r=h())&&null===(r=c())&&(43===n.charCodeAt(i)?(r="+",i++):(r=null,u('"+"')),null===r&&(45===n.charCodeAt(i)?(r="-",i++):(r=null,u('"-"')),null===r&&(46===n.charCodeAt(i)?(r=".",i++):(r=null,u('"."')))));null!==r;){t.push(r),null===(r=h())&&null===(r=c())&&(43===n.charCodeAt(i)?(r="+",i++):(r=null,u('"+"')),null===r&&(45===n.charCodeAt(i)?(r="-",i++):(r=null,u('"-"')),null===r&&(46===n.charCodeAt(i)?(r=".",i++):(r=null,u('"."')))));}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;return null!==e&&(e=function(e){Fn.scheme=n.substring(i,e);}(s)),null===e&&(i=s),e;}function Je(){var e;return null===(e=$e())&&(e=Xe()),e;}function $e(){var e,t,r,s;return r=i,s=i,null!==(e=te())?(64===n.charCodeAt(i)?(t="@",i++):(t=null,u('"@"')),null!==t?e=[e,t]:(e=null,i=s)):(e=null,i=s),null!==(e=null!==e?e:"")&&null!==(t=ie())?e=[e,t]:(e=null,i=r),e=null!==e?e:"";}function Xe(){var e,t;if(null===(t=T())&&null===(t=S())&&(36===n.charCodeAt(i)?(t="$",i++):(t=null,u('"$"')),null===t&&(44===n.charCodeAt(i)?(t=",",i++):(t=null,u('","')),null===t&&(59===n.charCodeAt(i)?(t=";",i++):(t=null,u('";"')),null===t&&(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null===t&&(64===n.charCodeAt(i)?(t="@",i++):(t=null,u('"@"')),null===t&&(38===n.charCodeAt(i)?(t="&",i++):(t=null,u('"&"')),null===t&&(61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"')))))))))),null!==t)for(e=[];null!==t;){e.push(t),null===(t=T())&&null===(t=S())&&(36===n.charCodeAt(i)?(t="$",i++):(t=null,u('"$"')),null===t&&(44===n.charCodeAt(i)?(t=",",i++):(t=null,u('","')),null===t&&(59===n.charCodeAt(i)?(t=";",i++):(t=null,u('";"')),null===t&&(58===n.charCodeAt(i)?(t=":",i++):(t=null,u('":"')),null===t&&(64===n.charCodeAt(i)?(t="@",i++):(t=null,u('"@"')),null===t&&(38===n.charCodeAt(i)?(t="&",i++):(t=null,u('"&"')),null===t&&(61===n.charCodeAt(i)?(t="=",i++):(t=null,u('"="')),null===t&&(43===n.charCodeAt(i)?(t="+",i++):(t=null,u('"+"'))))))))));}else e=null;return e;}function Qe(){var e,t;for(e=[],t=Ge();null!==t;){e.push(t),t=Ge();}return e;}function Ze(){var e,t,r,s,o,l,a,h;if(a=i,h=i,"sip"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"SIP"')),null!==e){if(47===n.charCodeAt(i)?(t="/",i++):(t=null,u('"/"')),null!==t){if(null!==(s=c()))for(r=[];null!==s;){r.push(s),s=c();}else r=null;if(null!==r){if(46===n.charCodeAt(i)?(s=".",i++):(s=null,u('"."')),null!==s){if(null!==(l=c()))for(o=[];null!==l;){o.push(l),l=c();}else o=null;null!==o?e=[e,t,r,s,o]:(e=null,i=h);}else e=null,i=h;}else e=null,i=h;}else e=null,i=h;}else e=null,i=h;return null!==e&&(e=function(e){Fn.sip_version=n.substring(i,e);}(a)),null===e&&(i=a),e;}function et(){var e;return"INVITE"===n.substr(i,6)?(e="INVITE",i+=6):(e=null,u('"INVITE"')),e;}function tt(){var e;return"ACK"===n.substr(i,3)?(e="ACK",i+=3):(e=null,u('"ACK"')),e;}function nt(){var e;return"OPTIONS"===n.substr(i,7)?(e="OPTIONS",i+=7):(e=null,u('"OPTIONS"')),e;}function rt(){var e;return"BYE"===n.substr(i,3)?(e="BYE",i+=3):(e=null,u('"BYE"')),e;}function st(){var e;return"CANCEL"===n.substr(i,6)?(e="CANCEL",i+=6):(e=null,u('"CANCEL"')),e;}function it(){var e;return"REGISTER"===n.substr(i,8)?(e="REGISTER",i+=8):(e=null,u('"REGISTER"')),e;}function ot(){var e;return"SUBSCRIBE"===n.substr(i,9)?(e="SUBSCRIBE",i+=9):(e=null,u('"SUBSCRIBE"')),e;}function lt(){var e;return"NOTIFY"===n.substr(i,6)?(e="NOTIFY",i+=6):(e=null,u('"NOTIFY"')),e;}function ut(){var e;return"REFER"===n.substr(i,5)?(e="REFER",i+=5):(e=null,u('"REFER"')),e;}function at(){var e,t;return t=i,null===(e=et())&&null===(e=tt())&&null===(e=nt())&&null===(e=rt())&&null===(e=st())&&null===(e=it())&&null===(e=ot())&&null===(e=lt())&&null===(e=ut())&&(e=k()),null!==e&&(e=function(e){return Fn.method=n.substring(i,e),Fn.method;}(t)),null===e&&(i=t),e;}function ct(){var e,t,n,r,s,o;return o=i,null!==(e=Ze())&&null!==(t=m())&&null!==(n=ht())&&null!==(r=m())&&null!==(s=dt())?e=[e,t,n,r,s]:(e=null,i=o),e;}function ht(){var e,t,n;return t=i,null!==(e=ft())&&(n=e,e=void(Fn.status_code=parseInt(n.join("")))),null===e&&(i=t),e;}function ft(){var e,t,n,r;return r=i,null!==(e=c())&&null!==(t=c())&&null!==(n=c())?e=[e,t,n]:(e=null,i=r),e;}function dt(){var e,t,r;for(r=i,e=[],null===(t=y())&&null===(t=T())&&null===(t=S())&&null===(t=I())&&null===(t=O())&&null===(t=m())&&(t=v());null!==t;){e.push(t),null===(t=y())&&null===(t=T())&&null===(t=S())&&null===(t=I())&&null===(t=O())&&null===(t=m())&&(t=v());}return null!==e&&(e=function(e){Fn.reason_phrase=n.substring(i,e);}(r)),null===e&&(i=r),e;}function _t(){var e,t,n,r,s,o,l;if(s=i,o=i,null===(e=$())&&(e=pt()),null!==e){for(t=[],l=i,null!==(n=j())&&null!==(r=vt())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=j())&&null!==(r=vt())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;return null!==e&&(e=function(e){var t;Fn.multi_header||(Fn.multi_header=[]);try{t=new Hn(Fn.uri,Fn.display_name,Fn.params),delete Fn.uri,delete Fn.display_name,delete Fn.params;}catch(e){t=null;}Fn.multi_header.push({possition:i,offset:e,parsed:t});}(s)),null===e&&(i=s),e;}function pt(){var e,t,n,r,s;return s=i,null!==(e=null!==(e=mt())?e:"")&&null!==(t=H())&&null!==(n=X())&&null!==(r=L())?e=[e,t,n,r]:(e=null,i=s),e;}function mt(){var e,t,n,r,s,o,l,u;if(s=i,o=i,null!==(e=k())){for(t=[],l=i,null!==(n=E())&&null!==(r=k())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=E())&&null!==(r=k())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;return null===e&&(e=Y()),null!==e&&(u=e,e=void(Fn.display_name="string"==typeof u?u:u[1].reduce(function(e,t){return e+t[0]+t[1];},u[0]))),null===e&&(i=s),e;}function vt(){var e;return null===(e=gt())&&null===(e=yt())&&(e=St()),e;}function gt(){var e,t,r,s,o,l;return s=i,o=i,"q"===n.substr(i,1).toLowerCase()?(e=n.substr(i,1),i++):(e=null,u('"q"')),null!==e&&null!==(t=D())&&null!==(r=Ct())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],Fn.params||(Fn.params={}),e=void(Fn.params.q=l)),null===e&&(i=s),e;}function yt(){var e,t,r,s,o,l;return s=i,o=i,"expires"===n.substr(i,7).toLowerCase()?(e=n.substr(i,7),i+=7):(e=null,u('"expires"')),null!==e&&null!==(t=D())&&null!==(r=Tt())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],Fn.params||(Fn.params={}),e=void(Fn.params.expires=l)),null===e&&(i=s),e;}function Tt(){var e,t,n;if(n=i,null!==(t=c()))for(e=[];null!==t;){e.push(t),t=c();}else e=null;return null!==e&&(e=parseInt(e.join(""))),null===e&&(i=n),e;}function Ct(){var e,t,r,s,o,l,a,h;return l=i,a=i,48===n.charCodeAt(i)?(e="0",i++):(e=null,u('"0"')),null!==e?(h=i,46===n.charCodeAt(i)?(t=".",i++):(t=null,u('"."')),null!==t&&null!==(r=null!==(r=c())?r:"")&&null!==(s=null!==(s=c())?s:"")&&null!==(o=null!==(o=c())?o:"")?t=[t,r,s,o]:(t=null,i=h),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=a)):(e=null,i=a),null!==e&&(e=function(e){return parseFloat(n.substring(i,e));}(l)),null===e&&(i=l),e;}function St(){var e,t,n,r,s,o,l,u;return r=i,s=i,null!==(e=k())?(o=i,null!==(t=D())&&null!==(n=Et())?t=[t,n]:(t=null,i=o),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=s)):(e=null,i=s),null!==e&&(l=e[0],u=e[1],Fn.params||(Fn.params={}),u=void 0===u?void 0:u[1],e=void(Fn.params[l.toLowerCase()]=u)),null===e&&(i=r),e;}function Et(){var e;return null===(e=k())&&null===(e=oe())&&(e=K()),e;}function At(){var e;return"render"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"render"')),null===e&&("session"===n.substr(i,7).toLowerCase()?(e=n.substr(i,7),i+=7):(e=null,u('"session"')),null===e&&("icon"===n.substr(i,4).toLowerCase()?(e=n.substr(i,4),i+=4):(e=null,u('"icon"')),null===e&&("alert"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"alert"')),null===e&&(e=k())))),e;}function bt(){var e;return null===(e=Rt())&&(e=St()),e;}function Rt(){var e,t,r,s;return s=i,"handling"===n.substr(i,8).toLowerCase()?(e=n.substr(i,8),i+=8):(e=null,u('"handling"')),null!==e&&null!==(t=D())?("optional"===n.substr(i,8).toLowerCase()?(r=n.substr(i,8),i+=8):(r=null,u('"optional"')),null===r&&("required"===n.substr(i,8).toLowerCase()?(r=n.substr(i,8),i+=8):(r=null,u('"required"')),null===r&&(r=k())),null!==r?e=[e,t,r]:(e=null,i=s)):(e=null,i=s),e;}function wt(){var e,t,n,r,s,o,l,u;if(l=i,null!==(e=It())){if(null!==(t=P())){if(null!==(n=xt())){for(r=[],u=i,null!==(s=j())&&null!==(o=Pt())?s=[s,o]:(s=null,i=u);null!==s;){r.push(s),u=i,null!==(s=j())&&null!==(o=Pt())?s=[s,o]:(s=null,i=u);}null!==r?e=[e,t,n,r]:(e=null,i=l);}else e=null,i=l;}else e=null,i=l;}else e=null,i=l;return e;}function It(){var e;return null===(e=Ot())&&(e=kt()),e;}function Ot(){var e;return"text"===n.substr(i,4).toLowerCase()?(e=n.substr(i,4),i+=4):(e=null,u('"text"')),null===e&&("image"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"image"')),null===e&&("audio"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"audio"')),null===e&&("video"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"video"')),null===e&&("application"===n.substr(i,11).toLowerCase()?(e=n.substr(i,11),i+=11):(e=null,u('"application"')),null===e&&(e=Nt()))))),e;}function kt(){var e;return"message"===n.substr(i,7).toLowerCase()?(e=n.substr(i,7),i+=7):(e=null,u('"message"')),null===e&&("multipart"===n.substr(i,9).toLowerCase()?(e=n.substr(i,9),i+=9):(e=null,u('"multipart"')),null===e&&(e=Nt())),e;}function Nt(){var e;return null===(e=k())&&(e=Ut()),e;}function Ut(){var e,t,r;return r=i,"x-"===n.substr(i,2).toLowerCase()?(e=n.substr(i,2),i+=2):(e=null,u('"x-"')),null!==e&&null!==(t=k())?e=[e,t]:(e=null,i=r),e;}function xt(){var e;return null===(e=Nt())&&(e=k()),e;}function Pt(){var e,t,n,r;return r=i,null!==(e=k())&&null!==(t=D())&&null!==(n=Dt())?e=[e,t,n]:(e=null,i=r),e;}function Dt(){var e;return null===(e=k())&&(e=K()),e;}function Mt(){var e,t,n,r;if(n=i,null!==(t=c()))for(e=[];null!==t;){e.push(t),t=c();}else e=null;return null!==e&&(r=e,e=void(Fn.value=parseInt(r.join("")))),null===e&&(i=n),e;}function qt(){var e,t,r,s,o,l;if(o=i,null!==(e=N())){for(t=[],l=i,46===n.charCodeAt(i)?(r=".",i++):(r=null,u('"."')),null!==r&&null!==(s=N())?r=[r,s]:(r=null,i=l);null!==r;){t.push(r),l=i,46===n.charCodeAt(i)?(r=".",i++):(r=null,u('"."')),null!==r&&null!==(s=N())?r=[r,s]:(r=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;return e;}function Lt(){var e;return null===(e=Ht())&&(e=St()),e;}function Ht(){var e,t,r,s,o,l;return s=i,o=i,"tag"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"tag"')),null!==e&&null!==(t=D())&&null!==(r=k())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.tag=l)),null===e&&(i=s),e;}function Ft(){var e,t,r,s,o,l,a,c;if(a=i,"digest"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"Digest"')),null!==e){if(null!==(t=E())){if(null!==(r=Bt())){for(s=[],c=i,null!==(o=F())&&null!==(l=Bt())?o=[o,l]:(o=null,i=c);null!==o;){s.push(o),c=i,null!==(o=F())&&null!==(l=Bt())?o=[o,l]:(o=null,i=c);}null!==s?e=[e,t,r,s]:(e=null,i=a);}else e=null,i=a;}else e=null,i=a;}else e=null,i=a;return null===e&&(e=jt()),e;}function jt(){var e,t,n,r,s,o,l,u;if(l=i,null!==(e=k())){if(null!==(t=E())){if(null!==(n=Gt())){for(r=[],u=i,null!==(s=F())&&null!==(o=Gt())?s=[s,o]:(s=null,i=u);null!==s;){r.push(s),u=i,null!==(s=F())&&null!==(o=Gt())?s=[s,o]:(s=null,i=u);}null!==r?e=[e,t,n,r]:(e=null,i=l);}else e=null,i=l;}else e=null,i=l;}else e=null,i=l;return e;}function Gt(){var e,t,n,r;return r=i,null!==(e=k())&&null!==(t=D())?(null===(n=k())&&(n=K()),null!==n?e=[e,t,n]:(e=null,i=r)):(e=null,i=r),e;}function Bt(){var e;return null===(e=Wt())&&null===(e=Kt())&&null===(e=zt())&&null===(e=$t())&&null===(e=Xt())&&null===(e=Qt())&&null===(e=Zt())&&(e=Gt()),e;}function Wt(){var e,t,r,s;return s=i,"realm"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"realm"')),null!==e&&null!==(t=D())&&null!==(r=Vt())?e=[e,t,r]:(e=null,i=s),e;}function Vt(){var e,t,n;return t=i,null!==(e=Y())&&(n=e,e=void(Fn.realm=n)),null===e&&(i=t),e;}function Kt(){var e,t,r,s,o,l,a,c,h;if(c=i,"domain"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"domain"')),null!==e){if(null!==(t=D())){if(null!==(r=B())){if(null!==(s=Yt())){if(o=[],h=i,null!==(a=m()))for(l=[];null!==a;){l.push(a),a=m();}else l=null;for(null!==l&&null!==(a=Yt())?l=[l,a]:(l=null,i=h);null!==l;){if(o.push(l),h=i,null!==(a=m()))for(l=[];null!==a;){l.push(a),a=m();}else l=null;null!==l&&null!==(a=Yt())?l=[l,a]:(l=null,i=h);}null!==o&&null!==(l=W())?e=[e,t,r,s,o,l]:(e=null,i=c);}else e=null,i=c;}else e=null,i=c;}else e=null,i=c;}else e=null,i=c;return e;}function Yt(){var e;return null===(e=qe())&&(e=Fe()),e;}function zt(){var e,t,r,s;return s=i,"nonce"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"nonce"')),null!==e&&null!==(t=D())&&null!==(r=Jt())?e=[e,t,r]:(e=null,i=s),e;}function Jt(){var e,t,n;return t=i,null!==(e=Y())&&(n=e,e=void(Fn.nonce=n)),null===e&&(i=t),e;}function $t(){var e,t,r,s,o,l;return s=i,o=i,"opaque"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"opaque"')),null!==e&&null!==(t=D())&&null!==(r=Y())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.opaque=l)),null===e&&(i=s),e;}function Xt(){var e,t,r,s,o;return s=i,"stale"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"stale"')),null!==e&&null!==(t=D())?(o=i,"true"===n.substr(i,4).toLowerCase()?(r=n.substr(i,4),i+=4):(r=null,u('"true"')),null!==r&&(r=void(Fn.stale=!0)),null===r&&(i=o),null===r&&(o=i,"false"===n.substr(i,5).toLowerCase()?(r=n.substr(i,5),i+=5):(r=null,u('"false"')),null!==r&&(r=void(Fn.stale=!1)),null===r&&(i=o)),null!==r?e=[e,t,r]:(e=null,i=s)):(e=null,i=s),e;}function Qt(){var e,t,r,s,o,l;return s=i,o=i,"algorithm"===n.substr(i,9).toLowerCase()?(e=n.substr(i,9),i+=9):(e=null,u('"algorithm"')),null!==e&&null!==(t=D())?("md5"===n.substr(i,3).toLowerCase()?(r=n.substr(i,3),i+=3):(r=null,u('"MD5"')),null===r&&("md5-sess"===n.substr(i,8).toLowerCase()?(r=n.substr(i,8),i+=8):(r=null,u('"MD5-sess"')),null===r&&(r=k())),null!==r?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.algorithm=l.toUpperCase())),null===e&&(i=s),e;}function Zt(){var e,t,r,s,o,l,a,c,h,f;if(c=i,"qop"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"qop"')),null!==e){if(null!==(t=D())){if(null!==(r=B())){if(h=i,null!==(s=en())){for(o=[],f=i,44===n.charCodeAt(i)?(l=",",i++):(l=null,u('","')),null!==l&&null!==(a=en())?l=[l,a]:(l=null,i=f);null!==l;){o.push(l),f=i,44===n.charCodeAt(i)?(l=",",i++):(l=null,u('","')),null!==l&&null!==(a=en())?l=[l,a]:(l=null,i=f);}null!==o?s=[s,o]:(s=null,i=h);}else s=null,i=h;null!==s&&null!==(o=W())?e=[e,t,r,s,o]:(e=null,i=c);}else e=null,i=c;}else e=null,i=c;}else e=null,i=c;return e;}function en(){var e,t,r;return t=i,"auth-int"===n.substr(i,8).toLowerCase()?(e=n.substr(i,8),i+=8):(e=null,u('"auth-int"')),null===e&&("auth"===n.substr(i,4).toLowerCase()?(e=n.substr(i,4),i+=4):(e=null,u('"auth"')),null===e&&(e=k())),null!==e&&(r=e,Fn.qop||(Fn.qop=[]),e=void Fn.qop.push(r.toLowerCase())),null===e&&(i=t),e;}function tn(){var e,t,n,r,s,o,l;if(s=i,o=i,null!==(e=pt())){for(t=[],l=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=l);null!==n;){t.push(n),l=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=l);}null!==t?e=[e,t]:(e=null,i=o);}else e=null,i=o;return null!==e&&(e=function(e){var t;Fn.multi_header||(Fn.multi_header=[]);try{t=new Hn(Fn.uri,Fn.display_name,Fn.params),delete Fn.uri,delete Fn.display_name,delete Fn.params;}catch(e){t=null;}Fn.multi_header.push({possition:i,offset:e,parsed:t});}(s)),null===e&&(i=s),e;}function nn(){var e;return null===(e=rn())&&(e=St()),e;}function rn(){var e,t,r,s,o,l,a;if(o=i,l=i,"cause"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"cause"')),null!==e){if(null!==(t=D())){if(null!==(s=c()))for(r=[];null!==s;){r.push(s),s=c();}else r=null;null!==r?e=[e,t,r]:(e=null,i=l);}else e=null,i=l;}else e=null,i=l;return null!==e&&(a=e[2],e=void(Fn.cause=parseInt(a.join("")))),null===e&&(i=o),e;}function sn(){var e,t,n,r,s,o;if(s=i,null!==(e=pt())){for(t=[],o=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=o);null!==n;){t.push(n),o=i,null!==(n=j())&&null!==(r=St())?n=[n,r]:(n=null,i=o);}null!==t?e=[e,t]:(e=null,i=s);}else e=null,i=s;return e;}function on(){var e,t;return t=i,"active"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"active"')),null===e&&("pending"===n.substr(i,7).toLowerCase()?(e=n.substr(i,7),i+=7):(e=null,u('"pending"')),null===e&&("terminated"===n.substr(i,10).toLowerCase()?(e=n.substr(i,10),i+=10):(e=null,u('"terminated"')),null===e&&(e=k()))),null!==e&&(e=function(e){Fn.state=n.substring(i,e);}(t)),null===e&&(i=t),e;}function ln(){var e,t,r,s,o,l,a,c;return s=i,o=i,"reason"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"reason"')),null!==e&&null!==(t=D())&&null!==(r=un())?e=[e,t,r]:(e=null,i=o),null!==e&&(e=void(void 0!==(l=e[2])&&(Fn.reason=l))),null===e&&(i=s),null===e&&(s=i,o=i,"expires"===n.substr(i,7).toLowerCase()?(e=n.substr(i,7),i+=7):(e=null,u('"expires"')),null!==e&&null!==(t=D())&&null!==(r=Tt())?e=[e,t,r]:(e=null,i=o),null!==e&&(e=void(void 0!==(c=e[2])&&(Fn.expires=c))),null===e&&(i=s),null===e&&(s=i,o=i,"retry_after"===n.substr(i,11).toLowerCase()?(e=n.substr(i,11),i+=11):(e=null,u('"retry_after"')),null!==e&&null!==(t=D())&&null!==(r=Tt())?e=[e,t,r]:(e=null,i=o),null!==e&&(e=void(void 0!==(a=e[2])&&(Fn.retry_after=a))),null===e&&(i=s),null===e&&(e=St()))),e;}function un(){var e;return"deactivated"===n.substr(i,11).toLowerCase()?(e=n.substr(i,11),i+=11):(e=null,u('"deactivated"')),null===e&&("probation"===n.substr(i,9).toLowerCase()?(e=n.substr(i,9),i+=9):(e=null,u('"probation"')),null===e&&("rejected"===n.substr(i,8).toLowerCase()?(e=n.substr(i,8),i+=8):(e=null,u('"rejected"')),null===e&&("timeout"===n.substr(i,7).toLowerCase()?(e=n.substr(i,7),i+=7):(e=null,u('"timeout"')),null===e&&("giveup"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"giveup"')),null===e&&("noresource"===n.substr(i,10).toLowerCase()?(e=n.substr(i,10),i+=10):(e=null,u('"noresource"')),null===e&&("invariant"===n.substr(i,9).toLowerCase()?(e=n.substr(i,9),i+=9):(e=null,u('"invariant"')),null===e&&(e=k()))))))),e;}function an(){var e;return null===(e=Ht())&&(e=St()),e;}function cn(){var e,t,n,r,s,o,l,u;if(l=i,null!==(e=gn())){if(null!==(t=E())){if(null!==(n=Cn())){for(r=[],u=i,null!==(s=j())&&null!==(o=hn())?s=[s,o]:(s=null,i=u);null!==s;){r.push(s),u=i,null!==(s=j())&&null!==(o=hn())?s=[s,o]:(s=null,i=u);}null!==r?e=[e,t,n,r]:(e=null,i=l);}else e=null,i=l;}else e=null,i=l;}else e=null,i=l;return e;}function hn(){var e;return null===(e=fn())&&null===(e=dn())&&null===(e=_n())&&null===(e=pn())&&null===(e=mn())&&(e=St()),e;}function fn(){var e,t,r,s,o,l;return s=i,o=i,"ttl"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"ttl"')),null!==e&&null!==(t=D())&&null!==(r=An())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.ttl=l)),null===e&&(i=s),e;}function dn(){var e,t,r,s,o,l;return s=i,o=i,"maddr"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"maddr"')),null!==e&&null!==(t=D())&&null!==(r=oe())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.maddr=l)),null===e&&(i=s),e;}function _n(){var e,t,r,s,o,l;return s=i,o=i,"received"===n.substr(i,8).toLowerCase()?(e=n.substr(i,8),i+=8):(e=null,u('"received"')),null!==e&&null!==(t=D())?(null===(r=_e())&&(r=he()),null!==r?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.received=l)),null===e&&(i=s),e;}function pn(){var e,t,r,s,o,l;return s=i,o=i,"branch"===n.substr(i,6).toLowerCase()?(e=n.substr(i,6),i+=6):(e=null,u('"branch"')),null!==e&&null!==(t=D())&&null!==(r=k())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.branch=l)),null===e&&(i=s),e;}function mn(){var e,t,r,s,o;return s=i,"rport"===n.substr(i,5).toLowerCase()?(e=n.substr(i,5),i+=5):(e=null,u('"rport"')),null!==e?(o=i,null!==(t=D())&&null!==(r=vn())?t=[t,r]:(t=null,i=o),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=s)):(e=null,i=s),e;}function vn(){var e,t,n,r,s,o,l,u;return o=i,l=i,null!==(e=null!==(e=c())?e:"")&&null!==(t=null!==(t=c())?t:"")&&null!==(n=null!==(n=c())?n:"")&&null!==(r=null!==(r=c())?r:"")&&null!==(s=null!==(s=c())?s:"")?e=[e,t,n,r,s]:(e=null,i=l),null!==e&&(u=e,e=void(Fn.rport=parseInt(u.join("")))),null===e&&(i=o),e;}function gn(){var e,t,n,r,s,o;return o=i,null!==(e=yn())&&null!==(t=P())&&null!==(n=k())&&null!==(r=P())&&null!==(s=Tn())?e=[e,t,n,r,s]:(e=null,i=o),e;}function yn(){var e,t,r;return t=i,"sip"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"SIP"')),null===e&&(e=k()),null!==e&&(r=e,e=void(Fn.protocol=r)),null===e&&(i=t),e;}function Tn(){var e,t,r;return t=i,"udp"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"UDP"')),null===e&&("tcp"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"TCP"')),null===e&&("tls"===n.substr(i,3).toLowerCase()?(e=n.substr(i,3),i+=3):(e=null,u('"TLS"')),null===e&&("sctp"===n.substr(i,4).toLowerCase()?(e=n.substr(i,4),i+=4):(e=null,u('"SCTP"')),null===e&&(e=k())))),null!==e&&(r=e,e=void(Fn.transport=r)),null===e&&(i=t),e;}function Cn(){var e,t,n,r,s;return r=i,null!==(e=Sn())?(s=i,null!==(t=G())&&null!==(n=En())?t=[t,n]:(t=null,i=s),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=r)):(e=null,i=r),e;}function Sn(){var e,t;return t=i,null===(e=_e())&&null===(e=ce())&&(e=le()),null!==e&&(e=function(e){Fn.host=n.substring(i,e);}(t)),null===e&&(i=t),e;}function En(){var e,t,n,r,s,o,l,u;return o=i,l=i,null!==(e=null!==(e=c())?e:"")&&null!==(t=null!==(t=c())?t:"")&&null!==(n=null!==(n=c())?n:"")&&null!==(r=null!==(r=c())?r:"")&&null!==(s=null!==(s=c())?s:"")?e=[e,t,n,r,s]:(e=null,i=l),null!==e&&(u=e,e=void(Fn.port=parseInt(u.join("")))),null===e&&(i=o),e;}function An(){var e,t,n,r,s;return r=i,s=i,null!==(e=c())&&null!==(t=null!==(t=c())?t:"")&&null!==(n=null!==(n=c())?n:"")?e=[e,t,n]:(e=null,i=s),null!==e&&(e=parseInt(e.join(""))),null===e&&(i=r),e;}function bn(){var e,t,n;return t=i,null!==(e=Tt())&&(n=e,e=void(Fn.expires=n)),null===e&&(i=t),e;}function Rn(){var e;return null===(e=wn())&&(e=St()),e;}function wn(){var e,t,r,s,o,l;return s=i,o=i,"refresher"===n.substr(i,9).toLowerCase()?(e=n.substr(i,9),i+=9):(e=null,u('"refresher"')),null!==e&&null!==(t=D())?("uac"===n.substr(i,3).toLowerCase()?(r=n.substr(i,3),i+=3):(r=null,u('"uac"')),null===r&&("uas"===n.substr(i,3).toLowerCase()?(r=n.substr(i,3),i+=3):(r=null,u('"uas"'))),null!==r?e=[e,t,r]:(e=null,i=o)):(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.refresher=l.toLowerCase())),null===e&&(i=s),e;}function In(){var e,t;for(e=[],null===(t=w())&&null===(t=O())&&(t=E());null!==t;){e.push(t),null===(t=w())&&null===(t=O())&&(t=E());}return e;}function On(){var e,t,r,s,o,l,a,c,h,f,d;return f=i,d=i,null!==(e=Nn())?(45===n.charCodeAt(i)?(t="-",i++):(t=null,u('"-"')),null!==t&&null!==(r=kn())?(45===n.charCodeAt(i)?(s="-",i++):(s=null,u('"-"')),null!==s&&null!==(o=kn())?(45===n.charCodeAt(i)?(l="-",i++):(l=null,u('"-"')),null!==l&&null!==(a=kn())?(45===n.charCodeAt(i)?(c="-",i++):(c=null,u('"-"')),null!==c&&null!==(h=Un())?e=[e,t,r,s,o,l,a,c,h]:(e=null,i=d)):(e=null,i=d)):(e=null,i=d)):(e=null,i=d)):(e=null,i=d),null!==e&&(e=function(e,t){Fn=n.substring(i+5,e);}(f,e[0])),null===e&&(i=f),e;}function kn(){var e,t,n,r,s;return s=i,null!==(e=f())&&null!==(t=f())&&null!==(n=f())&&null!==(r=f())?e=[e,t,n,r]:(e=null,i=s),e;}function Nn(){var e,t,n;return n=i,null!==(e=kn())&&null!==(t=kn())?e=[e,t]:(e=null,i=n),e;}function Un(){var e,t,n,r;return r=i,null!==(e=kn())&&null!==(t=kn())&&null!==(n=kn())?e=[e,t,n]:(e=null,i=r),e;}function xn(){var e,t,r,s,o,l;return s=i,o=i,null!==(e=U())?(l=i,64===n.charCodeAt(i)?(t="@",i++):(t=null,u('"@"')),null!==t&&null!==(r=U())?t=[t,r]:(t=null,i=l),null!==(t=null!==t?t:"")?e=[e,t]:(e=null,i=o)):(e=null,i=o),null!==e&&(e=function(e){Fn.call_id=n.substring(i,e);}(s)),null===e&&(i=s),e;}function Pn(){var e;return null===(e=Dn())&&null===(e=Mn())&&null===(e=qn())&&(e=St()),e;}function Dn(){var e,t,r,s,o,l;return s=i,o=i,"to-tag"===n.substr(i,6)?(e="to-tag",i+=6):(e=null,u('"to-tag"')),null!==e&&null!==(t=D())&&null!==(r=k())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.to_tag=l)),null===e&&(i=s),e;}function Mn(){var e,t,r,s,o,l;return s=i,o=i,"from-tag"===n.substr(i,8)?(e="from-tag",i+=8):(e=null,u('"from-tag"')),null!==e&&null!==(t=D())&&null!==(r=k())?e=[e,t,r]:(e=null,i=o),null!==e&&(l=e[2],e=void(Fn.from_tag=l)),null===e&&(i=s),e;}function qn(){var e,t;return t=i,"early-only"===n.substr(i,10)?(e="early-only",i+=10):(e=null,u('"early-only"')),null!==e&&(e=void(Fn.early_only=!0)),null===e&&(i=t),e;}var Ln=e("./URI"),Hn=e("./NameAddrHeader"),Fn={};if(null===s[r]()||i!==n.length){var jn=Math.max(i,o),Gn=jn<n.length?n.charAt(jn):null,Bn=function(){for(var e=1,t=1,r=!1,s=0;s<Math.max(i,o);s++){var l=n.charAt(s);"\n"===l?(r||e++,t=1,r=!1):"\r"===l||"\u2028"===l||"\u2029"===l?(e++,t=1,r=!0):(t++,r=!1);}return{line:e,column:t};}();return new this.SyntaxError(function(e){e.sort();for(var t=null,n=[],r=0;r<e.length;r++){e[r]!==t&&(n.push(e[r]),t=e[r]);}return n;}(l),Gn,jn,Bn.line,Bn.column),-1;}return Fn;},toSource:function toSource(){return this._source;},SyntaxError:function SyntaxError(e,n,r,s,i){this.name="SyntaxError",this.expected=e,this.found=n,this.message=function(e,n){var r;switch(e.length){case 0:r="end of input";break;case 1:r=e[0];break;default:r=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1];}return"Expected "+r+" but "+(n?t(n):"end of input")+" found.";}(e,n),this.offset=r,this.line=s,this.column=i;}};return n.SyntaxError.prototype=Error.prototype,n;}();},{"./NameAddrHeader":10,"./URI":25}],8:[function(e,t,n){"use strict";var r=e("../package.json"),s=e("./Constants"),i=e("./Exceptions"),o=e("./Utils"),l=e("./UA"),u=e("./URI"),a=e("./NameAddrHeader"),c=e("./Grammar"),h=e("./WebSocketInterface");e("debug")("JsSIP")("version %s",r.version),t.exports={C:s,Exceptions:i,Utils:o,UA:l,URI:u,NameAddrHeader:a,WebSocketInterface:h,Grammar:c,debug:e("debug"),get name(){return r.title;},get version(){return r.version;}};},{"../package.json":38,"./Constants":2,"./Exceptions":6,"./Grammar":7,"./NameAddrHeader":10,"./UA":24,"./URI":25,"./Utils":26,"./WebSocketInterface":27,debug:29}],9:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=u(e);if(t){var s=u(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return l(this,n);};}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var a=e("events").EventEmitter,c=e("./Constants"),h=e("./SIPMessage"),f=e("./Utils"),d=e("./RequestSender"),_=e("./Exceptions"),p=e("debug")("JsSIP:Message");t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(u,e);var t,n,r,l=o(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,u),(t=l.call(this))._ua=e,t._request=null,t._closed=!1,t._direction=null,t._local_identity=null,t._remote_identity=null,t._is_replied=!1,t._data={},t;}return t=u,(n=[{key:"direction",get:function get(){return this._direction;}},{key:"local_identity",get:function get(){return this._local_identity;}},{key:"remote_identity",get:function get(){return this._remote_identity;}},{key:"send",value:function value(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=e;if(void 0===e||void 0===t)throw new TypeError("Not enough arguments");if(!(e=this._ua.normalizeTarget(e)))throw new TypeError("Invalid target: ".concat(s));var i=f.cloneArray(r.extraHeaders),o=f.cloneObject(r.eventHandlers),l=r.contentType||"text/plain";for(var u in o){Object.prototype.hasOwnProperty.call(o,u)&&this.on(u,o[u]);}i.push("Content-Type: ".concat(l)),this._request=new h.OutgoingRequest(c.MESSAGE,e,this._ua,null,i),t&&(this._request.body=t);var a=new d(this._ua,this._request,{onRequestTimeout:function onRequestTimeout(){n._onRequestTimeout();},onTransportError:function onTransportError(){n._onTransportError();},onReceiveResponse:function onReceiveResponse(e){n._receiveResponse(e);}});this._newMessage("local",this._request),a.send();}},{key:"init_incoming",value:function value(e){this._request=e,this._newMessage("remote",e),this._is_replied||(this._is_replied=!0,e.reply(200)),this._close();}},{key:"accept",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=f.cloneArray(e.extraHeaders),n=e.body;if("incoming"!==this._direction)throw new _.NotSupportedError('"accept" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");this._is_replied=!0,this._request.reply(200,null,t,n);}},{key:"reject",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status_code||480,n=e.reason_phrase,r=f.cloneArray(e.extraHeaders),s=e.body;if("incoming"!==this._direction)throw new _.NotSupportedError('"reject" not supported for outgoing Message');if(this._is_replied)throw new Error("incoming Message already replied");if(t<300||t>=700)throw new TypeError("Invalid status_code: ".concat(t));this._is_replied=!0,this._request.reply(t,n,r,s);}},{key:"_receiveResponse",value:function value(e){if(!this._closed)switch(!0){case /^1[0-9]{2}$/.test(e.status_code):break;case /^2[0-9]{2}$/.test(e.status_code):this._succeeded("remote",e);break;default:var t=f.sipErrorCause(e.status_code);this._failed("remote",e,t);}}},{key:"_onRequestTimeout",value:function value(){this._closed||this._failed("system",null,c.causes.REQUEST_TIMEOUT);}},{key:"_onTransportError",value:function value(){this._closed||this._failed("system",null,c.causes.CONNECTION_ERROR);}},{key:"_close",value:function value(){this._closed=!0,this._ua.destroyMessage(this);}},{key:"_newMessage",value:function value(e,t){"remote"===e?(this._direction="incoming",this._local_identity=t.to,this._remote_identity=t.from):"local"===e&&(this._direction="outgoing",this._local_identity=t.from,this._remote_identity=t.to),this._ua.newMessage(this,{originator:e,message:this,request:t});}},{key:"_failed",value:function value(e,t,n){p("MESSAGE failed"),this._close(),p('emit "failed"'),this.emit("failed",{originator:e,response:t||null,cause:n});}},{key:"_succeeded",value:function value(e,t){p("MESSAGE succeeded"),this._close(),p('emit "succeeded"'),this.emit("succeeded",{originator:e,response:t});}}])&&s(t.prototype,n),r&&s(t,r),u;}(a);},{"./Constants":2,"./Exceptions":6,"./RequestSender":18,"./SIPMessage":19,"./Utils":26,debug:29,events:31}],10:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var s=e("./URI"),i=e("./Grammar");t.exports=function(){function e(t,n,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),!(t&&t instanceof s))throw new TypeError('missing or invalid "uri" parameter');for(var i in this._uri=t,this._parameters={},this.display_name=n,r){Object.prototype.hasOwnProperty.call(r,i)&&this.setParam(i,r[i]);}}var t,n,o;return t=e,o=[{key:"parse",value:function value(e){return-1!==(e=i.parse(e,"Name_Addr_Header"))?e:void 0;}}],(n=[{key:"uri",get:function get(){return this._uri;}},{key:"display_name",get:function get(){return this._display_name;},set:function set(e){this._display_name=0===e?"0":e;}},{key:"setParam",value:function value(e,t){e&&(this._parameters[e.toLowerCase()]=null==t?null:t.toString());}},{key:"getParam",value:function value(e){if(e)return this._parameters[e.toLowerCase()];}},{key:"hasParam",value:function value(e){if(e)return!!this._parameters.hasOwnProperty(e.toLowerCase());}},{key:"deleteParam",value:function value(e){if(e=e.toLowerCase(),this._parameters.hasOwnProperty(e)){var t=this._parameters[e];return delete this._parameters[e],t;}}},{key:"clearParams",value:function value(){this._parameters={};}},{key:"clone",value:function value(){return new e(this._uri.clone(),this._display_name,JSON.parse(JSON.stringify(this._parameters)));}},{key:"_quote",value:function value(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"');}},{key:"toString",value:function value(){var e=this._display_name?'"'.concat(this._quote(this._display_name),'" '):"";for(var t in e+="<".concat(this._uri.toString(),">"),this._parameters){Object.prototype.hasOwnProperty.call(this._parameters,t)&&(e+=";".concat(t),null!==this._parameters[t]&&(e+="=".concat(this._parameters[t])));}return e;}}])&&r(t.prototype,n),o&&r(t,o),e;}();},{"./Grammar":7,"./URI":25}],11:[function(e,t,n){"use strict";function r(e,t){var _n3;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n3=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t);}(e))||t&&e&&"number"==typeof e.length){_n3&&(e=_n3);var r=0,i=function i(){};return{s:i,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e4){throw _e4;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,l=!0,u=!1;return{s:function s(){_n3=e[Symbol.iterator]();},n:function n(){var e=_n3.next();return l=e.done,e;},e:function e(_e5){u=!0,o=_e5;},f:function f(){try{l||null==_n3["return"]||_n3["return"]();}finally{if(u)throw o;}}};}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}var i=e("./Grammar"),o=e("./SIPMessage"),l=e("debug")("JsSIP:ERROR:Parser");function u(e,t){var n=t,r=0,s=0;if(e.substring(n,n+2).match(/(^\r\n)/))return-2;for(;0===r;){if(-1===(s=e.indexOf("\r\n",n)))return s;!e.substring(s+2,s+4).match(/(^\r\n)/)&&e.charAt(s+2).match(/(^\s+)/)?n=s+2:r=s;}return r;}function a(e,t,n,s){var l,u=t.indexOf(":",n),a=t.substring(n,u).trim(),c=t.substring(u+1,s).trim();switch(a.toLowerCase()){case"via":case"v":e.addHeader("via",c),1===e.getHeaders("via").length?(l=e.parseHeader("Via"))&&(e.via=l,e.via_branch=l.branch):l=0;break;case"from":case"f":e.setHeader("from",c),(l=e.parseHeader("from"))&&(e.from=l,e.from_tag=l.getParam("tag"));break;case"to":case"t":e.setHeader("to",c),(l=e.parseHeader("to"))&&(e.to=l,e.to_tag=l.getParam("tag"));break;case"record-route":if(-1===(l=i.parse(c,"Record_Route")))l=void 0;else{var h,f=r(l);try{for(f.s();!(h=f.n()).done;){var d=h.value;e.addHeader("record-route",c.substring(d.possition,d.offset)),e.headers["Record-Route"][e.getHeaders("record-route").length-1].parsed=d.parsed;}}catch(e){f.e(e);}finally{f.f();}}break;case"call-id":case"i":e.setHeader("call-id",c),(l=e.parseHeader("call-id"))&&(e.call_id=c);break;case"contact":case"m":if(-1===(l=i.parse(c,"Contact")))l=void 0;else{var _,p=r(l);try{for(p.s();!(_=p.n()).done;){var m=_.value;e.addHeader("contact",c.substring(m.possition,m.offset)),e.headers.Contact[e.getHeaders("contact").length-1].parsed=m.parsed;}}catch(e){p.e(e);}finally{p.f();}}break;case"content-length":case"l":e.setHeader("content-length",c),l=e.parseHeader("content-length");break;case"content-type":case"c":e.setHeader("content-type",c),l=e.parseHeader("content-type");break;case"cseq":e.setHeader("cseq",c),(l=e.parseHeader("cseq"))&&(e.cseq=l.value),e instanceof o.IncomingResponse&&(e.method=l.method);break;case"max-forwards":e.setHeader("max-forwards",c),l=e.parseHeader("max-forwards");break;case"www-authenticate":e.setHeader("www-authenticate",c),l=e.parseHeader("www-authenticate");break;case"proxy-authenticate":e.setHeader("proxy-authenticate",c),l=e.parseHeader("proxy-authenticate");break;case"session-expires":case"x":e.setHeader("session-expires",c),(l=e.parseHeader("session-expires"))&&(e.session_expires=l.expires,e.session_expires_refresher=l.refresher);break;case"refer-to":case"r":e.setHeader("refer-to",c),(l=e.parseHeader("refer-to"))&&(e.refer_to=l);break;case"replaces":e.setHeader("replaces",c),(l=e.parseHeader("replaces"))&&(e.replaces=l);break;case"event":case"o":e.setHeader("event",c),(l=e.parseHeader("event"))&&(e.event=l);break;default:e.addHeader(a,c),l=0;}return void 0!==l||{error:'error parsing header "'.concat(a,'"')};}l.log=console.warn.bind(console),n.parseMessage=function(e,t){var n,r,s=e.indexOf("\r\n");if(-1!==s){var c=e.substring(0,s),h=i.parse(c,"Request_Response");if(-1!==h){h.status_code?((n=new o.IncomingResponse()).status_code=h.status_code,n.reason_phrase=h.reason_phrase):((n=new o.IncomingRequest(t)).method=h.method,n.ruri=h.uri),n.data=e;for(var f=s+2;;){if(-2===(s=u(e,f))){r=f+2;break;}if(-1===s)return void l("parseMessage() | malformed message");if(!0!==(h=a(n,e,f,s)))return void l("parseMessage() |",h.error);f=s+2;}if(n.hasHeader("content-length")){var d=n.getHeader("content-length");n.body=e.substr(r,d);}else n.body=e.substring(r);return n;}l('parseMessage() | error parsing first line of SIP message: "'.concat(c,'"'));}else l("parseMessage() | no CRLF found, not a SIP message");};},{"./Grammar":7,"./SIPMessage":19,debug:29}],12:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){var _n4;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n4=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t);}(e))||t&&e&&"number"==typeof e.length){_n4&&(e=_n4);var r=0,s=function s(){};return{s:s,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e6){throw _e6;},f:s};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,l=!0,u=!1;return{s:function s(){_n4=e[Symbol.iterator]();},n:function n(){var e=_n4.next();return l=e.done,e;},e:function e(_e7){u=!0,o=_e7;},f:function f(){try{l||null==_n4["return"]||_n4["return"]();}finally{if(u)throw o;}}};}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=c(e);if(t){var s=c(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return a(this,n);};}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var h=e("events").EventEmitter,f=e("sdp-transform"),d=e("./Constants"),_=e("./Exceptions"),p=e("./Transactions"),m=e("./Utils"),v=e("./Timers"),g=e("./SIPMessage"),y=e("./Dialog"),T=e("./RequestSender"),C=e("./RTCSession/DTMF"),S=e("./RTCSession/Info"),E=e("./RTCSession/ReferNotifier"),A=e("./RTCSession/ReferSubscriber"),b=e("./URI"),R=e("debug")("JsSIP:RTCSession"),w=e("debug")("JsSIP:ERROR:RTCSession");w.log=console.warn.bind(console);var I={STATUS_NULL:0,STATUS_INVITE_SENT:1,STATUS_1XX_RECEIVED:2,STATUS_INVITE_RECEIVED:3,STATUS_WAITING_FOR_ANSWER:4,STATUS_ANSWERED:5,STATUS_WAITING_FOR_ACK:6,STATUS_CANCELED:7,STATUS_TERMINATED:8,STATUS_CONFIRMED:9},O=["audio","video"];t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t);}(a,e);var t,n,r,i=u(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,a),R("new"),(t=i.call(this))._id=null,t._ua=e,t._status=I.STATUS_NULL,t._dialog=null,t._earlyDialogs={},t._contact=null,t._from_tag=null,t._to_tag=null,t._connection=null,t._connectionPromiseQueue=Promise.resolve(),t._request=null,t._is_canceled=!1,t._cancel_reason="",t._is_confirmed=!1,t._late_sdp=!1,t._rtcOfferConstraints=null,t._rtcAnswerConstraints=null,t._localMediaStream=null,t._localMediaStreamLocallyGenerated=!1,t._rtcReady=!0,t._timers={ackTimer:null,expiresTimer:null,invite2xxTimer:null,userNoAnswerTimer:null},t._direction=null,t._local_identity=null,t._remote_identity=null,t._start_time=null,t._end_time=null,t._tones=null,t._audioMuted=!1,t._videoMuted=!1,t._localHold=!1,t._remoteHold=!1,t._sessionTimers={enabled:t._ua.configuration.session_timers,refreshMethod:t._ua.configuration.session_timers_refresh_method,defaultExpires:d.SESSION_EXPIRES,currentExpires:null,running:!1,refresher:!1,timer:null},t._referSubscribers={},t._data={},t;}return t=a,r=[{key:"C",get:function get(){return I;}}],(n=[{key:"C",get:function get(){return I;}},{key:"causes",get:function get(){return d.causes;}},{key:"id",get:function get(){return this._id;}},{key:"connection",get:function get(){return this._connection;}},{key:"contact",get:function get(){return this._contact;}},{key:"direction",get:function get(){return this._direction;}},{key:"local_identity",get:function get(){return this._local_identity;}},{key:"remote_identity",get:function get(){return this._remote_identity;}},{key:"start_time",get:function get(){return this._start_time;}},{key:"end_time",get:function get(){return this._end_time;}},{key:"data",get:function get(){return this._data;},set:function set(e){this._data=e;}},{key:"status",get:function get(){return this._status;}},{key:"isInProgress",value:function value(){switch(this._status){case I.STATUS_NULL:case I.STATUS_INVITE_SENT:case I.STATUS_1XX_RECEIVED:case I.STATUS_INVITE_RECEIVED:case I.STATUS_WAITING_FOR_ANSWER:return!0;default:return!1;}}},{key:"isEstablished",value:function value(){switch(this._status){case I.STATUS_ANSWERED:case I.STATUS_WAITING_FOR_ACK:case I.STATUS_CONFIRMED:return!0;default:return!1;}}},{key:"isEnded",value:function value(){switch(this._status){case I.STATUS_CANCELED:case I.STATUS_TERMINATED:return!0;default:return!1;}}},{key:"isMuted",value:function value(){return{audio:this._audioMuted,video:this._videoMuted};}},{key:"isOnHold",value:function value(){return{local:this._localHold,remote:this._remoteHold};}},{key:"connect",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;R("connect()");var r=e,s=m.cloneObject(t.eventHandlers),i=m.cloneArray(t.extraHeaders),o=m.cloneObject(t.mediaConstraints,{audio:!0,video:!0}),l=t.mediaStream||null,u=m.cloneObject(t.pcConfig,{iceServers:[]}),a=t.rtcConstraints||null,c=t.rtcOfferConstraints||null;if(this._rtcOfferConstraints=c,this._rtcAnswerConstraints=t.rtcAnswerConstraints||null,this._data=t.data||this._data,void 0===e)throw new TypeError("Not enough arguments");if(this._status!==I.STATUS_NULL)throw new _.InvalidStateError(this._status);if(!window.RTCPeerConnection)throw new _.NotSupportedError("WebRTC not supported");if(!(e=this._ua.normalizeTarget(e)))throw new TypeError("Invalid target: ".concat(r));for(var h in this._sessionTimers.enabled&&m.isDecimal(t.sessionTimersExpires)&&(t.sessionTimersExpires>=d.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=t.sessionTimersExpires:this._sessionTimers.defaultExpires=d.SESSION_EXPIRES),s){Object.prototype.hasOwnProperty.call(s,h)&&this.on(h,s[h]);}this._from_tag=m.newTag();var f=t.anonymous||!1,p={from_tag:this._from_tag};this._contact=this._ua.contact.toString({anonymous:f,outbound:!0}),f?(p.from_display_name="Anonymous",p.from_uri=new b("sip","anonymous","anonymous.invalid"),i.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString())),i.push("Privacy: id")):t.fromUserName&&(p.from_uri=new b("sip",t.fromUserName,this._ua.configuration.uri.host),i.push("P-Preferred-Identity: ".concat(this._ua.configuration.uri.toString()))),t.fromDisplayName&&(p.from_display_name=t.fromDisplayName),i.push("Contact: ".concat(this._contact)),i.push("Content-Type: application/sdp"),this._sessionTimers.enabled&&i.push("Session-Expires: ".concat(this._sessionTimers.defaultExpires).concat(this._ua.configuration.session_timers_force_refresher?";refresher=uac":"")),this._request=new g.InitialOutgoingInviteRequest(e,this._ua,p,i),this._id=this._request.call_id+this._from_tag,this._createRTCConnection(u,a),this._direction="outgoing",this._local_identity=this._request.from,this._remote_identity=this._request.to,n&&n(this),this._newRTCSession("local",this._request),this._sendInitialRequest(o,c,l);}},{key:"init_incoming",value:function value(e,t){var n,r=this;R("init_incoming()");var s=e.hasHeader("Content-Type")?e.getHeader("Content-Type").toLowerCase():void 0;if(e.body&&"application/sdp"!==s)e.reply(415);else if(this._status=I.STATUS_INVITE_RECEIVED,this._from_tag=e.from_tag,this._id=e.call_id+this._from_tag,this._request=e,this._contact=this._ua.contact.toString(),e.hasHeader("expires")&&(n=1e3*e.getHeader("expires")),e.to_tag=m.newTag(),this._createDialog(e,"UAS",!0)){if(e.body?this._late_sdp=!1:this._late_sdp=!0,this._status=I.STATUS_WAITING_FOR_ANSWER,this._timers.userNoAnswerTimer=setTimeout(function(){e.reply(408),r._failed("local",null,d.causes.NO_ANSWER);},this._ua.configuration.no_answer_timeout),n&&(this._timers.expiresTimer=setTimeout(function(){r._status===I.STATUS_WAITING_FOR_ANSWER&&(e.reply(487),r._failed("system",null,d.causes.EXPIRES));},n)),this._direction="incoming",this._local_identity=e.to,this._remote_identity=e.from,t&&t(this),this._newRTCSession("remote",e),this._status!==I.STATUS_TERMINATED){var i=["Contact: ".concat(this._contact)],o=this._ua.modes.ringing_header_mode;void 0!==o&&(Array.isArray(o)?i=i.concat(o):i.push(o)),e.reply(180,null,i),this._progress("local",null);}}else e.reply(500,"Missing Contact header field");}},{key:"answer",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R("answer()");var n=this._request,r=m.cloneArray(t.extraHeaders),i=m.cloneObject(t.mediaConstraints),o=t.mediaStream||null,l=m.cloneObject(t.pcConfig,{iceServers:[]}),u=t.rtcConstraints||null,a=t.rtcAnswerConstraints||null,c=m.cloneObject(t.rtcOfferConstraints),h=!1,f=!1,p=!1,v=!1;if(this._rtcAnswerConstraints=a,this._rtcOfferConstraints=t.rtcOfferConstraints||null,this._data=t.data||this._data,"incoming"!==this._direction)throw new _.NotSupportedError('"answer" not supported for outgoing RTCSession');if(this._status!==I.STATUS_WAITING_FOR_ANSWER)throw new _.InvalidStateError(this._status);if(this._sessionTimers.enabled&&m.isDecimal(t.sessionTimersExpires)&&(t.sessionTimersExpires>=d.MIN_SESSION_EXPIRES?this._sessionTimers.defaultExpires=t.sessionTimersExpires:this._sessionTimers.defaultExpires=d.SESSION_EXPIRES),this._status=I.STATUS_ANSWERED,this._createDialog(n,"UAS")){clearTimeout(this._timers.userNoAnswerTimer),r.unshift("Contact: ".concat(this._contact));var g=n.parseSDP();Array.isArray(g.media)||(g.media=[g.media]);var y,T=s(g.media);try{for(T.s();!(y=T.n()).done;){var C=y.value;"audio"===C.type&&(h=!0,C.direction&&"sendrecv"!==C.direction||(p=!0)),"video"===C.type&&(f=!0,C.direction&&"sendrecv"!==C.direction||(v=!0));}}catch(e){T.e(e);}finally{T.f();}if(o&&!1===i.audio){var S,E=s(o.getAudioTracks());try{for(E.s();!(S=E.n()).done;){var A=S.value;o.removeTrack(A);}}catch(e){E.e(e);}finally{E.f();}}if(o&&!1===i.video){var b,O=s(o.getVideoTracks());try{for(O.s();!(b=O.n()).done;){var k=b.value;o.removeTrack(k);}}catch(e){O.e(e);}finally{O.f();}}o||void 0!==i.audio||(i.audio=p),o||void 0!==i.video||(i.video=v),o||h||c.offerToReceiveAudio||(i.audio=!1),o||f||c.offerToReceiveVideo||(i.video=!1),this._createRTCConnection(l,u),Promise.resolve().then(function(){return o||(i.audio||i.video?(e._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(i)["catch"](function(t){if(e._status===I.STATUS_TERMINATED)throw new Error("terminated");throw n.reply(480),e._failed("local",null,d.causes.USER_DENIED_MEDIA_ACCESS),w('emit "getusermediafailed" [error:%o]',t),e.emit("getusermediafailed",t),new Error("getUserMedia() failed");})):void 0);}).then(function(t){if(e._status===I.STATUS_TERMINATED)throw new Error("terminated");e._localMediaStream=t,t&&t.getTracks().forEach(function(n){e._connection.addTrack(n,t);});}).then(function(){if(!e._late_sdp){var t={originator:"remote",type:"offer",sdp:n.body};R('emit "sdp"'),e.emit("sdp",t);var r=new RTCSessionDescription({type:"offer",sdp:t.sdp});return e._connectionPromiseQueue=e._connectionPromiseQueue.then(function(){return e._connection.setRemoteDescription(r);})["catch"](function(t){throw n.reply(488),e._failed("system",null,d.causes.WEBRTC_ERROR),w('emit "peerconnection:setremotedescriptionfailed" [error:%o]',t),e.emit("peerconnection:setremotedescriptionfailed",t),new Error("peerconnection.setRemoteDescription() failed");}),e._connectionPromiseQueue;}}).then(function(){if(e._status===I.STATUS_TERMINATED)throw new Error("terminated");return e._connecting(n),e._late_sdp?e._createLocalDescription("offer",e._rtcOfferConstraints)["catch"](function(){throw n.reply(500),new Error("_createLocalDescription() failed");}):e._createLocalDescription("answer",a)["catch"](function(){throw n.reply(500),new Error("_createLocalDescription() failed");});}).then(function(t){if(e._status===I.STATUS_TERMINATED)throw new Error("terminated");e._handleSessionTimersInIncomingRequest(n,r),n.reply(200,null,r,t,function(){e._status=I.STATUS_WAITING_FOR_ACK,e._setInvite2xxTimer(n,t),e._setACKTimer(),e._accepted("local");},function(){e._failed("system",null,d.causes.CONNECTION_ERROR);});})["catch"](function(t){e._status!==I.STATUS_TERMINATED&&w(t);});}else n.reply(500,"Error creating dialog");}},{key:"terminate",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R("terminate()");var n,r=t.cause||d.causes.BYE,s=m.cloneArray(t.extraHeaders),i=t.body,o=t.status_code,l=t.reason_phrase;if(this._status===I.STATUS_TERMINATED)throw new _.InvalidStateError(this._status);switch(this._status){case I.STATUS_NULL:case I.STATUS_INVITE_SENT:case I.STATUS_1XX_RECEIVED:if(R("canceling session"),o&&(o<200||o>=700))throw new TypeError("Invalid status_code: ".concat(o));o&&(l=l||d.REASON_PHRASE[o]||"",n="SIP ;cause=".concat(o,' ;text="').concat(l,'"')),this._status===I.STATUS_NULL||this._status===I.STATUS_INVITE_SENT?(this._is_canceled=!0,this._cancel_reason=n):this._status===I.STATUS_1XX_RECEIVED&&this._request.cancel(n),this._status=I.STATUS_CANCELED,this._failed("local",null,d.causes.CANCELED);break;case I.STATUS_WAITING_FOR_ANSWER:case I.STATUS_ANSWERED:if(R("rejecting session"),(o=o||480)<300||o>=700)throw new TypeError("Invalid status_code: ".concat(o));this._request.reply(o,l,s,i),this._failed("local",null,d.causes.REJECTED);break;case I.STATUS_WAITING_FOR_ACK:case I.STATUS_CONFIRMED:if(R("terminating session"),l=t.reason_phrase||d.REASON_PHRASE[o]||"",o&&(o<200||o>=700))throw new TypeError("Invalid status_code: ".concat(o));if(o&&s.push("Reason: SIP ;cause=".concat(o,'; text="').concat(l,'"')),this._status===I.STATUS_WAITING_FOR_ACK&&"incoming"===this._direction&&this._request.server_transaction.state!==p.C.STATUS_TERMINATED){var u=this._dialog;this.receiveRequest=function(t){t.method===d.ACK&&(e.sendRequest(d.BYE,{extraHeaders:s,body:i}),u.terminate());},this._request.server_transaction.on("stateChanged",function(){e._request.server_transaction.state===p.C.STATUS_TERMINATED&&(e.sendRequest(d.BYE,{extraHeaders:s,body:i}),u.terminate());}),this._ended("local",null,r),this._dialog=u,this._ua.newDialog(u);}else this.sendRequest(d.BYE,{extraHeaders:s,body:i}),this._ended("local",null,r);}}},{key:"sendDTMF",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};R("sendDTMF() | tones: %s",e);var n=0,r=t.duration||null,s=t.interToneGap||null,i=t.transportType||d.DTMF_TRANSPORT.INFO;if(void 0===e)throw new TypeError("Not enough arguments");if(this._status!==I.STATUS_CONFIRMED&&this._status!==I.STATUS_WAITING_FOR_ACK)throw new _.InvalidStateError(this._status);if(i!==d.DTMF_TRANSPORT.INFO&&i!==d.DTMF_TRANSPORT.RFC2833)throw new TypeError("invalid transportType: ".concat(i));if("number"==typeof e&&(e=e.toString()),!e||"string"!=typeof e||!e.match(/^[0-9A-DR#*,]+$/i))throw new TypeError("Invalid tones: ".concat(e));if(r&&!m.isDecimal(r))throw new TypeError("Invalid tone duration: ".concat(r));if(r?r<C.C.MIN_DURATION?(R('"duration" value is lower than the minimum allowed, setting it to '.concat(C.C.MIN_DURATION," milliseconds")),r=C.C.MIN_DURATION):r>C.C.MAX_DURATION?(R('"duration" value is greater than the maximum allowed, setting it to '.concat(C.C.MAX_DURATION," milliseconds")),r=C.C.MAX_DURATION):r=Math.abs(r):r=C.C.DEFAULT_DURATION,t.duration=r,s&&!m.isDecimal(s))throw new TypeError("Invalid interToneGap: ".concat(s));if(s?s<C.C.MIN_INTER_TONE_GAP?(R('"interToneGap" value is lower than the minimum allowed, setting it to '.concat(C.C.MIN_INTER_TONE_GAP," milliseconds")),s=C.C.MIN_INTER_TONE_GAP):s=Math.abs(s):s=C.C.DEFAULT_INTER_TONE_GAP,i!==d.DTMF_TRANSPORT.RFC2833)this._tones?this._tones+=e:(this._tones=e,l.call(this));else{var o=this._getDTMFRTPSender();o&&(e=o.toneBuffer+e,o.insertDTMF(e,r,s));}function l(){var e,i=this;if(this._status===I.STATUS_TERMINATED||!this._tones||n>=this._tones.length)this._tones=null;else{var o=this._tones[n];if(n+=1,","===o)e=2e3;else{var u=new C(this);t.eventHandlers={onFailed:function onFailed(){i._tones=null;}},u.send(o,t),e=r+s;}setTimeout(l.bind(this),e);}}}},{key:"sendInfo",value:function value(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(R("sendInfo()"),this._status!==I.STATUS_CONFIRMED&&this._status!==I.STATUS_WAITING_FOR_ACK)throw new _.InvalidStateError(this._status);var r=new S(this);r.send(e,t,n);}},{key:"mute",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0,video:!1};R("mute()");var t=!1,n=!1;!1===this._audioMuted&&e.audio&&(t=!0,this._audioMuted=!0,this._toggleMuteAudio(!0)),!1===this._videoMuted&&e.video&&(n=!0,this._videoMuted=!0,this._toggleMuteVideo(!0)),!0!==t&&!0!==n||this._onmute({audio:t,video:n});}},{key:"unmute",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{audio:!0,video:!0};R("unmute()");var t=!1,n=!1;!0===this._audioMuted&&e.audio&&(t=!0,this._audioMuted=!1,!1===this._localHold&&this._toggleMuteAudio(!1)),!0===this._videoMuted&&e.video&&(n=!0,this._videoMuted=!1,!1===this._localHold&&this._toggleMuteVideo(!1)),!0!==t&&!0!==n||this._onunmute({audio:t,video:n});}},{key:"hold",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(R("hold()"),this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;if(!0===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!0,this._onhold("local");var r={succeeded:function succeeded(){n&&n();},failed:function failed(){e.terminate({cause:d.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Hold Failed"});}};return t.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:r,extraHeaders:t.extraHeaders}):this._sendReinvite({eventHandlers:r,extraHeaders:t.extraHeaders}),!0;}},{key:"unhold",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(R("unhold()"),this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;if(!1===this._localHold)return!1;if(!this._isReadyToReOffer())return!1;this._localHold=!1,this._onunhold("local");var r={succeeded:function succeeded(){n&&n();},failed:function failed(){e.terminate({cause:d.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Unhold Failed"});}};return t.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:r,extraHeaders:t.extraHeaders}):this._sendReinvite({eventHandlers:r,extraHeaders:t.extraHeaders}),!0;}},{key:"renegotiate",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;R("renegotiate()");var r=t.rtcOfferConstraints||null;if(this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;if(!this._isReadyToReOffer())return!1;var s={succeeded:function succeeded(){n&&n();},failed:function failed(){e.terminate({cause:d.causes.WEBRTC_ERROR,status_code:500,reason_phrase:"Media Renegotiation Failed"});}};return this._setLocalMediaStatus(),t.useUpdate?this._sendUpdate({sdpOffer:!0,eventHandlers:s,rtcOfferConstraints:r,extraHeaders:t.extraHeaders}):this._sendReinvite({eventHandlers:s,rtcOfferConstraints:r,extraHeaders:t.extraHeaders}),!0;}},{key:"refer",value:function value(e,t){var n=this;R("refer()");var r=e;if(this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;if(!(e=this._ua.normalizeTarget(e)))throw new TypeError("Invalid target: ".concat(r));var s=new A(this);s.sendRefer(e,t);var i=s.id;return this._referSubscribers[i]=s,s.on("requestFailed",function(){delete n._referSubscribers[i];}),s.on("accepted",function(){delete n._referSubscribers[i];}),s.on("failed",function(){delete n._referSubscribers[i];}),s;}},{key:"sendRequest",value:function value(e,t){return R("sendRequest()"),this._dialog.sendRequest(e,t);}},{key:"receiveRequest",value:function value(e){var t=this;if(R("receiveRequest()"),e.method===d.CANCEL)this._status!==I.STATUS_WAITING_FOR_ANSWER&&this._status!==I.STATUS_ANSWERED||(this._status=I.STATUS_CANCELED,this._request.reply(487),this._failed("remote",e,d.causes.CANCELED));else switch(e.method){case d.ACK:if(this._status!==I.STATUS_WAITING_FOR_ACK)return;if(this._status=I.STATUS_CONFIRMED,clearTimeout(this._timers.ackTimer),clearTimeout(this._timers.invite2xxTimer),this._late_sdp){if(!e.body){this.terminate({cause:d.causes.MISSING_SDP,status_code:400});break;}var n={originator:"remote",type:"answer",sdp:e.body};R('emit "sdp"'),this.emit("sdp",n);var r=new RTCSessionDescription({type:"answer",sdp:n.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._connection.setRemoteDescription(r);}).then(function(){t._is_confirmed||t._confirmed("remote",e);})["catch"](function(e){t.terminate({cause:d.causes.BAD_MEDIA_DESCRIPTION,status_code:488}),w('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),t.emit("peerconnection:setremotedescriptionfailed",e);});}else this._is_confirmed||this._confirmed("remote",e);break;case d.BYE:this._status===I.STATUS_CONFIRMED||this._status===I.STATUS_WAITING_FOR_ACK?(e.reply(200),this._ended("remote",e,d.causes.BYE)):this._status===I.STATUS_INVITE_RECEIVED||this._status===I.STATUS_WAITING_FOR_ANSWER?(e.reply(200),this._request.reply(487,"BYE Received"),this._ended("remote",e,d.causes.BYE)):e.reply(403,"Wrong Status");break;case d.INVITE:this._status===I.STATUS_CONFIRMED?e.hasHeader("replaces")?this._receiveReplaces(e):this._receiveReinvite(e):e.reply(403,"Wrong Status");break;case d.INFO:if(this._status===I.STATUS_1XX_RECEIVED||this._status===I.STATUS_WAITING_FOR_ANSWER||this._status===I.STATUS_ANSWERED||this._status===I.STATUS_WAITING_FOR_ACK||this._status===I.STATUS_CONFIRMED){var s=e.hasHeader("Content-Type")?e.getHeader("Content-Type").toLowerCase():void 0;s&&s.match(/^application\/dtmf-relay/i)?new C(this).init_incoming(e):void 0!==s?new S(this).init_incoming(e):e.reply(415);}else e.reply(403,"Wrong Status");break;case d.UPDATE:this._status===I.STATUS_CONFIRMED?this._receiveUpdate(e):e.reply(403,"Wrong Status");break;case d.REFER:this._status===I.STATUS_CONFIRMED?this._receiveRefer(e):e.reply(403,"Wrong Status");break;case d.NOTIFY:var i={event:e.event,request:e,taken:!1};if(this.emit("sipEvent",i),i.taken){e.reply(200);break;}this._status===I.STATUS_CONFIRMED?this._receiveNotify(e):e.reply(403,"Wrong Status");break;default:e.reply(501);}}},{key:"onTransportError",value:function value(){w("onTransportError()"),this._status!==I.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:d.causes.CONNECTION_ERROR,cause:d.causes.CONNECTION_ERROR});}},{key:"onRequestTimeout",value:function value(){w("onRequestTimeout()"),this._status!==I.STATUS_TERMINATED&&this.terminate({status_code:408,reason_phrase:d.causes.REQUEST_TIMEOUT,cause:d.causes.REQUEST_TIMEOUT});}},{key:"onDialogError",value:function value(){w("onDialogError()"),this._status!==I.STATUS_TERMINATED&&this.terminate({status_code:500,reason_phrase:d.causes.DIALOG_ERROR,cause:d.causes.DIALOG_ERROR});}},{key:"newDTMF",value:function value(e){R("newDTMF()"),this.emit("newDTMF",e);}},{key:"newInfo",value:function value(e){R("newInfo()"),this.emit("newInfo",e);}},{key:"_isReadyToReOffer",value:function value(){return this._rtcReady?this._dialog?!0!==this._dialog.uac_pending_reply&&!0!==this._dialog.uas_pending_reply||(R("_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress"),!1):(R("_isReadyToReOffer() | session not established yet"),!1):(R("_isReadyToReOffer() | internal WebRTC status not ready"),!1);}},{key:"_close",value:function value(){if(R("close()"),this._localMediaStream&&this._localMediaStreamLocallyGenerated&&(R("close() | closing local MediaStream"),m.closeMediaStream(this._localMediaStream)),this._status!==I.STATUS_TERMINATED){if(this._status=I.STATUS_TERMINATED,this._connection)try{this._connection.close();}catch(e){w("close() | error closing the RTCPeerConnection: %o",e);}for(var e in this._timers){Object.prototype.hasOwnProperty.call(this._timers,e)&&clearTimeout(this._timers[e]);}for(var t in clearTimeout(this._sessionTimers.timer),this._dialog&&(this._dialog.terminate(),delete this._dialog),this._earlyDialogs){Object.prototype.hasOwnProperty.call(this._earlyDialogs,t)&&(this._earlyDialogs[t].terminate(),delete this._earlyDialogs[t]);}for(var n in this._referSubscribers){Object.prototype.hasOwnProperty.call(this._referSubscribers,n)&&delete this._referSubscribers[n];}this._ua.destroyRTCSession(this);}}},{key:"_setInvite2xxTimer",value:function value(e,t){var n=v.T1;this._timers.invite2xxTimer=setTimeout(function r(){this._status===I.STATUS_WAITING_FOR_ACK&&(e.reply(200,null,["Contact: ".concat(this._contact)],t),n<v.T2&&(n*=2)>v.T2&&(n=v.T2),this._timers.invite2xxTimer=setTimeout(r.bind(this),n));}.bind(this),n);}},{key:"_setACKTimer",value:function value(){var e=this;this._timers.ackTimer=setTimeout(function(){e._status===I.STATUS_WAITING_FOR_ACK&&(R("no ACK received, terminating the session"),clearTimeout(e._timers.invite2xxTimer),e.sendRequest(d.BYE),e._ended("remote",null,d.causes.NO_ACK));},v.TIMER_H);}},{key:"_createRTCConnection",value:function value(e,t){var n=this;this._connection=new RTCPeerConnection(e,t),this._connection.addEventListener("iceconnectionstatechange",function(){var e=n._connection.iceConnectionState;if("failed"===e&&n.terminate({cause:d.causes.RTP_TIMEOUT,status_code:408,reason_phrase:d.causes.RTP_TIMEOUT}),void 0!==n._ua.modes.chrome_rtp_timeout_fix&&navigator.webkitGetUserMedia&&"disconnected"===e){var t=n._ua.modes.chrome_rtp_timeout_fix;R("AC: Chrome RTP timeout fix: iceConnectionState==disconnected: check that this will continue for "+t+" seconds..."),function e(){"disconnected"===n._connection.iceConnectionState?t-->0?setTimeout(function(){return e();},1e3):(R("AC: Chrome RTP timeout fix: Hangup call"),n.terminate({cause:d.causes.RTP_TIMEOUT,status_code:408,reason_phrase:d.causes.RTP_TIMEOUT})):R("AC: Chrome RTP timeout fix: iceConnectionState="+n._connection.iceConnectionState);}();}}),R('emit "peerconnection"'),this.emit("peerconnection",{peerconnection:this._connection});}},{key:"_createLocalDescription",value:function value(e,t){var n=this;if(R("createLocalDescription()"),"offer"!==e&&"answer"!==e)throw new Error('createLocalDescription() | invalid type "'.concat(e,'"'));var r=this._connection;return this._rtcReady=!1,Promise.resolve().then(function(){return"offer"===e?r.createOffer(t)["catch"](function(e){return w('emit "peerconnection:createofferfailed" [error:%o]',e),n.emit("peerconnection:createofferfailed",e),Promise.reject(e);}):r.createAnswer(t)["catch"](function(e){return w('emit "peerconnection:createanswerfailed" [error:%o]',e),n.emit("peerconnection:createanswerfailed",e),Promise.reject(e);});}).then(function(e){return r.setLocalDescription(e)["catch"](function(e){return n._rtcReady=!0,w('emit "peerconnection:setlocaldescriptionfailed" [error:%o]',e),n.emit("peerconnection:setlocaldescriptionfailed",e),Promise.reject(e);});}).then(function(){if(!("complete"!==r.iceGatheringState||t&&t.iceRestart)){n._rtcReady=!0;var s={originator:"local",type:e,sdp:r.localDescription.sdp};return R('emit "sdp"'),n.emit("sdp",s),Promise.resolve(s.sdp);}return new Promise(function(t){var s,i,o=!1,l=function l(){r.removeEventListener("icecandidate",s),r.removeEventListener("icegatheringstatechange",i),o=!0,n._rtcReady=!0;var l={originator:"local",type:e,sdp:r.localDescription.sdp};R('emit "sdp"'),n.emit("sdp",l),t(l.sdp);};r.addEventListener("icecandidate",s=function s(e){var t=e.candidate;t?n.emit("icecandidate",{candidate:t,ready:l}):o||l();}),r.addEventListener("icegatheringstatechange",i=function i(){"complete"!==r.iceGatheringState||o||l();}),void 0!==n._ua.modes.ice_timeout_fix&&setTimeout(function(){o||(R("AC: ICE gathering timeout fix"),l());},n._ua.modes.ice_timeout_fix);});});}},{key:"_createDialog",value:function value(e,t,n){var r="UAS"===t?e.to_tag:e.from_tag,s="UAS"===t?e.from_tag:e.to_tag,i=e.call_id+r+s,o=this._earlyDialogs[i];if(n)return!!o||((o=new y(this,e,t,y.C.STATUS_EARLY)).error?(R(o.error),this._failed("remote",e,d.causes.INTERNAL_ERROR),!1):(this._earlyDialogs[i]=o,!0));if(this._from_tag=e.from_tag,this._to_tag=e.to_tag,o)return o.update(e,t),this._dialog=o,delete this._earlyDialogs[i],!0;var l=new y(this,e,t);return l.error?(R(l.error),this._failed("remote",e,d.causes.INTERNAL_ERROR),!1):(this._dialog=l,!0);}},{key:"_receiveReinvite",value:function value(e){var t=this;R("receiveReinvite()");var n=e.hasHeader("Content-Type")?e.getHeader("Content-Type").toLowerCase():void 0,r={request:e,callback:void 0,reject:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s=!0;var n=t.status_code||403,r=t.reason_phrase||"",i=m.cloneArray(t.extraHeaders);if(this._status!==I.STATUS_CONFIRMED)return!1;if(n<300||n>=700)throw new TypeError("Invalid status_code: ".concat(n));e.reply(n,r,i);}.bind(this)},s=!1;if(this.emit("reinvite",r),!s){if(this._late_sdp=!1,!e.body)return this._late_sdp=!0,this._remoteHold&&(this._remoteHold=!1,this._onunhold("remote")),void(this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._createLocalDescription("offer",t._rtcOfferConstraints);}).then(function(e){i.call(t,e);})["catch"](function(){e.reply(500);}));if("application/sdp"!==n)return R("invalid Content-Type"),void e.reply(415);this._processInDialogSdpOffer(e).then(function(e){t._status!==I.STATUS_TERMINATED&&i.call(t,e);})["catch"](function(e){w(e);});}function i(t){var n=this,s=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(e,s),this._late_sdp&&(t=this._mangleOffer(t)),e.reply(200,null,s,t,function(){n._status=I.STATUS_WAITING_FOR_ACK,n._setInvite2xxTimer(e,t),n._setACKTimer();}),"function"==typeof r.callback&&r.callback();}}},{key:"_receiveUpdate",value:function value(e){var t=this;R("receiveUpdate()");var n=e.hasHeader("Content-Type")?e.getHeader("Content-Type").toLowerCase():void 0,r={request:e,callback:void 0,reject:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s=!0;var n=t.status_code||403,r=t.reason_phrase||"",i=m.cloneArray(t.extraHeaders);if(this._status!==I.STATUS_CONFIRMED)return!1;if(n<300||n>=700)throw new TypeError("Invalid status_code: ".concat(n));e.reply(n,r,i);}.bind(this)},s=!1;if(this.emit("update",r),!s)if(e.body){if("application/sdp"!==n)return R("invalid Content-Type"),void e.reply(415);this._processInDialogSdpOffer(e).then(function(e){t._status!==I.STATUS_TERMINATED&&i.call(t,e);})["catch"](function(e){w(e);});}else i.call(this,null);function i(t){var n=["Contact: ".concat(this._contact)];this._handleSessionTimersInIncomingRequest(e,n),e.reply(200,null,n,t),"function"==typeof r.callback&&r.callback();}}},{key:"_processInDialogSdpOffer",value:function value(e){var t=this;R("_processInDialogSdpOffer()");var n,r=e.parseSDP(),i=!1,o=s(r.media);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(-1!==O.indexOf(l.type)){var u=l.direction||r.direction||"sendrecv";if("sendonly"!==u&&"inactive"!==u){i=!1;break;}i=!0;}}}catch(e){o.e(e);}finally{o.f();}var a={originator:"remote",type:"offer",sdp:e.body};R('emit "sdp"'),this.emit("sdp",a);var c=new RTCSessionDescription({type:"offer",sdp:a.sdp});return this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if(t._status===I.STATUS_TERMINATED)throw new Error("terminated");return t._connection.setRemoteDescription(c)["catch"](function(n){throw e.reply(488),w('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),t.emit("peerconnection:setremotedescriptionfailed",n),n;});}).then(function(){if(t._status===I.STATUS_TERMINATED)throw new Error("terminated");!0===t._remoteHold&&!1===i?(t._remoteHold=!1,t._onunhold("remote")):!1===t._remoteHold&&!0===i&&(t._remoteHold=!0,t._onhold("remote"));}).then(function(){if(t._status===I.STATUS_TERMINATED)throw new Error("terminated");return t._createLocalDescription("answer",t._rtcAnswerConstraints)["catch"](function(t){throw e.reply(500),w('emit "peerconnection:createtelocaldescriptionfailed" [error:%o]',t),t;});})["catch"](function(e){w("_processInDialogSdpOffer() failed [error: %o]",e);}),this._connectionPromiseQueue;}},{key:"_receiveRefer",value:function value(e){var t=this;if(R("receiveRefer()"),!e.refer_to)return R("no Refer-To header field present in REFER"),void e.reply(400);if(e.refer_to.uri.scheme!==d.SIP)return R("Refer-To header field points to a non-SIP URI scheme"),void e.reply(416);e.reply(202);var n=new E(this,e.cseq);function r(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t="function"==typeof t?t:null,this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;var s=new a(this._ua);if(s.on("progress",function(e){var t=e.response;n.notify(t.status_code,t.reason_phrase);}),s.on("accepted",function(e){var t=e.response;n.notify(t.status_code,t.reason_phrase);}),s.on("_failed",function(e){var t=e.message,r=e.cause;t?n.notify(t.status_code,t.reason_phrase):n.notify(487,r);}),e.refer_to.uri.hasHeader("replaces")){var i=decodeURIComponent(e.refer_to.uri.getHeader("replaces"));r.extraHeaders=m.cloneArray(r.extraHeaders),r.extraHeaders.push("Replaces: ".concat(i));}s.connect(e.refer_to.uri.toAor(),r,t);}function s(){n.notify(603);}R('emit "refer"'),this.emit("refer",{request:e,accept:function accept(e,n){r.call(t,e,n);},reject:function reject(){s.call(t);}});}},{key:"_receiveNotify",value:function value(e){switch(R("receiveNotify()"),e.event||e.reply(400),e.event.event){case"refer":var t,n;if(e.event.params&&e.event.params.id)t=e.event.params.id,n=this._referSubscribers[t];else{if(1!==Object.keys(this._referSubscribers).length)return void e.reply(400,"Missing event id parameter");n=this._referSubscribers[Object.keys(this._referSubscribers)[0]];}if(!n)return void e.reply(481,"Subscription does not exist");n.receiveNotify(e),e.reply(200);break;default:e.reply(489);}}},{key:"_receiveReplaces",value:function value(e){var t=this;function n(t){var n=this;if(this._status!==I.STATUS_WAITING_FOR_ACK&&this._status!==I.STATUS_CONFIRMED)return!1;var r=new a(this._ua);r.on("confirmed",function(){n.terminate();}),r.init_incoming(e,t);}function r(){R("Replaced INVITE rejected by the user"),e.reply(486);}R("receiveReplaces()"),this.emit("replaces",{request:e,accept:function accept(e){n.call(t,e);},reject:function reject(){r.call(t);}});}},{key:"_sendInitialRequest",value:function value(e,t,n){var r=this,s=new T(this._ua,this._request,{onRequestTimeout:function onRequestTimeout(){r.onRequestTimeout();},onTransportError:function onTransportError(){r.onTransportError();},onAuthenticated:function onAuthenticated(e){r._request=e;},onReceiveResponse:function onReceiveResponse(e){r._receiveInviteResponse(e);}});Promise.resolve().then(function(){return n||(e.audio||e.video?(r._localMediaStreamLocallyGenerated=!0,navigator.mediaDevices.getUserMedia(e)["catch"](function(e){if(r._status===I.STATUS_TERMINATED)throw new Error("terminated");throw r._failed("local",null,d.causes.USER_DENIED_MEDIA_ACCESS),w('emit "getusermediafailed" [error:%o]',e),r.emit("getusermediafailed",e),e;})):void 0);}).then(function(e){if(r._status===I.STATUS_TERMINATED)throw new Error("terminated");return r._localMediaStream=e,e&&e.getTracks().forEach(function(t){r._connection.addTrack(t,e);}),r._connecting(r._request),r._createLocalDescription("offer",t)["catch"](function(e){throw r._failed("local",null,d.causes.WEBRTC_ERROR),e;});}).then(function(e){if(r._is_canceled||r._status===I.STATUS_TERMINATED)throw new Error("terminated");r._request.body=e,r._status=I.STATUS_INVITE_SENT,R('emit "sending" [request:%o]',r._request),r.emit("sending",{request:r._request}),s.send();})["catch"](function(e){r._status!==I.STATUS_TERMINATED&&w(e);});}},{key:"_getDTMFRTPSender",value:function value(){var e=this._connection.getSenders().find(function(e){return e.track&&"audio"===e.track.kind;});if(e&&e.dtmf)return e.dtmf;w("sendDTMF() | no local audio track to send DTMF with");}},{key:"_receiveInviteResponse",value:function value(e){var t=this;if(R("receiveInviteResponse()"),this._dialog&&e.status_code>=200&&e.status_code<=299){if(this._dialog.id.call_id===e.call_id&&this._dialog.id.local_tag===e.from_tag&&this._dialog.id.remote_tag===e.to_tag)return void this.sendRequest(d.ACK);var n=new y(this,e,"UAC");return void 0!==n.error?void R(n.error):(this.sendRequest(d.ACK),void this.sendRequest(d.BYE));}if(this._is_canceled)e.status_code>=100&&e.status_code<200?this._request.cancel(this._cancel_reason):e.status_code>=200&&e.status_code<299&&this._acceptAndTerminate(e);else if(this._status===I.STATUS_INVITE_SENT||this._status===I.STATUS_1XX_RECEIVED)switch(!0){case /^100$/.test(e.status_code):this._status=I.STATUS_1XX_RECEIVED;break;case /^1[0-9]{2}$/.test(e.status_code):if(!e.to_tag){R("1xx response received without to tag");break;}if(e.hasHeader("contact")&&!this._createDialog(e,"UAC",!0))break;if(this._status=I.STATUS_1XX_RECEIVED,!e.body){this._progress("remote",e);break;}var r={originator:"remote",type:"answer",sdp:e.body};R('emit "sdp"'),this.emit("sdp",r);var s=new RTCSessionDescription({type:"answer",sdp:r.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._connection.setRemoteDescription(s);}).then(function(){return t._progress("remote",e);})["catch"](function(e){w('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),t.emit("peerconnection:setremotedescriptionfailed",e);});break;case /^2[0-9]{2}$/.test(e.status_code):if(this._status=I.STATUS_CONFIRMED,!e.body){this._acceptAndTerminate(e,400,d.causes.MISSING_SDP),this._failed("remote",e,d.causes.BAD_MEDIA_DESCRIPTION);break;}if(!this._createDialog(e,"UAC"))break;var i={originator:"remote",type:"answer",sdp:e.body};R('emit "sdp"'),this.emit("sdp",i);var o=new RTCSessionDescription({type:"answer",sdp:i.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){if("stable"===t._connection.signalingState)return t._connection.createOffer(t._rtcOfferConstraints).then(function(e){return t._connection.setLocalDescription(e);})["catch"](function(n){t._acceptAndTerminate(e,500,n.toString()),t._failed("local",e,d.causes.WEBRTC_ERROR);});}).then(function(){t._connection.setRemoteDescription(o).then(function(){t._handleSessionTimersInIncomingResponse(e),t._accepted("remote",e),t.sendRequest(d.ACK),t._confirmed("local",null);})["catch"](function(n){t._acceptAndTerminate(e,488,"Not Acceptable Here"),t._failed("remote",e,d.causes.BAD_MEDIA_DESCRIPTION),w('emit "peerconnection:setremotedescriptionfailed" [error:%o]',n),t.emit("peerconnection:setremotedescriptionfailed",n);});});break;default:var l=m.sipErrorCause(e.status_code);this._failed("remote",e,l);}}},{key:"_sendReinvite",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R("sendReinvite()");var n=m.cloneArray(t.extraHeaders),r=m.cloneObject(t.eventHandlers),s=t.rtcOfferConstraints||this._rtcOfferConstraints||null,i=!1;function o(e){var t=this;if(this._status!==I.STATUS_TERMINATED&&(this.sendRequest(d.ACK),!i))if(this._handleSessionTimersInIncomingResponse(e),e.body){if(e.hasHeader("Content-Type")&&"application/sdp"===e.getHeader("Content-Type").toLowerCase()){var n={originator:"remote",type:"answer",sdp:e.body};R('emit "sdp"'),this.emit("sdp",n);var s=new RTCSessionDescription({type:"answer",sdp:n.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._connection.setRemoteDescription(s);}).then(function(){r.succeeded&&r.succeeded(e);})["catch"](function(e){l.call(t),w('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),t.emit("peerconnection:setremotedescriptionfailed",e);});}else l.call(this);}else l.call(this);}function l(e){r.failed&&r.failed(e);}n.push("Contact: ".concat(this._contact)),n.push("Content-Type: application/sdp"),this._sessionTimers.running&&n.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return e._createLocalDescription("offer",s);}).then(function(t){var r={originator:"local",type:"offer",sdp:t=e._mangleOffer(t)};R('emit "sdp"'),e.emit("sdp",r),e.sendRequest(d.INVITE,{extraHeaders:n,body:t,eventHandlers:{onSuccessResponse:function onSuccessResponse(t){o.call(e,t),i=!0;},onErrorResponse:function onErrorResponse(t){l.call(e,t);},onTransportError:function onTransportError(){e.onTransportError();},onRequestTimeout:function onRequestTimeout(){e.onRequestTimeout();},onDialogError:function onDialogError(){e.onDialogError();}}});})["catch"](function(){l();});}},{key:"_sendUpdate",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R("sendUpdate()");var n=m.cloneArray(t.extraHeaders),r=m.cloneObject(t.eventHandlers),s=t.rtcOfferConstraints||this._rtcOfferConstraints||null,i=t.sdpOffer||!1,o=!1;function l(e){var t=this;if(this._status!==I.STATUS_TERMINATED&&!o)if(this._handleSessionTimersInIncomingResponse(e),i){if(!e.body)return void u.call(this);if(!e.hasHeader("Content-Type")||"application/sdp"!==e.getHeader("Content-Type").toLowerCase())return void u.call(this);var n={originator:"remote",type:"answer",sdp:e.body};R('emit "sdp"'),this.emit("sdp",n);var s=new RTCSessionDescription({type:"answer",sdp:n.sdp});this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return t._connection.setRemoteDescription(s);}).then(function(){r.succeeded&&r.succeeded(e);})["catch"](function(e){u.call(t),w('emit "peerconnection:setremotedescriptionfailed" [error:%o]',e),t.emit("peerconnection:setremotedescriptionfailed",e);});}else r.succeeded&&r.succeeded(e);}function u(e){r.failed&&r.failed(e);}n.push("Contact: ".concat(this._contact)),this._sessionTimers.running&&n.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(this._sessionTimers.refresher?"uac":"uas")),i?(n.push("Content-Type: application/sdp"),this._connectionPromiseQueue=this._connectionPromiseQueue.then(function(){return e._createLocalDescription("offer",s);}).then(function(t){var r={originator:"local",type:"offer",sdp:t=e._mangleOffer(t)};R('emit "sdp"'),e.emit("sdp",r),e.sendRequest(d.UPDATE,{extraHeaders:n,body:t,eventHandlers:{onSuccessResponse:function onSuccessResponse(t){l.call(e,t),o=!0;},onErrorResponse:function onErrorResponse(t){u.call(e,t);},onTransportError:function onTransportError(){e.onTransportError();},onRequestTimeout:function onRequestTimeout(){e.onRequestTimeout();},onDialogError:function onDialogError(){e.onDialogError();}}});})["catch"](function(){u.call(e);})):this.sendRequest(d.UPDATE,{extraHeaders:n,eventHandlers:{onSuccessResponse:function onSuccessResponse(t){l.call(e,t);},onErrorResponse:function onErrorResponse(t){u.call(e,t);},onTransportError:function onTransportError(){e.onTransportError();},onRequestTimeout:function onRequestTimeout(){e.onRequestTimeout();},onDialogError:function onDialogError(){e.onDialogError();}}});}},{key:"_acceptAndTerminate",value:function value(e,t,n){R("acceptAndTerminate()");var r=[];t&&(n=n||d.REASON_PHRASE[t]||"",r.push("Reason: SIP ;cause=".concat(t,'; text="').concat(n,'"'))),(this._dialog||this._createDialog(e,"UAC"))&&(this.sendRequest(d.ACK),this.sendRequest(d.BYE,{extraHeaders:r})),this._status=I.STATUS_TERMINATED;}},{key:"_mangleOffer",value:function value(e){if(!this._localHold&&!this._remoteHold)return e;if(e=f.parse(e),this._localHold&&!this._remoteHold){R("mangleOffer() | me on hold, mangling offer");var t,n=s(e.media);try{for(n.s();!(t=n.n()).done;){var r=t.value;-1!==O.indexOf(r.type)&&(r.direction?"sendrecv"===r.direction?r.direction="sendonly":"recvonly"===r.direction&&(r.direction="inactive"):r.direction="sendonly");}}catch(e){n.e(e);}finally{n.f();}}else if(this._localHold&&this._remoteHold){R("mangleOffer() | both on hold, mangling offer");var i,o=s(e.media);try{for(o.s();!(i=o.n()).done;){var l=i.value;-1!==O.indexOf(l.type)&&(l.direction="inactive");}}catch(e){o.e(e);}finally{o.f();}}else if(this._remoteHold){R("mangleOffer() | remote on hold, mangling offer");var u,a=s(e.media);try{for(a.s();!(u=a.n()).done;){var c=u.value;-1!==O.indexOf(c.type)&&(c.direction?"sendrecv"===c.direction?c.direction="recvonly":"recvonly"===c.direction&&(c.direction="inactive"):c.direction="recvonly");}}catch(e){a.e(e);}finally{a.f();}}return f.write(e);}},{key:"_setLocalMediaStatus",value:function value(){var e=!0,t=!0;(this._localHold||this._remoteHold)&&(e=!1,t=!1),this._audioMuted&&(e=!1),this._videoMuted&&(t=!1),this._toggleMuteAudio(!e),this._toggleMuteVideo(!t);}},{key:"_handleSessionTimersInIncomingRequest",value:function value(e,t){var n;this._sessionTimers.enabled&&(e.session_expires&&e.session_expires>=d.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=e.session_expires,n=e.session_expires_refresher||"uas"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,n="uas"),t.push("Session-Expires: ".concat(this._sessionTimers.currentExpires,";refresher=").concat(n)),this._sessionTimers.refresher="uas"===n,this._runSessionTimer());}},{key:"_handleSessionTimersInIncomingResponse",value:function value(e){var t;this._sessionTimers.enabled&&(e.session_expires&&e.session_expires>=d.MIN_SESSION_EXPIRES?(this._sessionTimers.currentExpires=e.session_expires,t=e.session_expires_refresher||"uac"):(this._sessionTimers.currentExpires=this._sessionTimers.defaultExpires,t="uac"),this._sessionTimers.refresher="uac"===t,this._runSessionTimer());}},{key:"_runSessionTimer",value:function value(){var e=this,t=this._sessionTimers.currentExpires;this._sessionTimers.running=!0,clearTimeout(this._sessionTimers.timer),this._sessionTimers.refresher?this._sessionTimers.timer=setTimeout(function(){e._status!==I.STATUS_TERMINATED&&(R("runSessionTimer() | sending session refresh request"),e._sessionTimers.refreshMethod===d.UPDATE?e._sendUpdate():e._sendReinvite());},500*t):this._sessionTimers.timer=setTimeout(function(){e._status!==I.STATUS_TERMINATED&&(w("runSessionTimer() | timer expired, terminating the session"),e.terminate({cause:d.causes.REQUEST_TIMEOUT,status_code:408,reason_phrase:"Session Timer Expired"}));},1100*t);}},{key:"_toggleMuteAudio",value:function value(e){var t,n=s(this._connection.getSenders().filter(function(e){return e.track&&"audio"===e.track.kind;}));try{for(n.s();!(t=n.n()).done;){t.value.track.enabled=!e;}}catch(e){n.e(e);}finally{n.f();}}},{key:"_toggleMuteVideo",value:function value(e){var t,n=s(this._connection.getSenders().filter(function(e){return e.track&&"video"===e.track.kind;}));try{for(n.s();!(t=n.n()).done;){t.value.track.enabled=!e;}}catch(e){n.e(e);}finally{n.f();}}},{key:"_newRTCSession",value:function value(e,t){R("newRTCSession()"),this._ua.newRTCSession(this,{originator:e,session:this,request:t});}},{key:"_connecting",value:function value(e){R("session connecting"),R('emit "connecting"'),this.emit("connecting",{request:e});}},{key:"_progress",value:function value(e,t){R("session progress"),R('emit "progress"'),this.emit("progress",{originator:e,response:t||null});}},{key:"_accepted",value:function value(e,t){R("session accepted"),this._start_time=new Date(),R('emit "accepted"'),this.emit("accepted",{originator:e,response:t||null});}},{key:"_confirmed",value:function value(e,t){R("session confirmed"),this._is_confirmed=!0,R('emit "confirmed"'),this.emit("confirmed",{originator:e,ack:t||null});}},{key:"_ended",value:function value(e,t,n){R("session ended"),this._end_time=new Date(),this._close(),R('emit "ended"'),this.emit("ended",{originator:e,message:t||null,cause:n});}},{key:"_failed",value:function value(e,t,n){R("session failed"),R('emit "_failed"'),this.emit("_failed",{originator:e,message:t||null,cause:n}),this._close(),R('emit "failed"'),this.emit("failed",{originator:e,message:t||null,cause:n});}},{key:"_onhold",value:function value(e){R("session onhold"),this._setLocalMediaStatus(),R('emit "hold"'),this.emit("hold",{originator:e});}},{key:"_onunhold",value:function value(e){R("session onunhold"),this._setLocalMediaStatus(),R('emit "unhold"'),this.emit("unhold",{originator:e});}},{key:"_onmute",value:function value(e){var t=e.audio,n=e.video;R("session onmute"),this._setLocalMediaStatus(),R('emit "muted"'),this.emit("muted",{audio:t,video:n});}},{key:"_onunmute",value:function value(e){var t=e.audio,n=e.video;R("session onunmute"),this._setLocalMediaStatus(),R('emit "unmuted"'),this.emit("unmuted",{audio:t,video:n});}}])&&o(t.prototype,n),r&&o(t,r),a;}(h);},{"./Constants":2,"./Dialog":3,"./Exceptions":6,"./RTCSession/DTMF":13,"./RTCSession/Info":14,"./RTCSession/ReferNotifier":15,"./RTCSession/ReferSubscriber":16,"./RequestSender":18,"./SIPMessage":19,"./Timers":21,"./Transactions":22,"./URI":25,"./Utils":26,debug:29,events:31,"sdp-transform":35}],13:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=u(e);if(t){var s=u(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return l(this,n);};}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var a=e("events").EventEmitter,c=e("../Constants"),h=e("../Exceptions"),f=e("../Utils"),d=e("debug")("JsSIP:RTCSession:DTMF");e("debug")("JsSIP:ERROR:RTCSession:DTMF").log=console.warn.bind(console);var _={MIN_DURATION:70,MAX_DURATION:6e3,DEFAULT_DURATION:100,MIN_INTER_TONE_GAP:50,DEFAULT_INTER_TONE_GAP:500};t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(u,e);var t,n,r,l=o(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,u),(t=l.call(this))._session=e,t._direction=null,t._tone=null,t._duration=null,t._request=null,t;}return t=u,(n=[{key:"tone",get:function get(){return this._tone;}},{key:"duration",get:function get(){return this._duration;}},{key:"send",value:function value(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e)throw new TypeError("Not enough arguments");if(this._direction="outgoing",this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new h.InvalidStateError(this._session.status);var r=f.cloneArray(n.extraHeaders);if(this.eventHandlers=f.cloneObject(n.eventHandlers),"string"==typeof e)e=e.toUpperCase();else{if("number"!=typeof e)throw new TypeError("Invalid tone: ".concat(e));e=e.toString();}if(!e.match(/^[0-9A-DR#*]$/))throw new TypeError("Invalid tone: ".concat(e));this._tone=e,this._duration=n.duration,r.push("Content-Type: application/dtmf-relay");var s="Signal=".concat(this._tone,"\r\n");s+="Duration=".concat(this._duration),this._session.newDTMF({originator:"local",dtmf:this,request:this._request}),this._session.sendRequest(c.INFO,{extraHeaders:r,eventHandlers:{onSuccessResponse:function onSuccessResponse(e){t.emit("succeeded",{originator:"remote",response:e});},onErrorResponse:function onErrorResponse(e){t.eventHandlers.onFailed&&t.eventHandlers.onFailed(),t.emit("failed",{originator:"remote",response:e});},onRequestTimeout:function onRequestTimeout(){t._session.onRequestTimeout();},onTransportError:function onTransportError(){t._session.onTransportError();},onDialogError:function onDialogError(){t._session.onDialogError();}},body:s});}},{key:"init_incoming",value:function value(e){var t=/^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/,n=/^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/;if(this._direction="incoming",this._request=e,e.reply(200),e.body){var r=e.body.split("\n");r.length>=1&&t.test(r[0])&&(this._tone=r[0].replace(t,"$2")),r.length>=2&&n.test(r[1])&&(this._duration=parseInt(r[1].replace(n,"$2"),10));}this._duration||(this._duration=_.DEFAULT_DURATION),this._tone?this._session.newDTMF({originator:"remote",dtmf:this,request:e}):d("invalid INFO DTMF received, discarded");}}])&&s(t.prototype,n),r&&s(t,r),u;}(a),t.exports.C=_;},{"../Constants":2,"../Exceptions":6,"../Utils":26,debug:29,events:31}],14:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=u(e);if(t){var s=u(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return l(this,n);};}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var a=e("events").EventEmitter;e("debug")("JsSIP:ERROR:RTCSession:Info").log=console.warn.bind(console);var c=e("../Constants"),h=e("../Exceptions"),f=e("../Utils");t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(u,e);var t,n,r,l=o(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,u),(t=l.call(this))._session=e,t._direction=null,t._contentType=null,t._body=null,t;}return t=u,(n=[{key:"contentType",get:function get(){return this._contentType;}},{key:"body",get:function get(){return this._body;}},{key:"send",value:function value(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._direction="outgoing",t&&void 0===e)throw new TypeError("Not enough arguments");if(this._session.status!==this._session.C.STATUS_CONFIRMED&&this._session.status!==this._session.C.STATUS_WAITING_FOR_ACK)throw new h.InvalidStateError(this._session.status);this._contentType=e,this._body=t;var s=f.cloneArray(r.extraHeaders);e&&s.push("Content-Type: ".concat(e)),this._session.newInfo({originator:"local",info:this,request:this.request}),this._session.sendRequest(c.INFO,{extraHeaders:s,eventHandlers:{onSuccessResponse:function onSuccessResponse(e){n.emit("succeeded",{originator:"remote",response:e});},onErrorResponse:function onErrorResponse(e){n.emit("failed",{originator:"remote",response:e});},onTransportError:function onTransportError(){n._session.onTransportError();},onRequestTimeout:function onRequestTimeout(){n._session.onRequestTimeout();},onDialogError:function onDialogError(){n._session.onDialogError();}},body:t});}},{key:"init_incoming",value:function value(e){this._direction="incoming",this.request=e,e.reply(200),this._contentType=e.hasHeader("Content-Type")?e.getHeader("Content-Type").toLowerCase():void 0,this._body=e.body,this._session.newInfo({originator:"remote",info:this,request:e});}}])&&s(t.prototype,n),r&&s(t,r),u;}(a);},{"../Constants":2,"../Exceptions":6,"../Utils":26,debug:29,events:31}],15:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var s=e("../Constants"),i=e("debug")("JsSIP:RTCSession:ReferNotifier"),o="refer",l="message/sipfrag;version=2.0",u=300;t.exports=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),this._session=t,this._id=n,this._expires=r||u,this._active=!0,this.notify(100);}var t,n,a;return t=e,(n=[{key:"notify",value:function value(e,t){if(i("notify()"),!1!==this._active){var n;t=t||s.REASON_PHRASE[e]||"",n=e>=200?"terminated;reason=noresource":"active;expires=".concat(this._expires);try{this._session.sendRequest(s.NOTIFY,{extraHeaders:["Event: ".concat(o,";id=").concat(this._id),"Subscription-State: ".concat(n),"Content-Type: ".concat(l)],body:"SIP/2.0 ".concat(e," ").concat(t),eventHandlers:{onErrorResponse:function onErrorResponse(){this._active=!1;}}});}catch(e){i("send NOTIFY exception [ignored]");}}}}])&&r(t.prototype,n),a&&r(t,a),e;}();},{"../Constants":2,debug:29}],16:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=u(e);if(t){var s=u(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return l(this,n);};}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var a=e("events").EventEmitter,c=e("../Constants"),h=e("../Grammar"),f=e("../Utils"),d=e("debug")("JsSIP:RTCSession:ReferSubscriber");t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(u,e);var t,n,r,l=o(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,u),(t=l.call(this))._id=null,t._session=e,t;}return t=u,(n=[{key:"id",get:function get(){return this._id;}},{key:"sendRefer",value:function value(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d("sendRefer()");var r=f.cloneArray(n.extraHeaders),s=f.cloneObject(n.eventHandlers);for(var i in s){Object.prototype.hasOwnProperty.call(s,i)&&this.on(i,s[i]);}var o=null;n.replaces&&(o=n.replaces._request.call_id,o+=";to-tag=".concat(n.replaces._to_tag),o+=";from-tag=".concat(n.replaces._from_tag),o=encodeURIComponent(o));var l="Refer-To: <".concat(e).concat(o?"?Replaces=".concat(o):"",">");r.push(l);var u="Referred-By: <".concat(this._session._ua._configuration.uri._scheme,":").concat(this._session._ua._configuration.uri._user,"@").concat(this._session._ua._configuration.uri._host,">");r.push(u),r.push("Contact: ".concat(this._session.contact));var a=this._session.sendRequest(c.REFER,{extraHeaders:r,eventHandlers:{onSuccessResponse:function onSuccessResponse(e){t._requestSucceeded(e);},onErrorResponse:function onErrorResponse(e){t._requestFailed(e,c.causes.REJECTED);},onTransportError:function onTransportError(){t._requestFailed(null,c.causes.CONNECTION_ERROR);},onRequestTimeout:function onRequestTimeout(){t._requestFailed(null,c.causes.REQUEST_TIMEOUT);},onDialogError:function onDialogError(){t._requestFailed(null,c.causes.DIALOG_ERROR);}}});this._id=a.cseq;}},{key:"receiveNotify",value:function value(e){if(d("receiveNotify()"),e.body){var t=h.parse(e.body.trim(),"Status_Line");if(-1!==t)switch(!0){case /^100$/.test(t.status_code):this.emit("trying",{request:e,status_line:t});break;case /^1[0-9]{2}$/.test(t.status_code):this.emit("progress",{request:e,status_line:t});break;case /^2[0-9]{2}$/.test(t.status_code):this.emit("accepted",{request:e,status_line:t});break;default:this.emit("failed",{request:e,status_line:t});}else d('receiveNotify() | error parsing NOTIFY body: "'.concat(e.body,'"'));}}},{key:"_requestSucceeded",value:function value(e){d("REFER succeeded"),d('emit "requestSucceeded"'),this.emit("requestSucceeded",{response:e});}},{key:"_requestFailed",value:function value(e,t){d("REFER failed"),d('emit "requestFailed"'),this.emit("requestFailed",{response:e||null,cause:t});}}])&&s(t.prototype,n),r&&s(t,r),u;}(a);},{"../Constants":2,"../Grammar":7,"../Utils":26,debug:29,events:31}],17:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var s=e("./Utils"),i=e("./Constants"),o=e("./SIPMessage"),l=e("./RequestSender"),u=e("debug")("JsSIP:Registrator");t.exports=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e);this._ua=t,this._transport=n,this._registrar=t.configuration.registrar_server,this._expires=t.configuration.register_expires,this._call_id=s.createRandomToken(22),this._cseq=0,this._to_uri=t.configuration.uri,this._registrationTimer=null,this._registering=!1,this._registered=!1,this._contact=this._ua.contact.toString(),this._contact+=";+sip.ice",this._extraHeaders=[],this._extraContactParams="",this._contact+=";reg-id=".concat(1),this._contact+=';+sip.instance="<urn:uuid:'.concat(this._ua.configuration.instance_id,'>"');}var t,n,a;return t=e,(n=[{key:"registered",get:function get(){return this._registered;}},{key:"setExtraHeaders",value:function value(e){Array.isArray(e)||(e=[]),this._extraHeaders=e.slice();}},{key:"setExtraContactParams",value:function value(e){for(var t in e instanceof Object||(e={}),this._extraContactParams="",e){if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];this._extraContactParams+=";".concat(t),n&&(this._extraContactParams+="=".concat(n));}}}},{key:"register",value:function value(){var e=this;if(this._registering)u("Register request in progress...");else{var t=this._extraHeaders.slice();t.push("Contact: ".concat(this._contact,";expires=").concat(this._expires).concat(this._extraContactParams)),t.push("Expires: ".concat(this._expires));var n=new o.OutgoingRequest(i.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},t),r=new l(this._ua,n,{onRequestTimeout:function onRequestTimeout(){e._registrationFailure(null,i.causes.REQUEST_TIMEOUT);},onTransportError:function onTransportError(){e._registrationFailure(null,i.causes.CONNECTION_ERROR);},onAuthenticated:function onAuthenticated(){e._cseq+=1;},onReceiveResponse:function onReceiveResponse(t){if(t.cseq===e._cseq)switch(null!==e._registrationTimer&&(clearTimeout(e._registrationTimer),e._registrationTimer=null),!0){case /^1[0-9]{2}$/.test(t.status_code):break;case /^2[0-9]{2}$/.test(t.status_code):if(e._registering=!1,!t.hasHeader("Contact")){u("no Contact header in response to REGISTER, response ignored");break;}var n=t.headers.Contact.reduce(function(e,t){return e.concat(t.parsed);},[]).find(function(t){return t.uri.user===e._ua.contact.uri.user;});if(!n){u("no Contact header pointing to us, response ignored");break;}var r=n.getParam("expires");!r&&t.hasHeader("expires")&&(r=t.getHeader("expires")),r||(r=e._expires),(r=Number(r))<10&&(r=10);var o=r>=140?1e3*r/2+Math.floor(1e3*(r/2-70)*Math.random()):1e3*r-5e3;e._registrationTimer=setTimeout(function(){e._registrationTimer=null,0===e._ua.listeners("registrationExpiring").length?e.register():e._ua.emit("registrationExpiring");},o),n.hasParam("temp-gruu")&&(e._ua.contact.temp_gruu=n.getParam("temp-gruu").replace(/"/g,"")),n.hasParam("pub-gruu")&&(e._ua.contact.pub_gruu=n.getParam("pub-gruu").replace(/"/g,"")),e._registered||(e._registered=!0,e._ua.registered({response:t}));break;case /^423$/.test(t.status_code):t.hasHeader("min-expires")?(e._expires=Number(t.getHeader("min-expires")),e._expires<10&&(e._expires=10),e.register()):(u("423 response received for REGISTER without Min-Expires"),e._registrationFailure(t,i.causes.SIP_FAILURE_CODE));break;default:var l=s.sipErrorCause(t.status_code);e._registrationFailure(t,l);}}});this._registering=!0,r.send();}}},{key:"unregister",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._registered){this._registered=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null);var n=this._extraHeaders.slice();t.all?n.push("Contact: *".concat(this._extraContactParams)):n.push("Contact: ".concat(this._contact,";expires=0").concat(this._extraContactParams)),n.push("Expires: 0");var r=new o.OutgoingRequest(i.REGISTER,this._registrar,this._ua,{to_uri:this._to_uri,call_id:this._call_id,cseq:this._cseq+=1},n),a=new l(this._ua,r,{onRequestTimeout:function onRequestTimeout(){e._unregistered(null,i.causes.REQUEST_TIMEOUT);},onTransportError:function onTransportError(){e._unregistered(null,i.causes.CONNECTION_ERROR);},onAuthenticated:function onAuthenticated(){e._cseq+=1;},onReceiveResponse:function onReceiveResponse(t){switch(!0){case /^1[0-9]{2}$/.test(t.status_code):break;case /^2[0-9]{2}$/.test(t.status_code):e._unregistered(t);break;default:var n=s.sipErrorCause(t.status_code);e._unregistered(t,n);}}});a.send();}else u("already unregistered");}},{key:"close",value:function value(){this._registered&&this.unregister();}},{key:"onTransportClosed",value:function value(){this._registering=!1,null!==this._registrationTimer&&(clearTimeout(this._registrationTimer),this._registrationTimer=null),this._registered&&(this._registered=!1,this._ua.unregistered({}));}},{key:"_registrationFailure",value:function value(e,t){this._registering=!1,this._ua.registrationFailed({response:e||null,cause:t}),this._registered&&(this._registered=!1,this._ua.unregistered({response:e||null,cause:t}));}},{key:"_unregistered",value:function value(e,t){this._registering=!1,this._registered=!1,this._ua.unregistered({response:e||null,cause:t||null});}}])&&r(t.prototype,n),a&&r(t,a),e;}();},{"./Constants":2,"./RequestSender":18,"./SIPMessage":19,"./Utils":26,debug:29}],18:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var i=e("./Constants"),o=e("./DigestAuthentication"),l=e("./Transactions"),u=e("debug")("JsSIP:RequestSender"),a={onRequestTimeout:function onRequestTimeout(){},onTransportError:function onTransportError(){},onReceiveResponse:function onReceiveResponse(){},onAuthenticated:function onAuthenticated(){}};t.exports=function(){function e(t,n,s){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var l in r(this,e),this._ua=t,this._eventHandlers=s,this._method=n.method,this._request=n,this._auth=null,this._challenged=!1,this._staled=!1,this._config2=o,a){Object.prototype.hasOwnProperty.call(a,l)&&(this._eventHandlers[l]||(this._eventHandlers[l]=a[l]));}t.status!==t.C.STATUS_USER_CLOSED||this._method===i.BYE&&this._method===i.ACK||this._eventHandlers.onTransportError();}var t,n,c;return t=e,(n=[{key:"send",value:function value(){var e=this,t={onRequestTimeout:function onRequestTimeout(){e._eventHandlers.onRequestTimeout();},onTransportError:function onTransportError(){e._eventHandlers.onTransportError();},onReceiveResponse:function onReceiveResponse(t){e._receiveResponse(t);}};switch(this._method){case"INVITE":this.clientTransaction=new l.InviteClientTransaction(this._ua,this._ua.transport,this._request,t);break;case"ACK":this.clientTransaction=new l.AckClientTransaction(this._ua,this._ua.transport,this._request,t);break;default:this.clientTransaction=new l.NonInviteClientTransaction(this._ua,this._ua.transport,this._request,t);}this._ua._configuration.authorization_jwt&&this._request.setHeader("Authorization",this._ua._configuration.authorization_jwt),this.clientTransaction.send();}},{key:"_receiveResponse",value:function value(e){var t,n,r=e.status_code;if(401!==r&&407!==r||null===this._config2&&null===this._ua.configuration.password&&null===this._ua.configuration.ha1)this._eventHandlers.onReceiveResponse(e);else{if(401===e.status_code?(t=e.parseHeader("www-authenticate"),n="authorization"):(t=e.parseHeader("proxy-authenticate"),n="proxy-authorization"),!t)return u("".concat(e.status_code," with wrong or missing challenge, cannot authenticate")),void this._eventHandlers.onReceiveResponse(e);if(!this._challenged||!this._staled&&!0===t.stale){if(!this._auth){var s=this._config2?this._config2:this._ua.configuration;this._auth=new o({username:s.authorization_user,password:s.password,realm:s.realm,ha1:s.ha1});}if(!this._auth.authenticate(this._request,t))return void this._eventHandlers.onReceiveResponse(e);this._challenged=!0,this._config2?(this._config2.realm=this._auth.get("realm"),this._config2.ha1=this._auth.get("ha1")):(this._ua.set("realm",this._auth.get("realm")),this._ua.set("ha1",this._auth.get("ha1"))),t.stale&&(this._staled=!0),this._request=this._request.clone(),this._request.cseq+=1,this._request.setHeader("cseq","".concat(this._request.cseq," ").concat(this._method)),this._request.setHeader(n,this._auth.toString()),this._eventHandlers.onAuthenticated(this._request),this.send();}else this._eventHandlers.onReceiveResponse(e);}}}])&&s(t.prototype,n),c&&s(t,c),e;}();},{"./Constants":2,"./DigestAuthentication":5,"./Transactions":22,debug:29}],19:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=u(e);if(t){var s=u(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return l(this,n);};}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}(e):t;}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}function a(e,t){var _n5;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n5=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t);}(e))||t&&e&&"number"==typeof e.length){_n5&&(e=_n5);var r=0,s=function s(){};return{s:s,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e8){throw _e8;},f:s};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var i,o=!0,l=!1;return{s:function s(){_n5=e[Symbol.iterator]();},n:function n(){var e=_n5.next();return o=e.done,e;},e:function e(_e9){l=!0,i=_e9;},f:function f(){try{o||null==_n5["return"]||_n5["return"]();}finally{if(l)throw i;}}};}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function d(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e;}var _=e("sdp-transform"),p=e("./Constants"),m=e("./Utils"),v=e("./NameAddrHeader"),g=e("./Grammar"),y=e("debug")("JsSIP:SIPMessage"),T=function(){function e(t,n,r,s,i,o){if(h(this,e),!t||!n||!r)return null;s=s||{},this.ua=r,this.headers={},this.method=t,this.ruri=n,this.body=o,this.extraHeaders=m.cloneArray(i),s.route_set?this.setHeader("route",s.route_set):r.configuration.use_preloaded_route&&this.setHeader("route","<".concat(r.transport.sip_uri,";lr>")),this.setHeader("via",""),this.setHeader("max-forwards",p.MAX_FORWARDS);var l=s.to_uri||n,u=s.to_tag?{tag:s.to_tag}:null,a=void 0!==s.to_display_name?s.to_display_name:null;this.to=new v(l,a,u),this.setHeader("to",this.to.toString());var c,f=s.from_uri||r.configuration.uri,d={tag:s.from_tag||m.newTag()};c=void 0!==s.from_display_name?s.from_display_name:r.configuration.display_name?r.configuration.display_name:null,this.from=new v(f,c,d),this.setHeader("from",this.from.toString());var _=s.call_id||r.configuration.jssip_id+m.createRandomToken(15);this.call_id=_,this.setHeader("call-id",_);var g=s.cseq||Math.floor(1e4*Math.random());this.cseq=g,this.setHeader("cseq","".concat(g," ").concat(t));}return d(e,[{key:"setHeader",value:function value(e,t){for(var n=new RegExp("^\\s*".concat(e,"\\s*:"),"i"),r=0;r<this.extraHeaders.length;r++){n.test(this.extraHeaders[r])&&this.extraHeaders.splice(r,1);}this.headers[m.headerize(e)]=Array.isArray(t)?t:[t];}},{key:"getHeader",value:function value(e){var t=this.headers[m.headerize(e)];if(t){if(t[0])return t[0];}else{var n,r=new RegExp("^\\s*".concat(e,"\\s*:"),"i"),s=a(this.extraHeaders);try{for(s.s();!(n=s.n()).done;){var i=n.value;if(r.test(i))return i.substring(i.indexOf(":")+1).trim();}}catch(e){s.e(e);}finally{s.f();}}}},{key:"getHeaders",value:function value(e){var t=this.headers[m.headerize(e)],n=[];if(t){var r,s=a(t);try{for(s.s();!(r=s.n()).done;){var i=r.value;n.push(i);}}catch(e){s.e(e);}finally{s.f();}return n;}var o,l=new RegExp("^\\s*".concat(e,"\\s*:"),"i"),u=a(this.extraHeaders);try{for(u.s();!(o=u.n()).done;){var c=o.value;l.test(c)&&n.push(c.substring(c.indexOf(":")+1).trim());}}catch(e){u.e(e);}finally{u.f();}return n;}},{key:"hasHeader",value:function value(e){if(this.headers[m.headerize(e)])return!0;var t,n=new RegExp("^\\s*".concat(e,"\\s*:"),"i"),r=a(this.extraHeaders);try{for(r.s();!(t=r.n()).done;){var s=t.value;if(n.test(s))return!0;}}catch(e){r.e(e);}finally{r.f();}return!1;}},{key:"parseSDP",value:function value(e){return!e&&this.sdp||(this.sdp=_.parse(this.body||"")),this.sdp;}},{key:"toString",value:function value(){var e="".concat(this.method," ").concat(this.ruri," SIP/2.0\r\n");for(var t in this.headers){if(Object.prototype.hasOwnProperty.call(this.headers,t)){var n,r=a(this.headers[t]);try{for(r.s();!(n=r.n()).done;){var s=n.value;e+="".concat(t,": ").concat(s,"\r\n");}}catch(e){r.e(e);}finally{r.f();}}}var i,o=a(this.extraHeaders);try{for(o.s();!(i=o.n()).done;){var l=i.value;e+="".concat(l.trim(),"\r\n");}}catch(e){o.e(e);}finally{o.f();}var u=[];switch(this.method){case p.REGISTER:u.push("path","gruu");break;case p.INVITE:this.ua.configuration.session_timers&&u.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&u.push("gruu"),u.push("ice","replaces");break;case p.UPDATE:this.ua.configuration.session_timers&&u.push("timer"),u.push("ice");}u.push("outbound");var c=this.ua.configuration.user_agent||p.USER_AGENT;if(e+="Allow: ".concat(p.ALLOWED_METHODS,"\r\n"),e+="Supported: ".concat(u,"\r\n"),e+="User-Agent: ".concat(c,"\r\n"),this.body){var h=m.str_utf8_length(this.body);e+="Content-Length: ".concat(h,"\r\n\r\n"),e+=this.body;}else e+="Content-Length: 0\r\n\r\n";return e;}},{key:"clone",value:function value(){var t=new e(this.method,this.ruri,this.ua);return Object.keys(this.headers).forEach(function(e){t.headers[e]=this.headers[e].slice();},this),t.body=this.body,t.extraHeaders=m.cloneArray(this.extraHeaders),t.to=this.to,t.from=this.from,t.call_id=this.call_id,t.cseq=this.cseq,t;}}]),e;}(),C=function(e){s(n,e);var t=o(n);function n(e,r,s,i,o){var l;return h(this,n),(l=t.call(this,p.INVITE,e,r,s,i,o)).transaction=null,l;}return d(n,[{key:"cancel",value:function value(e){this.transaction.cancel(e);}},{key:"clone",value:function value(){var e=new n(this.ruri,this.ua);return Object.keys(this.headers).forEach(function(t){e.headers[t]=this.headers[t].slice();},this),e.body=this.body,e.extraHeaders=m.cloneArray(this.extraHeaders),e.to=this.to,e.from=this.from,e.call_id=this.call_id,e.cseq=this.cseq,e.transaction=this.transaction,e;}}]),n;}(T),S=function(){function e(){h(this,e),this.data=null,this.headers=null,this.method=null,this.via=null,this.via_branch=null,this.call_id=null,this.cseq=null,this.from=null,this.from_tag=null,this.to=null,this.to_tag=null,this.body=null,this.sdp=null;}return d(e,[{key:"addHeader",value:function value(e,t){var n={raw:t};e=m.headerize(e),this.headers[e]?this.headers[e].push(n):this.headers[e]=[n];}},{key:"getHeader",value:function value(e){var t=this.headers[m.headerize(e)];if(t)return t[0]?t[0].raw:void 0;}},{key:"getHeaders",value:function value(e){var t=this.headers[m.headerize(e)],n=[];if(!t)return[];var r,s=a(t);try{for(s.s();!(r=s.n()).done;){var i=r.value;n.push(i.raw);}}catch(e){s.e(e);}finally{s.f();}return n;}},{key:"hasHeader",value:function value(e){return!!this.headers[m.headerize(e)];}},{key:"parseHeader",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e=m.headerize(e),this.headers[e]){if(!(t>=this.headers[e].length)){var n=this.headers[e][t],r=n.raw;if(n.parsed)return n.parsed;var s=g.parse(r,e.replace(/-/g,"_"));return-1===s?(this.headers[e].splice(t,1),void y('error parsing "'.concat(e,'" header field with value "').concat(r,'"'))):(n.parsed=s,s);}y('not so many "'.concat(e,'" headers present'));}else y('header "'.concat(e,'" not present'));}},{key:"s",value:function value(e,t){return this.parseHeader(e,t);}},{key:"setHeader",value:function value(e,t){var n={raw:t};this.headers[m.headerize(e)]=[n];}},{key:"parseSDP",value:function value(e){return!e&&this.sdp||(this.sdp=_.parse(this.body||"")),this.sdp;}},{key:"toString",value:function value(){return this.data;}}]),e;}(),E=function(e){s(n,e);var t=o(n);function n(e){var r;return h(this,n),(r=t.call(this)).ua=e,r.headers={},r.ruri=null,r.transport=null,r.server_transaction=null,r;}return d(n,[{key:"reply",value:function value(e,t,n,r,s,i){var o=[],l=this.getHeader("To");if(t=t||null,!(e=e||null)||e<100||e>699)throw new TypeError("Invalid status_code: ".concat(e));if(t&&"string"!=typeof t&&!(t instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(t));t=t||p.REASON_PHRASE[e]||"",n=m.cloneArray(n);var u="SIP/2.0 ".concat(e," ").concat(t,"\r\n");if(this.method===p.INVITE&&e>100&&e<=200){var c,h=a(this.getHeaders("record-route"));try{for(h.s();!(c=h.n()).done;){var f=c.value;u+="Record-Route: ".concat(f,"\r\n");}}catch(e){h.e(e);}finally{h.f();}}var d,_=a(this.getHeaders("via"));try{for(_.s();!(d=_.n()).done;){var v=d.value;u+="Via: ".concat(v,"\r\n");}}catch(e){_.e(e);}finally{_.f();}!this.to_tag&&e>100?l+=";tag=".concat(m.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(l+=";tag=".concat(this.to_tag)),u+="To: ".concat(l,"\r\n"),u+="From: ".concat(this.getHeader("From"),"\r\n"),u+="Call-ID: ".concat(this.call_id,"\r\n"),u+="CSeq: ".concat(this.cseq," ").concat(this.method,"\r\n");var g,y=a(n);try{for(y.s();!(g=y.n()).done;){var T=g.value;u+="".concat(T.trim(),"\r\n");}}catch(e){y.e(e);}finally{y.f();}switch(this.method){case p.INVITE:this.ua.configuration.session_timers&&o.push("timer"),(this.ua.contact.pub_gruu||this.ua.contact.temp_gruu)&&o.push("gruu"),o.push("ice","replaces");break;case p.UPDATE:this.ua.configuration.session_timers&&o.push("timer"),r&&o.push("ice"),o.push("replaces");}if(o.push("outbound"),this.method===p.OPTIONS?(u+="Allow: ".concat(p.ALLOWED_METHODS,"\r\n"),u+="Accept: ".concat(p.ACCEPTED_BODY_TYPES,"\r\n")):405===e?u+="Allow: ".concat(p.ALLOWED_METHODS,"\r\n"):415===e&&(u+="Accept: ".concat(p.ACCEPTED_BODY_TYPES,"\r\n")),u+="Supported: ".concat(o,"\r\n"),r){var C=m.str_utf8_length(r);u+="Content-Type: application/sdp\r\n",u+="Content-Length: ".concat(C,"\r\n\r\n"),u+=r;}else u+="Content-Length: ".concat(0,"\r\n\r\n");this.server_transaction.receiveResponse(e,u,s,i);}},{key:"reply_sl",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getHeaders("via");if(!e||e<100||e>699)throw new TypeError("Invalid status_code: ".concat(e));if(t&&"string"!=typeof t&&!(t instanceof String))throw new TypeError("Invalid reason_phrase: ".concat(t));t=t||p.REASON_PHRASE[e]||"";var r,s="SIP/2.0 ".concat(e," ").concat(t,"\r\n"),i=a(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;s+="Via: ".concat(o,"\r\n");}}catch(e){i.e(e);}finally{i.f();}var l=this.getHeader("To");!this.to_tag&&e>100?l+=";tag=".concat(m.newTag()):this.to_tag&&!this.s("to").hasParam("tag")&&(l+=";tag=".concat(this.to_tag)),s+="To: ".concat(l,"\r\n"),s+="From: ".concat(this.getHeader("From"),"\r\n"),s+="Call-ID: ".concat(this.call_id,"\r\n"),s+="CSeq: ".concat(this.cseq," ").concat(this.method,"\r\n"),s+="Content-Length: ".concat(0,"\r\n\r\n"),this.transport.send(s);}}]),n;}(S),A=function(e){s(n,e);var t=o(n);function n(){var e;return h(this,n),(e=t.call(this)).headers={},e.status_code=null,e.reason_phrase=null,e;}return n;}(S);t.exports={OutgoingRequest:T,InitialOutgoingInviteRequest:C,IncomingRequest:E,IncomingResponse:A};},{"./Constants":2,"./Grammar":7,"./NameAddrHeader":10,"./Utils":26,debug:29,"sdp-transform":35}],20:[function(e,t,n){"use strict";var r=e("./Utils"),s=e("./Grammar"),i=e("debug")("JsSIP:ERROR:Socket");i.log=console.warn.bind(console),n.isSocket=function(e){if(Array.isArray(e))return!1;if(void 0===e)return i("undefined JsSIP.Socket instance"),!1;try{if(!r.isString(e.url))throw i("missing or invalid JsSIP.Socket url property"),new Error();if(!r.isString(e.via_transport))throw i("missing or invalid JsSIP.Socket via_transport property"),new Error();if(-1===s.parse(e.sip_uri,"SIP_URI"))throw i("missing or invalid JsSIP.Socket sip_uri property"),new Error();}catch(e){return!1;}try{["connect","disconnect","send"].forEach(function(t){if(!r.isFunction(e[t]))throw i("missing or invalid JsSIP.Socket method: ".concat(t)),new Error();});}catch(e){return!1;}return!0;};},{"./Grammar":7,"./Utils":26,debug:29}],21:[function(e,t,n){"use strict";var r=500;t.exports={T1:r,T2:4e3,T4:5e3,TIMER_B:32e3,TIMER_D:0,TIMER_F:32e3,TIMER_H:32e3,TIMER_I:0,TIMER_J:0,TIMER_K:0,TIMER_L:32e3,TIMER_M:32e3,PROVISIONAL_RESPONSE_INTERVAL:6e4};},{}],22:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e;}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t);}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=f(e);if(t){var s=f(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return c(this,n);};}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?h(e):t;}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var d=e("events").EventEmitter,_=e("./Constants"),p=e("./SIPMessage"),m=e("./Timers"),v=e("debug")("JsSIP:NonInviteClientTransaction"),g=e("debug")("JsSIP:InviteClientTransaction"),y=e("debug")("JsSIP:AckClientTransaction"),T=e("debug")("JsSIP:NonInviteServerTransaction"),C=e("debug")("JsSIP:InviteServerTransaction"),S={STATUS_TRYING:1,STATUS_PROCEEDING:2,STATUS_CALLING:3,STATUS_ACCEPTED:4,STATUS_COMPLETED:5,STATUS_TERMINATED:6,STATUS_CONFIRMED:7,NON_INVITE_CLIENT:"nict",NON_INVITE_SERVER:"nist",INVITE_CLIENT:"ict",INVITE_SERVER:"ist"},E=function(e){l(n,e);var t=a(n);function n(e,r,i,o){var l;s(this,n),(l=t.call(this)).type=S.NON_INVITE_CLIENT,l.id="z9hG4bK".concat(Math.floor(1e7*Math.random())),l.ua=e,l.transport=r,l.request=i,l.eventHandlers=o;var u="SIP/2.0/".concat(r.via_transport);return u+=" ".concat(e.configuration.via_host,";branch=").concat(l.id),l.request.setHeader("via",u),l.ua.newTransaction(h(l)),l;}return o(n,[{key:"C",get:function get(){return S;}},{key:"stateChanged",value:function value(e){this.state=e,this.emit("stateChanged");}},{key:"send",value:function value(){var e=this;this.stateChanged(S.STATUS_TRYING),this.F=setTimeout(function(){e.timer_F();},m.TIMER_F),this.transport.send(this.request)||this.onTransportError();}},{key:"onTransportError",value:function value(){v("transport error occurred, deleting transaction ".concat(this.id)),clearTimeout(this.F),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onTransportError();}},{key:"timer_F",value:function value(){v("Timer F expired for transaction ".concat(this.id)),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout();}},{key:"timer_K",value:function value(){this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this);}},{key:"receiveResponse",value:function value(e){var t=e.status_code;if(t<200)switch(this.state){case S.STATUS_TRYING:case S.STATUS_PROCEEDING:this.stateChanged(S.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(e);}else switch(this.state){case S.STATUS_TRYING:case S.STATUS_PROCEEDING:this.stateChanged(S.STATUS_COMPLETED),clearTimeout(this.F),408===t?this.eventHandlers.onRequestTimeout():this.eventHandlers.onReceiveResponse(e),this.timer_K();}}}]),n;}(d),A=function(e){l(n,e);var t=a(n);function n(e,r,i,o){var l;s(this,n),(l=t.call(this)).type=S.INVITE_CLIENT,l.id="z9hG4bK".concat(Math.floor(1e7*Math.random())),l.ua=e,l.transport=r,l.request=i,l.eventHandlers=o,i.transaction=h(l);var u="SIP/2.0/".concat(r.via_transport);return u+=" ".concat(e.configuration.via_host,";branch=").concat(l.id),l.request.setHeader("via",u),l.ua.newTransaction(h(l)),l;}return o(n,[{key:"C",get:function get(){return S;}},{key:"stateChanged",value:function value(e){this.state=e,this.emit("stateChanged");}},{key:"send",value:function value(){var e=this;this.stateChanged(S.STATUS_CALLING),this.B=setTimeout(function(){e.timer_B();},m.TIMER_B),this.transport.send(this.request)||this.onTransportError();}},{key:"onTransportError",value:function value(){clearTimeout(this.B),clearTimeout(this.M),this.state!==S.STATUS_ACCEPTED&&(g("transport error occurred, deleting transaction ".concat(this.id)),this.eventHandlers.onTransportError()),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this);}},{key:"timer_M",value:function value(){g("Timer M expired for transaction ".concat(this.id)),this.state===S.STATUS_ACCEPTED&&(clearTimeout(this.B),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this));}},{key:"timer_B",value:function value(){g("Timer B expired for transaction ".concat(this.id)),this.state===S.STATUS_CALLING&&(this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this),this.eventHandlers.onRequestTimeout());}},{key:"timer_D",value:function value(){g("Timer D expired for transaction ".concat(this.id)),clearTimeout(this.B),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this);}},{key:"sendACK",value:function value(e){var t=new p.OutgoingRequest(_.ACK,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});t.setHeader("from",this.request.getHeader("from")),t.setHeader("via",this.request.getHeader("via")),t.setHeader("to",e.getHeader("to")),this.transport.send(t),this.timer_D();}},{key:"cancel",value:function value(e){if(this.state===S.STATUS_PROCEEDING){var t=new p.OutgoingRequest(_.CANCEL,this.request.ruri,this.ua,{route_set:this.request.getHeaders("route"),call_id:this.request.getHeader("call-id"),cseq:this.request.cseq});t.setHeader("from",this.request.getHeader("from")),t.setHeader("via",this.request.getHeader("via")),t.setHeader("to",this.request.getHeader("to")),e&&t.setHeader("reason",e),this.transport.send(t);}}},{key:"receiveResponse",value:function value(e){var t=this,n=e.status_code;if(n>=100&&n<=199)switch(this.state){case S.STATUS_CALLING:this.stateChanged(S.STATUS_PROCEEDING),this.eventHandlers.onReceiveResponse(e);break;case S.STATUS_PROCEEDING:this.eventHandlers.onReceiveResponse(e);}else if(n>=200&&n<=299)switch(this.state){case S.STATUS_CALLING:case S.STATUS_PROCEEDING:this.stateChanged(S.STATUS_ACCEPTED),this.M=setTimeout(function(){t.timer_M();},m.TIMER_M),this.eventHandlers.onReceiveResponse(e);break;case S.STATUS_ACCEPTED:this.eventHandlers.onReceiveResponse(e);}else if(n>=300&&n<=699)switch(this.state){case S.STATUS_CALLING:case S.STATUS_PROCEEDING:this.stateChanged(S.STATUS_COMPLETED),this.sendACK(e),this.eventHandlers.onReceiveResponse(e);break;case S.STATUS_COMPLETED:this.sendACK(e);}}}]),n;}(d),b=function(e){l(n,e);var t=a(n);function n(e,r,i,o){var l;s(this,n),(l=t.call(this)).id="z9hG4bK".concat(Math.floor(1e7*Math.random())),l.transport=r,l.request=i,l.eventHandlers=o;var u="SIP/2.0/".concat(r.via_transport);return u+=" ".concat(e.configuration.via_host,";branch=").concat(l.id),l.request.setHeader("via",u),l;}return o(n,[{key:"C",get:function get(){return S;}},{key:"send",value:function value(){this.transport.send(this.request)||this.onTransportError();}},{key:"onTransportError",value:function value(){y("transport error occurred for transaction ".concat(this.id)),this.eventHandlers.onTransportError();}}]),n;}(d),R=function(e){l(n,e);var t=a(n);function n(e,r,i){var o;return s(this,n),(o=t.call(this)).type=S.NON_INVITE_SERVER,o.id=i.via_branch,o.ua=e,o.transport=r,o.request=i,o.last_response="",i.server_transaction=h(o),o.state=S.STATUS_TRYING,e.newTransaction(h(o)),o;}return o(n,[{key:"C",get:function get(){return S;}},{key:"stateChanged",value:function value(e){this.state=e,this.emit("stateChanged");}},{key:"timer_J",value:function value(){T("Timer J expired for transaction ".concat(this.id)),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this);}},{key:"onTransportError",value:function value(){this.transportError||(this.transportError=!0,T("transport error occurred, deleting transaction ".concat(this.id)),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this));}},{key:"receiveResponse",value:function value(e,t,n,r){if(100===e)switch(this.state){case S.STATUS_TRYING:this.stateChanged(S.STATUS_PROCEEDING),this.transport.send(t)||this.onTransportError();break;case S.STATUS_PROCEEDING:this.last_response=t,this.transport.send(t)?n&&n():(this.onTransportError(),r&&r());}else if(e>=200&&e<=699)switch(this.state){case S.STATUS_TRYING:case S.STATUS_PROCEEDING:this.stateChanged(S.STATUS_COMPLETED),this.last_response=t,this.timer_J(),this.transport.send(t)?n&&n():(this.onTransportError(),r&&r());}}}]),n;}(d),w=function(e){l(n,e);var t=a(n);function n(e,r,i){var o;return s(this,n),(o=t.call(this)).type=S.INVITE_SERVER,o.id=i.via_branch,o.ua=e,o.transport=r,o.request=i,o.last_response="",i.server_transaction=h(o),o.state=S.STATUS_PROCEEDING,e.newTransaction(h(o)),o.resendProvisionalTimer=null,i.reply(100),o;}return o(n,[{key:"C",get:function get(){return S;}},{key:"stateChanged",value:function value(e){this.state=e,this.emit("stateChanged");}},{key:"timer_H",value:function value(){C("Timer H expired for transaction ".concat(this.id)),this.state===S.STATUS_COMPLETED&&C("ACK not received, dialog will be terminated"),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this);}},{key:"timer_I",value:function value(){this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this);}},{key:"timer_L",value:function value(){C("Timer L expired for transaction ".concat(this.id)),this.state===S.STATUS_ACCEPTED&&(this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this));}},{key:"onTransportError",value:function value(){this.transportError||(this.transportError=!0,C("transport error occurred, deleting transaction ".concat(this.id)),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),clearTimeout(this.L),clearTimeout(this.H),this.stateChanged(S.STATUS_TERMINATED),this.ua.destroyTransaction(this));}},{key:"resend_provisional",value:function value(){this.transport.send(this.last_response)||this.onTransportError();}},{key:"receiveResponse",value:function value(e,t,n,r){var s=this;if(e>=100&&e<=199)switch(this.state){case S.STATUS_PROCEEDING:this.transport.send(t)||this.onTransportError(),this.last_response=t;}if(e>100&&e<=199&&this.state===S.STATUS_PROCEEDING)null===this.resendProvisionalTimer&&(this.resendProvisionalTimer=setInterval(function(){s.resend_provisional();},m.PROVISIONAL_RESPONSE_INTERVAL));else if(e>=200&&e<=299)switch(this.state){case S.STATUS_PROCEEDING:this.stateChanged(S.STATUS_ACCEPTED),this.last_response=t,this.L=setTimeout(function(){s.timer_L();},m.TIMER_L),null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null);case S.STATUS_ACCEPTED:this.transport.send(t)?n&&n():(this.onTransportError(),r&&r());}else if(e>=300&&e<=699)switch(this.state){case S.STATUS_PROCEEDING:null!==this.resendProvisionalTimer&&(clearInterval(this.resendProvisionalTimer),this.resendProvisionalTimer=null),this.transport.send(t)?(this.stateChanged(S.STATUS_COMPLETED),this.H=setTimeout(function(){s.timer_H();},m.TIMER_H),n&&n()):(this.onTransportError(),r&&r());}}}]),n;}(d);t.exports={C:S,NonInviteClientTransaction:E,InviteClientTransaction:A,AckClientTransaction:b,NonInviteServerTransaction:R,InviteServerTransaction:w,checkTransaction:function checkTransaction(e,t){var n,r=e._transactions;switch(t.method){case _.INVITE:if(n=r.ist[t.via_branch]){switch(n.state){case S.STATUS_PROCEEDING:n.transport.send(n.last_response);}return!0;}break;case _.ACK:if(!(n=r.ist[t.via_branch]))return!1;if(n.state===S.STATUS_ACCEPTED)return!1;if(n.state===S.STATUS_COMPLETED)return n.state=S.STATUS_CONFIRMED,n.timer_I(),!0;break;case _.CANCEL:return(n=r.ist[t.via_branch])?(t.reply_sl(200),n.state!==S.STATUS_PROCEEDING):(t.reply_sl(481),!0);default:if(n=r.nist[t.via_branch]){switch(n.state){case S.STATUS_TRYING:break;case S.STATUS_PROCEEDING:case S.STATUS_COMPLETED:n.transport.send(n.last_response);}return!0;}}}};},{"./Constants":2,"./SIPMessage":19,"./Timers":21,debug:29,events:31}],23:[function(e,t,n){"use strict";function r(e,t){var _n6;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n6=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t);}(e))||t&&e&&"number"==typeof e.length){_n6&&(e=_n6);var r=0,i=function i(){};return{s:i,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e10){throw _e10;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,l=!0,u=!1;return{s:function s(){_n6=e[Symbol.iterator]();},n:function n(){var e=_n6.next();return l=e.done,e;},e:function e(_e11){u=!0,o=_e11;},f:function f(){try{l||null==_n6["return"]||_n6["return"]();}finally{if(u)throw o;}}};}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var l=e("./Socket"),u=e("debug")("JsSIP:Transport"),a=e("debug")("JsSIP:ERROR:Transport"),c=e("./Constants");a.log=console.warn.bind(console);var h={STATUS_CONNECTED:0,STATUS_CONNECTING:1,STATUS_DISCONNECTED:2,SOCKET_STATUS_READY:0,SOCKET_STATUS_ERROR:1,recovery_options:{min_interval:c.CONNECTION_RECOVERY_MIN_INTERVAL,max_interval:c.CONNECTION_RECOVERY_MAX_INTERVAL}};t.exports=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.recovery_options;i(this,e),u("new()"),this._ua=t,this.status=h.STATUS_DISCONNECTED,this.socket=null,this.sockets=[],this.recovery_options=r,this.recover_attempts=0,this.recovery_timer=null,this.close_requested=!1;try{this.textDecoder=new TextDecoder("utf8");}catch(e){a("cannot use TextDecoder: ".concat(e));}if(void 0===n)throw new TypeError("Invalid argument. undefined 'sockets' argument");n instanceof Array||(n=[n]),n.forEach(function(e){if(!l.isSocket(e.socket))throw new TypeError("Invalid argument. invalid 'JsSIP.Socket' instance");if(e.weight&&!Number(e.weight))throw new TypeError("Invalid argument. 'weight' attribute is not a number");this.sockets.push({socket:e.socket,weight:e.weight||0,status:h.SOCKET_STATUS_READY});},this),this._getSocket();}var t,n,s;return t=e,(n=[{key:"via_transport",get:function get(){return this.socket.via_transport;}},{key:"url",get:function get(){return this.socket.url;}},{key:"sip_uri",get:function get(){return this.socket.sip_uri;}},{key:"connect",value:function value(){u("connect()"),this.isConnected()?u("Transport is already connected"):this.isConnecting()?u("Transport is connecting"):(this.close_requested=!1,this.status=h.STATUS_CONNECTING,this.onconnecting({socket:this.socket,attempts:this.recover_attempts}),this.close_requested||(this.socket.onconnect=this._onConnect.bind(this),this.socket.ondisconnect=this._onDisconnect.bind(this),this.socket.ondata=this._onData.bind(this),this.socket.connect()));}},{key:"disconnect",value:function value(){u("close()"),this.close_requested=!0,this.recover_attempts=0,this.status=h.STATUS_DISCONNECTED,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.socket.onconnect=function(){},this.socket.ondisconnect=function(){},this.socket.ondata=function(){},this.socket.disconnect(),this.ondisconnect({socket:this.socket,error:!1});}},{key:"send",value:function value(e){if(u("send()"),!this.isConnected())return a("unable to send message, transport is not connected"),!1;var t=e.toString();return u("sending message:\n\n".concat(t,"\n")),this.socket.send(t);}},{key:"isConnected",value:function value(){return this.status===h.STATUS_CONNECTED;}},{key:"isConnecting",value:function value(){return this.status===h.STATUS_CONNECTING;}},{key:"_get_number_of_sbc",value:function value(){return this.sockets.length;}},{key:"_switch_sbc",value:function value(){var e=this.ondisconnect;this.ondisconnect=function(){},this.disconnect(),this.ondisconnect=e,this.close_requested=!1,this.sockets.forEach(function(e){this.socket===e.socket&&(e.status=h.SOCKET_STATUS_ERROR);},this),this._getSocket(),this.connect();}},{key:"_register_redirect",value:function value(e){var t,n=null,s=r(this.sockets);try{for(s.s();!(t=s.n()).done;){var i=t.value;if(i.socket.url===e){n=i.socket;break;}}}catch(e){s.e(e);}finally{s.f();}if(null===n&&!e.includes(":",6)){e+=":443";var o,l=r(this.sockets);try{for(l.s();!(o=l.n()).done;){var u=o.value;if(u.socket.url===e){n=u.socket;break;}}}catch(e){l.e(e);}finally{l.f();}}if(null===n)return!1;var a=this.ondisconnect;return this.ondisconnect=function(){},this.disconnect(),this.ondisconnect=a,this.socket=n,this.connect(),!0;}},{key:"_reconnect",value:function value(){var e=this;this.recover_attempts+=1;var t=Math.floor(Math.random()*Math.pow(2,this.recover_attempts)+1);t<this.recovery_options.min_interval?t=this.recovery_options.min_interval:t>this.recovery_options.max_interval&&(t=this.recovery_options.max_interval),u("reconnection attempt: ".concat(this.recover_attempts,". next connection attempt in ").concat(t," seconds")),this.recovery_timer=setTimeout(function(){e.close_requested||e.isConnected()||e.isConnecting()||(e._getSocket(),e.connect());},1e3*t);}},{key:"_getSocket",value:function value(){var e=[];if(this.sockets.forEach(function(t){t.status!==h.SOCKET_STATUS_ERROR&&(0===e.length?e.push(t):t.weight>e[0].weight?e=[t]:t.weight===e[0].weight&&e.push(t));}),0===e.length)return this.sockets.forEach(function(e){e.status=h.SOCKET_STATUS_READY;}),void this._getSocket();var t=Math.floor(Math.random()*e.length);this.socket=e[t].socket;}},{key:"_onConnect",value:function value(){this.recover_attempts=0,this._ha_connect_time=void 0,this.status=h.STATUS_CONNECTED,null!==this.recovery_timer&&(clearTimeout(this.recovery_timer),this.recovery_timer=null),this.onconnect({socket:this});}},{key:"_onDisconnect",value:function value(e,t,n){var r=this.status;if(this.status=h.STATUS_DISCONNECTED,this.ondisconnect({socket:this.socket,error:e,code:t,reason:n}),!this.close_requested){if(void 0!==this._ua.modes.sbc_ha_pairs_mode){if(r===h.STATUS_CONNECTED)return u("AC: SBC HA pairs mode: Reconnect to the same SBC "+this._ua.modes.sbc_ha_pairs_mode+" seconds left"),this._ha_connect_time=new Date().getTime()+1e3*this._ua.modes.sbc_ha_pairs_mode,void this._connect2();if(void 0!==this._ha_connect_time){var s=this._ha_connect_time-new Date().getTime();if(s>0)return u("AC: SBC HA pairs mode: Repeat "+s/1e3+" seconds left"),void this._connect2();u("AC: SBC HA pairs mode: Failed"),this._ha_connect_time=void 0;}}this.sockets.forEach(function(e){this.socket===e.socket&&(e.status=h.SOCKET_STATUS_ERROR);},this),this._reconnect();}}},{key:"_connect2",value:function value(){var e=this,t=0;if(this._ha_last_connect){var n=new Date().getTime()-this._ha_last_connect;t=n>500?0:500-n;}this.recovery_timer=setTimeout(function(){e.close_requested||e.isConnected()||e.isConnecting()||(e._ha_last_connect=new Date().getTime(),e.connect());},t);}},{key:"_onData",value:function value(e){if("\r\n"!==e){if("string"!=typeof e){try{e=this.textDecoder?this.textDecoder.decode(e):String.fromCharCode.apply(null,new Uint8Array(e));}catch(e){return void u("received binary message failed to be converted into string, message discarded");}u("received binary message:\n\n".concat(e,"\n"));}else u("received text message:\n\n".concat(e,"\n"));this.ondata({transport:this,message:e});}else u("received message with CRLF Keep Alive response");}}])&&o(t.prototype,n),s&&o(t,s),e;}();},{"./Constants":2,"./Socket":20,debug:29}],24:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e;})(e,t);}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(e){return!1;}}();return function(){var n,r=a(e);if(t){var s=a(this).constructor;n=Reflect.construct(r,arguments,s);}else n=r.apply(this,arguments);return l(this,n);};}function l(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?u(e):t;}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e);})(e);}var c=e("events").EventEmitter,h=e("./Constants"),f=e("./Registrator"),d=e("./RTCSession"),_=e("./Message"),p=e("./Transactions"),m=e("./Transport"),v=e("./Utils"),g=e("./Exceptions"),y=e("./URI"),T=e("./Parser"),C=e("./SIPMessage"),S=e("./RequestSender"),E=e("./sanityCheck"),A=e("./Config"),b=e("debug")("JsSIP:UA"),R=e("debug")("JsSIP:ERROR:UA");R.log=console.warn.bind(console);var w={STATUS_INIT:0,STATUS_READY:1,STATUS_USER_CLOSED:2,STATUS_NOT_READY:3,CONFIGURATION_ERROR:1,NETWORK_ERROR:2};function I(e){this.emit("connecting",e);}function O(e){this._status!==w.STATUS_USER_CLOSED&&(this._status=w.STATUS_READY,this._error=null,this.emit("connected",e),this._dynConfiguration.register&&this._registrator.register());}function k(e){for(var t=0,n=["nict","ict","nist","ist"];t<n.length;t++){var r=n[t];for(var s in this._transactions[r]){Object.prototype.hasOwnProperty.call(this._transactions[r],s)&&this._transactions[r][s].onTransportError();}}this.emit("disconnected",e),this._registrator.onTransportClosed(),this._status!==w.STATUS_USER_CLOSED&&(this._status=w.STATUS_NOT_READY,this._error=w.NETWORK_ERROR);}function N(e){var t=e.transport,n=e.message;if((n=T.parseMessage(n,this))&&!(this._status===w.STATUS_USER_CLOSED&&n instanceof C.IncomingRequest)&&E(n,this,t))if(n instanceof C.IncomingRequest)n.transport=t,this.receiveRequest(n);else if(n instanceof C.IncomingResponse){var r;switch(n.method){case h.INVITE:(r=this._transactions.ict[n.via_branch])&&r.receiveResponse(n);break;case h.ACK:break;default:(r=this._transactions.nict[n.via_branch])&&r.receiveResponse(n);}}}t.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t);}(a,e);var t,n,r,l=o(a);function a(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,a),(t=l.call(this)).modes={},t._cache={credentials:{}},t._configuration=Object.assign({},A.settings),t._dynConfiguration={},t._dialogs={},t._applicants={},t._sessions={},t._transport=null,t._contact=null,t._status=w.STATUS_INIT,t._error=null,t._transactions={nist:{},nict:{},ist:{},ict:{}},t._data={},t._closeTimer=null,void 0===e)throw new TypeError("Not enough arguments");try{t._loadConfig(e);}catch(e){throw t._status=w.STATUS_NOT_READY,t._error=w.CONFIGURATION_ERROR,e;}return t._registrator=new f(u(t)),t;}return t=a,r=[{key:"C",get:function get(){return w;}}],(n=[{key:"C",get:function get(){return w;}},{key:"status",get:function get(){return this._status;}},{key:"contact",get:function get(){return this._contact;}},{key:"configuration",get:function get(){return this._configuration;}},{key:"transport",get:function get(){return this._transport;}},{key:"start",value:function value(){b("start()"),this._status===w.STATUS_INIT?this._transport.connect():this._status===w.STATUS_USER_CLOSED?(b("restarting UA"),null!==this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null,this._transport.disconnect()),this._status=w.STATUS_INIT,this._transport.connect()):this._status===w.STATUS_READY?b("UA is in READY status, not restarted"):b("ERROR: connection is down, Auto-Recovery system is trying to reconnect"),this._dynConfiguration.register=this._configuration.register;}},{key:"register",value:function value(){b("register()"),this._dynConfiguration.register=!0,this._registrator.register();}},{key:"unregister",value:function value(e){b("unregister()"),this._dynConfiguration.register=!1,this._registrator.unregister(e);}},{key:"registrator",value:function value(){return this._registrator;}},{key:"isRegistered",value:function value(){return this._registrator.registered;}},{key:"isConnected",value:function value(){return this._transport.isConnected();}},{key:"call",value:function value(e,t){b("call()");var n=new d(this);return n.connect(e,t),n;}},{key:"sendMessage",value:function value(e,t,n){b("sendMessage()");var r=new _(this);return r.send(e,t,n),r;}},{key:"sendRequest",value:function value(e,t,n,r,s,i,o){b("sendRequest()");var l=new C.OutgoingRequest(e,this.normalizeTarget(t),this,n,r,s);new S(this,l,i,o).send();}},{key:"terminateSessions",value:function value(e){for(var t in b("terminateSessions()"),this._sessions){this._sessions[t].isEnded()||this._sessions[t].terminate(e);}}},{key:"stop",value:function value(){var e=this;if(b("stop()"),this._dynConfiguration={},this._status!==w.STATUS_USER_CLOSED){this._registrator.close();var t=Object.keys(this._sessions).length;for(var n in this._sessions){if(Object.prototype.hasOwnProperty.call(this._sessions,n)){b("closing session ".concat(n));try{this._sessions[n].terminate();}catch(e){}}}for(var r in this._applicants){if(Object.prototype.hasOwnProperty.call(this._applicants,r))try{this._applicants[r].close();}catch(e){}}this._status=w.STATUS_USER_CLOSED,0===Object.keys(this._transactions.nict).length+Object.keys(this._transactions.nist).length+Object.keys(this._transactions.ict).length+Object.keys(this._transactions.ist).length&&0===t?this._transport.disconnect():this._closeTimer=setTimeout(function(){e._closeTimer=null,e._transport.disconnect();},2e3);}else b("UA already closed");}},{key:"normalizeTarget",value:function value(e){return v.normalizeTarget(e,this._configuration.hostport_params);}},{key:"get",value:function value(e){switch(e){case"authorization_user":return this._configuration.authorization_user;case"realm":return this._configuration.realm;case"ha1":return this._configuration.ha1;case"authorization_jwt":return this._configuration.authorization_jwt;default:return void R('get() | cannot get "%s" parameter in runtime',e);}}},{key:"set",value:function value(e,t){switch(e){case"authorization_user":this._configuration.authorization_user=String(t);break;case"password":this._configuration.password=String(t);break;case"realm":this._configuration.realm=String(t);break;case"ha1":this._configuration.ha1=String(t),this._configuration.password=null;break;case"authorization_jwt":this._configuration.authorization_jwt=String(t);break;case"display_name":this._configuration.display_name=t;break;default:return R('set() | cannot set "%s" parameter in runtime',e),!1;}return!0;}},{key:"registerRedirect",value:function value(e){return this._transport._register_redirect(e);}},{key:"switchSBC",value:function value(){this._transport._get_number_of_sbc()<2?b("switchSBC: ignored, no other SBC set"):(this._registrator._unregistered(null,h.causes.CONNECTION_ERROR),this._transport._switch_sbc());}},{key:"getNumberOfSBC",value:function value(){return this._transport._get_number_of_sbc();}},{key:"newTransaction",value:function value(e){this._transactions[e.type][e.id]=e,this.emit("newTransaction",{transaction:e});}},{key:"destroyTransaction",value:function value(e){delete this._transactions[e.type][e.id],this.emit("transactionDestroyed",{transaction:e});}},{key:"newDialog",value:function value(e){this._dialogs[e.id]=e;}},{key:"destroyDialog",value:function value(e){delete this._dialogs[e.id];}},{key:"newMessage",value:function value(e,t){this._applicants[e]=e,this.emit("newMessage",t);}},{key:"destroyMessage",value:function value(e){delete this._applicants[e];}},{key:"newRTCSession",value:function value(e,t){this._sessions[e.id]=e,this.emit("newRTCSession",t);}},{key:"destroyRTCSession",value:function value(e){delete this._sessions[e.id];}},{key:"registered",value:function value(e){this.emit("registered",e);}},{key:"unregistered",value:function value(e){this.emit("unregistered",e);}},{key:"registrationFailed",value:function value(e){this.emit("registrationFailed",e);}},{key:"receiveRequest",value:function value(e){var t=e.method;if(e.ruri.user!==this._configuration.uri.user&&e.ruri.user!==this._contact.uri.user)return b("Request-URI does not point to us"),void(e.method!==h.ACK&&e.reply_sl(404));if(e.ruri.scheme!==h.SIPS){if(!p.checkTransaction(this,e)){if(t===h.INVITE?new p.InviteServerTransaction(this,this._transport,e):t!==h.ACK&&t!==h.CANCEL&&new p.NonInviteServerTransaction(this,this._transport,e),t===h.OPTIONS)e.reply(200);else if(t===h.MESSAGE){if(0===this.listeners("newMessage").length)return void e.reply(405);new _(this).init_incoming(e);}else if(t===h.SUBSCRIBE){if(0===this.listeners("newSubscribe").length)return void e.reply(405);}else if(t===h.INVITE&&!e.to_tag&&0===this.listeners("newRTCSession").length)return void e.reply(405);var n,r;if(e.to_tag)(n=this._findDialog(e.call_id,e.from_tag,e.to_tag))?n.receiveRequest(e):t===h.NOTIFY?(r=this._findSession(e))?r.receiveRequest(e):(b("received NOTIFY request for a non existent subscription"),e.reply(481,"Subscription does not exist")):t!==h.ACK&&e.reply(481);else switch(t){case h.INVITE:if(window.RTCPeerConnection){if(e.hasHeader("replaces")){var s=e.replaces;(n=this._findDialog(s.call_id,s.from_tag,s.to_tag))?(r=n.owner).isEnded()?e.reply(603):r.receiveRequest(e):e.reply(481);}else(r=new d(this)).init_incoming(e);}else R("INVITE received but WebRTC is not supported"),e.reply(488);break;case h.BYE:e.reply(481);break;case h.CANCEL:(r=this._findSession(e))?r.receiveRequest(e):b("received CANCEL request for a non existent session");break;case h.ACK:break;case h.NOTIFY:this.emit("sipEvent",{event:e.event,request:e}),e.reply(200);break;case h.SUBSCRIBE:this.emit("newSubscribe",{event:e.event,request:e});break;default:e.reply(405);}}}else e.reply_sl(416);}},{key:"_findSession",value:function value(e){var t=e.call_id,n=e.from_tag,r=e.to_tag,s=t+n,i=this._sessions[s],o=t+r,l=this._sessions[o];return i||l||null;}},{key:"_findDialog",value:function value(e,t,n){var r=e+t+n,s=this._dialogs[r];return s||(r=e+n+t,(s=this._dialogs[r])||null);}},{key:"_loadConfig",value:function value(e){try{A.load(this._configuration,e);}catch(e){throw e;}0===this._configuration.display_name&&(this._configuration.display_name="0"),this._configuration.instance_id||(this._configuration.instance_id=v.newUUID()),this._configuration.jssip_id=v.createRandomToken(5);var t=this._configuration.uri.clone();t.user=null,this._configuration.hostport_params=t.toString().replace(/^sip:/i,"");try{this._transport=new m(this,this._configuration.sockets,{max_interval:this._configuration.connection_recovery_max_interval,min_interval:this._configuration.connection_recovery_min_interval}),this._transport.onconnecting=I.bind(this),this._transport.onconnect=O.bind(this),this._transport.ondisconnect=k.bind(this),this._transport.ondata=N.bind(this);}catch(e){throw R(e),new g.ConfigurationError("sockets",this._configuration.sockets);}if(delete this._configuration.sockets,this._configuration.authorization_user||(this._configuration.authorization_user=this._configuration.uri.user),!this._configuration.registrar_server){var n=this._configuration.uri.clone();n.user=null,n.clearParams(),n.clearHeaders(),this._configuration.registrar_server=n;}this._configuration.no_answer_timeout*=1e3,this._configuration.contact_uri?this._configuration.via_host=this._configuration.contact_uri.host:this._configuration.contact_uri=new y("sip",v.createRandomToken(8),this._configuration.via_host,null,{transport:"ws"}),this._contact={pub_gruu:null,temp_gruu:null,uri:this._configuration.contact_uri,toString:function toString(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.anonymous||null,n=e.outbound||null,r="<";return r+=t?this.temp_gruu||"sip:anonymous@anonymous.invalid;transport=ws":this.pub_gruu||this.uri.toString(),!n||(t?this.temp_gruu:this.pub_gruu)||(r+=";ob"),r+=">";}};var r=["authorization_user","password","realm","ha1","authorization_jwt","display_name","register"];for(var s in this._configuration){Object.prototype.hasOwnProperty.call(this._configuration,s)&&(-1!==r.indexOf(s)?Object.defineProperty(this._configuration,s,{writable:!0,configurable:!1}):Object.defineProperty(this._configuration,s,{writable:!1,configurable:!1}));}for(var i in b("configuration parameters after validation:"),this._configuration){if(Object.prototype.hasOwnProperty.call(A.settings,i))switch(i){case"uri":case"registrar_server":b("- ".concat(i,": ").concat(this._configuration[i]));break;case"password":case"ha1":case"authorization_jwt":b("- ".concat(i,": NOT SHOWN"));break;default:b("- ".concat(i,": ").concat(JSON.stringify(this._configuration[i])));}}}}])&&s(t.prototype,n),r&&s(t,r),a;}(c);},{"./Config":1,"./Constants":2,"./Exceptions":6,"./Message":9,"./Parser":11,"./RTCSession":12,"./Registrator":17,"./RequestSender":18,"./SIPMessage":19,"./Transactions":22,"./Transport":23,"./URI":25,"./Utils":26,"./sanityCheck":28,debug:29,events:31}],25:[function(e,t,n){"use strict";function r(e,t){var _n7;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n7=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t);}(e))||t&&e&&"number"==typeof e.length){_n7&&(e=_n7);var r=0,i=function i(){};return{s:i,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e12){throw _e12;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,l=!0,u=!1;return{s:function s(){_n7=e[Symbol.iterator]();},n:function n(){var e=_n7.next();return l=e.done,e;},e:function e(_e13){u=!0,o=_e13;},f:function f(){try{l||null==_n7["return"]||_n7["return"]();}finally{if(u)throw o;}}};}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var l=e("./Constants"),u=e("./Utils"),a=e("./Grammar");t.exports=function(){function e(t,n,r,s){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(i(this,e),!r)throw new TypeError('missing or invalid "host" parameter');for(var a in this._parameters={},this._headers={},this._scheme=t||l.SIP,this._user=n,this._host=r,this._port=s,o){Object.prototype.hasOwnProperty.call(o,a)&&this.setParam(a,o[a]);}for(var c in u){Object.prototype.hasOwnProperty.call(u,c)&&this.setHeader(c,u[c]);}}var t,n,s;return t=e,s=[{key:"parse",value:function value(e){return-1!==(e=a.parse(e,"SIP_URI"))?e:void 0;}}],(n=[{key:"scheme",get:function get(){return this._scheme;},set:function set(e){this._scheme=e.toLowerCase();}},{key:"user",get:function get(){return this._user;},set:function set(e){this._user=e;}},{key:"host",get:function get(){return this._host;},set:function set(e){this._host=e.toLowerCase();}},{key:"port",get:function get(){return this._port;},set:function set(e){this._port=0===e?e:parseInt(e,10)||null;}},{key:"setParam",value:function value(e,t){e&&(this._parameters[e.toLowerCase()]=null==t?null:t.toString());}},{key:"getParam",value:function value(e){if(e)return this._parameters[e.toLowerCase()];}},{key:"hasParam",value:function value(e){if(e)return!!this._parameters.hasOwnProperty(e.toLowerCase());}},{key:"deleteParam",value:function value(e){if(e=e.toLowerCase(),this._parameters.hasOwnProperty(e)){var t=this._parameters[e];return delete this._parameters[e],t;}}},{key:"clearParams",value:function value(){this._parameters={};}},{key:"setHeader",value:function value(e,t){this._headers[u.headerize(e)]=Array.isArray(t)?t:[t];}},{key:"getHeader",value:function value(e){if(e)return this._headers[u.headerize(e)];}},{key:"hasHeader",value:function value(e){if(e)return!!this._headers.hasOwnProperty(u.headerize(e));}},{key:"deleteHeader",value:function value(e){if(e=u.headerize(e),this._headers.hasOwnProperty(e)){var t=this._headers[e];return delete this._headers[e],t;}}},{key:"clearHeaders",value:function value(){this._headers={};}},{key:"clone",value:function value(){return new e(this._scheme,this._user,this._host,this._port,JSON.parse(JSON.stringify(this._parameters)),JSON.parse(JSON.stringify(this._headers)));}},{key:"toString",value:function value(){var e=[],t="".concat(this._scheme,":");for(var n in this._user&&(t+="".concat(u.escapeUser(this._user),"@")),t+=this._host,(this._port||0===this._port)&&(t+=":".concat(this._port)),this._parameters){Object.prototype.hasOwnProperty.call(this._parameters,n)&&(t+=";".concat(n),null!==this._parameters[n]&&(t+="=".concat(this._parameters[n])));}for(var s in this._headers){if(Object.prototype.hasOwnProperty.call(this._headers,s)){var i,o=r(this._headers[s]);try{for(o.s();!(i=o.n()).done;){var l=i.value;e.push("".concat(s,"=").concat(l));}}catch(e){o.e(e);}finally{o.f();}}}return e.length>0&&(t+="?".concat(e.join("&"))),t;}},{key:"toAor",value:function value(e){var t="".concat(this._scheme,":");return this._user&&(t+="".concat(u.escapeUser(this._user),"@")),t+=this._host,e&&(this._port||0===this._port)&&(t+=":".concat(this._port)),t;}}])&&o(t.prototype,n),s&&o(t,s),e;}();},{"./Constants":2,"./Grammar":7,"./Utils":26}],26:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e);})(e);}function s(e,t){var _n8;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n8=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t);}(e))||t&&e&&"number"==typeof e.length){_n8&&(e=_n8);var r=0,s=function s(){};return{s:s,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e14){throw _e14;},f:s};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,l=!0,u=!1;return{s:function s(){_n8=e[Symbol.iterator]();},n:function n(){var e=_n8.next();return l=e.done,e;},e:function e(_e15){u=!0,o=_e15;},f:function f(){try{l||null==_n8["return"]||_n8["return"]();}finally{if(u)throw o;}}};}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}var o=e("./Constants"),l=e("./URI"),u=e("./Grammar");n.str_utf8_length=function(e){return unescape(encodeURIComponent(e)).length;};var a=n.isFunction=function(e){return void 0!==e&&"[object Function]"===Object.prototype.toString.call(e);};n.isString=function(e){return void 0!==e&&"[object String]"===Object.prototype.toString.call(e);},n.isDecimal=function(e){return!isNaN(e)&&parseFloat(e)===parseInt(e,10);},n.isEmpty=function(e){return null===e||""===e||void 0===e||Array.isArray(e)&&0===e.length||"number"==typeof e&&isNaN(e);},n.hasMethods=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++){n[r-1]=arguments[r];}for(var s=0,i=n;s<i.length;s++){var o=i[s];if(a(e[o]))return!1;}return!0;};var c=n.createRandomToken=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r="";for(t=0;t<e;t++){r+=(Math.random()*n|0).toString(n);}return r;};n.newTag=function(){return c(10);},n.newUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16);});},n.hostType=function(e){if(e)return-1!==(e=u.parse(e,"host"))?e.host_type:void 0;};var h=n.escapeUser=function(e){return encodeURIComponent(decodeURIComponent(e)).replace(/%3A/gi,":").replace(/%2B/gi,"+").replace(/%3F/gi,"?").replace(/%2F/gi,"/");};n.normalizeTarget=function(e,t){if(e){if(e instanceof l)return e;if("string"==typeof e){var n,r,s,i=e.split("@");switch(i.length){case 1:if(!t)return;n=e,r=t;break;case 2:n=i[0],r=i[1];break;default:n=i.slice(0,i.length-1).join("@"),r=i[i.length-1];}return n=n.replace(/^(sips?|tel):/i,""),/^[-.()]*\+?[0-9\-.()]+$/.test(n)&&(n=n.replace(/[-.()]/g,"")),e="".concat(o.SIP,":").concat(h(n),"@").concat(r),(s=l.parse(e))?s:void 0;}}else;},n.headerize=function(e){var t,n={"Call-Id":"Call-ID",Cseq:"CSeq","Www-Authenticate":"WWW-Authenticate"},r=e.toLowerCase().replace(/_/g,"-").split("-"),s="",i=r.length;for(t=0;t<i;t++){0!==t&&(s+="-"),s+=r[t].charAt(0).toUpperCase()+r[t].substring(1);}return n[s]&&(s=n[s]),s;},n.sipErrorCause=function(e){for(var t in o.SIP_ERROR_CAUSES){if(-1!==o.SIP_ERROR_CAUSES[t].indexOf(e))return o.causes[t];}return o.causes.SIP_FAILURE_CODE;},n.getRandomTestNetIP=function(){return"192.0.2.".concat((e=1,t=254,Math.floor(Math.random()*(t-e+1)+e)));var e,t;},n.calculateMD5=function(e){function t(e,t){return e<<t|e>>>32-t;}function n(e,t){var n=2147483648&e,r=2147483648&t,s=1073741824&e,i=1073741824&t,o=(1073741823&e)+(1073741823&t);return s&i?2147483648^o^n^r:s|i?1073741824&o?3221225472^o^n^r:1073741824^o^n^r:o^n^r;}function r(e,r,s,i,o,l,u){return e=n(e,n(n(function(e,t,n){return e&t|~e&n;}(r,s,i),o),u)),n(t(e,l),r);}function s(e,r,s,i,o,l,u){return e=n(e,n(n(function(e,t,n){return e&n|t&~n;}(r,s,i),o),u)),n(t(e,l),r);}function i(e,r,s,i,o,l,u){return e=n(e,n(n(function(e,t,n){return e^t^n;}(r,s,i),o),u)),n(t(e,l),r);}function o(e,r,s,i,o,l,u){return e=n(e,n(n(function(e,t,n){return t^(e|~n);}(r,s,i),o),u)),n(t(e,l),r);}function l(e){var t,n="",r="";for(t=0;t<=3;t++){n+=(r="0".concat((e>>>8*t&255).toString(16))).substr(r.length-2,2);}return n;}var u,a,c,h,f,d,_,p,m,v;for(u=function(e){for(var t,n=e.length,r=n+8,s=16*((r-r%64)/64+1),i=new Array(s-1),o=0,l=0;l<n;){o=l%4*8,i[t=(l-l%4)/4]=i[t]|e.charCodeAt(l)<<o,l++;}return o=l%4*8,i[t=(l-l%4)/4]=i[t]|128<<o,i[s-2]=n<<3,i[s-1]=n>>>29,i;}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128));}return t;}(e)),_=1732584193,p=4023233417,m=2562383102,v=271733878,a=0;a<u.length;a+=16){c=_,h=p,f=m,d=v,_=r(_,p,m,v,u[a+0],7,3614090360),v=r(v,_,p,m,u[a+1],12,3905402710),m=r(m,v,_,p,u[a+2],17,606105819),p=r(p,m,v,_,u[a+3],22,3250441966),_=r(_,p,m,v,u[a+4],7,4118548399),v=r(v,_,p,m,u[a+5],12,1200080426),m=r(m,v,_,p,u[a+6],17,2821735955),p=r(p,m,v,_,u[a+7],22,4249261313),_=r(_,p,m,v,u[a+8],7,1770035416),v=r(v,_,p,m,u[a+9],12,2336552879),m=r(m,v,_,p,u[a+10],17,4294925233),p=r(p,m,v,_,u[a+11],22,2304563134),_=r(_,p,m,v,u[a+12],7,1804603682),v=r(v,_,p,m,u[a+13],12,4254626195),m=r(m,v,_,p,u[a+14],17,2792965006),_=s(_,p=r(p,m,v,_,u[a+15],22,1236535329),m,v,u[a+1],5,4129170786),v=s(v,_,p,m,u[a+6],9,3225465664),m=s(m,v,_,p,u[a+11],14,643717713),p=s(p,m,v,_,u[a+0],20,3921069994),_=s(_,p,m,v,u[a+5],5,3593408605),v=s(v,_,p,m,u[a+10],9,38016083),m=s(m,v,_,p,u[a+15],14,3634488961),p=s(p,m,v,_,u[a+4],20,3889429448),_=s(_,p,m,v,u[a+9],5,568446438),v=s(v,_,p,m,u[a+14],9,3275163606),m=s(m,v,_,p,u[a+3],14,4107603335),p=s(p,m,v,_,u[a+8],20,1163531501),_=s(_,p,m,v,u[a+13],5,2850285829),v=s(v,_,p,m,u[a+2],9,4243563512),m=s(m,v,_,p,u[a+7],14,1735328473),_=i(_,p=s(p,m,v,_,u[a+12],20,2368359562),m,v,u[a+5],4,4294588738),v=i(v,_,p,m,u[a+8],11,2272392833),m=i(m,v,_,p,u[a+11],16,1839030562),p=i(p,m,v,_,u[a+14],23,4259657740),_=i(_,p,m,v,u[a+1],4,2763975236),v=i(v,_,p,m,u[a+4],11,1272893353),m=i(m,v,_,p,u[a+7],16,4139469664),p=i(p,m,v,_,u[a+10],23,3200236656),_=i(_,p,m,v,u[a+13],4,681279174),v=i(v,_,p,m,u[a+0],11,3936430074),m=i(m,v,_,p,u[a+3],16,3572445317),p=i(p,m,v,_,u[a+6],23,76029189),_=i(_,p,m,v,u[a+9],4,3654602809),v=i(v,_,p,m,u[a+12],11,3873151461),m=i(m,v,_,p,u[a+15],16,530742520),_=o(_,p=i(p,m,v,_,u[a+2],23,3299628645),m,v,u[a+0],6,4096336452),v=o(v,_,p,m,u[a+7],10,1126891415),m=o(m,v,_,p,u[a+14],15,2878612391),p=o(p,m,v,_,u[a+5],21,4237533241),_=o(_,p,m,v,u[a+12],6,1700485571),v=o(v,_,p,m,u[a+3],10,2399980690),m=o(m,v,_,p,u[a+10],15,4293915773),p=o(p,m,v,_,u[a+1],21,2240044497),_=o(_,p,m,v,u[a+8],6,1873313359),v=o(v,_,p,m,u[a+15],10,4264355552),m=o(m,v,_,p,u[a+6],15,2734768916),p=o(p,m,v,_,u[a+13],21,1309151649),_=o(_,p,m,v,u[a+4],6,4149444226),v=o(v,_,p,m,u[a+11],10,3174756917),m=o(m,v,_,p,u[a+2],15,718787259),p=o(p,m,v,_,u[a+9],21,3951481745),_=n(_,c),p=n(p,h),m=n(m,f),v=n(v,d);}return(l(_)+l(p)+l(m)+l(v)).toLowerCase();},n.closeMediaStream=function(e){if(e)try{if(e.getTracks){var t,n=s(e.getTracks());try{for(n.s();!(t=n.n()).done;){t.value.stop();}}catch(e){n.e(e);}finally{n.f();}}else{var i,o=s(e.getAudioTracks());try{for(o.s();!(i=o.n()).done;){i.value.stop();}}catch(e){o.e(e);}finally{o.f();}var l,u=s(e.getVideoTracks());try{for(u.s();!(l=u.n()).done;){l.value.stop();}}catch(e){u.e(e);}finally{u.f();}}}catch(t){"function"!=typeof e.stop&&"object"!==r(e.stop)||e.stop();}},n.cloneArray=function(e){return e&&e.slice()||[];},n.cloneObject=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&Object.assign({},e)||t;};},{"./Constants":2,"./Grammar":7,"./URI":25}],27:[function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r);}}var s=e("./Grammar"),i=e("debug")("JsSIP:WebSocketInterface"),o=e("debug")("JsSIP:ERROR:WebSocketInterface");o.log=console.warn.bind(console),t.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}(this,e),i('new() [url:"%s"]',t),this._url=t,this._sip_uri=null,this._via_transport=null,this._ws=null;var n=s.parse(t,"absoluteURI");if(-1===n)throw o("invalid WebSocket URI: ".concat(t)),new TypeError("Invalid argument: ".concat(t));if("wss"!==n.scheme&&"ws"!==n.scheme)throw o("invalid WebSocket URI scheme: ".concat(n.scheme)),new TypeError("Invalid argument: ".concat(t));this._sip_uri="sip:".concat(n.host).concat(n.port?":".concat(n.port):"",";transport=ws"),this._via_transport=n.scheme.toUpperCase();}var t,n,l;return t=e,(n=[{key:"via_transport",get:function get(){return this._via_transport;},set:function set(e){this._via_transport=e.toUpperCase();}},{key:"sip_uri",get:function get(){return this._sip_uri;}},{key:"url",get:function get(){return this._url;}},{key:"connect",value:function value(){if(i("connect()"),this.isConnected())i("WebSocket ".concat(this._url," is already connected"));else if(this.isConnecting())i("WebSocket ".concat(this._url," is connecting"));else{this._ws&&this.disconnect(),i("connecting to WebSocket ".concat(this._url));try{this._ws=new WebSocket(this._url,"sip"),this._ws.binaryType="arraybuffer",this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onmessage=this._onMessage.bind(this),this._ws.onerror=this._onError.bind(this);}catch(e){this._onError(e);}}}},{key:"disconnect",value:function value(){i("disconnect()"),this._ws&&(this._ws.onopen=function(){},this._ws.onclose=function(){},this._ws.onmessage=function(){},this._ws.onerror=function(){},this._ws.close(),this._ws=null);}},{key:"send",value:function value(e){return i("send()"),this.isConnected()?(this._ws.send(e),!0):(o("unable to send message, WebSocket is not open"),!1);}},{key:"isConnected",value:function value(){return this._ws&&this._ws.readyState===this._ws.OPEN;}},{key:"isConnecting",value:function value(){return this._ws&&this._ws.readyState===this._ws.CONNECTING;}},{key:"_onOpen",value:function value(){i("WebSocket ".concat(this._url," connected")),this.onconnect();}},{key:"_onClose",value:function value(e){var t=e.wasClean,n=e.code,r=e.reason;i("WebSocket ".concat(this._url," closed")),!1===t&&i("WebSocket abrupt disconnection"),this.ondisconnect(!t,n,r);}},{key:"_onMessage",value:function value(e){var t=e.data;i("received WebSocket message"),this.ondata(t);}},{key:"_onError",value:function value(e){o("WebSocket ".concat(this._url," error: "),e);}}])&&r(t.prototype,n),l&&r(t,l),e;}();},{"./Grammar":7,debug:29}],28:[function(e,t,n){"use strict";function r(e,t){var _n9;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(_n9=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t);}(e))||t&&e&&"number"==typeof e.length){_n9&&(e=_n9);var r=0,i=function i(){};return{s:i,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e16){throw _e16;},f:i};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,l=!0,u=!1;return{s:function s(){_n9=e[Symbol.iterator]();},n:function n(){var e=_n9.next();return l=e.done,e;},e:function e(_e17){u=!0,o=_e17;},f:function f(){try{l||null==_n9["return"]||_n9["return"]();}finally{if(u)throw o;}}};}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++){r[n]=e[n];}return r;}var i,o,l,u=e("./Constants"),a=e("./SIPMessage"),c=e("./Utils"),h=e("debug")("JsSIP:sanityCheck"),f=[function(){for(var e=0,t=["from","to","call_id","cseq","via"];e<t.length;e++){var n=t[e];if(!i.hasHeader(n))return h("missing mandatory header field : ".concat(n,", dropping the response")),!1;}}],d=[function(){if("sip"!==i.s("to").uri.scheme)return p(416),!1;},function(){if(!i.to_tag&&i.call_id.substr(0,5)===o.configuration.jssip_id)return p(482),!1;},function(){var e=c.str_utf8_length(i.body),t=i.getHeader("content-length");if(e<t)return p(400),!1;},function(){var e,t=i.from_tag,n=i.call_id,r=i.cseq;if(i.to_tag)return;if(i.method===u.INVITE){if(o._transactions.ist[i.via_branch])return!1;for(var s in o._transactions.ist){if(Object.prototype.hasOwnProperty.call(o._transactions.ist,s)&&(e=o._transactions.ist[s]).request.from_tag===t&&e.request.call_id===n&&e.request.cseq===r)return p(482),!1;}}else{if(o._transactions.nist[i.via_branch])return!1;for(var l in o._transactions.nist){if(Object.prototype.hasOwnProperty.call(o._transactions.nist,l)&&(e=o._transactions.nist[l]).request.from_tag===t&&e.request.call_id===n&&e.request.cseq===r)return p(482),!1;}}}],_=[function(){if(i.getHeaders("via").length>1)return h("more than one Via header field present in the response, dropping the response"),!1;},function(){var e=c.str_utf8_length(i.body),t=i.getHeader("content-length");if(e<t)return h("message body length is lower than the value in Content-Length header field, dropping the response"),!1;}];function p(e){var t,n,s=i.getHeaders("via"),o="SIP/2.0 ".concat(e," ").concat(u.REASON_PHRASE[e],"\r\n"),a=r(s);try{for(a.s();!(n=a.n()).done;){var h=n.value;o+="Via: ".concat(h,"\r\n");}}catch(e){a.e(e);}finally{a.f();}t=i.getHeader("To"),i.to_tag||(t+=";tag=".concat(c.newTag())),o+="To: ".concat(t,"\r\n"),o+="From: ".concat(i.getHeader("From"),"\r\n"),o+="Call-ID: ".concat(i.call_id,"\r\n"),o+="CSeq: ".concat(i.cseq," ").concat(i.method,"\r\n"),o+="\r\n",l.send(o);}t.exports=function(e,t,n){i=e,o=t,l=n;var s,u=r(f);try{for(u.s();!(s=u.n()).done;){if(!1===(0,s.value)())return!1;}}catch(e){u.e(e);}finally{u.f();}if(i instanceof a.IncomingRequest){var c,h=r(d);try{for(h.s();!(c=h.n()).done;){if(!1===(0,c.value)())return!1;}}catch(e){h.e(e);}finally{h.f();}}else if(i instanceof a.IncomingResponse){var p,m=r(_);try{for(m.s();!(p=m.n()).done;){if(!1===(0,p.value)())return!1;}}catch(e){m.e(e);}finally{m.f();}}return!0;};},{"./Constants":2,"./SIPMessage":19,"./Utils":26,debug:29}],29:[function(e,t,n){(function(r){(function(){n.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(s=r));}),e.splice(s,0,n);},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug");}catch(e){}},n.load=function(){var e;try{e=n.storage.getItem("debug");}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e;},n.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/);},n.storage=function(){try{return localStorage;}catch(e){}}(),n.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."));};}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||function(){},t.exports=e("./common")(n);var s=t.exports.formatters;s.j=function(e){try{return JSON.stringify(e);}catch(e){return"[UnexpectedJSONParseError]: "+e.message;}};}).call(this);}).call(this,e("_process"));},{"./common":30,_process:33}],30:[function(e,t,n){t.exports=function(t){function n(e){var t,s=null;function i(){for(var _len=arguments.length,e=new Array(_len),_key=0;_key<_len;_key++){e[_key]=arguments[_key];}if(!i.enabled)return;var r=i,s=Number(new Date()),o=s-(t||s);r.diff=o,r.prev=t,r.curr=s,t=s,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var l=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(t,s){if("%%"===t)return"%";l++;var i=n.formatters[s];if("function"==typeof i){var _n10=e[l];t=i.call(r,_n10),e.splice(l,1),l--;}return t;}),n.formatArgs.call(r,e);(r.log||n.log).apply(r,e);}return i.namespace=e,i.useColors=n.useColors(),i.color=n.selectColor(e),i.extend=r,i.destroy=n.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:function get(){return null===s?n.enabled(e):s;},set:function set(e){s=e;}}),"function"==typeof n.init&&n.init(i),i;}function r(e,t){var r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r;}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*");}return n.debug=n,n["default"]=n,n.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e;},n.disable=function(){var e=[].concat(_toConsumableArray(n.names.map(s)),_toConsumableArray(n.skips.map(s).map(function(e){return"-"+e;}))).join(",");return n.enable(""),e;},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),s=r.length;for(t=0;t<s;t++){r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++){if(n.skips[t].test(e))return!1;}for(t=0,r=n.names.length;t<r;t++){if(n.names[t].test(e))return!0;}return!1;},n.humanize=e("ms"),n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");},Object.keys(t).forEach(function(e){n[e]=t[e];}),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(e){var t=0;for(var _n11=0;_n11<e.length;_n11++){t=(t<<5)-t+e.charCodeAt(_n11),t|=0;}return n.colors[Math.abs(t)%n.colors.length];},n.enable(n.load()),n;};},{ms:32}],31:[function(e,t,n){"use strict";var r,s="object"==(typeof Reflect==="undefined"?"undefined":_typeof(Reflect))?Reflect:null,i=s&&"function"==typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n);};r=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e));}:function(e){return Object.getOwnPropertyNames(e);};var o=Number.isNaN||function(e){return e!=e;};function l(){l.init.call(this);}t.exports=l,t.exports.once=function(e,t){return new Promise(function(n,r){function s(n){e.removeListener(t,i),r(n);}function i(){"function"==typeof e.removeListener&&e.removeListener("error",s),n([].slice.call(arguments));}v(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,n);}(e,s,{once:!0});});},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var u=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+_typeof(e));}function c(e){return void 0===e._maxListeners?l.defaultMaxListeners:e._maxListeners;}function h(e,t,n,r){var s,i,o,l;if(a(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),o=i[t]),void 0===o)o=i[t]=n,++e._eventsCount;else if("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(s=c(e))>0&&o.length>s&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,l=u,console&&console.warn&&console.warn(l);}return e;}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments);}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=f.bind(r);return s.listener=n,r.wrapFn=s,s;}function _(e,t,n){var r=e._events;if(void 0===r)return[];var s=r[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n){t[n]=e[n].listener||e[n];}return t;}(s):m(s,s.length);}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length;}return 0;}function m(e,t){for(var n=new Array(t),r=0;r<t;++r){n[r]=e[r];}return n;}function v(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+_typeof(e));e.addEventListener(t,function s(i){r.once&&e.removeEventListener(t,s),n(i);});}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function get(){return u;},set:function set(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e;}}),l.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0;},l.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this;},l.prototype.getMaxListeners=function(){return c(this);},l.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++){t.push(arguments[n]);}var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var l=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw l.context=o,l;}var u=s[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else{var a=u.length,c=m(u,a);for(n=0;n<a;++n){i(c[n],this,t);}}return!0;},l.prototype.addListener=function(e,t){return h(this,e,t,!1);},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(e,t){return h(this,e,t,!0);},l.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this;},l.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this;},l.prototype.removeListener=function(e,t){var n,r,s,i,o;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,i=n.length-1;i>=0;i--){if(n[i]===t||n[i].listener===t){o=n[i].listener,s=i;break;}}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++){e[t]=e[t+1];}e.pop();}(n,s),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t);}return this;},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,i=Object.keys(n);for(r=0;r<i.length;++r){"removeListener"!==(s=i[r])&&this.removeAllListeners(s);}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this;}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--){this.removeListener(e,t[r]);}return this;},l.prototype.listeners=function(e){return _(this,e,!0);},l.prototype.rawListeners=function(e){return _(this,e,!1);},l.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t);},l.prototype.listenerCount=p,l.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[];};},{}],32:[function(e,t,n){var r=1e3,s=6e4,i=60*s,o=24*i;function l(e,t,n,r){var s=t>=1.5*n;return Math.round(e/n)+" "+r+(s?"s":"");}t.exports=function(e,t){t=t||{};var n=_typeof(e);if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"hrs":case"hr":case"h":return n*i;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return;}}(e);if("number"===n&&isFinite(e))return t["long"]?function(e){var t=Math.abs(e);if(t>=o)return l(e,t,o,"day");if(t>=i)return l(e,t,i,"hour");if(t>=s)return l(e,t,s,"minute");if(t>=r)return l(e,t,r,"second");return e+" ms";}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=s)return Math.round(e/s)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms";}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e));};},{}],33:[function(e,t,n){var r,s,i=t.exports={};function o(){throw new Error("setTimeout has not been defined");}function l(){throw new Error("clearTimeout has not been defined");}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0);}catch(t){try{return r.call(null,e,0);}catch(t){return r.call(this,e,0);}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o;}catch(e){r=o;}try{s="function"==typeof clearTimeout?clearTimeout:l;}catch(e){s=l;}}();var a,c=[],h=!1,f=-1;function d(){h&&a&&(h=!1,a.length?c=a.concat(c):f=-1,c.length&&_());}function _(){if(!h){var e=u(d);h=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;){a&&a[f].run();}f=-1,t=c.length;}a=null,h=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===l||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e);}catch(t){try{return s.call(null,e);}catch(t){return s.call(this,e);}}}(e);}}function p(e,t){this.fun=e,this.array=t;}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n];}c.push(new p(e,t)),1!==c.length||h||u(_);},p.prototype.run=function(){this.fun.apply(null,this.array);},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[];},i.binding=function(e){throw new Error("process.binding is not supported");},i.cwd=function(){return"/";},i.chdir=function(e){throw new Error("process.chdir is not supported");},i.umask=function(){return 0;};},{}],34:[function(e,t,n){var r=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function format(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s";}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function format(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d";}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function format(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s";}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function format(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"");}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function format(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s";}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function format(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v";}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function format(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t;}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function format(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s";}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function format(e){return e.params?"rid:%s %s %s":"rid:%s %s";}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function format(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"");}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function format(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"");}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function format(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"");}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function format(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":"";}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(r).forEach(function(e){r[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s");});});},{}],35:[function(e,t,n){var r=e("./parser"),s=e("./writer");n.write=s,n.parse=r.parse,n.parseParams=r.parseParams,n.parseFmtpConfig=r.parseFmtpConfig,n.parsePayloads=r.parsePayloads,n.parseRemoteCandidates=r.parseRemoteCandidates,n.parseImageAttributes=r.parseImageAttributes,n.parseSimulcastStreamList=r.parseSimulcastStreamList;},{"./parser":36,"./writer":37}],36:[function(e,t,n){var r=function r(e){return String(Number(e))===e?Number(e):e;},s=function s(e,t,n){var s=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:s&&!t[e.name]&&(t[e.name]={});var i=e.push?{}:s?t[e.name]:t;!function(e,t,n,s){if(s&&!n)t[s]=r(e[1]);else for(var i=0;i<n.length;i+=1){null!=e[i+1]&&(t[n[i]]=r(e[i+1]));}}(n.match(e.reg),i,e.names,e.name),e.push&&t[e.push].push(i);},i=e("./grammar"),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach(function(e){var t=e[0],o=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var l=0;l<(i[t]||[]).length;l+=1){var u=i[t][l];if(u.reg.test(o))return s(u,r,o);}}),t.media=n,t;};var l=function l(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e;};n.parseParams=function(e){return e.split(/;\s?/).reduce(l,{});},n.parseFmtpConfig=n.parseParams,n.parsePayloads=function(e){return e.toString().split(" ").map(Number);},n.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),s=0;s<n.length;s+=3){t.push({component:n[s],ip:n[s+1],port:n[s+2]});}return t;},n.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(l,{});});},n.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n};});});};},{"./grammar":34}],37:[function(e,t,n){var r=e("./grammar"),s=/%[sdv%]/g,i=function i(e){var t=1,n=arguments,r=n.length;return e.replace(s,function(e){if(t>=r)return e;var s=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return"";}});},o=function o(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var s=0;s<t.names.length;s+=1){var o=t.names[s];t.name?r.push(n[t.name][o]):r.push(n[t.names[s]]);}else r.push(n[t.name]);return i.apply(null,r);},l=["v","o","s","i","u","e","p","c","b","t","r","z","a"],u=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="");});var n=t.outerOrder||l,s=t.innerOrder||u,i=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(o(t,n,e));});});}),e.media.forEach(function(e){i.push(o("m",r.m[0],e)),s.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(o(t,n,e));});});});}),i.join("\r\n")+"\r\n";};},{"./grammar":34}],38:[function(e,t,n){t.exports={name:"jssip",title:"JsSIP",description:"the Javascript SIP library",version:"3.7.5",homepage:"https://jssip.net",author:"José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)",contributors:["Iñaki Baz Castillo <ibc@aliax.net> (https://github.com/ibc)"],types:"lib/JsSIP.d.ts",main:"lib-es5/JsSIP.js",keywords:["sip","websocket","webrtc","node","browser","library"],license:"MIT",repository:{type:"git",url:"https://github.com/versatica/JsSIP.git"},bugs:{url:"https://github.com/versatica/JsSIP/issues"},dependencies:{"@types/debug":"^4.1.5","@types/node":"^14.14.34",debug:"^4.3.1",events:"^3.3.0","sdp-transform":"^2.14.1"},devDependencies:{"@babel/core":"^7.13.10","@babel/preset-env":"^7.13.10","ansi-colors":"^3.2.4",browserify:"^16.5.1",eslint:"^5.16.0","fancy-log":"^1.3.3",gulp:"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint":"^5.0.0","gulp-expect-file":"^1.0.2","gulp-header":"^2.0.9","gulp-nodeunit-runner":"^0.2.2","gulp-plumber":"^1.2.1","gulp-rename":"^1.4.0","gulp-uglify-es":"^1.0.4",pegjs:"^0.7.0","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},scripts:{lint:"gulp lint",test:"gulp test",prepublishOnly:"gulp babel"}};},{}]},{},[8])(8);});}},{key:"version",value:function version(){return"1.14.1";}},{key:"getBrowserName",value:function getBrowserName(){return this.browserName;}},{key:"getBrowser",value:function getBrowser(){return this.browser;}},{key:"getBrowserVersion",value:function getBrowserVersion(){return this.browserVersion;}},{key:"getWR",value:function getWR(){return this.webrtcapi;}},{key:"checkAvailableDevices",value:function checkAvailableDevices(){return this.getWR().checkAvailableDevices();}},{key:"getServerAddress",value:function getServerAddress(){if(null===this.wsSocket)return null;var e=this.wsSocket.url;return e.endsWith("/")&&(e=e.slice(0,-1)),e;}},{key:"setOAuthToken",value:function setOAuthToken(e){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;this.oauthToken=e,this.oauthTokenUseInInvite=s,this.setRegisterExtraHeaders(this.registerExtraHeaders);}},{key:"setUserAgent",value:function setUserAgent(e){this.u17=e;}},{key:"setChromeAudioConstraints",value:function setChromeAudioConstraints(e){AudioCodesUA.ac_log("AC: setChromeAudioConstraints= "+e);var s,i=e.split(",").map(function(e){return e.trim();}).filter(function(e){return e.length>0;});if(0===i.length)s=!0;else{s={};var _iterator=_createForOfIteratorHelper(i),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _e18=_step.value;s[_e18]=!0;}}catch(err){_iterator.e(err);}finally{_iterator.f();}}this.setConstraints("chrome","audio",s);}},{key:"setConstraints",value:function setConstraints(e,s,i){if(AudioCodesUA.ac_log("AC: setConstraints "+e+" "+s,i),void 0===this.constraints[e])throw"Unsupported browser: "+e;if(void 0===this.constraints[e][s])throw"Wrong type: "+s;this.constraints[e][s]=i;}},{key:"setBrowsersConstraints",value:function setBrowsersConstraints(e){for(var _i=0,_Object$keys=Object.keys(e);_i<_Object$keys.length;_i++){var s=_Object$keys[_i];var i=e[s];void 0!==i.audio&&this.setConstraints(s,"audio",i.audio),void 0!==i.video&&this.setConstraints(s,"video",i.video);}}},{key:"setServerConfig",value:function setServerConfig(e,s){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];this.serverConfig={addresses:e,domain:s,iceServers:this._convertIceList(i)},AudioCodesUA.ac_log("AC: setServerConfig()",this.serverConfig);}},{key:"setReconnectIntervals",value:function setReconnectIntervals(e,s){AudioCodesUA.ac_log("AC: setReconnectIntervals min="+e+" max="+s),this.reconnectMin=e,this.reconnectMax=s;}},{key:"setAccount",value:function setAccount(e,s,i,t){void 0!==s&&null!==s&&0!==s.length||(s=void 0),void 0!==t&&null!==t&&0!==t.length||(t=e);var o=this.account;o.user=e,o.displayName=s,o.password=i,o.authUser=t;}},{key:"setRegisterExpires",value:function setRegisterExpires(e){AudioCodesUA.ac_log("AC: setRegisterExpires="+e),this.account.registerExpires=e;}},{key:"setUseSessionTimer",value:function setUseSessionTimer(e){AudioCodesUA.ac_log("AC: setUseSessionTimer="+e),this.account.useSessionTimer=e;}},{key:"setDtmfOptions",value:function setDtmfOptions(e){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;AudioCodesUA.ac_log("AC: setDtmfOptions useWebRTC=".concat(e," duration=").concat(s," interToneGap=").concat(i)),this.dtmfUseWebRTC=e,null!==s&&(this.dtmfDuration=s),null!==i&&(this.dtmfInterToneGap=i);}},{key:"setEnableAddVideo",value:function setEnableAddVideo(e){AudioCodesUA.ac_log("AC: setEnableAddVideo="+e),this.enableAddVideo=e;}},{key:"getEnableAddVideo",value:function getEnableAddVideo(){return this.enableAddVideo;}},{key:"getAccount",value:function getAccount(){return this.account;}},{key:"setListeners",value:function setListeners(e){AudioCodesUA.ac_log("AC: setListeners()");for(var _i2=0,_arr=["loginStateChanged","outgoingCallProgress","callTerminated","callConfirmed","callShowStreams","incomingCall","callHoldStateChanged"];_i2<_arr.length;_i2++){var s=_arr[_i2];if(!(s in e))throw"listener missed method: "+s;}this.listeners=e;}},{key:"setJsSipLogger",value:function setJsSipLogger(e){JsSIP.debug.log=e;}},{key:"setAcLogger",value:function setAcLogger(e){AudioCodesUA.ac_log=e;}},{key:"isInitialized",value:function isInitialized(){return this._isInitialized;}},{key:"setModes",value:function setModes(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};AudioCodesUA.ac_log("AC: setModes() "+JSON.stringify(e)),Object.assign(this.modes,e),this._normalizeModes();}},{key:"_normalizeModes",value:function _normalizeModes(){function e(e,s){return"number"==typeof e&&e<=s?void 0:e;}var s=this.modes;s.sbc_ha_pairs_mode=e(s.sbc_ha_pairs_mode,0),s.chrome_rtp_timeout_fix=e(s.chrome_rtp_timeout_fix,0);}},{key:"init",value:function init(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;if(AudioCodesUA.ac_log("AC: init() autoLogin="+e),this._isInitialized)return;this._isInitialized=!0,JsSIP.debug.enable("JsSIP:*"),JsSIP.debug.formatArgs=function(){};var s=[];var _iterator2=_createForOfIteratorHelper(this.serverConfig.addresses),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _e19=_step2.value;_e19 instanceof Array?s.push({socket:new JsSIP.WebSocketInterface(_e19[0]),weight:_e19[1]}):s.push(new JsSIP.WebSocketInterface(_e19));}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}var i={sockets:s,uri:"sip:"+this.account.user+"@"+this.serverConfig.domain,contact_uri:"sip:"+this.account.user+"@"+this._randomToken(12)+".invalid;transport=ws",authorization_user:this.account.authUser,password:this.account.password,register:e,session_timers:this.account.useSessionTimer,register_expires:this.account.registerExpires,user_agent:this.u17,connection_recovery_min_interval:this.reconnectMin,connection_recovery_max_interval:this.reconnectMax};this.account.displayName&&this.account.displayName.length>0&&(i.display_name=this.account.displayName),this.jssipUA=new JsSIP.UA(i),this.setRegisterExtraHeaders(this.registerExtraHeaders),this._setUACallbacks(),AudioCodesUA.ac_log("AC: applied SDK modes: "+JSON.stringify(this.modes,function(e,s){return void 0===s?"<undefined>":s;})),this.jssipUA.modes=this.modes,this.jssipUA.start();}},{key:"deinit",value:function deinit(){this._isInitialized=!1,this.jssipUA&&this.jssipUA.stop();}},{key:"setRegisterExtraHeaders",value:function setRegisterExtraHeaders(e){if(this.registerExtraHeaders=e,this.jssipUA){var s=null!==e?e:[];null!==this.oauthToken&&(s=s.slice()).push("Authorization: Bearer "+this.oauthToken),this.jssipUA.registrator().setExtraHeaders(s);}}},{key:"login",value:function login(){AudioCodesUA.ac_log("AC: login()"),this.jssipUA.register();}},{key:"logout",value:function logout(){AudioCodesUA.ac_log("AC: logout()"),this.jssipUA.isRegistered()&&this.jssipUA.unregister();}},{key:"switchSBC",value:function switchSBC(){AudioCodesUA.ac_log("AC: switchSBC()"),this.jssipUA.switchSBC();}},{key:"getNumberOfSBC",value:function getNumberOfSBC(){return this.jssipUA.getNumberOfSBC();}},{key:"setWebSocketKeepAlive",value:function setWebSocketKeepAlive(e){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;var t=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var o=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;if(AudioCodesUA.ac_log("AC: setWebSocketKeepAlive pingInterval="+e+" pongTimeout="+s+" timerThrottlingBestEffort="+JSON.stringify(i)+" pongReport="+t+" pongDist="+o),"number"!=typeof e||"boolean"!=typeof s)throw"setWebSocketKeepAlive: wrong type of 1st or 2nd argument";var n;this.wsPingMs=this.wsOrigPingMs=1e3*e,this.wsPongTimeout=s,this.wsPongReport=t,this.wsPongDist=o,this.wsPongReportCounter=0,this.wsIsThrottling=!1;var r=(n=!0===i?{log:0,chrome:{interval:62,visibility:!0,call:!0,log:1}}:!1===i?{log:0}:i)[this.browser];this.wsThrottlingPingMs=r&&void 0!==r.interval?1e3*r.interval:0,this.wsVisibility=!(!r||void 0===r.visibility)&&r.visibility,this.wsCall=!(!r||void 0===r.call)&&r.call,this.wsLog=r&&void 0!==r.log?r.log:n.log,this.wsPongDelays=new Array(this.wsPongReport>0?this.wsPongReport:50),this.wsPongDelaysIx=0,0!==this.wsOrigPingMs&&0!==this.wsThrottlingPingMs&&this.wsVisibility&&document.addEventListener("visibilitychange",this._onVisibilityChange.bind(this));}},{key:"_pingLog",value:function _pingLog(){return" (ping=".concat(this.wsPingMs/1e3," sec)");}},{key:"_visibilityLog",value:function _visibilityLog(e){var s="AC: keep-alive: Page is "+(document.hidden?"hidden":"visible");document.hidden&&(this.wsCall&&(s+=", "+(0===this.activeCalls?"no active call":"active call")),s+=" and "+(this.wsIsThrottling?"was":"was not")+" trottling"),e&&(s+=this._pingLog()),AudioCodesUA.ac_log(s);}},{key:"_activeCallsLog",value:function _activeCallsLog(e){var s="AC: keep-alive: ".concat(0===this.activeCalls?"Call ended":"Call started");0===this.activeCalls&&(this.wsVisibility&&(s+=", page is "+(document.hidden?"hidden":"visible")),s+=" and "+(this.wsIsThrottling?"was":"was not")+" trottling"),e&&(s+=this._pingLog()),AudioCodesUA.ac_log(s);}},{key:"_onActiveCallsChange",value:function _onActiveCallsChange(e){if(this.activeCalls+=e,this.wsCall&&0!==this.wsPingMs&&0!==this.wsThrottlingPingMs)if(this.activeCalls<0&&AudioCodesUA.ac_log("Warning: keep-alive: activeCalls < 0"),0===this.activeCalls){if((!this.wsVisibility||document.hidden)&&this.wsIsThrottling&&this.wsPingMs<this.wsThrottlingPingMs)return this.wsPingMs=this.wsThrottlingPingMs,void this._activeCallsLog(!0);this.wsLog>=2&&this._activeCallsLog(!1);}else if(1===this.activeCalls&&e>0){if(this.wsPingMs>this.wsOrigPingMs)return this.wsPingMs=this.wsOrigPingMs,void this._activeCallsLog(!0);this.wsLog>=2&&this._activeCallsLog(!1);}}},{key:"_onVisibilityChange",value:function _onVisibilityChange(){if(this.wsVisibility&&0!==this.wsPingMs&&0!==this.wsThrottlingPingMs)if(document.hidden){if(this.wsCall&&0===this.activeCalls&&this.wsIsThrottling&&this.wsPingMs<this.wsThrottlingPingMs)return this.wsPingMs=this.wsThrottlingPingMs,void this._visibilityLog(!0);this.wsLog>=2&&this._visibilityLog(!1);}else{if(this.wsPingMs>this.wsOrigPingMs)return this.wsPingMs=this.wsOrigPingMs,void this._visibilityLog(!0);this.wsLog>=2&&this._visibilityLog(!1);}}},{key:"_onMessageHook",value:function _onMessageHook(e){"\r\n"===e.data?this._onPong():this.wsOnMessage(e);}},{key:"_onPong",value:function _onPong(){var e;this.wsPongReceived=!0,null===this.wsPongSupported&&(AudioCodesUA.ac_log("AC: keep-alive: Server supports CRLF pong"),this.wsPongSupported=!0),null!==this.wsPongTimeoutTime?(e=Date.now()-this.wsPongTimeoutTime,this.wsPongTimeoutTime=null,AudioCodesUA.ac_log("AC: keep-alive: Received pong that exceeded the timeout, delay="+e)):e=Date.now()-this.wsPingTime,this.wsPongDelays[this.wsPongDelaysIx]=e,this.wsPongDelaysIx=this.wsPongDelaysIx+1,this.wsPongDelaysIx===this.wsPongDelays.length&&(this.wsPongDelaysIx=0),this.wsPongReport>0&&this.wsPongReportCounter++;}},{key:"_onPongTimeout",value:function _onPongTimeout(e){if(AudioCodesUA.ac_log("AC: keep-alive: Pong timeout (not received within ".concat(e/1e3," seconds)")),AudioCodesUA.ac_log("AC: keep-alive: Previous pongs statistics: "+this._createPongReport(!0)),this.wsPongTimeout){AudioCodesUA.ac_log("AC: keep-alive: Close websocket connection"),this._stopWsKeepAlive();try{this.wsSocket.close();}catch(e){AudioCodesUA.ac_log("AC: Close websocket error",e);}}else AudioCodesUA.ac_log("AC: keep-alive: Warning: websocket is not closed, because pongTimeout=false");}},{key:"_sendPing",value:function _sendPing(){try{var e=Date.now();if(null!==this.wsPingTime){var s=e-this.wsNextPingTime;this.wsLog>=3&&AudioCodesUA.ac_log("AC: keep-alive: timer deviation (ms): ".concat(s));var i=this.wsPingMs;if(Math.abs(s)>=1e4&&((this.wsLog>0||!this.wsIsThrottling)&&(AudioCodesUA.ac_log("AC: keep-alive detected timer throttling: ".concat(Math.round(s/1e3)," seconds ").concat(s>0?"later":"earlier")),0===this.wsLog&&AudioCodesUA.ac_log("AC: keep-alive: The next timer throttling will not be shown in the logs, because log==0")),this.wsIsThrottling=!0,this.wsPingMs<this.wsThrottlingPingMs&&(this.wsPingMs=this.wsThrottlingPingMs,AudioCodesUA.ac_log("AC: keep-alive: ping interval increased"+this._pingLog()))),null!==this.wsPongSupported||this.wsPongReceived||(AudioCodesUA.ac_log("AC: keep-alive: Server does not support CRLF pong."),this.wsPongSupported=!1),this.wsPongSupported&&!this.wsPongReceived&&null===this.wsPongTimeoutTime){if(this._onPongTimeout(i),this.wsPongTimeout)return;this.wsPongTimeoutTime=this.wsPingTime;}}this.wsPingTime=e,this.wsNextPingTime=this.wsPingTime+this.wsPingMs,this.wsPongReceived=!1,this.wsSocket.readyState===WebSocket.OPEN?this.wsSocket.send("\r\n\r\n"):AudioCodesUA.ac_log("AC: keep-alive: Warning: Cannot send Ping, websocket state="+this.wsSocket.readyState),this.wsPingJob=setTimeout(this._sendPing.bind(this),this.wsPingMs),this.wsPongReport>0&&this.wsPongReportCounter>=this.wsPongReport&&(this.wsPongReportCounter=0,AudioCodesUA.ac_log("AC: keep-alive: Pong statistics: "+this._createPongReport(this.wsPongDist)));}catch(e){AudioCodesUA.ac_log("AC: keep-alive: send ping error",e);}}},{key:"_startWsKeepAlive",value:function _startWsKeepAlive(e){this.wsSocket=e,0!==this.wsPingMs&&(this.wsOnMessage=e.onmessage,e.onmessage=this._onMessageHook.bind(this),this._stopWsKeepAlive(),this.wsPingTime=null,this.wsPingJob=setTimeout(this._sendPing.bind(this),this.wsPingMs));}},{key:"_stopWsKeepAlive",value:function _stopWsKeepAlive(){null!==this.wsPingJob&&(clearTimeout(this.wsPingJob),this.wsPingJob=null);}},{key:"_createPongReport",value:function _createPongReport(e){var s,i="",t=!1,o=1e6,n=0;e&&(s=new Array(this.wsPingMs/1e3*4).fill(0));var r=0;for(var _i3=0;_i3<this.wsPongDelays.length;_i3++){var a=this.wsPongDelays[_i3];if(void 0!==a&&(r++,a<o&&(o=a),a>n&&(n=a),e)){var _e20=Math.floor(a/250);_e20>=s.length&&(_e20=s.length-1,t=!0),s[_e20]++;}}if(e){i="\r\npongs distribution (1/4 second step): ";for(var _e21=0;_e21<s.length;_e21++){i+=s[_e21].toString(),_e21!==s.length-1&&(i+=(_e21+1)%4==0?",":" ");}t&&(i+=" (+)");}return"pongs=".concat(r," delay=").concat(o,"..").concat(n," ms").concat(i);}},{key:"_setUACallbacks",value:function _setUACallbacks(){var _this=this;this.jssipUA.on("connected",function(e){AudioCodesUA.ac_log('AC>>: loginStateChanged: isLogin=false "connected"'),_this._startWsKeepAlive(e.socket.socket._ws),_this.listeners.loginStateChanged(!1,"connected",null);}),this.jssipUA.on("disconnected",function(){_this._stopWsKeepAlive(),AudioCodesUA.ac_log('AC>>: loginStateChanged: isLogin=false "disconnected"'),_this.listeners.loginStateChanged(!1,"disconnected",null);}),this.jssipUA.on("registered",function(e){AudioCodesUA.ac_log('AC>>: loginStateChanged: isLogin=true "login"'),_this.listeners.loginStateChanged(!0,"login",e.response);}),this.jssipUA.on("unregistered",function(e){AudioCodesUA.ac_log('AC>>: loginStateChanged: isLogin=false "logout"'),_this.listeners.loginStateChanged(!1,"logout",e.response);}),this.jssipUA.on("registrationFailed",function(e){if(e.response&&e.response.status_code>=300&&e.response.status_code<400)if(_this.jssipUA.registerRedirect){var s=e.response.parseHeader("contact");if(s){var _e22=s.uri,i="wss://"+_e22.host;if(_e22.port&&443!==_e22.port&&(i+=":"+_e22.port.toString()),AudioCodesUA.ac_log('AC>>: loginStateChanged: isLogin=false "redirection" '+i),_this.jssipUA.registerRedirect(i))return;AudioCodesUA.ac_log("AC: redirect url missed in server addresses, please see setServerConfig()");}else AudioCodesUA.ac_log('AC: 3xx response without "Contact" is ignored');}else AudioCodesUA.ac_log("AC: REGISTER 3xx redirection is not supported in the original JsSIP");AudioCodesUA.ac_log('AC>>: loginStateChanged: isLogin=false "login failed"'),_this.listeners.loginStateChanged(!1,"login failed",e.response?e.response:null);}),this.jssipUA.on("newMessage",function(e){"remote"===e.originator&&(AudioCodesUA.ac_log("AC>>: incomingMessage",e),_this.listeners.incomingMessage&&_this.listeners.incomingMessage(null,AudioCodesUA.instance._get_from(e.request),AudioCodesUA.instance._get_content_type(e.request),e.request.body,e.request));}),this.jssipUA.on("sipEvent",function(e){_this.listeners.incomingNotify&&(AudioCodesUA.ac_log("AC>>: incoming out of dialog NOTIFY",e),_this.listeners.incomingNotify(null,e.event?e.event.event:null,AudioCodesUA.instance._get_from(e.request),AudioCodesUA.instance._get_content_type(e.request),e.request.body,e.request));}),this.jssipUA.on("newRTCSession",function(e){AudioCodesUA.ac_log("AC: event ".concat("remote"===e.originator?"incoming":"outgoing"," \"newRTCSession\""),e);var s,i=new AudioCodesSession(e.session);if(i.js_session.on("sipEvent",function(e){if(!AudioCodesUA.instance.listeners.incomingNotify)return;var s=this.data.ac_session;AudioCodesUA.ac_log("AC>>: incoming NOTIFY",s,e),e.taken=AudioCodesUA.instance.listeners.incomingNotify(s,e.event?e.event.event:null,AudioCodesUA.instance._get_from(e.request),AudioCodesUA.instance._get_content_type(e.request),e.request.body,e.request);}),i.js_session.on("newInfo",function(e){if(!AudioCodesUA.instance.listeners.incomingInfo)return;if("local"===e.originator)return;var s=this.data.ac_session;AudioCodesUA.ac_log("AC>>: incoming INFO",s,e),AudioCodesUA.instance.listeners.incomingInfo(s,AudioCodesUA.instance._get_from(e.request),AudioCodesUA.instance._get_content_type(e.request),e.request.body,e.request);}),i.js_session.on("replaces",function(e){AudioCodesUA.instance.replacedCall=this.data.ac_session,AudioCodesUA.ac_log("AC>>: incoming INVITE with Replaces. This call will be replaced:",this.data.ac_session),e.accept();}),i.js_session.on("sdp",function(e){AudioCodesUA.instance._sdp_checking(this,e);}),i.js_session.on("connecting",function(){}),i.js_session.on("reinvite",function(e){if(!AudioCodesUA.instance.listeners.callIncomingReinvite)return;var s=this.data.ac_session;AudioCodesUA.ac_log("AC>>: callIncomingReinvite start"),AudioCodesUA.instance.listeners.callIncomingReinvite(s,!0,e.request),e.callback=function(){AudioCodesUA.ac_log("AC>>: callIncomingIncomingReinvite end"),AudioCodesUA.instance.listeners.callIncomingReinvite(s,!1,null);};}),i.js_session.on("hold",function(e){var s=this.data.ac_session,i="remote"===e.originator;AudioCodesUA.ac_log("AC>>: callHoldStateChanged isHold=true isRemote=".concat(i," session:"),s),AudioCodesUA.instance.listeners.callHoldStateChanged(s,!0,i);}),i.js_session.on("unhold",function(e){var s=this.data.ac_session,i="remote"===e.originator;AudioCodesUA.ac_log("AC>>: callHoldStateChanged isHold=false isRemote=".concat(i," session:"),s),AudioCodesUA.instance.listeners.callHoldStateChanged(s,!1,i);}),i.js_session.on("progress",function(e){if("remote"===e.originator){var _s=this.data.ac_session;AudioCodesUA.ac_log("AC>>: outgoingCallProgress",_s),AudioCodesUA.instance.listeners.outgoingCallProgress(_s,e.response);}}),i.js_session.on("failed",function(e){var s=this.data.ac_session,i=null;if("Redirected"===e.cause&&e.message&&e.message.headers){var _s2=e.message.parseHeader("Contact");_s2&&(i=_s2.uri.toString());}AudioCodesUA.ac_log("AC>>: callTerminated (failed)",s,e.cause,i),AudioCodesUA.instance.listeners.callTerminated(s,e.message,e.cause,i);}),i.js_session.on("accepted",function(e){var s=this.data.ac_session;s.data._accepted=!0,"remote"===e.originator&&(s.data._ok_response=e.response);}),"remote"===e.originator&&null!==AudioCodesUA.instance.replacedCall&&i.js_session.removeAllListeners("confirmed"),i.js_session.on("confirmed",function(){var e,s=this.data.ac_session,t=null;"_ok_response"in s.data?(t=s.data._ok_response,delete s.data._ok_response,e="ACK sent"):e="ACK received",i.data._video_call_audio_answer_firefox&&(i.data._video_call_audio_answer_firefox=!1,AudioCodesUA.ac_log("AC: [video call/audio answer] Firefox workaround. Send re-INVITE"),i.sendReInvite({showStreams:!0})),AudioCodesUA.ac_log("AC>>: callConfirmed",s,e),AudioCodesUA.instance._onActiveCallsChange.call(AudioCodesUA.instance,1),AudioCodesUA.instance.listeners.callConfirmed(s,t,e);}),i.js_session.on("ended",function(e){var s=this.data.ac_session;s.data._screenSharing&&s._onEndedScreenSharing.call(s,"call terminated"),AudioCodesUA.ac_log("AC>>: callTerminated (ended)",s,e.cause),AudioCodesUA.instance._onActiveCallsChange.call(AudioCodesUA.instance,-1),AudioCodesUA.instance.listeners.callTerminated(s,e.message,e.cause);}),i.js_session.on("refer",function(e){if(AudioCodesUA.instance.listeners.transfereeCreatedCall){var _s3,_i4=this.data.ac_session;if(_s3=!AudioCodesUA.instance.listeners.transfereeRefer||AudioCodesUA.instance.listeners.transfereeRefer(_i4,e.request)){var _s4;AudioCodesUA.ac_log("AC>>: incoming REFER accepted"),_s4=_i4.isScreenSharing()?_i4.doesScreenSharingReplaceCamera():_i4.hasSendVideo();var t=AudioCodesUA.instance._callOptions(_s4,!0);e.accept(function(e){e.data._created_by_refer=_i4;},t);}else AudioCodesUA.ac_log("AC>>: incoming REFER rejected"),e.reject();}else AudioCodesUA.ac_log("AC>>: incoming REFER rejected, because transfereeCreatedCall is not set"),e.reject();}),i._setEnabledReceiveVideo(AudioCodesUA.instance.enableAddVideo),i.js_session.connection?(AudioCodesUA.instance._set_connection_listener(i),AudioCodesUA.ac_log('AC: connection exists, set "track" listener')):(AudioCodesUA.ac_log("AC: peer connection does not exist, wait creation"),i.js_session.on("peerconnection",function(){AudioCodesUA.instance._set_connection_listener(i),AudioCodesUA.ac_log('AC: [event connection] connection created, set "track" listener');})),s="remote"===e.originator?e.request.from:e.request.to,i.data._user=s.uri.user,i.data._host=s.uri.host,i.data._display_name=s.display_name,i.data._create_time=new Date(),"remote"===e.originator){var _s5,t,o,n=null;if(null!==AudioCodesUA.instance.replacedCall&&(n=AudioCodesUA.instance.replacedCall,AudioCodesUA.instance.replacedCall=null),e.request.body){o=!0;var _i5=new AudioCodesSDP(e.request.body);var _i5$getMediaDirection=_i5.getMediaDirection("video",!0);var _i5$getMediaDirection2=_slicedToArray(_i5$getMediaDirection,2);_s5=_i5$getMediaDirection2[0];t=_i5$getMediaDirection2[1];}else o=!1,_s5=t=!0,AudioCodesUA.ac_log("AC: warning incoming INVITE without SDP");i._setVideoState(_s5,t),AudioCodesUA.ac_log("AC>>: incomingCall ".concat(i.hasVideo()?"video":"audio"," from \"").concat(i.data._display_name,"\" ").concat(i.data._user),i,n),AudioCodesUA.instance.listeners.incomingCall(i,e.request,n,o);}else i.js_session.data._created_by_refer?(AudioCodesUA.ac_log("AC>>: outgoing call created by REFER"),i.data._created_by_refer=i.js_session.data._created_by_refer,AudioCodesUA.instance.listeners.transfereeCreatedCall(i)):AudioCodesUA.ac_log("AC>>: outgoing call created by phone.call()");});}},{key:"_get_from",value:function _get_from(e){return{user:e.from.uri.user,host:e.from.uri.host,displayName:e.from.display_name?e.from.display_name:null};}},{key:"_get_content_type",value:function _get_content_type(e){var s=e.headers["Content-Type"];return s&&s.length>0?s[0].parsed:null;}},{key:"_set_connection_listener",value:function _set_connection_listener(e){AudioCodesUA.instance.getWR().connection.addEventListener(e.js_session.connection,"track",function(s){if(AudioCodesUA.ac_log('AC>>: "track"  event kind: '+s.track.kind,s),s.streams.length>0){var _i6=s.streams[0];AudioCodesUA.ac_log("AC: set call remote stream: "+_i6.id,e),e.data._remoteMediaStream=_i6;}else AudioCodesUA.ac_log('AC: Warning "track" event without stream');if("video"===s.track.kind){if(!e.hasEnabledReceiveVideo()){e.data._video_call_audio_answer_safari&&(s.track.onmute=function(){AudioCodesUA.ac_log('AC: [video call/audio answer] Safari fix. Fired video track "mute" event.  Call callShowStream'),s.track.onmute=null;var i=e.getRTCLocalStream(),t=e.getRTCRemoteStream();AudioCodesUA.ac_log("AC>>: callShowStreams",e,i,t),AudioCodesUA.instance.listeners.callShowStreams(e,i,t);},AudioCodesUA.ac_log('AC: [video call/audio answer] Safari fix. Set video track "mute" event listener'),e.data._video_call_audio_answer_safari=!1),AudioCodesUA.ac_log('AC>>: event "track" video and !hasEnabledReceiveVideo therefore change transceiver direction.',e);var _i7=AudioCodesUA.instance.getWR().connection.getTransceiver(e.js_session.connection,"video");if(null!==_i7){var _s6=e.hasEnabledSendVideo()?"sendonly":"inactive";AudioCodesUA.instance.getWR().transceiver.setDirection(_i7,_s6);}}return;}var i=e.getRTCLocalStream(),t=e.getRTCRemoteStream();AudioCodesUA.ac_log("AC>>: callShowStreams",e,i,t),AudioCodesUA.instance.listeners.callShowStreams(e,i,t);});}},{key:"_sdp_checking",value:function _sdp_checking(e,s){var i,t,o,n=s.originator+" "+s.type,r=e.data.ac_session;try{var _i$getMediaDirection,_i$getMediaDirection2;i=new AudioCodesSDP(s.sdp),(_i$getMediaDirection=i.getMediaDirection("video","remote"===s.originator),_i$getMediaDirection2=_slicedToArray(_i$getMediaDirection,2),t=_i$getMediaDirection2[0],o=_i$getMediaDirection2[1]);}catch(s){return void AudioCodesUA.ac_log("AC: cannot parse SDP",s);}var a=r.data._initial;switch("answer"===s.type&&(r.data._initial=!1),AudioCodesUA.ac_log("AC: Event \"sdp\" ".concat(a?"initial":""," ").concat(n,"   Session state:").concat(AudioCodesUA.getSessionStatusName(e._status))),n){case"remote offer":break;case"remote answer":if(r.isLocalHold()||r.isRemoteHold())break;r._setVideoState(t,o);break;case"local offer":AudioCodesUA.instance.networkPriority&&AudioCodesUA.instance._set_senders_dscp(e);break;case"local answer":if(r.isLocalHold()||r.isRemoteHold())break;AudioCodesUA.instance.networkPriority&&AudioCodesUA.instance._set_senders_dscp(e),r._setVideoState(t,o);}}},{key:"_set_senders_dscp",value:function _set_senders_dscp(e){if("chrome"!==AudioCodesUA.instance.browser)return;AudioCodesUA.ac_log("AC: _set_senders_dscp()");var s=AudioCodesUA.instance.networkPriority;AudioCodesUA.instance._set_dscp(e,"audio",s),AudioCodesUA.instance._set_dscp(e,"video",s);}},{key:"_set_dscp",value:function _set_dscp(e,s,i){var t=e.connection,o=AudioCodesUA.instance.getWR().connection.getTransceiver(t,s);return o||"video"!==s?Promise.resolve().then(function(){var e=o.sender.getParameters();if(!e)throw"getParameters returns undefined";var t=e.encodings;if(!t)throw"encodings is undefined";if(0===t.length)throw"encodings is empty array";var n=t[0].networkPriority;if(!n)throw"networkPriority is undefined";return n===i||(t[0].networkPriority=i,o.sender.setParameters(e).then(function(){return AudioCodesUA.ac_log("AC: DSCP: ".concat(s," \"").concat(i,"\"")),!0;}));})["catch"](function(e){return AudioCodesUA.ac_log("AC: DSCP: ".concat(s," error: ").concat(e)),!1;}):Promise.resolve(!1);}},{key:"_convertIceList",value:function _convertIceList(e){var s=[];var _iterator3=_createForOfIteratorHelper(e),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var i=_step3.value;"string"==typeof i&&(i={urls:"stun:"+i}),s.push(i);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}return s;}},{key:"_randomToken",value:function _randomToken(e){var s="";for(var i=0;i<e;i++){s+=Math.floor(36*Math.random()).toString(36);}return s;}},{key:"_detectBrowser",value:function _detectBrowser(){try{var e=navigator.userAgent;if(this.browser="other",this.browserName=e,this.browserVersion=0,navigator.mozGetUserMedia)this.browser="firefox",this.browserName=e.match(/Firefox\/([.\d]+)$/)[0],this.browserVersion=parseInt(e.match(/Firefox\/(\d+)\./)[1],10);else if(navigator.webkitGetUserMedia){this.browser="chrome",this.browserName=e.match(/Chrom(e|ium)\/([.\d]+)/)[0],this.browserVersion=parseInt(e.match(/Chrom(e|ium)\/(\d+)\./)[2],10);var s=e.toLowerCase();for(var _e23=0;_e23<this.chromiumBased.length;_e23++){var i=this.chromiumBased[_e23].s,t=s.indexOf(i);if(-1!==t){var o=s.substring(t+i.length).match(/([.\d]+)/)[1];this.browserName+=" ("+this.chromiumBased[_e23].n+"/"+o+")";break;}}}else window.safari?(this.browser="safari",this.browserName="Safari/"+e.match(/Version\/([.\d]+)/)[1],this.browserVersion=parseInt(e.match(/Version\/(\d+)\./)[1],10)):-1!==e.indexOf("Edge/")&&(this.browser="other",this.browserName=e.match(/Edge\/([.\d]+)/)[0],this.browserVersion=parseInt(e.match(/Edge\/(\d+).(\d+)$/)[2],10));/iPad|iPhone|iPod/.test(e)&&(this.browser="ios_safari",this.browserName=e,this.browserVersion=parseInt(e.match(/Version\/(\d+)\./)[1],10));}catch(e){AudioCodesUA.ac_log("AC: Browser detection error",e),this.browser="other",this.browserName=navigator.userAgent,this.browserVersion=0;}}},{key:"_callOptions",value:function _callOptions(e,s){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var t=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var o={};if("chrome"===this.browser&&this.networkPriority){var _e24={rtcConstraints:{optional:[{googDscp:!0}]}};Object.assign(o,_e24);}return null!==t&&Object.assign(o,t),o.mediaConstraints={audio:this.constraints[this.browser].audio},e&&(o.mediaConstraints.video=this.constraints[this.browser].video),void 0===o.pcConfig&&(o.pcConfig={}),o.pcConfig.iceServers=this.serverConfig.iceServers,null!==i&&(i=i.slice()),null!==this.oauthToken&&this.oauthTokenUseInInvite&&s&&(null===i&&(i=[]),i.push("Authorization: Bearer "+this.oauthToken)),null!==i&&(o.extraHeaders=i),o;}},{key:"call",value:function call(e,s){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var t=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(!1===e?e=AudioCodesUA.instance.AUDIO:!0===e&&(e=AudioCodesUA.instance.VIDEO),"symbol"!=_typeof(e)||![AudioCodesUA.instance.AUDIO,AudioCodesUA.instance.VIDEO].includes(e)){throw"Illegal videoOption="+e.toString();}AudioCodesUA.ac_log("AC: call ".concat(e.description," to ").concat(s));var o=this._callOptions(e===AudioCodesUA.instance.VIDEO,!0,i,t),n=this.jssipUA.call(s,o);o.mediaStream&&(n._localMediaStreamLocallyGenerated=!0);var r=n.data.ac_session;return r._setEnabledSendVideo(e===AudioCodesUA.instance.VIDEO),e===AudioCodesUA.instance.VIDEO&&r._setEnabledReceiveVideo(!0),r;}},{key:"sendMessage",value:function sendMessage(e,s){var _this2=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"text/plain";return AudioCodesUA.ac_log("AC: sendMessage to: ".concat(e," \"").concat(s,"\"")),new Promise(function(t,o){var n={contentType:i,eventHandlers:{succeeded:function succeeded(e){return t(e);},failed:function failed(e){return o(e);}}};_this2.jssipUA.sendMessage(e,s,n);});}},{key:"isScreenSharingSupported",value:function isScreenSharingSupported(){return AudioCodesUA.instance.getWR().hasDisplayMedia();}},{key:"openScreenSharing",value:function openScreenSharing(){return this.isScreenSharingSupported()?(AudioCodesUA.ac_log("AC: openScreenSharing()"),AudioCodesUA.instance.getWR().getDisplayMedia().then(function(e){return e;})["catch"](function(e){throw AudioCodesUA.ac_log("AC: openScreenSharing() error",e),e;})):(AudioCodesUA.ac_log("AC: openScreenSharing: screen sharing is not supported in the browser"),Promise.reject("Screen sharing is not supported"));}},{key:"closeScreenSharing",value:function closeScreenSharing(e){if(AudioCodesUA.ac_log("AC: closeScreenSharing()"),e){var s=e.getVideoTracks();if(0==s.length)return;var i=s[0];"live"===i.readyState&&(i.stop(),i.dispatchEvent(new Event("ended")));}}},{key:"setNetworkPriority",value:function setNetworkPriority(e){if(AudioCodesUA.ac_log("AC: setNetworkPriority="+e),void 0!==e&&"high"!==e&&"medium"!==e&&"low"!==e&&"very-low"!==e)throw"setNetworkPriority: illegal value";this.networkPriority=e;}}],[{key:"getSessionStatusName",value:function getSessionStatusName(e){switch(e){case 0:return"NULL (0)";case 1:return"INVITE_SENT (1)";case 2:return"1XX_RECEIVED (2)";case 3:return"INVITE_RECEIVED (3)";case 4:return"WAITING_FOR_ANSWER (4)";case 5:return"ANSWERED (5)";case 6:return"WAITING_FOR_ACK (6)";case 7:return"CANCELED (7)";case 8:return"TERMINATED (8)";case 9:return"CONFIRMED (9)";default:return"Unknown ("+e+")";}}}]);return AudioCodesUA;}();var AudioCodesSession=/*#__PURE__*/function(){function AudioCodesSession(e){_classCallCheck(this,AudioCodesSession);this.js_session=e,this.data={_user:null,_display_name:null,_create_time:null,_initial:!0,_remoteMediaStream:null,_wasUsedSendVideo:!1,_screenSharing:null,_video:{send:!1,receive:!1,enabledSend:!1,enabledReceive:!1}},e.data.ac_session=this;}_createClass(AudioCodesSession,[{key:"getRTCPeerConnection",value:function getRTCPeerConnection(){return this.js_session.connection;}},{key:"getRTCLocalStream",value:function getRTCLocalStream(){return this.js_session._localMediaStream;}},{key:"getRTCRemoteStream",value:function getRTCRemoteStream(){return this.data._remoteMediaStream;}},{key:"isEstablished",value:function isEstablished(){return this.js_session.isEstablished();}},{key:"isTerminated",value:function isTerminated(){return this.js_session.isEnded();}},{key:"isOutgoing",value:function isOutgoing(){return"outgoing"===this.js_session.direction;}},{key:"isAudioMuted",value:function isAudioMuted(){return this.js_session.isMuted().audio;}},{key:"isVideoMuted",value:function isVideoMuted(){return this.js_session.isMuted().video;}},{key:"wasAccepted",value:function wasAccepted(){return!0===this.data._accepted;}},{key:"getReplacesHeader",value:function getReplacesHeader(){if(!this.js_session.isEstablished()||!this.js_session._dialog)return AudioCodesUA.ac_log("getReplacesHeader(): call is not established"),null;var e=this.js_session._dialog.id;return"".concat(e.call_id,";to-tag=").concat(e.remote_tag,";from-tag=").concat(e.local_tag);}},{key:"muteAudio",value:function muteAudio(e){AudioCodesUA.ac_log("AC: muteAudio() arg=".concat(e," ")),e?this.js_session.mute({audio:!0,video:!1}):this.js_session.unmute({audio:!0,video:!1});}},{key:"muteVideo",value:function muteVideo(e){AudioCodesUA.ac_log("AC: muteVideo() arg=".concat(e," ")),e?this.js_session.mute({audio:!1,video:!0}):this.js_session.unmute({audio:!1,video:!0});}},{key:"sendDTMF",value:function sendDTMF(e){var s=AudioCodesUA.instance.dtmfUseWebRTC;if(s&&["safari","ios_safari"].includes(AudioCodesUA.instance.browser)){void 0===AudioCodesUA.instance.getWR().connection.getDTMFSender(this.js_session.connection)&&(s=!1);}AudioCodesUA.ac_log("AC: sendDTMF() tone=".concat(e," ").concat(s?"[RFC2833]":"[INFO]"));var i={duration:AudioCodesUA.instance.dtmfDuration,interToneGap:AudioCodesUA.instance.dtmfInterToneGap,transportType:s?"RFC2833":"INFO"};this.js_session.sendDTMF(e,i);}},{key:"sendInfo",value:function sendInfo(e,s){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;AudioCodesUA.ac_log("AC: sendInfo()",e,s,i);var t=null!==i?{extraHeaders:i}:void 0;this.js_session.sendInfo(s,e,t);}},{key:"duration",value:function duration(){var e=this.js_session.start_time;if(!e)return 0;var s=this.js_session.end_time;return s||(s=new Date()),Math.floor((s.getTime()-e.getTime())/1e3);}},{key:"hasSendVideo",value:function hasSendVideo(){return this.data._video.send;}},{key:"hasReceiveVideo",value:function hasReceiveVideo(){return this.data._video.receive;}},{key:"hasVideo",value:function hasVideo(){return this.hasSendVideo()&&this.hasReceiveVideo();}},{key:"getVideoState",value:function getVideoState(){return this.hasSendVideo()&&this.hasReceiveVideo()?"sendrecv":this.hasSendVideo()?"sendonly":this.hasReceiveVideo()?"recvonly":"inactive";}},{key:"_setVideoState",value:function _setVideoState(e,s){AudioCodesUA.ac_log("AC: _setVideoState(send=".concat(e,", receive=").concat(s,")")),this.data._video.send=e,this.data._video.receive=s;}},{key:"hasEnabledSendVideo",value:function hasEnabledSendVideo(){return this.data._video.enabledSend;}},{key:"hasEnabledReceiveVideo",value:function hasEnabledReceiveVideo(){return this.data._video.enabledReceive;}},{key:"getEnabledVideoState",value:function getEnabledVideoState(){return this.hasEnabledSendVideo()&&this.hasEnabledReceiveVideo()?"sendrecv":this.hasEnabledSendVideo()?"sendonly":this.hasEnabledReceiveVideo()?"recvonly":"inactive";}},{key:"_setEnabledSendVideo",value:function _setEnabledSendVideo(e){AudioCodesUA.ac_log("AC: _setEnabledSendVideo(".concat(e,")")),this.data._video.enabledSend=e;}},{key:"_setEnabledReceiveVideo",value:function _setEnabledReceiveVideo(e){AudioCodesUA.ac_log("AC: _setEnabledReceiveVideo(".concat(e,")")),this.data._video.enabledReceive=e;}},{key:"answer",value:function answer(e){var _this3=this;var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(this.data._answer_called)return void AudioCodesUA.ac_log("AC: answer() is already called. [Ignored]");if(this.data._answer_called=!0,!1===e?e=AudioCodesUA.instance.AUDIO:!0===e&&(e=AudioCodesUA.instance.VIDEO),"symbol"!=_typeof(e)||![AudioCodesUA.instance.AUDIO,AudioCodesUA.instance.RECVONLY_VIDEO,AudioCodesUA.instance.VIDEO].includes(e))throw"Illegal videoOption="+e.toString();if(AudioCodesUA.ac_log("AC: ".concat(e.description," answer")),this.hasVideo()||e!==AudioCodesUA.instance.RECVONLY_VIDEO&&e!==AudioCodesUA.instance.VIDEO||(AudioCodesUA.ac_log('AC: incoming INVITE without video, so answer can be only "audio"'),e=AudioCodesUA.instance.AUDIO),this.hasVideo()&&e===AudioCodesUA.instance.AUDIO){var _e25=AudioCodesUA.instance,_s7=_e25.browser,_i8=_e25.modes,_t2=_e25.browserVersion;"firefox"===_s7&&_i8.video_call_audio_answer_firefox_fix?this.data._video_call_audio_answer_firefox=!0:"safari"!==_s7&&"ios_safari"!==_s7||(!0===_i8.video_call_audio_answer_safari_fix&&_t2<14||"force"===_i8.video_call_audio_answer_safari_fix)&&(this.data._video_call_audio_answer_safari=!0);}switch(e){case AudioCodesUA.instance.AUDIO:this._setEnabledSendVideo(!1),this._setEnabledReceiveVideo(!this.hasVideo()&&AudioCodesUA.instance.enableAddVideo),this._setVideoState(!1,!1);break;case AudioCodesUA.instance.VIDEO:this._setEnabledSendVideo(!0),this._setEnabledReceiveVideo(!0),this._setVideoState(!0,!0);break;case AudioCodesUA.instance.RECVONLY_VIDEO:this._setEnabledSendVideo(!1),this._setEnabledReceiveVideo(!0),this._setVideoState(!1,!0);}var t=AudioCodesUA.instance._callOptions(e===AudioCodesUA.instance.VIDEO,!1,s,i);Promise.resolve().then(function(){return t.mediaStream?t.mediaStream:AudioCodesUA.instance.getWR().getUserMedia(t.mediaConstraints);}).then(function(e){t.mediaStream=e,_this3.js_session._localMediaStreamLocallyGenerated=!0,AudioCodesUA.ac_log("AC: answer options:",t),_this3.js_session.answer(t);})["catch"](function(e){AudioCodesUA.ac_log("AC: getUserMedia failure",e),_this3.reject(488);});}},{key:"reject",value:function reject(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:486;var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;AudioCodesUA.ac_log("AC: reject()");try{var i={status_code:e};s&&(i.extraHeaders=s),this.js_session.terminate(i);}catch(e){AudioCodesUA.ac_log("AC: call reject error:",e);}}},{key:"terminate",value:function terminate(){AudioCodesUA.ac_log("AC: terminate()");try{this.js_session.terminate();}catch(e){AudioCodesUA.ac_log("AC: call terminate error:",e);}}},{key:"redirect",value:function redirect(e){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:302;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;AudioCodesUA.ac_log("AC: redirect() callTo=%s",e);try{var _t$extraHeaders;var t={status_code:s,extraHeaders:["Contact: "+AudioCodesUA.instance.jssipUA.normalizeTarget(e)]};i&&(_t$extraHeaders=t.extraHeaders).push.apply(_t$extraHeaders,_toConsumableArray(i)),this.js_session.terminate(t);}catch(e){AudioCodesUA.ac_log("AC: call redirect error:",e);}}},{key:"isLocalHold",value:function isLocalHold(){return this.js_session.isOnHold().local;}},{key:"isRemoteHold",value:function isRemoteHold(){return this.js_session.isOnHold().remote;}},{key:"isReadyToReOffer",value:function isReadyToReOffer(){return this.js_session._isReadyToReOffer();}},{key:"hold",value:function hold(e){var _this4=this;return AudioCodesUA.ac_log("AC: hold(".concat(e,")")),new Promise(function(s,i){(e?_this4.js_session.hold:_this4.js_session.unhold).call(_this4.js_session,{},function(){AudioCodesUA.ac_log("AC: hold()/unhold() is completed"),s();})||(AudioCodesUA.ac_log("AC: hold()/unhold() failed"),i());});}},{key:"enableReceiveVideo",value:function enableReceiveVideo(e){this._setEnabledReceiveVideo(e);var s=this.getRTCPeerConnection(),i=AudioCodesUA.instance.getWR().connection.getTransceiver(s,"video");if(null!==i){var _e26=this.getEnabledVideoState();AudioCodesUA.instance.getWR().transceiver.setDirection(i,_e26);}return AudioCodesUA.ac_log("AC: enableReceiveVideo(".concat(e,") ").concat(null!==i?"":"No video transceiver")),null!==i;}},{key:"startSendingVideo",value:function startSendingVideo(){var _this5=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var s=e&&!1!==e.enabledReceiveVideo;return this.hasEnabledSendVideo()?(AudioCodesUA.ac_log("AC: startSendingVideo(). Already started"),Promise.reject("video already started")):(AudioCodesUA.ac_log("AC: startSendingVideo()"),AudioCodesUA.instance.getWR().getUserMedia({video:!0})["catch"](function(e){throw AudioCodesUA.ac_log("AC: startSendingVideo() getUserMedia failure",e),e;}).then(function(e){var i=e.getVideoTracks()[0];_this5.getRTCLocalStream().addTrack(i),_this5._setEnabledSendVideo(!0),_this5._setEnabledReceiveVideo(s);var t=_this5.data._wasUsedSendVideo;return AudioCodesUA.instance.getWR().connection.addVideo(_this5.getRTCPeerConnection(),_this5.getRTCLocalStream(),i,_this5.hasEnabledReceiveVideo(),t)["catch"](function(e){throw AudioCodesUA.ac_log("AC: startSendingVideo(). Adding video error",e),e;});}).then(function(){return _this5._renegotiate(e);}));}},{key:"stopSendingVideo",value:function stopSendingVideo(){var _this6=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return this.hasEnabledSendVideo()?(AudioCodesUA.ac_log("AC: stopSendingVideo()"),AudioCodesUA.instance.getWR().connection.removeVideo(this.getRTCPeerConnection(),this.getRTCLocalStream())["catch"](function(e){throw AudioCodesUA.ac_log("AC: stopSendingVideo(). Remove video error",e),e;}).then(function(){return _this6._setEnabledSendVideo(!1),_this6.data._wasUsedSendVideo=!0,_this6._renegotiate(e);})):(AudioCodesUA.ac_log("AC: stopSendingVideo(). Already stopped"),Promise.reject("video already stopped"));}},{key:"_doRenegotiate",value:function _doRenegotiate(e){var _this7=this;return this.js_session.isEnded()?Promise.reject("call is ended"):new Promise(function(s){if(!_this7.js_session.renegotiate(e,function(){return s(!0);}))return s(!1);});}},{key:"_renegotiate",value:function _renegotiate(e){var _this8=this;var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:30;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:500;return AudioCodesUA.ac_log("AC: _renegotiate() attemptsLeft=".concat(s)),this._doRenegotiate(e).then(function(t){if(t)return AudioCodesUA.ac_log("AC: Renegotiation success"),!0;if(s<=1)throw"Too many attempts";return new Promise(function(e){return setTimeout(e,i);}).then(function(){return _this8._renegotiate(e,s-1,i);});})["catch"](function(e){throw AudioCodesUA.ac_log("AC: Renegotiation failed",e),e;});}},{key:"sendReInvite",value:function sendReInvite(){var _this9=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return AudioCodesUA.ac_log("AC: sendReInvite()"),this._renegotiate(e).then(function(){if(e.showStreams){var _e27=_this9.getRTCLocalStream(),s=_this9.getRTCRemoteStream();AudioCodesUA.ac_log("AC>>: [after send re-INVITE] callShowStreams",_this9,_e27,s),AudioCodesUA.instance.listeners.callShowStreams(_this9,_e27,s);}});}},{key:"startScreenSharing",value:function startScreenSharing(e){var _this10=this;var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{localScreenSharing:!0,enabledReceiveVideo:!0,separateVideo:!1};if(AudioCodesUA.ac_log("AC: startScreenSharing"),!e)return Promise.reject("missed stream argument");if(this.data._screenSharing)return Promise.reject("the call is already using screen-sharing");var i=s&&!1!==s.enabledReceiveVideo,t=e.getVideoTracks()[0],o=void 0;s.localScreenSharing&&(o=this._onEndedScreenSharingTrack.bind(this),t.addEventListener("ended",o)),this.data._screenSharing={stream:e,onended:o,hadSendVideo:this.hasSendVideo()};var n=this.data._wasUsedSendVideo;return this._setEnabledSendVideo(!0),this._setEnabledReceiveVideo(i),AudioCodesUA.instance.getWR().connection.addVideo(this.getRTCPeerConnection(),this.getRTCLocalStream(),t,this.hasEnabledReceiveVideo(),n)["catch"](function(e){throw AudioCodesUA.ac_log("AC: startScreenSharing() error",e),_this10.data._screenSharing=null,e;}).then(function(){return _this10._renegotiate({extraHeaders:["X-Screen-Sharing: on"]});});}},{key:"stopScreenSharing",value:function stopScreenSharing(){return AudioCodesUA.ac_log("AC: stopScreenSharing"),this.data._screenSharing?this._onEndedScreenSharing("called stopScreenSharing()"):Promise.reject("the call does not use screen-sharing");}},{key:"isScreenSharing",value:function isScreenSharing(){return!!this.data._screenSharing;}},{key:"doesScreenSharingReplaceCamera",value:function doesScreenSharingReplaceCamera(){var e=this.data._screenSharing;return e&&e.hadSendVideo;}},{key:"_onEndedScreenSharingTrack",value:function _onEndedScreenSharingTrack(){return this._onEndedScreenSharing("track ended");}},{key:"_onEndedScreenSharing",value:function _onEndedScreenSharing(e){var _this11=this;var s=this.data._screenSharing;this.data._screenSharing=null;var i=s.stream,t=s.onended;if(i&&t){i.getVideoTracks()[0].removeEventListener("ended",t);}return Promise.resolve().then(function(){if(!_this11.isTerminated()){var _e28=_this11.getRTCPeerConnection(),_i9=_this11.getRTCLocalStream(),_t3={extraHeaders:["X-Screen-Sharing: off"]};return s.hadSendVideo?(AudioCodesUA.ac_log("AC: screen sharing stopped - restore previously sending video track"),AudioCodesUA.instance.getWR().connection.replaceSenderTrack(_e28,"video",_i9),_this11._renegotiate(_t3)):(AudioCodesUA.ac_log("AC: screen sharing stopped - stop send video"),_this11.stopSendingVideo(_t3));}}).then(function(){AudioCodesUA.instance.listeners.callScreenSharingEnded&&(AudioCodesUA.ac_log("AC>>: callScreenSharingEnded \"".concat(e,"\""),_this11,i),AudioCodesUA.instance.listeners.callScreenSharingEnded(_this11,i));});}},{key:"setRemoteHoldState",value:function setRemoteHoldState(){this.js_session._remoteHold=!0;}},{key:"sendRefer",value:function sendRefer(e){var s=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!AudioCodesUA.instance.listeners.transferorNotification)throw"transferorNotification missed in phone.setListeners()";var i=this,t={eventHandlers:{requestSucceeded:function requestSucceeded(){AudioCodesUA.ac_log("AC>>: transferorNotification progress [REFER accepted]"),AudioCodesUA.instance.listeners.transferorNotification(i,0);},requestFailed:function requestFailed(){AudioCodesUA.ac_log("AC>>: transferorNotification failed [REFER failed]"),AudioCodesUA.instance.listeners.transferorNotification(i,-1);},trying:function trying(){AudioCodesUA.ac_log("AC>>: transferorNotification progress [NOTIFY 1xx]"),AudioCodesUA.instance.listeners.transferorNotification(i,0);},progress:function progress(){AudioCodesUA.ac_log("AC>>: transferorNotification progress [NOTIFY 1xx]"),AudioCodesUA.instance.listeners.transferorNotification(i,0);},accepted:function accepted(){AudioCodesUA.ac_log("AC>>: transferorNotification success [NOTIFY 2xx]"),AudioCodesUA.instance.listeners.transferorNotification(i,1);},failed:function failed(){AudioCodesUA.ac_log("AC>>: transferorNotification failed [NOTIFY >= 300]"),AudioCodesUA.instance.listeners.transferorNotification(i,-1);}}};null!==s&&(t.replaces=s.js_session),this.js_session.refer(e,t);}}]);return AudioCodesSession;}();var AudioCodesSDP=/*#__PURE__*/function(){function AudioCodesSDP(e){_classCallCheck(this,AudioCodesSDP);this.start=[],this.media=[];var s=e.split("\n").map(function(e){return e.trim();}).filter(function(e){return e.length>0;}),i=this.start;var _iterator4=_createForOfIteratorHelper(s),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _e29=_step4.value;_e29.startsWith("m=")&&(i=[],this.media.push(i)),i.push(_e29);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}_createClass(AudioCodesSDP,[{key:"getMedia",value:function getMedia(e){var _iterator5=_createForOfIteratorHelper(this.media),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var s=_step5.value;if(s.length>0&&s[0].startsWith("m="+e))return s;}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}return null;}},{key:"checkSendRecv",value:function checkSendRecv(e){switch(e){case"a=sendrecv":return"sendrecv";case"a=sendonly":return"sendonly";case"a=recvonly":return"recvonly";case"a=inactive":return"inactive";default:return null;}}},{key:"getMediaDirectionValue",value:function getMediaDirectionValue(e){var s,i=this.getMedia(e);if(null===i)return null;var t="sendrecv";var _iterator6=_createForOfIteratorHelper(this.start),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _e30=_step6.value;if(null!==(s=this.checkSendRecv(_e30))){t=s;break;}}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}var _iterator7=_createForOfIteratorHelper(i),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _e31=_step7.value;if(null!==(s=this.checkSendRecv(_e31))){t=s;break;}}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}return t;}},{key:"getMediaDirection",value:function getMediaDirection(e,s){var i=this.getMediaDirectionValue(e);switch(i){case"sendrecv":return[!0,!0,i];case"sendonly":return s?[!1,!0,i]:[!0,!1,i];case"recvonly":return s?[!0,!1,i]:[!1,!0,i];case null:case"inactive":return[!1,!1,i];}}},{key:"toString",value:function toString(){var e=this.start;var _iterator8=_createForOfIteratorHelper(this.media),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var s=_step8.value;e=e.concat(s);}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}return e.join("\r\n")+"\r\n";}}]);return AudioCodesSDP;}();var AudioCodesWebRTCWrapper={getUserMedia:function getUserMedia(e){return AudioCodesUA.ac_log("[webrtc] getUserMedia constraints",e),navigator.mediaDevices.getUserMedia(e);},hasDisplayMedia:function hasDisplayMedia(){return navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia;},getDisplayMedia:function getDisplayMedia(){return AudioCodesUA.ac_log("[webrtc] getDisplayMedia"),navigator.mediaDevices.getDisplayMedia({video:!0});},checkAvailableDevices:function checkAvailableDevices(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return Promise.reject("WebRTC is not supported");var e=!1,s=!1,i=!1;return navigator.mediaDevices.enumerateDevices().then(function(t){return t.forEach(function(t){switch(t.kind){case"videoinput":e=!0;break;case"audioinput":s=!0;break;case"audiooutput":i=!0;}}),void 0===navigator.webkitGetUserMedia&&(i=!0),i?s?Promise.resolve(e):Promise.reject("Missing a microphone! Please connect one and reload"):Promise.reject("Missing a speaker! Please connect one and reload");});},transceiver:{setDirection:function setDirection(e,s){var i="";null!==e.sender.track?i=e.sender.track.kind:null!==e.receiver.track&&(i=e.receiver.track.kind),AudioCodesUA.ac_log("[webrtc] set ".concat(i," transceiver direction=").concat(s)),e.direction=s;}},stream:{getInfo:function getInfo(e){function s(e){return e.length>0?e[0].enabled.toString():"-";}return null===e?Promise.resolve("stream is null"):Promise.resolve("audio: ".concat(s(e.getAudioTracks())," video: ").concat(s(e.getVideoTracks())));}},connection:{getTransceiversInfo:function getTransceiversInfo(e){function s(e){return null===e?"none":"d=".concat(e.direction," c=").concat(e.currentDirection);}var i=e.getTransceivers(),t=AudioCodesUA.instance.getWR().connection.getTransceiver(e,"audio"),o=AudioCodesUA.instance.getWR().connection.getTransceiver(e,"video");return Promise.resolve("(".concat(i.length,") audio ").concat(s(t)," video ").concat(s(o)));},getTransceiver:function getTransceiver(e,s){var _iterator9=_createForOfIteratorHelper(e.getTransceivers()),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var i=_step9.value;if(null!==i.sender&&null!==i.sender.track&&i.sender.track.kind===s)return i;if(null!==i.receiver&&null!==i.receiver.track&&i.receiver.track.kind===s)return i;}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}return null;},addEventListener:function addEventListener(e,s,i){return AudioCodesUA.ac_log("[webrtc] Connection addEventListener "+s),"track"!==s?Promise.reject("Wrong event name: "+s):(e.addEventListener(s,i),Promise.resolve());},getDTMFSender:function getDTMFSender(e){var s=e.getSenders().find(function(e){return e.track&&"audio"===e.track.kind;});if(s&&s.dtmf)return s.dtmf;},addVideo:function addVideo(e,s,i,t,o){AudioCodesUA.ac_log("[webrtc] Connection addVideo");var n=AudioCodesUA.instance.getWR().connection.getTransceiver(e,"video");if(null!==n){var _e32=t?"sendrecv":"sendonly";AudioCodesUA.instance.getWR().transceiver.setDirection(n,_e32);}return null===n||null===n.sender.track&&!o?(AudioCodesUA.ac_log("[webrtc] addVideo (connection addTrack)"),e.addTrack(i,s),Promise.resolve(!0)):(AudioCodesUA.ac_log("[webrtc] addVideo (video transceiver sender replaceTrack)"),n.sender.replaceTrack(i).then(function(){return!1;}));},removeVideo:function removeVideo(e,s){AudioCodesUA.ac_log("[webrtc] Connection removeVideo");var i=AudioCodesUA.instance.getWR().connection.getTransceiver(e,"video");if(null===i)return Promise.reject("no video transceiver found");if(e.removeTrack(i.sender),s){var _iterator10=_createForOfIteratorHelper(s.getVideoTracks()),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var _e33=_step10.value;s.removeTrack(_e33),_e33.stop();}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}}return Promise.resolve();},replaceSenderTrack:function replaceSenderTrack(e,s,i){AudioCodesUA.ac_log("[webrtc] ReplaceSenderTrack "+s);var t=null;var _iterator11=_createForOfIteratorHelper(e.getSenders()),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _i10=_step11.value;if(null!==_i10.track&&_i10.track.kind===s){t=_i10;break;}}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}if(null===t)return Promise.reject("No ".concat(s," sender"));var o="audio"===s?i.getAudioTracks():i.getVideoTracks();return 0===o.length?Promise.reject("No ".concat(s," track")):t.replaceTrack(o[0]);},getStats:function getStats(e,s){var i="";return e.getStats(null).then(function(e){return e.forEach(function(e){if(s.includes(e.type)){i+=" {";var _s8=!0;for(var _i11=0,_Object$keys2=Object.keys(e);_i11<_Object$keys2.length;_i11++){var t=_Object$keys2[_i11];_s8?_s8=!1:i+=",",i+=t+"="+e[t];}i+="} \r\n";}}),i;});}}};

/***/ }),

/***/ "./src/plugins/agentDesktop/agentdesktop-script.js":
/*!*********************************************************!*\
  !*** ./src/plugins/agentDesktop/agentdesktop-script.js ***!
  \*********************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ac_webrtc__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ac_webrtc */ "./src/plugins/agentDesktop/ac_webrtc.js");
/* harmony import */ var _libs_korejquery__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../libs/korejquery */ "./src/libs/korejquery.js");
/* harmony import */ var _components_base_sdk_kore_bot_sdk_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/base-sdk/kore-bot-sdk-client */ "./src/components/base-sdk/kore-bot-sdk-client.js");
/* harmony import */ var _agentdesktop_css__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./agentdesktop.css */ "./src/plugins/agentDesktop/agentdesktop.css");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* module decorator */ module = __webpack_require__.hmd(module);
/* provided dependency */ var __webpack_provided_window_dot_jQuery = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}//////////////////////////// socket.io //////////////////////////////////////////////////////////////
/*!
 * Socket.IO v4.2.0
 * (c) 2014-2021 Guillermo Rauch
 * Released under the MIT License.
 */!function(t,e){"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))&&"object"==( false?0:_typeof(module))?module.exports=e():"function"==typeof define&&__webpack_require__.amdO?define([],e):"object"==(typeof exports==="undefined"?"undefined":_typeof(exports))?exports.io=e():t.io=e();}(self,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports;}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r});},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0});},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==_typeof(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t){n.d(r,o,function(e){return t[e];}.bind(null,o));}return r;},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"];}:function(){return t;};return n.d(e,"a",e),e;},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e);},n.p="",n(n.s=18);}([function(t,e){t.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();},function(t,e,n){var r=n(24),o=n(25),i=String.fromCharCode(30);t.exports={protocol:4,encodePacket:r,encodePayload:function encodePayload(t,e){var n=t.length,o=new Array(n),s=0;t.forEach(function(t,c){r(t,!1,function(t){o[c]=t,++s===n&&e(o.join(i));});});},decodePacket:o,decodePayload:function decodePayload(t,e){for(var n=t.split(i),r=[],s=0;s<n.length;s++){var c=o(n[s],e);if(r.push(c),"error"===c.type)break;}return r;}};},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype){t[e]=r.prototype[e];}return t;}(t);}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this;},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments);}return n.fn=e,this.on(t,n),this;},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<r.length;o++){if((n=r[o])===e||n.fn===e){r.splice(o,1);break;}}return 0===r.length&&delete this._callbacks["$"+t],this;},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++){e[r-1]=arguments[r];}if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r){n[r].apply(this,e);}}return this;},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[];},r.prototype.hasListeners=function(t){return!!this.listeners(t).length;};},function(t,e,n){var r=n(0);t.exports.pick=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++){n[r-1]=arguments[r];}return n.reduce(function(e,n){return t.hasOwnProperty(n)&&(e[n]=t[n]),e;},{});};var o=setTimeout,i=clearTimeout;t.exports.installTimerFunctions=function(t,e){e.useNativeTimers?(t.setTimeoutFn=o.bind(r),t.clearTimeoutFn=i.bind(r)):(t.setTimeoutFn=setTimeout.bind(r),t.clearTimeoutFn=clearTimeout.bind(r));};},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=u(t);if(e){var o=u(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return c(this,n);};}function c(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return a(t);}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}var f=n(1),l=n(2),p=n(3).installTimerFunctions,h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e);}(u,t);var e,n,r,c=s(u);function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}(this,u),e=c.call(this),p(a(e),t),e.opts=t,e.query=t.query,e.readyState="",e.socket=t.socket,e;}return e=u,(n=[{key:"onError",value:function value(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this;}},{key:"open",value:function value(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this;}},{key:"close",value:function value(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this;}},{key:"send",value:function value(t){"open"===this.readyState&&this.write(t);}},{key:"onOpen",value:function value(){this.readyState="open",this.writable=!0,this.emit("open");}},{key:"onData",value:function value(t){var e=f.decodePacket(t,this.socket.binaryType);this.onPacket(e);}},{key:"onPacket",value:function value(t){this.emit("packet",t);}},{key:"onClose",value:function value(){this.readyState="closed",this.emit("close");}}])&&o(e.prototype,n),r&&o(e,r),u;}(l);t.exports=h;},function(t,e){e.encode=function(t){var e="";for(var n in t){t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));}return e;},e.decode=function(t){for(var e={},n=t.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]);}return e;};},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t));){;}return t;}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value;}})(t,e,n||t);}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=a(t);if(e){var o=a(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return c(this,n);};}function c(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}(t);}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function l(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t;}Object.defineProperty(e,"__esModule",{value:!0}),e.Decoder=e.Encoder=e.PacketType=e.protocol=void 0;var p,h=n(2),y=n(30),d=n(15);e.protocol=5,function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK";}(p=e.PacketType||(e.PacketType={}));var v=function(){function t(){u(this,t);}return l(t,[{key:"encode",value:function value(t){return t.type!==p.EVENT&&t.type!==p.ACK||!d.hasBinary(t)?[this.encodeAsString(t)]:(t.type=t.type===p.EVENT?p.BINARY_EVENT:p.BINARY_ACK,this.encodeAsBinary(t));}},{key:"encodeAsString",value:function value(t){var e=""+t.type;return t.type!==p.BINARY_EVENT&&t.type!==p.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data)),e;}},{key:"encodeAsBinary",value:function value(t){var e=y.deconstructPacket(t),n=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(n),r;}}]),t;}();e.Encoder=v;var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e);}(n,t);var e=s(n);function n(){return u(this,n),e.call(this);}return l(n,[{key:"add",value:function value(t){var e;if("string"==typeof t)(e=this.decodeString(t)).type===p.BINARY_EVENT||e.type===p.BINARY_ACK?(this.reconstructor=new m(e),0===e.attachments&&o(a(n.prototype),"emit",this).call(this,"decoded",e)):o(a(n.prototype),"emit",this).call(this,"decoded",e);else{if(!d.isBinary(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,o(a(n.prototype),"emit",this).call(this,"decoded",e));}}},{key:"decodeString",value:function value(t){var e=0,r={type:Number(t.charAt(0))};if(void 0===p[r.type])throw new Error("unknown packet type "+r.type);if(r.type===p.BINARY_EVENT||r.type===p.BINARY_ACK){for(var o=e+1;"-"!==t.charAt(++e)&&e!=t.length;){;}var i=t.substring(o,e);if(i!=Number(i)||"-"!==t.charAt(e))throw new Error("Illegal attachments");r.attachments=Number(i);}if("/"===t.charAt(e+1)){for(var s=e+1;++e;){if(","===t.charAt(e))break;if(e===t.length)break;}r.nsp=t.substring(s,e);}else r.nsp="/";var c=t.charAt(e+1);if(""!==c&&Number(c)==c){for(var a=e+1;++e;){var u=t.charAt(e);if(null==u||Number(u)!=u){--e;break;}if(e===t.length)break;}r.id=Number(t.substring(a,e+1));}if(t.charAt(++e)){var f=function(t){try{return JSON.parse(t);}catch(t){return!1;}}(t.substr(e));if(!n.isPayloadValid(r.type,f))throw new Error("invalid payload");r.data=f;}return r;}},{key:"destroy",value:function value(){this.reconstructor&&this.reconstructor.finishedReconstruction();}}],[{key:"isPayloadValid",value:function value(t,e){switch(t){case p.CONNECT:return"object"===r(e);case p.DISCONNECT:return void 0===e;case p.CONNECT_ERROR:return"string"==typeof e||"object"===r(e);case p.EVENT:case p.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case p.ACK:case p.BINARY_ACK:return Array.isArray(e);}}}]),n;}(h);e.Decoder=b;var m=function(){function t(e){u(this,t),this.packet=e,this.buffers=[],this.reconPack=e;}return l(t,[{key:"takeBinaryData",value:function value(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=y.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e;}return null;}},{key:"finishedReconstruction",value:function value(){this.reconPack=null,this.buffers=[];}}]),t;}();},function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,o=t.indexOf("["),i=t.indexOf("]");-1!=o&&-1!=i&&(t=t.substring(0,o)+t.substring(o,i).replace(/:/g,";")+t.substring(i,t.length));for(var s,c,a=n.exec(t||""),u={},f=14;f--;){u[r[f]]=a[f]||"";}return-1!=o&&-1!=i&&(u.source=e,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=function(t,e){var n=e.replace(/\/{2,9}/g,"/").split("/");"/"!=e.substr(0,1)&&0!==e.length||n.splice(0,1);"/"==e.substr(e.length-1,1)&&n.splice(n.length-1,1);return n;}(0,u.path),u.queryKey=(s=u.query,c={},s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,e,n){e&&(c[e]=n);}),c),u;};},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=u(t);if(e){var o=u(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return c(this,n);};}function c(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return a(t);}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}Object.defineProperty(e,"__esModule",{value:!0}),e.Manager=void 0;var f=n(20),l=n(3),p=n(14),h=n(6),y=n(16),d=n(31),v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e);}(v,t);var e,n,c,u=s(v);function v(t,e){var n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}(this,v),(n=u.call(this)).nsps={},n.subs=[],t&&"object"===r(t)&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",n.opts=e,(0,l.installTimerFunctions)(a(n),e),n.reconnection(!1!==e.reconnection),n.reconnectionAttempts(e.reconnectionAttempts||1/0),n.reconnectionDelay(e.reconnectionDelay||1e3),n.reconnectionDelayMax(e.reconnectionDelayMax||5e3),n.randomizationFactor(null!==(o=e.randomizationFactor)&&void 0!==o?o:.5),n.backoff=new d({min:n.reconnectionDelay(),max:n.reconnectionDelayMax(),jitter:n.randomizationFactor()}),n.timeout(null==e.timeout?2e4:e.timeout),n._readyState="closed",n.uri=t;var i=e.parser||h;return n.encoder=new i.Encoder(),n.decoder=new i.Decoder(),n._autoConnect=!1!==e.autoConnect,n._autoConnect&&n.open(),n;}return e=v,(n=[{key:"reconnection",value:function value(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection;}},{key:"reconnectionAttempts",value:function value(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this);}},{key:"reconnectionDelay",value:function value(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this);}},{key:"randomizationFactor",value:function value(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this);}},{key:"reconnectionDelayMax",value:function value(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this);}},{key:"timeout",value:function value(t){return arguments.length?(this._timeout=t,this):this._timeout;}},{key:"maybeReconnectOnOpen",value:function value(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect();}},{key:"open",value:function value(t){var e=this;if(~this._readyState.indexOf("open"))return this;this.engine=f(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var o=(0,y.on)(n,"open",function(){r.onopen(),t&&t();}),i=(0,y.on)(n,"error",function(n){r.cleanup(),r._readyState="closed",e.emitReserved("error",n),t?t(n):r.maybeReconnectOnOpen();});if(!1!==this._timeout){var s=this._timeout;0===s&&o();var c=this.setTimeoutFn(function(){o(),n.close(),n.emit("error",new Error("timeout"));},s);this.opts.autoUnref&&c.unref(),this.subs.push(function(){clearTimeout(c);});}return this.subs.push(o),this.subs.push(i),this;}},{key:"connect",value:function value(t){return this.open(t);}},{key:"onopen",value:function value(){this.cleanup(),this._readyState="open",this.emitReserved("open");var t=this.engine;this.subs.push((0,y.on)(t,"ping",this.onping.bind(this)),(0,y.on)(t,"data",this.ondata.bind(this)),(0,y.on)(t,"error",this.onerror.bind(this)),(0,y.on)(t,"close",this.onclose.bind(this)),(0,y.on)(this.decoder,"decoded",this.ondecoded.bind(this)));}},{key:"onping",value:function value(){this.emitReserved("ping");}},{key:"ondata",value:function value(t){this.decoder.add(t);}},{key:"ondecoded",value:function value(t){this.emitReserved("packet",t);}},{key:"onerror",value:function value(t){this.emitReserved("error",t);}},{key:"socket",value:function value(t,e){var n=this.nsps[t];return n||(n=new p.Socket(this,t,e),this.nsps[t]=n),n;}},{key:"_destroy",value:function value(t){for(var e=0,n=Object.keys(this.nsps);e<n.length;e++){var r=n[e];if(this.nsps[r].active)return;}this._close();}},{key:"_packet",value:function value(t){for(var e=this.encoder.encode(t),n=0;n<e.length;n++){this.engine.write(e[n],t.options);}}},{key:"cleanup",value:function value(){this.subs.forEach(function(t){return t();}),this.subs.length=0,this.decoder.destroy();}},{key:"_close",value:function value(){this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close();}},{key:"disconnect",value:function value(){return this._close();}},{key:"onclose",value:function value(t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect();}},{key:"reconnect",value:function value(){var t=this;if(this._reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn(function(){e.skipReconnect||(t.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(function(n){n?(e._reconnecting=!1,e.reconnect(),t.emitReserved("reconnect_error",n)):e.onreconnect();}));},n);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r);});}}},{key:"onreconnect",value:function value(){var t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t);}}])&&o(e.prototype,n),c&&o(e,c),v;}(n(17).StrictEventEmitter);e.Manager=v;},function(t,e,n){var r=n(10),o=n(23),i=n(27),s=n(28);e.polling=function(t){var e=!1,n=!1,s=!1!==t.jsonp;if("undefined"!=typeof location){var c="https:"===location.protocol,a=location.port;a||(a=c?443:80),e=t.hostname!==location.hostname||a!==t.port,n=t.secure!==c;}if(t.xdomain=e,t.xscheme=n,"open"in new r(t)&&!t.forceJSONP)return new o(t);if(!s)throw new Error("JSONP disabled");return new i(t);},e.websocket=s;},function(t,e,n){var r=n(22),o=n(0);t.exports=function(t){var e=t.xdomain,n=t.xscheme,i=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest();}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest();}catch(t){}if(!e)try{return new o[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP");}catch(t){}};},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=u(t);if(e){var o=u(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return a(this,n);};}function a(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}(t);}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}var f=n(4),l=n(5),p=n(1),h=n(13),y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e);}(u,t);var e,n,r,a=c(u);function u(){return o(this,u),a.apply(this,arguments);}return e=u,(n=[{key:"name",get:function get(){return"polling";}},{key:"doOpen",value:function value(){this.poll();}},{key:"pause",value:function value(t){var e=this;this.readyState="pausing";var n=function n(){e.readyState="paused",t();};if(this.polling||!this.writable){var r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||n();})),this.writable||(r++,this.once("drain",function(){--r||n();}));}else n();}},{key:"poll",value:function value(){this.polling=!0,this.doPoll(),this.emit("poll");}},{key:"onData",value:function value(t){var e=this;p.decodePayload(t,this.socket.binaryType).forEach(function(t){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t);}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll());}},{key:"doClose",value:function value(){var t=this,e=function e(){t.write([{type:"close"}]);};"open"===this.readyState?e():this.once("open",e);}},{key:"write",value:function value(t){var e=this;this.writable=!1,p.encodePayload(t,function(t){e.doWrite(t,function(){e.writable=!0,e.emit("drain");});});}},{key:"uri",value:function value(){var t=this.query||{},e=this.opts.secure?"https":"http",n="";return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=h()),this.supportsBinary||t.sid||(t.b64=1),t=l.encode(t),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),t.length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t;}}])&&i(e.prototype,n),r&&i(e,r),u;}(f);t.exports=y;},function(t,e){var n=Object.create(null);n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";var r=Object.create(null);Object.keys(n).forEach(function(t){r[n[t]]=t;});t.exports={PACKET_TYPES:n,PACKET_TYPES_REVERSE:r,ERROR_PACKET:{type:"error",data:"parser error"}};},function(t,e,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i={},s=0,c=0;function a(t){var e="";do{e=o[t%64]+e,t=Math.floor(t/64);}while(t>0);return e;}function u(){var t=a(+new Date());return t!==r?(s=0,r=t):t+"."+a(s++);}for(;c<64;c++){i[o[c]]=c;}u.encode=a,u.decode=function(t){var e=0;for(c=0;c<t.length;c++){e=64*e+i[t.charAt(c)];}return e;},t.exports=u;},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e){var _n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!_n){if(Array.isArray(t)||(_n=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e);}(t))||e&&t&&"number"==typeof t.length){_n&&(t=_n);var r=0,o=function o(){};return{s:o,n:function n(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]};},e:function e(t){throw t;},f:o};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var s,c=!0,a=!1;return{s:function s(){_n=_n.call(t);},n:function n(){var t=_n.next();return c=t.done,t;},e:function e(t){a=!0,s=t;},f:function f(){try{c||null==_n["return"]||_n["return"]();}finally{if(a)throw s;}}};}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++){r[n]=t[n];}return r;}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t));){;}return t;}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value;}})(t,e,n||t);}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return f(this,n);};}function f(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}(t);}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}Object.defineProperty(e,"__esModule",{value:!0}),e.Socket=void 0;var p=n(6),h=n(16),y=n(17),d=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e);}(f,t);var e,n,r,i=u(f);function f(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}(this,f),(r=i.call(this)).connected=!1,r.disconnected=!0,r.receiveBuffer=[],r.sendBuffer=[],r.ids=0,r.acks={},r.flags={},r.io=t,r.nsp=e,n&&n.auth&&(r.auth=n.auth),r.io._autoConnect&&r.open(),r;}return e=f,(n=[{key:"subEvents",value:function value(){if(!this.subs){var t=this.io;this.subs=[(0,h.on)(t,"open",this.onopen.bind(this)),(0,h.on)(t,"packet",this.onpacket.bind(this)),(0,h.on)(t,"error",this.onerror.bind(this)),(0,h.on)(t,"close",this.onclose.bind(this))];}}},{key:"active",get:function get(){return!!this.subs;}},{key:"connect",value:function value(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this;}},{key:"open",value:function value(){return this.connect();}},{key:"send",value:function value(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++){e[n]=arguments[n];}return e.unshift("message"),this.emit.apply(this,e),this;}},{key:"emit",value:function value(t){if(d.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++){n[r-1]=arguments[r];}n.unshift(t);var o={type:p.PacketType.EVENT,data:n,options:{}};o.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]&&(this.acks[this.ids]=n.pop(),o.id=this.ids++);var i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,s=this.flags["volatile"]&&(!i||!this.connected);return s||(this.connected?this.packet(o):this.sendBuffer.push(o)),this.flags={},this;}},{key:"packet",value:function value(t){t.nsp=this.nsp,this.io._packet(t);}},{key:"onopen",value:function value(){var t=this;"function"==typeof this.auth?this.auth(function(e){t.packet({type:p.PacketType.CONNECT,data:e});}):this.packet({type:p.PacketType.CONNECT,data:this.auth});}},{key:"onerror",value:function value(t){this.connected||this.emitReserved("connect_error",t);}},{key:"onclose",value:function value(t){this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",t);}},{key:"onpacket",value:function value(t){if(t.nsp===this.nsp)switch(t.type){case p.PacketType.CONNECT:if(t.data&&t.data.sid){var e=t.data.sid;this.onconnect(e);}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case p.PacketType.EVENT:case p.PacketType.BINARY_EVENT:this.onevent(t);break;case p.PacketType.ACK:case p.PacketType.BINARY_ACK:this.onack(t);break;case p.PacketType.DISCONNECT:this.ondisconnect();break;case p.PacketType.CONNECT_ERROR:var n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);}}},{key:"onevent",value:function value(t){var e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e));}},{key:"emitEvent",value:function value(t){if(this._anyListeners&&this._anyListeners.length){var e,n=o(this._anyListeners.slice());try{for(n.s();!(e=n.n()).done;){e.value.apply(this,t);}}catch(t){n.e(t);}finally{n.f();}}c(l(f.prototype),"emit",this).apply(this,t);}},{key:"ack",value:function value(t){var e=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,o=new Array(r),i=0;i<r;i++){o[i]=arguments[i];}e.packet({type:p.PacketType.ACK,id:t,data:o});}};}},{key:"onack",value:function value(t){var e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id]);}},{key:"onconnect",value:function value(t){this.id=t,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect");}},{key:"emitBuffered",value:function value(){var t=this;this.receiveBuffer.forEach(function(e){return t.emitEvent(e);}),this.receiveBuffer=[],this.sendBuffer.forEach(function(e){return t.packet(e);}),this.sendBuffer=[];}},{key:"ondisconnect",value:function value(){this.destroy(),this.onclose("io server disconnect");}},{key:"destroy",value:function value(){this.subs&&(this.subs.forEach(function(t){return t();}),this.subs=void 0),this.io._destroy(this);}},{key:"disconnect",value:function value(){return this.connected&&this.packet({type:p.PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this;}},{key:"close",value:function value(){return this.disconnect();}},{key:"compress",value:function value(t){return this.flags.compress=t,this;}},{key:"volatile",get:function get(){return this.flags["volatile"]=!0,this;}},{key:"onAny",value:function value(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this;}},{key:"prependAny",value:function value(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this;}},{key:"offAny",value:function value(t){if(!this._anyListeners)return this;if(t){for(var e=this._anyListeners,n=0;n<e.length;n++){if(t===e[n])return e.splice(n,1),this;}}else this._anyListeners=[];return this;}},{key:"listenersAny",value:function value(){return this._anyListeners||[];}}])&&s(e.prototype,n),r&&s(e,r),f;}(y.StrictEventEmitter);e.Socket=v;},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}Object.defineProperty(e,"__esModule",{value:!0}),e.hasBinary=e.isBinary=void 0;var o="function"==typeof ArrayBuffer,i=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),c="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);function a(t){return o&&(t instanceof ArrayBuffer||function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer;}(t))||s&&t instanceof Blob||c&&t instanceof File;}e.isBinary=a,e.hasBinary=function t(e,n){if(!e||"object"!==r(e))return!1;if(Array.isArray(e)){for(var o=0,i=e.length;o<i;o++){if(t(e[o]))return!0;}return!1;}if(a(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return t(e.toJSON(),!0);for(var s in e){if(Object.prototype.hasOwnProperty.call(e,s)&&t(e[s]))return!0;}return!1;};},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.on=void 0,e.on=function(t,e,n){return t.on(e,n),function(){t.off(e,n);};};},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t));){;}return t;}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value;}})(t,e,n||t);}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=f(t);if(e){var o=f(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return u(this,n);};}function u(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}(t);}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}Object.defineProperty(e,"__esModule",{value:!0}),e.StrictEventEmitter=void 0;var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e);}(l,t);var e,n,r,u=a(l);function l(){return o(this,l),u.apply(this,arguments);}return e=l,(n=[{key:"on",value:function value(t,e){return s(f(l.prototype),"on",this).call(this,t,e),this;}},{key:"once",value:function value(t,e){return s(f(l.prototype),"once",this).call(this,t,e),this;}},{key:"emit",value:function value(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++){r[o-1]=arguments[o];}return(e=s(f(l.prototype),"emit",this)).call.apply(e,[this,t].concat(r)),this;}},{key:"emitReserved",value:function value(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++){r[o-1]=arguments[o];}return(e=s(f(l.prototype),"emit",this)).call.apply(e,[this,t].concat(r)),this;}},{key:"listeners",value:function value(t){return s(f(l.prototype),"listeners",this).call(this,t);}}])&&i(e.prototype,n),r&&i(e,r),l;}(n(2));e.StrictEventEmitter=l;},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}Object.defineProperty(e,"__esModule",{value:!0}),e.io=e.Socket=e.Manager=e.protocol=void 0;var o=n(19),i=n(8);t.exports=e=c;var s=e.managers={};function c(t,e){"object"===r(t)&&(e=t,t=void 0),e=e||{};var n,c=(0,o.url)(t,e.path||"/socket.io"),a=c.source,u=c.id,f=c.path,l=s[u]&&f in s[u].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||l?n=new i.Manager(a,e):(s[u]||(s[u]=new i.Manager(a,e)),n=s[u]),c.query&&!e.query&&(e.query=c.queryKey),n.socket(c.path,e);}e.io=c;var a=n(6);Object.defineProperty(e,"protocol",{enumerable:!0,get:function get(){return a.protocol;}}),e.connect=c;var u=n(8);Object.defineProperty(e,"Manager",{enumerable:!0,get:function get(){return u.Manager;}});var f=n(14);Object.defineProperty(e,"Socket",{enumerable:!0,get:function get(){return f.Socket;}}),e["default"]=c;},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.url=void 0;var r=n(7);e.url=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,o=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),o=r(t)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";var i=-1!==o.host.indexOf(":"),s=i?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+s+":"+o.port+e,o.href=o.protocol+"://"+s+(n&&n.port===o.port?"":":"+o.port),o;};},function(t,e,n){var r=n(21);t.exports=function(t,e){return new r(t,e);},t.exports.Socket=r,t.exports.protocol=r.protocol,t.exports.Transport=n(4),t.exports.transports=n(9),t.exports.parser=n(1);},function(t,e,n){function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n){Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);}}return t;}).apply(this,arguments);}function o(t){return(o="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return u(this,n);};}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return f(t);}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}var p=n(9),h=n(2),y=n(1),d=n(7),v=n(5),b=n(3).installTimerFunctions,m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e);}(h,t);var e,n,u,l=a(h);function h(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i(this,h),e=l.call(this),t&&"object"===o(t)&&(n=t,t=null),t?(t=d(t),n.hostname=t.host,n.secure="https"===t.protocol||"wss"===t.protocol,n.port=t.port,t.query&&(n.query=t.query)):n.host&&(n.hostname=d(n.host).host),b(f(e),n),e.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=e.secure?"443":"80"),e.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),e.port=n.port||("undefined"!=typeof location&&location.port?location.port:e.secure?443:80),e.transports=n.transports||["polling","websocket"],e.readyState="",e.writeBuffer=[],e.prevBufferLen=0,e.opts=r({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},n),e.opts.path=e.opts.path.replace(/\/$/,"")+"/","string"==typeof e.opts.query&&(e.opts.query=v.decode(e.opts.query)),e.id=null,e.upgrades=null,e.pingInterval=null,e.pingTimeout=null,e.pingTimeoutTimer=null,"function"==typeof addEventListener&&(e.opts.closeOnBeforeunload&&addEventListener("beforeunload",function(){e.transport&&(e.transport.removeAllListeners(),e.transport.close());},!1),"localhost"!==e.hostname&&(e.offlineEventListener=function(){e.onClose("transport close");},addEventListener("offline",e.offlineEventListener,!1))),e.open(),e;}return e=h,(n=[{key:"createTransport",value:function value(t){var e=function(t){var e={};for(var n in t){t.hasOwnProperty(n)&&(e[n]=t[n]);}return e;}(this.opts.query);e.EIO=y.protocol,e.transport=t,this.id&&(e.sid=this.id);var n=r({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new p[t](n);}},{key:"open",value:function value(){var t,e=this;if(this.opts.rememberUpgrade&&h.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(function(){e.emit("error","No transports available");},0);t=this.transports[0];}this.readyState="opening";try{t=this.createTransport(t);}catch(t){return this.transports.shift(),void this.open();}t.open(),this.setTransport(t);}},{key:"setTransport",value:function value(t){var e=this;this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",function(){e.onClose("transport close");});}},{key:"probe",value:function value(t){var e=this,n=this.createTransport(t,{probe:1}),r=!1;h.priorWebsocketSuccess=!1;var o=function o(){r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",function(t){if(!r)if("pong"===t.type&&"probe"===t.data){if(e.upgrading=!0,e.emit("upgrading",n),!n)return;h.priorWebsocketSuccess="websocket"===n.name,e.transport.pause(function(){r||"closed"!==e.readyState&&(f(),e.setTransport(n),n.send([{type:"upgrade"}]),e.emit("upgrade",n),n=null,e.upgrading=!1,e.flush());});}else{var o=new Error("probe error");o.transport=n.name,e.emit("upgradeError",o);}}));};function i(){r||(r=!0,f(),n.close(),n=null);}var s=function s(t){var r=new Error("probe error: "+t);r.transport=n.name,i(),e.emit("upgradeError",r);};function c(){s("transport closed");}function a(){s("socket closed");}function u(t){n&&t.name!==n.name&&i();}var f=function f(){n.removeListener("open",o),n.removeListener("error",s),n.removeListener("close",c),e.removeListener("close",a),e.removeListener("upgrading",u);};n.once("open",o),n.once("error",s),n.once("close",c),this.once("close",a),this.once("upgrading",u),n.open();}},{key:"onOpen",value:function value(){if(this.readyState="open",h.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause)for(var t=0,e=this.upgrades.length;t<e;t++){this.probe(this.upgrades[t]);}}},{key:"onPacket",value:function value(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data);}}},{key:"onHandshake",value:function value(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout();}},{key:"resetPingTimeout",value:function value(){var t=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(function(){t.onClose("ping timeout");},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref();}},{key:"onDrain",value:function value(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush();}},{key:"flush",value:function value(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"));}},{key:"write",value:function value(t,e,n){return this.sendPacket("message",t,e,n),this;}},{key:"send",value:function value(t,e,n){return this.sendPacket("message",t,e,n),this;}},{key:"sendPacket",value:function value(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:t,data:e,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush();}}},{key:"close",value:function value(){var t=this,e=function e(){t.onClose("forced close"),t.transport.close();},n=function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e();},r=function r(){t.once("upgrade",n),t.once("upgradeError",n);};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){t.upgrading?r():e();}):this.upgrading?r():e()),this;}},{key:"onError",value:function value(t){h.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t);}},{key:"onClose",value:function value(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingIntervalTimer),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0);}},{key:"filterUpgrades",value:function value(t){for(var e=[],n=0,r=t.length;n<r;n++){~this.transports.indexOf(t[n])&&e.push(t[n]);}return e;}}])&&s(e.prototype,n),u&&s(e,u),h;}(h);m.priorWebsocketSuccess=!1,m.protocol=y.protocol,t.exports=m;},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest();}catch(e){t.exports=!1;}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n){Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);}}return t;}).apply(this,arguments);}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t;}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e);}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=h(t);if(e){var o=h(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return l(this,n);};}function l(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return p(t);}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}var y=n(10),d=n(11),v=n(2),b=n(3),m=b.pick,g=b.installTimerFunctions,k=n(0);function w(){}var O=null!=new y({xdomain:!1}).responseType,_=function(t){a(n,t);var e=f(n);function n(t){var r;if(i(this,n),r=e.call(this,t),"undefined"!=typeof location){var o="https:"===location.protocol,s=location.port;s||(s=o?443:80),r.xd="undefined"!=typeof location&&t.hostname!==location.hostname||s!==t.port,r.xs=t.secure!==o;}var c=t&&t.forceBase64;return r.supportsBinary=O&&!c,r;}return c(n,[{key:"request",value:function value(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(t,{xd:this.xd,xs:this.xs},this.opts),new E(this.uri(),t);}},{key:"doWrite",value:function value(t,e){var n=this,r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",function(t){n.onError("xhr post error",t);});}},{key:"doPoll",value:function value(){var t=this,e=this.request();e.on("data",this.onData.bind(this)),e.on("error",function(e){t.onError("xhr poll error",e);}),this.pollXhr=e;}}]),n;}(d),E=function(t){a(n,t);var e=f(n);function n(t,r){var o;return i(this,n),o=e.call(this),g(p(o),r),o.opts=r,o.method=r.method||"GET",o.uri=t,o.async=!1!==r.async,o.data=void 0!==r.data?r.data:null,o.create(),o;}return c(n,[{key:"create",value:function value(){var t=this,e=m(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;var r=this.xhr=new y(e);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var o in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.opts.extraHeaders){this.opts.extraHeaders.hasOwnProperty(o)&&r.setRequestHeader(o,this.opts.extraHeaders[o]);}}catch(t){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8");}catch(t){}try{r.setRequestHeader("Accept","*/*");}catch(t){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),this.hasXDR()?(r.onload=function(){t.onLoad();},r.onerror=function(){t.onError(r.responseText);}):r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?t.onLoad():t.setTimeoutFn(function(){t.onError("number"==typeof r.status?r.status:0);},0));},r.send(this.data);}catch(e){return void this.setTimeoutFn(function(){t.onError(e);},0);}"undefined"!=typeof document&&(this.index=n.requestsCount++,n.requests[this.index]=this);}},{key:"onSuccess",value:function value(){this.emit("success"),this.cleanup();}},{key:"onData",value:function value(t){this.emit("data",t),this.onSuccess();}},{key:"onError",value:function value(t){this.emit("error",t),this.cleanup(!0);}},{key:"cleanup",value:function value(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=w:this.xhr.onreadystatechange=w,t)try{this.xhr.abort();}catch(t){}"undefined"!=typeof document&&delete n.requests[this.index],this.xhr=null;}}},{key:"onLoad",value:function value(){var t=this.xhr.responseText;null!==t&&this.onData(t);}},{key:"hasXDR",value:function value(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR;}},{key:"abort",value:function value(){this.cleanup();}}]),n;}(v);if(E.requestsCount=0,E.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",S);else if("function"==typeof addEventListener){addEventListener("onpagehide"in k?"pagehide":"unload",S,!1);}function S(){for(var t in E.requests){E.requests.hasOwnProperty(t)&&E.requests[t].abort();}}t.exports=_,t.exports.Request=E;},function(t,e,n){var r=n(12).PACKET_TYPES,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),i="function"==typeof ArrayBuffer,s=function s(t,e){var n=new FileReader();return n.onload=function(){var t=n.result.split(",")[1];e("b"+t);},n.readAsDataURL(t);};t.exports=function(t,e,n){var c,a=t.type,u=t.data;return o&&u instanceof Blob?e?n(u):s(u,n):i&&(u instanceof ArrayBuffer||(c=u,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(c):c&&c.buffer instanceof ArrayBuffer))?e?n(u instanceof ArrayBuffer?u:u.buffer):s(new Blob([u]),n):n(r[a]+(u||""));};},function(t,e,n){var r,o=n(12),i=o.PACKET_TYPES_REVERSE,s=o.ERROR_PACKET;"function"==typeof ArrayBuffer&&(r=n(26));var c=function c(t,e){if(r){var n=r.decode(t);return a(n,e);}return{base64:!0,data:t};},a=function a(t,e){switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t;}};t.exports=function(t,e){if("string"!=typeof t)return{type:"message",data:a(t,e)};var n=t.charAt(0);return"b"===n?{type:"message",data:c(t.substring(1),e)}:i[n]?t.length>1?{type:i[n],data:t.substring(1)}:{type:i[n]}:s;};},function(t,e){!function(t){"use strict";e.encode=function(e){var n,r=new Uint8Array(e),o=r.length,i="";for(n=0;n<o;n+=3){i+=t[r[n]>>2],i+=t[(3&r[n])<<4|r[n+1]>>4],i+=t[(15&r[n+1])<<2|r[n+2]>>6],i+=t[63&r[n+2]];}return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i;},e.decode=function(e){var n,r,o,i,s,c=.75*e.length,a=e.length,u=0;"="===e[e.length-1]&&(c--,"="===e[e.length-2]&&c--);var f=new ArrayBuffer(c),l=new Uint8Array(f);for(n=0;n<a;n+=4){r=t.indexOf(e[n]),o=t.indexOf(e[n+1]),i=t.indexOf(e[n+2]),s=t.indexOf(e[n+3]),l[u++]=r<<2|o>>4,l[u++]=(15&o)<<4|i>>2,l[u++]=(3&i)<<6|63&s;}return f;};}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function i(t,e,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t));){;}return t;}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value;}})(t,e,n||t);}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=f(t);if(e){var o=f(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return a(this,n);};}function a(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t);}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}var l,p=n(11),h=n(0),y=/\n/g,d=/\\n/g,v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e);}(p,t);var e,n,r,a=c(p);function p(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}(this,p),(e=a.call(this,t)).query=e.query||{},l||(l=h.___eio=h.___eio||[]),e.index=l.length,l.push(e.onData.bind(u(e))),e.query.j=e.index,e;}return e=p,(n=[{key:"supportsBinary",get:function get(){return!1;}},{key:"doClose",value:function value(){this.script&&(this.script.onerror=function(){},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),i(f(p.prototype),"doClose",this).call(this);}},{key:"doPoll",value:function value(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e);};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&this.setTimeoutFn(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t);},100);}},{key:"doWrite",value:function value(t,e){var n,r=this;if(!this.form){var o=document.createElement("form"),i=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=s,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i;}function c(){a(),e();}this.form.action=this.uri();var a=function a(){if(r.iframe)try{r.form.removeChild(r.iframe);}catch(t){r.onError("jsonp polling iframe removal error",t);}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(t);}catch(t){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0";}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n;};a(),t=t.replace(d,"\\\n"),this.area.value=t.replace(y,"\\n");try{this.form.submit();}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&c();}:this.iframe.onload=c;}}])&&o(e.prototype,n),r&&o(e,r),p;}(p);t.exports=v;},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r);}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t;})(t,e);}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0;}catch(t){return!1;}}();return function(){var n,r=a(t);if(e){var o=a(this).constructor;n=Reflect.construct(r,arguments,o);}else n=r.apply(this,arguments);return c(this,n);};}function c(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;}(t);}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t);})(t);}var u=n(4),f=n(1),l=n(5),p=n(13),h=n(3).pick,y=n(29),d=y.WebSocket,v=y.usingBrowserWebSocket,b=y.defaultBinaryType,m=y.nextTick,g="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e);}(a,t);var e,n,r,c=s(a);function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");}(this,a),(e=c.call(this,t)).supportsBinary=!t.forceBase64,e;}return e=a,(n=[{key:"name",get:function get(){return"websocket";}},{key:"doOpen",value:function value(){if(this.check()){var t=this.uri(),e=this.opts.protocols,n=g?{}:h(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=v&&!g?e?new d(t,e):new d(t):new d(t,e,n);}catch(t){return this.emit("error",t);}this.ws.binaryType=this.socket.binaryType||b,this.addEventListeners();}}},{key:"addEventListeners",value:function value(){var t=this;this.ws.onopen=function(){t.opts.autoUnref&&t.ws._socket.unref(),t.onOpen();},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=function(e){return t.onData(e.data);},this.ws.onerror=function(e){return t.onError("websocket error",e);};}},{key:"write",value:function value(t){var e=this;this.writable=!1;for(var n=function n(_n2){var r=t[_n2],o=_n2===t.length-1;f.encodePacket(r,e.supportsBinary,function(t){var n={};v||(r.options&&(n.compress=r.options.compress),e.opts.perMessageDeflate&&("string"==typeof t?Buffer.byteLength(t):t.length)<e.opts.perMessageDeflate.threshold&&(n.compress=!1));try{v?e.ws.send(t):e.ws.send(t,n);}catch(t){}o&&m(function(){e.writable=!0,e.emit("drain");},e.setTimeoutFn);});},r=0;r<t.length;r++){n(r);}}},{key:"onClose",value:function value(){u.prototype.onClose.call(this);}},{key:"doClose",value:function value(){void 0!==this.ws&&(this.ws.close(),this.ws=null);}},{key:"uri",value:function value(){var t=this.query||{},e=this.opts.secure?"wss":"ws",n="";return this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=p()),this.supportsBinary||(t.b64=1),(t=l.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+t;}},{key:"check",value:function value(){return!(!d||"__initialize"in d&&this.name===a.prototype.name);}}])&&o(e.prototype,n),r&&o(e,r),a;}(u);t.exports=k;},function(t,e,n){var r=n(0),o="function"==typeof Promise&&"function"==typeof Promise.resolve?function(t){return Promise.resolve().then(t);}:function(t,e){return e(t,0);};t.exports={WebSocket:r.WebSocket||r.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:o};},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(t){return _typeof(t);}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof(t);})(t);}Object.defineProperty(e,"__esModule",{value:!0}),e.reconstructPacket=e.deconstructPacket=void 0;var o=n(15);e.deconstructPacket=function(t){var e=[],n=t.data,i=t;return i.data=function t(e,n){if(!e)return e;if(o.isBinary(e)){var i={_placeholder:!0,num:n.length};return n.push(e),i;}if(Array.isArray(e)){for(var s=new Array(e.length),c=0;c<e.length;c++){s[c]=t(e[c],n);}return s;}if("object"===r(e)&&!(e instanceof Date)){var a={};for(var u in e){e.hasOwnProperty(u)&&(a[u]=t(e[u],n));}return a;}return e;}(n,e),i.attachments=e.length,{packet:i,buffers:e};},e.reconstructPacket=function(t,e){return t.data=function t(e,n){if(!e)return e;if(e&&e._placeholder)return n[e.num];if(Array.isArray(e))for(var o=0;o<e.length;o++){e[o]=t(e[o],n);}else if("object"===r(e))for(var i in e){e.hasOwnProperty(i)&&(e[i]=t(e[i],n));}return e;}(t.data,e),t.attachments=void 0,t;};},function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0;}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n;}return 0|Math.min(t,this.max);},n.prototype.reset=function(){this.attempts=0;},n.prototype.setMin=function(t){this.ms=t;},n.prototype.setMax=function(t){this.max=t;},n.prototype.setJitter=function(t){this.jitter=t;};}]);});/*
 * JsSIP v3.7.5
 * the Javascript SIP library
 * Copyright: 2012-2021 José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)
 * Homepage: https://jssip.net
 * License: MIT
 *///import { io } from "socket.io-client";
// import * as JsSIP from 'jssip';
/** @ignore */var AgentDesktopPluginScript=/*#__PURE__*/_createClass(function AgentDesktopPluginScript(_config,response){var _this5=this;_classCallCheck(this,AgentDesktopPluginScript);_defineProperty(this,"name",'AgentDesktopPlugin');_defineProperty(this,"config",{});_defineProperty(this,"koreCoBrowse",void 0);_defineProperty(this,"rrweb",void 0);_defineProperty(this,"authResponse",void 0);_defineProperty(this,"AgentDesktop",function(uuId,aResponse){var _this2=this;var me=this;this.authResponse=null;var cwInstance=this.config.hostInstance;var botInstance=cwInstance.bot;console.log("agentdesktop uuId",uuId);/*if (uuId && uuId.length > 0) {
            localStorage.setItem("kr-cw-uid", uuId)
        }*/var userIcon='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAu6SURBVHgB7Z3PbxvHFcff7HIp6pdL90eMomlLFz0WMA20coscTB/aUwtbf4Hlooe2F4u33mzdeiN1DxD5L7CNognQi+hD0EYJEObYooCZoEWaNLZpixLFH7sv83a5Eknzxy65P95Q+wEiSiRjDve7782bN29mBCwApY8xC52jHICeF0K/AghZ+bT8G3O9t2R7/w1TAxB1+VgHxDqC9Qk9gi6qkMpUi1ft15RGgIKUPmwWwEQS87r8BnmwxQyFmrxZqojmExK9+LPlCiiGEgLbFtpqbvUELcBoa4wCaelQQWE9BhMqxV8s14A5bAU+FVVL3ZSutgAsERUE8wEYmUdc3Tk7gcn9CtBvyr5wC+Kz1BkQewjt3eLGWhUYwUZgW1jU7/G1Vq84Vl3cWN4DBsQu8OII+xo1GZXvxC10bAIvsLDD1GRQdieuCDxygUt/b+aEppXkJ9+Cc4Xso01zJ+rIW4MI2T1o3xW69vH5E5fALfrupX+cbEOERGLBttXq+jvnwB17pYamdSMKaw7dgk+tNhG3n1xU1hyaBVOiQnQ79+R4NlKXpBwoytvX0kUIiVAE7rnkh7L1eUjwQmguO3AXXXq/kZfuZz8R1xfksvfJMCBgAhW49FHrljAMKW5oszuLjNMvf9AKdIQRmMC7H3VvCwukW1Ypf8yOrBDwkK4lBEQgfTA1CC1zDxICQ2j61t2fph7AnMwtcCJueAQh8lwC232u45YTQgIRNovXlh7BjMwssDMUogRG0ueGTB07nRvFt2abZ54pyOqJS9FyIm74ZOXI5OGsQ6iZBO6Jm4OEqLATR3YZk098C1z+sF2CRNwYwLxoy9SvT3wJTBMHSW45RgRu+52g8BxkJUEVG+oyb33Va97aswUnQRUbss7cujc8WTC5ZgQsgyJYCPCyhXDSReiYAM0uPYdg4tl7DE1AWgfIpABWDQHLKQGGDsqAFhaLP89M1WSqwKq4ZhL1+QnCoRT2qIMwCyR0NiNgzVBCbE+uOgVTkOJS5MZWXBL2q2OEZ01rwEJngW4M9+YgoS+taJyFztrFiwCbk9400YKd0la772XJsybCl0fzCzsOcuHZJQ3eWOW7hKtXKFAZ9/rEIEuK67kzjxLqV5/WLfi8EZ64RFt+zpfHFvzruWl/JkdkwDVxbDxW4NJBcwsYJjSO2gj/fmHO3M/OAgn99KUJr1rRfaZ3sCDjpMK4V8cKLEDznTUJm7oMop6+DNdqx0Eif/bKstvAjUlWPFJgjtZLF/Y/hxbEDbWBn8jjrXikwAL0wEpGguCkCyzEdaG2RNlFeGGcFb8mcOmgnedUpN6xXSO/COcz2VXwCrxGW/FrAgvAu8AIspY2wwiW4gBOXsVGF69VZA4M8OzVCJ32C2DCC9nX/ZfbRRzie+saXMywGSfX0Uhf7t9OYtCCOyesVv39/5i3uMT/GvFE9WPIQqu11f/EgMCcgiuyXo6ueRgS9xmjG1GmL2/2/30qsFPzwye4UsF6XShlygcZbPWV9pxZsG7vP8WCV201rNeFrJjVsKnPTZ8KLMSgaccJz5TgZJglPwruL2cWjHws+FBBgTndlEIT193fbYHtvR+ZzPlS1opRVOoZajO1nQlZN+nhWLDJZy3vUUed4GqYozajtgtha2oLLPOY14EJKgVXw3DSF3r9sGPBCGwsWGEDZpWblv3wFfuRW3qSKjW4zdR4hYr2Lmcj3XpsIjJteVGD7kmyl8aicnyU0zgFWAkBY+h5TUZbyWqFhUXkNZmcvgKMMPh0Yb7RmVXXCtC+oQHysuC0QstHhslMXUYQObIPFshKYIObGfggk+LWdpQCIy+BLyypK/AyO4HtRIfIASPIgGnln2pkdJYL1hiNyvu4mAHlWE0DR3gKfGFJvVD628s828yyVe6ibFVYZbyemK2pcF6yOQzntpLALI9kI6tQwYovpHm3UwqMbI9QfXNdY5cdGua7a6zjhRrr1lG/9sYq3yaSa2a+l0ddXj2tBoz51jJPF7guEzJvrHCP9kVdQzQ/Beb8QKbMOSU/qC3fX+c/lEPLeknTheyPMad++EdZHiJTG6gtSiTbBFZpwp/VebfjoL4ubpFpMsFugyozXihdNOi6EgITdGF//E3N3sMqaugzlRKXQKymwDBq0GmDKpC7puHTcgrtDdA6VrgFepoQcGmVgj0FKxEymaptCuWDk6fcZpW8QGWqXxyHtymKArvdTaK2vbF02alBEKIKqN4m33ThyZovrQQnNFkszWbRvLRK+fBh0MJP6NEWGE3zidB0Zc/07Reaaqpp+Wmj7eww6wUSdTnliErbMSg4HT2KCv1wLBiFMoHWJEjorC5OgzDaTpiWk5z0CundVRMkYFp3hFxLq1lgMBV0Rken36x80KLVDUkJ7WJQl/3vRfrlLDQUjkknqI/sf5+4v58KTP0wJCwGGp6elHZmwUvLe5CwGJhn3vhUYGfzLFGBBMURlf5t/gfSM2h1H0OC0iCYA6eVDubfHDfNfnYpYQJGZuCk0gGByU0j4Fzn1SbEidjr36eSeD2DbuLMZ9UmxAt22rvDz41M4ZQP2vuctjWch05vTyZ6cLdnohkpt5hP5cVug4jK9kb6xvCzIxc8yjHxjtC1AigCpSTpdLNJJ51Nwl4PJX+kNSfdSZMMzqlo6og/HFy5jP0GnK2YTl5pms6OeCRqWBunkfAkMhXYrRmsBbenBke9MHbJMjcrJlFploimBKPaCc/dZNTd9YesesVwZpw4TSUiWDvjXpvYyrit2D22jvaODrtywy8k9ndWNA7nHI61XmLipgNxWTH1o181rUit1S+0I5973ECclR9oWncmvT7Vz5Q/aD2U74qkGCDsEpywiV5osScj54kCT902BC2r2LPi0OaKyft+ceScIKoydGPWT8yohK6Th532pqmlgpS4lvOLU/+hWaHt8P/5zFRe3H6cI/hMO3YIC9LEyzHvnkPBoAMucsccTxALGoq2qV4sYGueGFj147nYV7oD8vWBTETQHR71CaJxQd8xYGumk79veH2zZ4GDctWfN5xDJlXc1X1W3IibzjueF6+u2cX3aL10cFIWIHwff+eeQdjks+19LFA27IcXZnPZcqZvt7iR2fbz//hfj2Es3Zc/fZXZdnoHLJ93cQlKrdK1mGHz8JpfcQnfAttzxqa1SR/o5f10UAX1typv1R807oniJLZHan763X5mTqiW3m/khWHIyHr8+JjEfVo3z1V/6weazKAd4qdMYpBBXfXT7/Yz85K54ltrVTkjNzaLkog7Hbo2dITBJEumazyruMRcayKL15YejcqF2n1uIq4nXJFH9clylugOXWOYg7kXvcq7a69fZDegSsT1ji3yUOBli7sxf616IKuaXZGtXkOTgMo/dM0+feXkB4ISlwhs2TqJ/LzV3eyaSdntrDS7Vv1QXsOgxCUCL0vYeq+Z0y3cl/9wDhI8Iw23tm5Ym+VfrQW6lDeUuhMSeQlw37QSkb2g61C9uCQ2/3xj9mh5HKEWFv3+3Ua5i5rvtOZ5Qs637/7kzdX7wwXrQRF65dgf3j3eloHDPStZXD6AzCvX19Nip/zLlTKESCSlgeSyswbsN1qYgwRSt9LtiDt7m8G75GEirf0879ZMVitQ7Lz963Cttp/Ii3vtKNu07gshbsM5QgZSj2QgVQwjkJpEbNXbf9pvFl618B05wM/BIiPdMaC58/Zv1isQA7GX5//2r40tAdq9hRs3xyysC5v1F398r7HVNvXbIBRf1chEWBd2q6m2/9bIH7bFtq5pt73uVBc3aJ97IR4Iy3zERVgXtsvlth5iVksf3dKQsVVLa7U067HVWt3b2+S5sboSC2Ap8tYss6CDdtMCLAiI50hcslQNRCUlrCdNxqL2o84K5z5+95fDgqWLvI7adTmmzocVoKFzLE3VlIJqJla5uV8vKCnwMOTOU6lG3pCid0yRFZq4gvbB11YWhfx7xA3Q6zdtC5TJh5oQUJPe4aWci63qUtROe7WmgoVO42tTkUVXGt3SOQAAAABJRU5ErkJggg==';var rejectIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMCSURBVHgBxZjPaxNBFMffzG43oFCSo1gwMW3BUxPwR/HSBKwUT/XeYIX2asV/IO1/YC+CtFBLejdHaYXGW7ViVy8e2pL14k0SCoLdpDu+t/lhkmbNTDY/vpDsJHmb/fDezLz3hoGi8tOJsFPW50FjUyBYAgQEgeGLJKCIYwtHFjjOB7tczt4yc5bK/zNZw5M7s4sc4IlgCKEmUwixPn6490bGuCPQ8e0HCc75Fg7D4E8Wgq11AvMEOoolgsERI+0weA69lGAvz0rna3EzVwRZoO+xRNgwjLc4jEF/ZNm2nWw3v5gHzD74D1FXUE1AFKZRwzgaAExN5hlCNYaPN/5Kc2aAMKTY6Egg3fhF3UO0rBljWzAEOY6TnPj8PkfjuocQJg1DUnVbqYzpjbwDgw1Vq8JVhgoQemdF9k5jMiprqmRLWcC90jIHyf0mMHkTxjKvILSc6mgbWl5wbWWhKCX9vP/ohvZibHwRXTQnc9PFr0L1YSlyK/z58s0TJrSUgsLGDvzey4GsbCF+6KDxGczS0ips7vyDos8bGU+YwmYGVIRhm9IRJgyK8oLyA+NKiEQFSLoI8YaiYsgXTEVBvV5cdaHLnvIF4wJx8CvmMe5SerXs7MpLjXPGDZnHRFdQkUJGmVYZyGsC+4ISYGnPrkfjTLEQ84Kp7Uud9ilPHgYftZVrkbDsxvg/mF5A4W79mnNdz8reQKlDZmnT6qOQhZYWlPKZzljWXRcn92b3mZBrbwITUTg/PpUxVbLF+WNGD3fjlWXvwDZISvoBirYCxDpd6zvH6d2HeRheTWRFP+1GaFDfGLGMfApDEjWQtXEdiGpaanlhwGpts5tSh1YqrWIMTRicLO1qabXxiyagCPZHjPPHZAgDgMHiPhnJNbfUl5Jr5OCda9hnKNOFwWe1/tA227tQth3vx5yi/+RX7LYwpI4FQ7WB7EVHa9FKrjWEXlI6sKq2S0qJGD2Sw8t2zw6sWpWfnsMjvfI8tpszQF6rlMCNR3r4QogL8ZXr5WzkQO1I7y91mFsdhEgKrAAAAABJRU5ErkJggg==";var acceptIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMfSURBVHgBxZg/TBNRHMe/v1cQCTGpCerg4AHGlEXEwZWDiDLS4GBjohJjIokJRF2IA7Az2NGpEmM6GRwN/isxDsACLt6kNyhBoqYJktIW7vl+154tWuiV67Xfpb+7+11/n7zfu997v0eoUKGYrlFTw6Ak6gJIJ2kFlR3kZyRl0hJkKssUljUvafuFEUmYlfw/uXUMPeu/CYEbytRRgSRhmXYQNa69euLGvyxQ6OlFHQ0UU6YGbzJhYaoc2J5AWkwPNjcfmpBSjqGKIqJHqVRmyhxOJEs+L3UzFNc1SY2zJHEO/sgEsr2l5heVggEa38F7ig4EJYovOE01grHDcRZyMfcA4jlTIxhbPCXyMQv3HCP/WcdQF0mVutcJtgojJDCBuoliBQzkR6eGqSohLc+QA1LVdBT1Vm4VgODPnMi3eoOTLSewODSLULC9nKve+bzvlCDZMAifxDAzfdN48/UDjOTn8i+kRVhYAj3wQQ7M0voKxhemXb3DOwgBizRUWQeByUsXAlJDFeUBRi28CApnc7WfjjS24MLxs+XcPMGwpFRAbhw7j562A4Xb+uEXjKPAsaH2MTVWh/dz+rb53V5jxs+PYCPzGys/DV9gVMqSgdYrHXeUXTZti+sfbah7Xbfs6yV1XQzDoLfnH8KL1ObNCLQOdXTDZWFkKA58Pw+1qkbOgbn+9gEyVhZeJEELnDJNoQ24fYnTtbq5Zqcv3H4ZP1K/bJiN7Ca8Skj5WKXszJpiq2jfzFWXoZoCh3D3/WRVYGxRw4i9HwrF+3mXqKOOUvNn+dPVuW7ns59BnaW6myj/FnaM8UtfUOWq7V5kGpG5NraKCqM1jLpJTjnWXyDe06o+PYoaSy0XUSNS6GZ3LR2p9M6kclhGzURmOp2dLL6zC4jbW6JAmB1RAxgVvvfflvq/xdWIvLQd/YTiExGOkYu1WyVXe3bc2sp0+zGneM6kU9mSMKzyxzFxbk9owntJ4BG3hp2GcE8vuBSDqeI1qipqhR2KTKgwM8VfUlWACmADGsntQZXsHsuCJkDq0AD5Iz0kla0mqaVKCK0c5EjvD7WHTOQEQMMGAAAAAElFTkSuQmCC";if(aResponse){this.authResponse=aResponse;me.autoStartCobrowse();}var _self=this;this.phone=new _ac_webrtc__WEBPACK_IMPORTED_MODULE_2__.AudioCodesUA();this.activeCall=null;this.callDetails=null;this.callAccepted=false;this.callMuted=false;this.showPhonePanel=false;this.showVideo=false;this.screenSharingStream=null;this.agentProfileIcon=null;this.maskClassList=null;this.maskPatternList=null;this.phoneConfig={reconnectIntervalMin:2,// Minimum interval between WebSocket reconnection attempts. (seconds)
reconnectIntervalMax:30,// Maximum interval between WebSocket reconnection attempts (seconds)
registerExpires:600,// SIP registration expiry time (seconds) 
useSessionTimer:false,// Enable Session Timers (as per RFC 4028)
keepAlivePing:10,// To detect websocket disconnection, send CRLF ping interval (seconds) 
keepAlivePong:10,// Wait pong response interval (seconds)
keepAliveStats:60,// Each n pongs print to console log min and max pong delay
keepAliveDist:false,// Print to console log also pong distribution.
restoreCall:true,// Restore call if HTML page was reloaded during call.
restoreServer:true,// After page reload arise priority of previously connected SBC
restoreCallMaxDelay:20,// Maximum interval to restore call (seconds)
dtmfUseWebRTC:true,// Send DTMF using RTP as per RFC2833 (otherwise use SIP INFO)
dtmfDuration:null,// Duration of the DTMF tone (milliseconds) Default is 250
dtmfInterToneGap:null,// Interval between two DTMF tones (milliseconds) Default is 250
avoidTwoWayHold:true,// If call in remote hold, disable local hold button to avoid 2 way holds.
enableAddVideo:true,// Enable to call remote side to add video stream.
addLoggerTimestamp:true,// Always add timestamp string to log.
useWebrtcTracer:false,// Use advanced WebRTC methods logging tools.
audioAutoAnswerNoSdp:true,// Use audio for auto answer to incoming INVITE without SDP
switchSbcAtInvite5xx:true,// When outgoing call answer 5xx switch to alternative SBC and re-call.
// SDK modes and fixes.
modes:{ice_timeout_fix:2000,// ICE gathering timeout (milliseconds)
chrome_rtp_timeout_fix:13,// Workaround of https://bugs.chromium.org/p/chromium/issues/detail?id=982793
sbc_ha_pairs_mode:undefined,// After SBC disconnection try reconnect to the same URL.
ringing_header_mode:'Allow-Events: talk,hold,conference'// Extra header(s) to response 180.                             // Only for multiple SBC HA pairs configuration.
},// Set browser constraints.
constraints:{chrome:{audio:{echoCancellation:true}},firefox:{audio:{echoCancellation:true}},safari:{audio:{echoCancellation:true}},ios_safari:{audio:{echoCancellation:true}}},version:'18-Nov-2020'};this.callTerminated=function(){var callContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#callcontainer");callContainer.empty();this.removeAudoVideoContainer();this.disableMinimizeButton(false);};this.showFooterButtons=function(callConnected,videoCall){var footerButtonsHTML=null;if(callConnected){footerButtonsHTML="<div class=\"footer-btn-a-v-attch\">\n                <div id=\"closecall\" class=\"btn_actions enable-audio\">\n                    <img title=\"End Call\" src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iOCIgdmlld0JveD0iMCAwIDIwIDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNMTguMjYzOSA3LjU0OTg5QzE4Ljk3NyA3LjU0OTg5IDE5LjU1NTEgNi45NzE3NyAxOS41NTUxIDYuMjU4NjJMMTkuNTU1MSA0LjY2NTQ4QzE5LjU1NTEgMy4wODM3IDE4LjQ5NTkgMS42ODA4NiAxNi45NjQyIDEuMjgwMDVDMTUuMjUzNiAwLjgyOTEzNyAxMy45NDAyIDAuNTQ2NDIgOS42Mjc5IDAuNTQ5OTk5QzUuMzE1NTkgMC41NDY0MjEgNC40MzUyMyAwLjgzOTg3MyAyLjc0OTY3IDEuMjgwMDVDMS4yMTQ0MiAxLjY4NDQ0IDAuMTU4NzEyIDMuMDgzNyAwLjE2MjI5IDQuNjYxOUwwLjE2MDMxNSA2LjI1NjE5QzAuMTU5NDMgNi45NzAyOSAwLjczODMxNyA3LjU0OTUyIDEuNDUyNDIgNy41NDkwNkw0LjQ0NzQzIDcuNTQ3MTRDNS4xNjAyNSA3LjU0NjY5IDUuNzM3ODcgNi45Njg3IDUuNzM3ODcgNi4yNTU4N0w1LjczNzg3IDUuMjc3NDNDNS45MzQ3IDUuMjAyMjggNi4yNDYwNCA1LjEwNTY2IDYuNjMyNTQgNS4wMTk3N0M3LjQzMDU5IDQuODQ0NDEgOC41MjkyNCA0LjY5NzY5IDkuNjI3OSA0LjcwMTI3QzEwLjcyNjUgNC42OTc2OSAxMS45NDY5IDQuODQ0NDEgMTIuODcwMiA1LjAyMzM1QzEzLjMyNDcgNS4xMTI4MSAxMy43MTgzIDUuMjEzMDIgMTMuOTU4MSA1LjI5NTMzQzEzLjk2ODggNS4yOTg5MSAxMy45Njg4IDUuMjk4OSAxMy45Nzk2IDUuMzAyNDhWNi4yNTg2MkMxMy45Nzk2IDYuOTcxNzcgMTQuNTU3NyA3LjU0OTg5IDE1LjI3MDggNy41NDk4OUwxOC4yNjM5IDcuNTQ5ODlaTTE4LjI1OTcgNi4yNTQ0MUwxNS4yNzUxIDYuMjU0NDFMMTUuMjcxNSA0Ljk0MTA0QzE1LjI3MTUgNC42NjkwNiAxNS4xMzU1IDQuNTA0NDQgMTUuMDQ2IDQuNDIyMTNDMTQuOTYzNyA0LjMzOTgyIDE0Ljg5MjEgNC4yOTY4OCAxNC44MjQxIDQuMjU3NTFDMTQuNjgxIDQuMTc4NzggMTQuNTQxNCA0LjEyNTEgMTQuMzczMiA0LjA2NDI2QzE0LjA0MDQgMy45NTMzMiAxMy42MTQ1IDMuODQ5NTQgMTMuMTEzNSAzLjc0OTM0QzEyLjExODcgMy41NTYwOSAxMC44MzM5IDMuNDAyMjEgOS42Mjc4OSAzLjM5ODYzQzguNDIxODggMy40MDIyMSA3LjI0ODA3IDMuNTU5NjcgNi4zNTM0IDMuNzYwMDhDNS45MDYwNyAzLjg1NjcgNS41MzM4OSAzLjk2NDA2IDUuMjQwNDMgNC4wNzg1OEM1LjA5MDEzIDQuMTM1ODQgNC45NjEzIDQuMTkzMDkgNC44Mjg4OSA0LjI4MjU2QzQuNzY0NDcgNC4zMjU1IDQuNjk2NDggNC4zNzkxOSA0LjYyMTMyIDQuNDY4NjVDNC41NDI1OSA0LjU1NDU0IDQuNDQyMzkgNC43MTIgNC40NDIzOSA0Ljk0MTA0TDQuNDQyMzkgNi4yNTA4M0wxLjQ1NDE5IDYuMjU0NDFWNC42NTgzMkMxLjQ1NDE5IDMuNjYzNDUgMi4xMTYyNSAyLjc4NjY3IDMuMDc4OTEgMi41MzI1OUM0Ljc5MzEgMi4wODUyNSA1LjM3Mjg1IDEuODQxOSA5LjYyNzkgMS44MzgzMkMxMy44ODI5IDEuODQxOSAxNC45NDU4IDIuMDg4ODMgMTYuNjM0OSAyLjUzMjU5QzE3LjU5NzYgMi43ODY2NyAxOC4yNTk3IDMuNjYzNDUgMTguMjU5NyA0LjY1ODMyTDE4LjI1OTcgNi4yNTQ0MVoiIGZpbGw9IndoaXRlIi8+DQo8L3N2Zz4NCg==\" />\t\t\t\t\t\t\n                </div>\t\t\n                <div id=\"muteaudio\" class=\"btn_actions mute-audio\">\n                    <img title=\"Mute Audio\" class=\"mute-img\" src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAxNCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik03LjAwMDA2IDAuODMyMDMxQzQuOTM2NDMgMC44MzIwMzEgMy4yNTAwNiAyLjUxODQgMy4yNTAwNiA0LjU4MjAzVjEwLjgzMkMzLjI1MDA2IDEyLjg5NTcgNC45MzY0MyAxNC41ODIgNy4wMDAwNiAxNC41ODJDOS4wNjM3IDE0LjU4MiAxMC43NTAxIDEyLjg5NTcgMTAuNzUwMSAxMC44MzJWNC41ODIwM0MxMC43NTAxIDIuNTE4NCA5LjA2MzcgMC44MzIwMzEgNy4wMDAwNiAwLjgzMjAzMVpNNy4wMDAwNiAyLjA4MjAzQzguMzg4MSAyLjA4MjAzIDkuNTAwMDYgMy4xOTQgOS41MDAwNiA0LjU4MjAzVjEwLjgzMkM5LjUwMDA2IDEyLjIyMDEgOC4zODgxIDEzLjMzMiA3LjAwMDA2IDEzLjMzMkM1LjYxMjAzIDEzLjMzMiA0LjUwMDA2IDEyLjIyMDEgNC41MDAwNiAxMC44MzJWNC41ODIwM0M0LjUwMDA2IDMuMTk0IDUuNjEyMDMgMi4wODIwMyA3LjAwMDA2IDIuMDgyMDNaTTEuMzY1MyA4LjczOTc0QzEuMTk5NjggOC43NDIzMyAxLjA0MTg2IDguODEwNTUgMC45MjY1MDQgOC45Mjk0MkMwLjgxMTE0OCA5LjA0ODI4IDAuNzQ3Njg5IDkuMjA4MDggMC43NTAwNjQgOS4zNzM3VjEwLjgzMkMwLjc1MDA2NCAxNC4wNjU2IDMuMjIyNTggMTYuNzM1NCA2LjM3NTA2IDE3LjA1MDNWMTguOTU3QzYuMzczODkgMTkuMDM5OCA2LjM4OTE5IDE5LjEyMjEgNi40MjAwOCAxOS4xOTg5QzYuNDUwOTYgMTkuMjc1OCA2LjQ5NjgxIDE5LjM0NTcgNi41NTQ5NyAxOS40MDQ3QzYuNjEzMTIgMTkuNDYzNyA2LjY4MjQxIDE5LjUxMDUgNi43NTg4MiAxOS41NDI1QzYuODM1MjMgMTkuNTc0NSA2LjkxNzI0IDE5LjU5MDkgNy4wMDAwNiAxOS41OTA5QzcuMDgyODkgMTkuNTkwOSA3LjE2NDkgMTkuNTc0NSA3LjI0MTMxIDE5LjU0MjVDNy4zMTc3MiAxOS41MTA1IDcuMzg3MDEgMTkuNDYzNyA3LjQ0NTE2IDE5LjQwNDdDNy41MDMzMiAxOS4zNDU3IDcuNTQ5MTcgMTkuMjc1OCA3LjU4MDA1IDE5LjE5ODlDNy42MTA5MyAxOS4xMjIxIDcuNjI2MjQgMTkuMDM5OCA3LjYyNTA2IDE4Ljk1N1YxNy4wNTAzQzEwLjc3NzUgMTYuNzM1NCAxMy4yNTAxIDE0LjA2NTYgMTMuMjUwMSAxMC44MzJWOS4zNzM3QzEzLjI1MTIgOS4yOTA4OCAxMy4yMzU5IDkuMjA4NjUgMTMuMjA1MSA5LjEzMTc5QzEzLjE3NDIgOS4wNTQ5NCAxMy4xMjgzIDguOTg0OTkgMTMuMDcwMiA4LjkyNjAxQzEzLjAxMiA4Ljg2NzAzIDEyLjk0MjcgOC44MjAxOSAxMi44NjYzIDguNzg4MjJDMTIuNzg5OSA4Ljc1NjI2IDEyLjcwNzkgOC43Mzk3OSAxMi42MjUxIDguNzM5NzlDMTIuNTQyMiA4LjczOTc5IDEyLjQ2MDIgOC43NTYyNiAxMi4zODM4IDguNzg4MjJDMTIuMzA3NCA4LjgyMDE5IDEyLjIzODEgOC44NjcwMyAxMi4xOCA4LjkyNjAxQzEyLjEyMTggOC45ODQ5OSAxMi4wNzYgOS4wNTQ5NCAxMi4wNDUxIDkuMTMxNzlDMTIuMDE0MiA5LjIwODY1IDExLjk5ODkgOS4yOTA4OCAxMi4wMDAxIDkuMzczN1YxMC44MzJDMTIuMDAwMSAxMy41NzU5IDkuODA4MjYgMTUuNzg4MiA3LjA3NDEyIDE1LjgyOEM3LjA0NjMyIDE1LjgyNDUgNy4wMTgzMiAxNS44MjI4IDYuOTkwMyAxNS44MjMxQzYuOTY3NDQgMTUuODIzNSA2Ljk0NDYyIDE1LjgyNTEgNi45MjE5NCAxNS44MjhDNC4xODk3IDE1Ljc4NiAyLjAwMDA2IDEzLjU3NDYgMi4wMDAwNiAxMC44MzJWOS4zNzM3QzIuMDAxMjYgOS4yOTAwNCAxLjk4NTY2IDkuMjA3IDEuOTU0MTcgOS4xMjk0OUMxLjkyMjY5IDkuMDUxOTggMS44NzU5NiA4Ljk4MTU4IDEuODE2NzcgOC45MjI0NkMxLjc1NzU3IDguODYzMzQgMS42ODcxMSA4LjgxNjcxIDEuNjA5NTYgOC43ODUzMkMxLjUzMjAxIDguNzUzOTQgMS40NDg5NSA4LjczODQ0IDEuMzY1MyA4LjczOTc0WiIgZmlsbD0id2hpdGUiLz4NCjwvc3ZnPg0K\" />\t\t\t\t\t\t\n                    <img title=\"Unmute Audio\" class=\"un-mute\" src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTciIGhlaWdodD0iMTkiIHZpZXdCb3g9IjAgMCAxNyAxOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik04LjUwMDUyIDAuNzkyOTY5QzEwLjQ2MzkgMC43OTI5NjkgMTIuMDYzIDIuMzkyMTQgMTIuMDYzIDQuMzU1NDdWMTAuMjkzQzEyLjA2MyAxMC4zNzYxIDEyLjA1OTIgMTAuNDU4OSAxMi4wNTUzIDEwLjUzOEwxMC44NzU1IDkuMzU5MDVWNC4zNTU0N0MxMC44NzU1IDQuMjczNTggMTAuODcxMyA0LjE5MjQ4IDEwLjg2MzEgNC4xMTI3MUMxMC43NDE0IDIuOTE2MTUgOS43Mjg4NCAxLjk4MDQ3IDguNTAwNTIgMS45ODA0N0M3LjE5MDMxIDEuOTgwNDcgNi4xMjU1MiAzLjA0NTI2IDYuMTI1NTIgNC4zNTU0N1Y0LjYwOTA1TDUuMDM2OTcgMy41MjA1MUM1LjQxMzAyIDEuOTU2OTcgNi44MjYxNCAwLjc5Mjk2OSA4LjUwMDUyIDAuNzkyOTY5Wk0xLjE4OTIgMS41NzkyMkMxLjM0MzQgMS41ODM3MiAxLjQ4OTggMS42NDgwNCAxLjU5NzQgMS43NTg1OUwxMi41NzE3IDEyLjczMjlDMTIuODA1OCAxMi4zNDMzIDEyLjk4NTEgMTEuOTE3OCAxMy4wOTk4IDExLjQ2NUMxMy4xMjcyIDExLjM1OTggMTMuMTUwOSAxMS4yNTM0IDEzLjE3MDkgMTEuMTQ1N0MxMy4xODg3IDExLjA0NzEgMTMuMjA0MSAxMC45NDc5IDEzLjIxNTcgMTAuODQ3M0MxMy4yMjA4IDEwLjgwMzkgMTMuMjI1NyAxMC43NjA0IDEzLjIyOTYgMTAuNzE2NkMxMy4yNDE5IDEwLjU3NjkgMTMuMjUwNSAxMC40MzYgMTMuMjUwNSAxMC4yOTNWOC45MDc1NUMxMy4yNDk0IDguODI4MDggMTMuMjY0MiA4Ljc0OTE5IDEzLjI5NDEgOC42NzU1NkMxMy4zMjQgOC42MDE5MiAxMy4zNjg0IDguNTM1MDQgMTMuNDI0NiA4LjQ3ODg4QzEzLjQ4MDkgOC40MjI3MiAxMy41NDc4IDguMzc4NDEgMTMuNjIxNSA4LjM0ODZDMTMuNjk1MiA4LjMxODc4IDEzLjc3NDEgOC4zMDQwNiAxMy44NTM1IDguMzA1M0MxNC4wMTA5IDguMzA3NzYgMTQuMTYwOCA4LjM3MjU2IDE0LjI3MDQgOC40ODU0OUMxNC4zOCA4LjU5ODQxIDE0LjQ0MDMgOC43NTAyMSAxNC40MzggOC45MDc1NVYxMC4yOTNDMTQuNDM4IDEwLjQ4NTkgMTQuNDI4NCAxMC42NzYzIDE0LjQxMDIgMTAuODY0M0MxNC4zNTU1IDExLjQzNjcgMTQuMjE5OSAxMS45ODU0IDE0LjAxNDQgMTIuNDk3OUwxNC4wMDk3IDEyLjQ5MzJDMTMuODUzMiAxMi44Nzk2IDEzLjY1NDEgMTMuMjQzNCAxMy40MjI5IDEzLjU4NDFMMTYuMjQzMiAxNi40MDQ0QzE2LjMwMDIgMTYuNDU5MSAxNi4zNDU3IDE2LjUyNDcgMTYuMzc3MSAxNi41OTcyQzE2LjQwODQgMTYuNjY5NyAxNi40MjQ5IDE2Ljc0NzcgMTYuNDI1OCAxNi44MjY3QzE2LjQyNjYgMTYuOTA1NyAxNi40MTE2IDE2Ljk4NDEgMTYuMzgxNyAxNy4wNTcyQzE2LjM1MTkgMTcuMTMwMyAxNi4zMDc3IDE3LjE5NjggMTYuMjUxOSAxNy4yNTI2QzE2LjE5NiAxNy4zMDg1IDE2LjEyOTYgMTcuMzUyNyAxNi4wNTY0IDE3LjM4MjVDMTUuOTgzMyAxNy40MTI0IDE1LjkwNDkgMTcuNDI3MyAxNS44MjU5IDE3LjQyNjVDMTUuNzQ2OSAxNy40MjU3IDE1LjY2ODkgMTcuNDA5MiAxNS41OTY0IDE3LjM3NzhDMTUuNTIzOSAxNy4zNDY1IDE1LjQ1ODMgMTcuMzAxIDE1LjQwMzYgMTcuMjQ0TDEyLjY2OTkgMTQuNTEwM0MxMS43MzAyIDE1LjQ0MTUgMTAuNDgxNCAxNi4wNTc2IDkuMDk0MjcgMTYuMTk2NVYxOC4wMTE3QzkuMDk1MzggMTguMDkwNCA5LjA4MDg0IDE4LjE2ODUgOS4wNTE1IDE4LjI0MTVDOS4wMjIxNiAxOC4zMTQ1IDguOTc4NjEgMTguMzgxIDguOTIzMzYgMTguNDM3QzguODY4MTIgMTguNDkzMSA4LjgwMjI5IDE4LjUzNzUgOC43Mjk3IDE4LjU2NzlDOC42NTcxMSAxOC41OTgzIDguNTc5MiAxOC42MTM5IDguNTAwNTIgMTguNjEzOUM4LjQyMTgzIDE4LjYxMzkgOC4zNDM5MyAxOC41OTgzIDguMjcxMzQgMTguNTY3OUM4LjE5ODc1IDE4LjUzNzUgOC4xMzI5MiAxOC40OTMxIDguMDc3NjcgMTguNDM3QzguMDIyNDMgMTguMzgxIDcuOTc4ODcgMTguMzE0NSA3Ljk0OTUzIDE4LjI0MTVDNy45MjAxOSAxOC4xNjg1IDcuOTA1NjUgMTguMDkwNCA3LjkwNjc3IDE4LjAxMTdWMTYuMjAwM0M0LjkxMDk0IDE1LjkwMTMgMi41NjMwMiAxMy4zNjYxIDIuNTYzMDIgMTAuMjkzVjguOTA3NTVDMi41NjMwMiA4LjU3OTAxIDIuODI4MjMgOC4zMTM4IDMuMTU2NzcgOC4zMTM4QzMuNDg1MzEgOC4zMTM4IDMuNzUwNTIgOC41NzkwMSAzLjc1MDUyIDguOTA3NTVWMTAuMjkzQzMuNzUwNTIgMTIuODg5MSA1Ljg0MTU4IDE1LjAwMSA4LjQyODYyIDE1LjAzOTlDOC40Mzg5IDE1LjAzODYgOC40NDkyMSAxNS4wMzc1IDguNDU5NTQgMTUuMDM2OEM4LjQ2MDU3IDE1LjAzNjUgOC40NjE2IDE1LjAzNjMgOC40NjI2MyAxNS4wMzZDOC40NjYyNCAxNS4wMzYgOC40Njk4NSAxNS4wMzYgOC40NzM0NiAxNS4wMzZDOC40ODU1NSAxNS4wMzUxIDguNDk3NjcgMTUuMDM0NiA4LjUwOTc5IDE1LjAzNDVDOC41MTM5MiAxNS4wMzQ3IDguNTE4MDQgMTUuMDM0OSA4LjUyMjE2IDE1LjAzNTJDOC41MjYyOSAxNS4wMzU1IDguNTMwNDEgMTUuMDM1NyA4LjUzNDUzIDE1LjAzNkM4Ljk5OTc2IDE1LjAzMjYgOS40NDczOSAxNC45NjAyIDkuODcxMjQgMTQuODMzNUM5LjkwNTIgMTQuODIzMiA5LjkzOTY2IDE0LjgxNDMgOS45NzMzIDE0LjgwMzNDMTAuMDgyOSAxNC43Njc4IDEwLjE4OTggMTQuNzI2NSAxMC4yOTU3IDE0LjY4MzVDMTAuMzQ5MiAxNC42NjE1IDEwLjQwMjQgMTQuNjM5MyAxMC40NTQ5IDE0LjYxNTRDMTAuNTQxMyAxNC41NzY2IDEwLjYyNjYgMTQuNTM1NSAxMC43MTAxIDE0LjQ5MTdDMTAuNzg1NCAxNC40NTE5IDEwLjg1OTEgMTQuNDA5NCAxMC45MzIgMTQuMzY1N0MxMC45OTQxIDE0LjMyODggMTEuMDU2NSAxNC4yOTI1IDExLjExNjcgMTQuMjUyOEMxMS4yMzIgMTQuMTc2NCAxMS4zNDM2IDE0LjA5NTMgMTEuNDUxNSAxNC4wMDkzQzExLjQ2NzQgMTMuOTk2OCAxMS40ODQ1IDEzLjk4NTcgMTEuNTAwMiAxMy45NzNDMTEuNjE1OCAxMy44Nzg0IDExLjcyNSAxMy43NzY0IDExLjgzMTEgMTMuNjcxNUwxMC45ODkyIDEyLjgyOTVDMTAuMzQ2IDEzLjQ2MDcgOS40NzAzOSAxMy44NTU1IDguNTAwNTIgMTMuODU1NUM2LjUzNzE4IDEzLjg1NTUgNC45MzgwMiAxMi4yNTYzIDQuOTM4MDIgMTAuMjkzVjYuNzc4NEwwLjc1NzggMi41OTgxOUMwLjY3MjE0MiAyLjUxNDc2IDAuNjEzNjYzIDIuNDA3NDIgMC41OTAwMTggMi4yOTAyMUMwLjU2NjM3NCAyLjE3MyAwLjU3ODY2MyAyLjA1MTM5IDAuNjI1Mjc5IDEuOTQxMjhDMC42NzE4OTYgMS44MzExNyAwLjc1MDY2OCAxLjczNzcgMC44NTEyODUgMS42NzMxQzAuOTUxOTAxIDEuNjA4NSAxLjA2OTY4IDEuNTc1NzggMS4xODkyIDEuNTc5MjJaTTYuMTI1NTIgNy45NjU5VjEwLjI5M0M2LjEyNTUyIDExLjYwMzIgNy4xOTAzMSAxMi42NjggOC41MDA1MiAxMi42NjhDOS4xNDQ1MiAxMi42NjggOS43Mjc4OCAxMi40MTIgMTAuMTU1IDExLjk5NTRMNi4xMjU1MiA3Ljk2NTlaIiBmaWxsPSJ3aGl0ZSIvPg0KPC9zdmc+DQo=\" />\t\t\t\t\t\t                        \n                </div>";if(videoCall){footerButtonsHTML+="\n                <div id=\"videobuttons\" class=\"btn_actions enable-video active-\">\n                    <img class=\"video-unmute\" src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTAiIHZpZXdCb3g9IjAgMCAxOCAxMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0xNy43NSAwLjkzNTU3N0MxNy43NSAwLjQ1Njc0IDE3LjI5ODIgMC4xNTU3NjIgMTYuOTMzNiAwLjM5MTc1M0wxMy4zNzUgMi42OTUzMVYxLjg3NUMxMy4zNzUgMC44NDQ3MjYgMTIuNjM1OSAwIDExLjczNDQgMEgxLjg5MDYyQzAuOTg5MTM2IDAgMC4yNSAwLjg0NDcyNiAwLjI1IDEuODc1VjguMTI1QzAuMjUgOS4xNTUyNyAwLjk4OTEzNiAxMCAxLjg5MDYyIDEwSDExLjczNDRDMTIuNjM1OSAxMCAxMy4zNzUgOS4xNTUyNyAxMy4zNzUgOC4xMjVWNy4zMDQ2OUwxNi45MzM2IDkuNjA4MjVDMTcuMjk4MiA5Ljg0NDI0IDE3Ljc1IDkuNTQzMjYgMTcuNzUgOS4wNjQ0MlYwLjkzNTU3N1pNMS44OTA2MiAxLjI1SDExLjczNDRDMTIuMDQyIDEuMjUgMTIuMjgxMiAxLjUyMzQ0IDEyLjI4MTIgMS44NzVWOC4xMjVDMTIuMjgxMiA4LjQ3NjU2IDEyLjA0MiA4Ljc1IDExLjczNDQgOC43NUgxLjg5MDYyQzEuNTgzMDEgOC43NSAxLjM0Mzc1IDguNDc2NTYgMS4zNDM3NSA4LjEyNVYxLjg3NUMxLjM0Mzc1IDEuNTIzNDQgMS41ODMwMSAxLjI1IDEuODkwNjIgMS4yNVpNMTYuNjU2MiAyLjAxMTcyVjcuOTg4MjhMMTMuMzc1IDUuODY0MjZWNC4xMzU3NEwxNi42NTYyIDIuMDExNzJaIiBmaWxsPSJ3aGl0ZSIvPg0KPC9zdmc+DQo=\" />\t\t\t\t\t\t\n                    <img class=\"video-mute\" src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxOCAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0zLjYxNzA2IDAuOTY3MjAzQzMuNDA0NDggMC43MjQ0MTUgMy4wNTk5NCAwLjcyNDQ4MyAyLjg0NzQzIDAuOTY3MzU1QzIuNjM1MDkgMS4yMTAwMiAyLjYzNDgzIDEuNjAzMzcgMi44NDY4NCAxLjg0NjQxTDMuODUxNjggMi45OTgzNEgxLjg5MDYyQzAuOTg5MTM2IDIuOTk4MzQgMC4yNSAzLjg0MzA3IDAuMjUgNC44NzMzNFYxMS4xMjMzQzAuMjUgMTIuMTUzNiAwLjk4OTEzNiAxMi45OTgzIDEuODkwNjIgMTIuOTk4M0gxMS43MzQ0QzExLjk4NjUgMTIuOTk4MyAxMi4yMjU3IDEyLjkzIDEyLjQzOTMgMTIuODEyOEwxNC4zNzUgMTUuMDI5MUMxNC41ODk1IDE1LjI3NDcgMTQuOTM3NyAxNS4yNzQ5IDE1LjE1MjUgMTUuMDI5NUMxNS4zNjcxIDE0Ljc4NDIgMTUuMzY3IDE0LjM4NjQgMTUuMTUyMyAxNC4xNDEyTDMuNjE3MDYgMC45NjcyMDNaTTE3Ljc1IDMuOTM0ODNDMTcuNzUgMy40NTU3OSAxNy4yOTc4IDMuMTU0ODQgMTYuOTMzMyAzLjM5MTI0TDEzLjM3NSA1LjY5ODU0VjQuODczMzRDMTMuMzc1IDMuODM4MTkgMTIuNjQwMSAyLjk5ODM0IDExLjczNDQgMi45OTgzNEg2LjkwMjIyTDcuOTk1OTcgNC4yNDgzNEgxMS43MzQ0QzEyLjAzNzcgNC4yNDgzNCAxMi4yODEyIDQuNTI2NjYgMTIuMjgxMiA0Ljg3MzM0VjkuMDkyMDlMMTMuMzc1IDEwLjM0MjFMMTYuOTM2NCAxMi42MTU3QzE3LjMwMSAxMi44NDg0IDE3Ljc1IDEyLjU0NzIgMTcuNzUgMTIuMDdWMy45MzQ4M1pNMS44OTA2MiA0LjI0ODM0SDQuOTQ1NDRMMTEuNTA3OSAxMS43NDgzSDEuODkwNjJDMS41ODMwMSAxMS43NDgzIDEuMzQzNzUgMTEuNDc0OSAxLjM0Mzc1IDExLjEyMzNWNC44NzMzNEMxLjM0Mzc1IDQuNTIxNzggMS41ODMwMSA0LjI0ODM0IDEuODkwNjIgNC4yNDgzNFpNMTYuNjU2MiA1LjAxMDA2VjEwLjk4NjZMMTMuMzc1IDguODk2NzhWNy4xMzQwOUwxNi42NTYyIDUuMDEwMDZaIiBmaWxsPSJ3aGl0ZSIvPg0KPC9zdmc+DQo=\" />\n                </div>";}footerButtonsHTML+="</div>";}var callbuttons=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#callbuttons");callbuttons.empty();callbuttons.append(footerButtonsHTML);var mutecallbutton=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#muteaudio");mutecallbutton.off('click').on('click',function(event){var muted=_self.activeCall.isAudioMuted();_self.activeCall.muteAudio(!muted);if(!muted){mutecallbutton.addClass('active-');}else{mutecallbutton.removeClass('active-');}});var closecallbutton=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#closecall");closecallbutton.off('click').on('click',function(event){if(callConnected){_self.activeCall.terminate();}});var sendSelfVideo=true;if(videoCall){var selfvideo=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#videobuttons");selfvideo.off('click').on('click',function(event){if(_self.activeCall){sendSelfVideo=!sendSelfVideo;var localVideTmp=document.getElementById("kore_local_video_tmp");var localStream=localVideTmp["srcObject"];localStream.getVideoTracks().forEach(function(track){return track.enabled=sendSelfVideo;});if(sendSelfVideo){//_self.activeCall.startSendingVideo();
//_self.sendControlMessage("start_sending_video");
_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#kore_local_video_tmp").show();selfvideo.addClass('active-');_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#agentyou").hide();}else{//_self.activeCall.stopSendingVideo();
//_self.sendControlMessage('stop_sending_video');
selfvideo.removeClass('active-');_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#kore_local_video_tmp").hide();_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#agentyou").show();}}else{console.log('there is no active call, hence cannot toggle send video');}});}};this.fullScreen=false;this.callConnected=function(videoCall,agentName){var callConnectedHTML="<div do-not-mutate=\"true\" class=\"video-audio-chat-container\">\n            <div class=\"video-chat-\">\n                <div class=\"video-name-title\">".concat(agentName,"</div>\n                <div id ='audiovideocallcontainer'></div>\n            </div>\n            <div id=\"callbuttons\"></div>\n        </div>");var videoContainerHTML="<div id=\"video_view\" class=\"video-view-\">\n            <video id=\"kore_remote_video_tmp\" autoplay=\"autoplay\" playsinline style=\"display: block;\"></video>\n            <div class=\"action-minimize-audio-control\">\n                <div id=\"maximizevideo\" class=\"maximize-video\">\n                    <img src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNC44NTQ4IDEwLjQwMTRDMTUuMTkxNCAxMC40MDE0IDE1LjQ2NzcgMTAuNjU5MSAxNS40OTc0IDEwLjk4NzlMMTUuNSAxMS4wNDY2VjEzLjMzMTVDMTUuNSAxNC40OTk5IDE0LjU3NTkgMTUuNDUyNSAxMy40MTg4IDE1LjQ5ODNMMTMuMzMxNSAxNS41SDExLjA0NjZDMTAuNjkwMyAxNS41IDEwLjQwMTQgMTUuMjExMiAxMC40MDE0IDE0Ljg1NDhDMTAuNDAxNCAxNC41MTgzIDEwLjY1OTEgMTQuMjQyIDEwLjk4NzkgMTQuMjEyM0wxMS4wNDY2IDE0LjIwOTdIMTMuMzMxNUMxMy43OTU0IDE0LjIwOTcgMTQuMTc1MyAxMy44NSAxNC4yMDc1IDEzLjM5NDNMMTQuMjA5NyAxMy4zMzE1VjExLjA0NjZDMTQuMjA5NyAxMC42OTAzIDE0LjQ5ODUgMTAuNDAxNCAxNC44NTQ4IDEwLjQwMTRaTTEuMTQ1MTYgMTAuNDAxNEMxLjQ4MTY4IDEwLjQwMTQgMS43NTgwMiAxMC42NTkxIDEuNzg3NjkgMTAuOTg3OUwxLjc5MDMyIDExLjA0NjZWMTMuMzMxNUMxLjc5MDMyIDEzLjc5NTQgMi4xNTAwMyAxNC4xNzUzIDIuNjA1NzUgMTQuMjA3NUwyLjY2ODQ2IDE0LjIwOTdINC45NTM0MUM1LjMwOTcyIDE0LjIwOTcgNS41OTg1NyAxNC40OTg1IDUuNTk4NTcgMTQuODU0OEM1LjU5ODU3IDE1LjE5MTQgNS4zNDA5MiAxNS40Njc3IDUuMDEyMTMgMTUuNDk3NEw0Ljk1MzQxIDE1LjVIMi42Njg0NkMxLjUwMDA2IDE1LjUgMC41NDc0OTQgMTQuNTc1OSAwLjUwMTcyMiAxMy40MTg4TDAuNSAxMy4zMzE1VjExLjA0NjZDMC41IDEwLjY5MDMgMC43ODg4NDkgMTAuNDAxNCAxLjE0NTE2IDEwLjQwMTRaTTQuOTUzNDEgMC41QzUuMzA5NzIgMC41IDUuNTk4NTcgMC43ODg4NDkgNS41OTg1NyAxLjE0NTE2QzUuNTk4NTcgMS40ODE2OCA1LjM0MDkyIDEuNzU4MDIgNS4wMTIxMyAxLjc4NzY5TDQuOTUzNDEgMS43OTAzMkgyLjY2ODQ2QzIuMjA0NTYgMS43OTAzMiAxLjgyNDY4IDIuMTUwMDMgMS43OTI1MyAyLjYwNTc1TDEuNzkwMzIgMi42Njg0NlY0Ljk1MzQxQzEuNzkwMzIgNS4zMDk3MiAxLjUwMTQ3IDUuNTk4NTcgMS4xNDUxNiA1LjU5ODU3QzAuODA4NjQ0IDUuNTk4NTcgMC41MzIzMDMgNS4zNDA5MiAwLjUwMjYzNyA1LjAxMjEzTDAuNSA0Ljk1MzQxVjIuNjY4NDZDMC41IDEuNTAwMDYgMS40MjQwNyAwLjU0NzQ5NCAyLjU4MTI0IDAuNTAxNzIyTDIuNjY4NDYgMC41SDQuOTUzNDFaTTEzLjMzMTUgMC41QzE0LjQ5OTkgMC41IDE1LjQ1MjUgMS40MjQwNyAxNS40OTgzIDIuNTgxMjRMMTUuNSAyLjY2ODQ2VjQuOTUzNDFDMTUuNSA1LjMwOTcyIDE1LjIxMTIgNS41OTg1NyAxNC44NTQ4IDUuNTk4NTdDMTQuNTE4MyA1LjU5ODU3IDE0LjI0MiA1LjM0MDkyIDE0LjIxMjMgNS4wMTIxM0wxNC4yMDk3IDQuOTUzNDFWMi42Njg0NkMxNC4yMDk3IDIuMjA0NTYgMTMuODUgMS44MjQ2OCAxMy4zOTQzIDEuNzkyNTNMMTMuMzMxNSAxLjc5MDMySDExLjA0NjZDMTAuNjkwMyAxLjc5MDMyIDEwLjQwMTQgMS41MDE0NyAxMC40MDE0IDEuMTQ1MTZDMTAuNDAxNCAwLjgwODY0NCAxMC42NTkxIDAuNTMyMzAzIDEwLjk4NzkgMC41MDI2MzdMMTEuMDQ2NiAwLjVIMTMuMzMxNVoiIGZpbGw9IiMyMDIxMjQiLz4KPC9zdmc+Cg==\" />\n                </div>\n            </div>\n            <div id=\"showselfvideocontainer\" class=\"show-self-video-container\">\n                <div class=\"show-self-video\">\n                    <img src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEwIDAuMzk4NDM4QzYuNTcxODggMC4zOTg0MzggMy42OTY4OCAyLjgxMDk0IDIuOTc1IDYuMDIzNDRDMy4wNDg0NCA2LjAxNTYyIDMuMTI1IDUuOTk4NDQgMy4yIDUuOTk4NDRDMy40MDQ2OSA1Ljk5ODQ0IDMuNjAxNTYgNi4wNDA2MyAzLjc4NzUgNi4wOTg0NEM0LjQ2NTYzIDMuMjkzNzUgNi45ODkwNiAxLjE5ODQ0IDEwIDEuMTk4NDRDMTMuMDA5NCAxLjE5ODQ0IDE1LjUzNDQgMy4yOTM3NSAxNi4yMTI1IDYuMDk4NDRDMTYuMzk4NCA2LjA0MDYzIDE2LjU5MzggNS45OTg0NCAxNi44IDUuOTk4NDRDMTYuODc1IDUuOTk4NDQgMTYuOTUxNiA2LjAxNTYyIDE3LjAyNSA2LjAyMzQ0QzE2LjMwMzEgMi44MTA5NCAxMy40MjY2IDAuMzk4NDM4IDEwIDAuMzk4NDM4Wk0zLjIgNi43OTg0NEMyLjUzOTA2IDYuNzk4NDQgMiA3LjMzNzUgMiA3Ljk5ODQ0VjEzLjk5ODRDMiAxNC42NTk0IDIuNTM5MDYgMTUuMTk4NCAzLjIgMTUuMTk4NEMzLjg2MDk0IDE1LjE5ODQgNC40IDE0LjY1OTQgNC40IDEzLjk5ODRWNy45OTg0NEM0LjQgNy4zMzc1IDMuODYwOTQgNi43OTg0NCAzLjIgNi43OTg0NFpNMTYuOCA2Ljc5ODQ0QzE2LjEzOTEgNi43OTg0NCAxNS42IDcuMzM3NSAxNS42IDcuOTk4NDRWMTMuOTk4NEMxNS42IDE0LjY1OTQgMTYuMTM5MSAxNS4xOTg0IDE2LjggMTUuMTk4NEMxNy40NjA5IDE1LjE5ODQgMTggMTQuNjU5NCAxOCAxMy45OTg0VjcuOTk4NDRDMTggNy4zMzc1IDE3LjQ2MDkgNi43OTg0NCAxNi44IDYuNzk4NDRaTTEuMiA4LjA0ODQ0QzAuNDc4MTI1IDguNjI4MTMgMCA5LjcxNTYyIDAgMTAuOTk4NEMwIDEyLjI4MTIgMC40NzgxMjUgMTMuMzY4OCAxLjIgMTMuOTQ4NFY4LjA0ODQ0Wk0xOC44IDguMDQ4NDRWMTMuOTQ4NEMxOS41MjE5IDEzLjM2ODggMjAgMTIuMjgxMiAyMCAxMC45OTg0QzIwIDkuNzE1NjIgMTkuNTIxOSA4LjYyODEzIDE4LjggOC4wNDg0NFpNMTYuMjM3NSAxNS45MTA5QzE1Ljg4NDQgMTYuOTk2OSAxNC45NjcyIDE3LjU5ODQgMTMuNiAxNy41OTg0SDEzLjE2MjVDMTMuMTg5MSAxNy43MjgxIDEzLjIgMTcuODYwOSAxMy4yIDE3Ljk5ODRDMTMuMiAxOC4xMzU5IDEzLjE4OTEgMTguMjY4NyAxMy4xNjI1IDE4LjM5ODRIMTMuNkMxNS4zOTY5IDE4LjM5ODQgMTYuNjQwNiAxNy40OTUzIDE3LjA1IDE1Ljk3MzRDMTYuOTY1NiAxNS45ODQ0IDE2Ljg4NTkgMTUuOTk4NCAxNi44IDE1Ljk5ODRDMTYuNjAzMSAxNS45OTg0IDE2LjQxNzIgMTUuOTY0MSAxNi4yMzc1IDE1LjkxMDlaTTkuMiAxNi43OTg0QzguNTM5MDYgMTYuNzk4NCA4IDE3LjMzNzUgOCAxNy45OTg0QzggMTguNjU5NCA4LjUzOTA2IDE5LjE5ODQgOS4yIDE5LjE5ODRIMTEuMkMxMS44NjA5IDE5LjE5ODQgMTIuNCAxOC42NTk0IDEyLjQgMTcuOTk4NEMxMi40IDE3LjMzNzUgMTEuODYwOSAxNi43OTg0IDExLjIgMTYuNzk4NEg5LjJaIiBmaWxsPSIjMjAyMTI0Ii8+Cjwvc3ZnPgo=\" />\n                </div>\n            </div>\n            <div id=\"selfvideocontainer\" class=\"self-video-container\">\n            <div class=\"self-video\">\n                <div id=\"agentyou\" class=\"video-user-alphabet\">YOU</div>\n                <video id=\"kore_local_video_tmp\" autoplay=\"autoplay\" playsinline style=\"display: block;\"></video>\n            </div>\n            <div id=\"closeselfvideo\" class=\"close-video\">\n                <img width: 10px; style='height: 10px;top:-5px;left:-9px;position: absolute;' \n                     src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACuSURBVHgBnZLBDcMgDEWdsoBLF6AVvXeEbla6Ta7doJmgC/SQY08pGxAHJZGVGIiChLCNH/4yBqBlzPUGG9eUq6JRhQ9qDf7fNVnoYh901Iinl/K++yHqigIuB0cogKP9bNtvzSRYZ842jK+uoHhHObIUAU5Bijsk+81l41HfmTy5mlg5I+8AcjSIdkpqrMa6R24DhW7P0FJerttJqAgX/0mCh5ErQSt4mu09Q94DEcdaRcYvY1cAAAAASUVORK5CYII=\" />\n            </div>\n            </div>\n        </div>\n       ";var videoAudoStr=videoCall?'video':'audio';var audioContainerHTML="<div id=\"video_view\" class=\"video-view- audio-view-\">\n            <div class=\"agent-profile-img\">\n                <img style='height: 30px; width:30px; top:0px;left:0px;position: absolute; border-radius: 50%;'\n                    src=\"".concat(_self.agentProfileIcon,"\"> \n            </div>\n            <div class=\"title\">Connected ").concat(videoAudoStr," Call...</div>\n            <div class=\"audio-info\">Disconnecting ").concat(videoAudoStr," call doesn't end conversation</div>\n        </div>");var callcontainer=document.getElementById("callcontainer");if(callcontainer){callcontainer.remove();callcontainer=null;}if(!callcontainer){callcontainer=document.createElement("div");callcontainer.id="callcontainer";var agentcontainer=document.getElementById("agentcontainer");agentcontainer.appendChild(callcontainer);}setTimeout(function(){var callContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#callcontainer");callContainer.empty();callContainer.append(callConnectedHTML);// callContainer.draggable({
//     handle: koreJquery('#callcontainer').find(".video-name-title"),
//     containment: "document",
//     })
//     .resizable({
//         handles: "n, e, w, s",
//         containment: "document",
//         minWidth: 300,
//         minHeight: 375
//     });
var audiovideocallcontainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#audiovideocallcontainer");audiovideocallcontainer.empty();if(_self.callDetails.videoCall){audiovideocallcontainer.append(videoContainerHTML);_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#agentyou").hide();var gLocalVideo=document.getElementById('kore_local_video');gLocalVideo["srcObject"]=gLocalVideo["srcObject"];gLocalVideo["volume"]=0.0;var lLocalVideo=document.getElementById('kore_local_video_tmp');if(lLocalVideo){lLocalVideo["srcObject"]=gLocalVideo["srcObject"];lLocalVideo["volume"]=0.0;}var gRemoteVideo=document.getElementById('kore_remote_video');gRemoteVideo["volume"]=0.5;var lRemoteVideo=document.getElementById('kore_remote_video_tmp');if(gRemoteVideo&&lRemoteVideo){lRemoteVideo["srcObject"]=gRemoteVideo["srcObject"];lRemoteVideo["volume"]=0.5;}// koreJquery("#selfvideocontainer").draggable({
//     containment: ".video-audio-chat-container"
// });
_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#selfvideocontainer").css({"top":"65px","right":"15px","left":""});audiovideocallcontainer.css({"position":"absolute","width":"90%","height":"74%","top":"24%","background-color":"black"});var showselfvideocontainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#showselfvideocontainer").hide();var closeselfvideo=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#closeselfvideo");closeselfvideo.off('click').on('click',function(event){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#selfvideocontainer").hide();showselfvideocontainer.show();});showselfvideocontainer.off('click').on('click',function(event){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#selfvideocontainer").show();showselfvideocontainer.hide();});var maximizevideo=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#maximizevideo");maximizevideo.off('click').on('click',function(event){var elem=document.getElementById("audiovideocallcontainer");if(!_self.fullScreen){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#selfvideocontainer").css({"top":"174px","right":"15px","left":""});// koreJquery("#selfvideocontainer").draggable({
//     containment: "document"
// });
_self.fullScreen=true;if(elem.requestFullscreen){elem.requestFullscreen();}else if(elem.webkitRequestFullscreen){/* Safari */elem.webkitRequestFullscreen();}else if(elem.msRequestFullscreen){/* IE11 */elem.msRequestFullscreen();}}else{_self.fullScreen=false;document.exitFullscreen();// koreJquery("#selfvideocontainer").draggable({
//     containment: ".video-audio-chat-container"
// });
_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#selfvideocontainer").css({"top":"65px","right":"15px","left":""});}});}else{audiovideocallcontainer.append(audioContainerHTML);}_self.disableMinimizeButton(true);_self.showFooterButtons(true,_self.callDetails.videoCall);},1000);};this.disableMinimizeButton=function(flag){var minBtns=document.getElementsByClassName("minimize-btn");if(minBtns&&minBtns.length>0){minBtns[0].disabled=flag;}};this.callConnecting=function(videoCall,agentName){var videoAudoStr=videoCall?'Video':'Audio';var callConnectingHTML="<div class=\"video-audio-chat-container\">\n            <div class=\"video-chat-\">\n                <div class=\"video-name-title\">".concat(agentName,"</div>\n                <div id=\"video_view\" class=\"video-view- audio-view-\">\n                    <div class=\"agent-profile-img\">\n                        <img style='height: 30px; width:30px; top:0px;left:0px;position: absolute; border-radius: 50%;'\n                            src=\"").concat(_self.agentProfileIcon,"\"> \n                    </div>\n                    <div class=\"title\">Connecting ").concat(videoAudoStr," Call...</div>\n                    <div class=\"audio-info\">Disconnecting ").concat(videoAudoStr," call doesn't end conversation</div>\n                </div>\t\t\t\t\t\t\t\t\t\t\n            </div>\n            <div id=\"callbuttons\"></div>\n        </div>");var callContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#callcontainer");callContainer.empty();callContainer.append(callConnectingHTML);// callContainer.css({
//     "top":  koreJquery(".kore-chat-window").offset().top,
//     "left" : koreJquery(".kore-chat-window").offset().left - koreJquery(".kore-chat-window").width
// })
// callContainer.draggable({
//     handle: koreJquery('#callcontainer').find(".video-name-title"),
//     containment: "document",
// })
//     .resizable({
//         handles: "n, e, w, s",
//         containment: "document",
//         minWidth: 300,
//         minHeight: 375
//     });
_self.showFooterButtons(false,_self.callDetails.videoCall);};this.showScreenShareMessage=function(videoCall,agentName){var incomingCall="\n        <div class=\"initial-video-audio-container\">\n            <div class=\"ad-img-block\">\n                <img src=\"".concat(_self.agentProfileIcon,"\" />\n            </div>\n            <div class=\"content-desc\">\n                <div class=\"name\">").concat(agentName,"</div>\n                <div class=\"type-text\">is requesting for a screenshare</div>\n            </div>\n            <div class=\"controls-v-a\">\n                <img id=\"rejectcall\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMCSURBVHgBxZjPaxNBFMffzG43oFCSo1gwMW3BUxPwR/HSBKwUT/XeYIX2asV/IO1/YC+CtFBLejdHaYXGW7ViVy8e2pL14k0SCoLdpDu+t/lhkmbNTDY/vpDsJHmb/fDezLz3hoGi8tOJsFPW50FjUyBYAgQEgeGLJKCIYwtHFjjOB7tczt4yc5bK/zNZw5M7s4sc4IlgCKEmUwixPn6490bGuCPQ8e0HCc75Fg7D4E8Wgq11AvMEOoolgsERI+0weA69lGAvz0rna3EzVwRZoO+xRNgwjLc4jEF/ZNm2nWw3v5gHzD74D1FXUE1AFKZRwzgaAExN5hlCNYaPN/5Kc2aAMKTY6Egg3fhF3UO0rBljWzAEOY6TnPj8PkfjuocQJg1DUnVbqYzpjbwDgw1Vq8JVhgoQemdF9k5jMiprqmRLWcC90jIHyf0mMHkTxjKvILSc6mgbWl5wbWWhKCX9vP/ohvZibHwRXTQnc9PFr0L1YSlyK/z58s0TJrSUgsLGDvzey4GsbCF+6KDxGczS0ips7vyDos8bGU+YwmYGVIRhm9IRJgyK8oLyA+NKiEQFSLoI8YaiYsgXTEVBvV5cdaHLnvIF4wJx8CvmMe5SerXs7MpLjXPGDZnHRFdQkUJGmVYZyGsC+4ISYGnPrkfjTLEQ84Kp7Uud9ilPHgYftZVrkbDsxvg/mF5A4W79mnNdz8reQKlDZmnT6qOQhZYWlPKZzljWXRcn92b3mZBrbwITUTg/PpUxVbLF+WNGD3fjlWXvwDZISvoBirYCxDpd6zvH6d2HeRheTWRFP+1GaFDfGLGMfApDEjWQtXEdiGpaanlhwGpts5tSh1YqrWIMTRicLO1qabXxiyagCPZHjPPHZAgDgMHiPhnJNbfUl5Jr5OCda9hnKNOFwWe1/tA227tQth3vx5yi/+RX7LYwpI4FQ7WB7EVHa9FKrjWEXlI6sKq2S0qJGD2Sw8t2zw6sWpWfnsMjvfI8tpszQF6rlMCNR3r4QogL8ZXr5WzkQO1I7y91mFsdhEgKrAAAAABJRU5ErkJggg==\"  />\n                <img id=\"acceptcall\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMfSURBVHgBxZg/TBNRHMe/v1cQCTGpCerg4AHGlEXEwZWDiDLS4GBjohJjIokJRF2IA7Az2NGpEmM6GRwN/isxDsACLt6kNyhBoqYJktIW7vl+154tWuiV67Xfpb+7+11/n7zfu997v0eoUKGYrlFTw6Ak6gJIJ2kFlR3kZyRl0hJkKssUljUvafuFEUmYlfw/uXUMPeu/CYEbytRRgSRhmXYQNa69euLGvyxQ6OlFHQ0UU6YGbzJhYaoc2J5AWkwPNjcfmpBSjqGKIqJHqVRmyhxOJEs+L3UzFNc1SY2zJHEO/sgEsr2l5heVggEa38F7ig4EJYovOE01grHDcRZyMfcA4jlTIxhbPCXyMQv3HCP/WcdQF0mVutcJtgojJDCBuoliBQzkR6eGqSohLc+QA1LVdBT1Vm4VgODPnMi3eoOTLSewODSLULC9nKve+bzvlCDZMAifxDAzfdN48/UDjOTn8i+kRVhYAj3wQQ7M0voKxhemXb3DOwgBizRUWQeByUsXAlJDFeUBRi28CApnc7WfjjS24MLxs+XcPMGwpFRAbhw7j562A4Xb+uEXjKPAsaH2MTVWh/dz+rb53V5jxs+PYCPzGys/DV9gVMqSgdYrHXeUXTZti+sfbah7Xbfs6yV1XQzDoLfnH8KL1ObNCLQOdXTDZWFkKA58Pw+1qkbOgbn+9gEyVhZeJEELnDJNoQ24fYnTtbq5Zqcv3H4ZP1K/bJiN7Ca8Skj5WKXszJpiq2jfzFWXoZoCh3D3/WRVYGxRw4i9HwrF+3mXqKOOUvNn+dPVuW7ns59BnaW6myj/FnaM8UtfUOWq7V5kGpG5NraKCqM1jLpJTjnWXyDe06o+PYoaSy0XUSNS6GZ3LR2p9M6kclhGzURmOp2dLL6zC4jbW6JAmB1RAxgVvvfflvq/xdWIvLQd/YTiExGOkYu1WyVXe3bc2sp0+zGneM6kU9mSMKzyxzFxbk9owntJ4BG3hp2GcE8vuBSDqeI1qipqhR2KTKgwM8VfUlWACmADGsntQZXsHsuCJkDq0AD5Iz0kla0mqaVKCK0c5EjvD7WHTOQEQMMGAAAAAElFTkSuQmCC\" />\n            </div>\n        </div>");var toastContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#toast");toastContainer.empty();toastContainer.append(incomingCall);var rejectCall=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#rejectcall");var acceptCall=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#acceptcall");rejectCall.off('click').on('click',function(event){if(_self.activeCall&&_self.activeCall.isScreenSharing()){_self.sendControlMessage('screenshare_end');if(!_self.callDetails.videoCall){_self.sendVideo(false);}_self.activeCall.stopScreenSharing();}toastContainer.empty();});acceptCall.off('click').on('click',function(event){if(_self.activeCall){_self.screenShare(_self.callDetails);}toastContainer.empty();});};this.showIncomingCallMessage=function(videoCall,agentName){var audioVideoStr=videoCall?'video':'audio';var toastContainer=document.getElementById("toast");if(toastContainer){toastContainer.remove();toastContainer=null;}if(!toastContainer){toastContainer=document.createElement("div");toastContainer.id="toast";document.body.appendChild(toastContainer);}var incomingCall="\n        <div class=\"initial-video-audio-container\">\n            <div class=\"ad-img-block\">\n                <img src=\"".concat(_self.agentProfileIcon,"\" />\n            </div>\n            <div class=\"content-desc\">\n                <div class=\"name\">").concat(agentName,"</div>\n                <div class=\"type-text\">is trying to ").concat(audioVideoStr," call you</div>\n            </div>\n            <div class=\"controls-v-a\">\n                <img id=\"rejectcall\" src=\"").concat(rejectIcon,"\"/>\n                <img id=\"acceptcall\" src= \"").concat(acceptIcon,"\"/>\n            </div>\n        </div>");setTimeout(function(){var toastContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#toast");toastContainer.empty();toastContainer.append(incomingCall);var rejectCall=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#rejectcall");var acceptCall=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#acceptcall");rejectCall.off('click').on('click',function(event){if(_self.activeCall){_self.activeCall.terminate();}_self.callAccepted=false;toastContainer.empty();});acceptCall.off('click').on('click',function(event){_self.addAudioVideoContainer();_self.callConnecting(_self.callDetails.videoCall,_self.callDetails.firstName);_self.callAgent();toastContainer.empty();var timedOut=setTimeout(function(){// even after these many number of seconds call is not established then close the panel
if(_self.activeCall===null||!_self.activeCall.isEstablished()){_self.callTerminated();}// if (_self.activeCall !== null) {
//     _self.activeCall.terminate();
// }
clearTimeout(timedOut);},30000);});},100);};this.showCobrowseRequest=function(cobrowseRequest){var me=this;// let cwInstance = me.hostInstance;
var toastContainer=document.getElementById("toast");if(toastContainer){toastContainer.remove();toastContainer=null;}if(!toastContainer){toastContainer=document.createElement("div");toastContainer.id="toast";document.body.appendChild(toastContainer);}var cobrowsetoolbar=document.getElementById("cobrowse-toolbar");if(cobrowsetoolbar){cobrowsetoolbar.remove();}var agentName=cobrowseRequest===null||cobrowseRequest===void 0?void 0:cobrowseRequest.firstName;var cobrowseRequestHML="\n        <div class=\"initial-video-audio-container\">\n            <div class=\"ad-img-block\">\n                <img src=\"".concat(_self.agentProfileIcon,"\" />\n            </div>\n            <div class=\"content-desc\">\n                <div class=\"name\">").concat(agentName,"</div>\n                <div class=\"type-text\">is requesting a CoBrowse session with you</div>\n            </div>\n            <div class=\"controls-v-a\">\n                <img id=\"rejectcall\" src=\"").concat(rejectIcon,"\"/>\n                <img id=\"acceptcall\" src= \"").concat(acceptIcon,"\"/>\n            </div>\n        </div>");var toastContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#toast");toastContainer.empty();toastContainer.append(cobrowseRequestHML);var rejectCall=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#rejectcall");var acceptCall=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#acceptcall");rejectCall.off('click').on('click',function(event){toastContainer.empty();});acceptCall.off('click').on('click',function(event){toastContainer.empty();//_self.initializeCoBrowse(cobrowseRequest);
cobrowseRequest["userId"]=uuId;me.cobrowseInitialize(cobrowseRequest);localStorage.setItem("cobrowseRequest",JSON.stringify(cobrowseRequest));});};this.sendCoBrowseEvent=function(convId,evt){_self.socket.emit("cobrowseevent",{"room":convId,"event":evt},function(ack){console.log("sent and received ack",ack);});};if(window&&window.KoreSDK&&window.KoreSDK.dependencies&&window.KoreSDK.dependencies.jQuery){//load kore's jquery version
_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__=window.KoreSDK.dependencies.jQuery;}else{//fall back to clients jquery version
_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__=__webpack_provided_window_dot_jQuery;}function overrideCloseButton(){if(overrideFlag){return;}var closeBtns=document.getElementsByClassName("close-btn");if(closeBtns&&closeBtns.length>0){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__(".close-btn").off('click').on('click',function(event){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#smartassist-menu").show();});overrideFlag=true;}else{console.log("close button not found");}}console.log("window.KoreSDK",window.KoreSDK,uuId);var events=(0,_components_base_sdk_kore_bot_sdk_client__WEBPACK_IMPORTED_MODULE_4__["default"])('/KoreBot.js').instance();var originalSendMessageFunction=events.sendMessage;botInstance.sendMessage=function sendMessage(message,optCb){var pagesVisited=localStorage.getItem("pagesVisited");var pagesVisitedArray=[];if(pagesVisited&&pagesVisited!='[]'){pagesVisitedArray=JSON.parse(pagesVisited);// calculate time spent on last item
var obj=pagesVisitedArray[0];var start=moment__WEBPACK_IMPORTED_MODULE_1___default()(obj.timestamp);var end=moment__WEBPACK_IMPORTED_MODULE_1___default()();var duration=moment__WEBPACK_IMPORTED_MODULE_1___default().duration(end.diff(start));var seconds=duration.asSeconds();obj['timespent']=seconds;obj['domain']=window.location.hostname;}localStorage.setItem("pagesVisited",JSON.stringify(pagesVisitedArray));message["agentDesktopMeta"]={"pagesVisited":pagesVisitedArray};originalSendMessageFunction.call(this,message,optCb);};var overrideFlag=false;botInstance.on('message',function(message){overrideCloseButton();var msgJson=JSON.parse(message.data);if(msgJson.type==='events'&&msgJson.message&&msgJson.message.type==='call_agent_webrtc'){//koreJquery("#rejectPhone").show();
_self.callDetails=msgJson.message;_self.agentProfileIcon=_self.userIcon;if(_self.callDetails.profileIcon&&_self.callDetails.profileIcon!=='undefined'){_self.agentProfileIcon=_self.callDetails.profileIcon;}console.log('payload=',msgJson.message);_self.callAccepted=false;_self.showPhonePanel=true;if(_self.callDetails.restoreCall){if(_self.activeCall){_self.activeCall.terminate();}_self.callAgent();_self.callAccepted=true;_self.showVideo=true;}else{_this2.showIncomingCallMessage(_self.callDetails.videoCall,_self.callDetails.firstName);}}else if(msgJson.type==='events'&&msgJson.message&&msgJson.message.type==='terminate_agent_webrtc'){_self.removeAudoVideoContainer();_self.showPhonePanel=false;_self.showVideo=false;if(_self.activeCall){_self.activeCall.terminate();_self.phone.deinit();}var toastContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#toast");toastContainer.empty();}// webrtc_screenshare will be sent, when in video call
else if(msgJson.type==='events'&&msgJson.message&&msgJson.message.type==='webrtc_screenshare'){/*if (_self.activeCall) {
                    _self.screenShare(msgJson.message);
                }*/_this2.showScreenShareMessage(_self.callDetails.videoCall,_self.callDetails.firstName);}else if(msgJson.type==='events'&&msgJson.message&&msgJson.message.type==='webrtc_screenshare_cancel'){if(!_self.callDetails.videoCall){//_self.activeCall.stopSendingVideo();
_self.sendVideo(false);}if(_self.screenSharingStream){_self.phone.closeScreenSharing();}if(_self.activeCall&&_self.activeCall.isScreenSharing()){_self.activeCall.stopScreenSharing();}}else if(msgJson.type==='events'&&msgJson.message&&msgJson.message.type==='cobrowse'){console.log("cobrowse request ",msgJson.message);_self.maskClassList=msgJson.message.blockClasses;_self.maskPatternList=msgJson.message.patternList;if(_self.maskPatternList){_self.scanElement(document.body,_self.maskPatternList);}_self.cobrowseMaskFields(msgJson.message);_self.agentProfileIcon=_self.userIcon;if(msgJson.message.profileIcon&&msgJson.message.profileIcon!=='undefined'){_self.agentProfileIcon=msgJson.message.profileIcon;}_this2.showCobrowseRequest(msgJson.message);}else if(msgJson.type==='events'&&msgJson.message&&msgJson.message.type==='close_cobrowse'){var toastContainer=_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#toast");toastContainer.empty();_this2.stopCoBrowse(false);}else if(msgJson.type==='events'&&msgJson.message&&msgJson.message.type==='clear_pagevisit_history'){localStorage.removeItem("pagesVisited");var pagesVisitedArray=[];var pageTitle=_this2.getPageTitle();pagesVisitedArray.push({page:pageTitle,timestamp:new (moment__WEBPACK_IMPORTED_MODULE_1___default())()});localStorage.setItem("pagesVisited",JSON.stringify(pagesVisitedArray));}});this.getPageTitle=function(){var title=document.title;var metaTags=document.getElementsByTagName("meta");if(metaTags&&metaTags.length>0){for(var i=0;i<metaTags.length;i++){if(metaTags[i].name==='title'||metaTags[i].name==='og:title'){title=metaTags[i].content;}}}console.log("page title ",title);return title;};this.addAudioVideoContainer=function(){var koreChatBody=document.getElementsByClassName("kore-chat-body");var agentcontainer=document.getElementById("agentcontainer");if(!agentcontainer){if(koreChatBody&&koreChatBody.length>0){var el=document.createElement("div");el.id="agentcontainer";el.style.height='25%';koreChatBody[0].parentNode.insertBefore(el,koreChatBody[0]);koreChatBody[0].style.position='relative';}}else{agentcontainer.style.display='block';}if(!_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#callcontainer").length){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#agentcontainer").append("<div id=\"callcontainer\" class=\"callcontainer\"></div>");/* koreJquery("#callcontainer").css({
                     "top":  koreJquery(".kore-chat-window").offset().top,
                     "left" : koreJquery(".kore-chat-window").offset().left - koreJquery(".kore-chat-window").width
                })*/}koreChatBody[0].style.top="0px";koreChatBody[0].style.height="54%";var koreChatWindow=document.getElementsByClassName("kore-chat-window");koreChatWindow[0].style.top="0px";koreChatWindow[0].style.maxHeight='99%';koreChatWindow[0].style.height='97%';};this.removeAudoVideoContainer=function(){var koreChatBody=document.getElementsByClassName("kore-chat-body");var agentcontainer=document.getElementById("agentcontainer");if(agentcontainer){agentcontainer.style.display='none';koreChatBody[0].style.height='78%';}};this.sendVideo=function(flag){var localVideoTmp=document.getElementById("kore_local_video_tmp");if(!localVideoTmp){localVideoTmp=document.getElementById("kore_local_video");}var localStream=localVideoTmp["srcObject"];if(localStream&&localStream.getVideoTracks()){localStream.getVideoTracks().forEach(function(track){return track.enabled=flag;});}};//this.updateGui();
this.screenShare=function(data){var _this3=this;var p=Promise.resolve();if(!this.callDetails.videoCall&&this.activeCall.hasEnabledSendVideo()){//_self.activeCall.stopSendingVideo();
this.sendVideo(false);}return p.then(function(){if(_this3.screenSharingStream===null){return _this3.phone.openScreenSharing().then(function(stream){_this3.screenSharingStream=stream;_this3.screenSharingStream.getVideoTracks()[0].onended=function(){me.sendVideo(me.callDetails.videoCall);me.sendControlMessage('screenshare_end');};});}}).then(function(){_this3.sendControlMessage('screenshare_start');_this3.sendVideo(true);return _this3.activeCall.startScreenSharing(_this3.screenSharingStream);})["catch"](function(e){console.log('guiScreenSharing: error: '+e);_this3.sendControlMessage('screenshare_end');})["finally"](function(){});};this.initSipStack=function(account,serverConfig){console.log('this.phoneConfig',this.phoneConfig);this.phone.setServerConfig(serverConfig.addresses,serverConfig.domain,serverConfig.iceServers);this.phone.setReconnectIntervals(this.phoneConfig.reconnectIntervalMin,this.phoneConfig.reconnectIntervalMax);this.phone.setRegisterExpires(this.phoneConfig.registerExpires);this.phone.setUseSessionTimer(this.phoneConfig.useSessionTimer);this.phone.setDtmfOptions(this.phoneConfig.dtmfUseWebRTC,this.phoneConfig.dtmfDuration,this.phoneConfig.dtmfInterToneGap);this.phone.setBrowsersConstraints(this.phoneConfig.constraints);this.phone.setEnableAddVideo(this.phoneConfig.enableAddVideo);this.phone.setAcLogger(console.log);this.phone.setModes(this.phoneConfig.modes);this.phone.setAccount(account.user,account.displayName,account.password);var self=this;// Set phone API listeners
this.phone.setListeners({loginStateChanged:function loginStateChanged(isLogin,cause){switch(cause){case"connected":console.log('phone>>> loginStateChanged: connected');self._makeCall();//guiMakeCall(callTo);
break;case"disconnected":console.log('phone>>> loginStateChanged: disconnected');break;case"login failed":console.log('phone>>> loginStateChanged: login failed');break;case"login":console.log('phone>>> loginStateChanged: login');break;case"logout":console.log('phone>>> loginStateChanged: logout');break;}},callScreenSharingEnded:function callScreenSharingEnded(call,stream){console.log('phone>>> callScreenSharingEnded',call);//_self.sendControlMessage('screenshare_end');
//_self.phone.closeScreenSharing(_self.screenSharingStream);
//_self.sendVideo(_self.callDetails.videoCall);
_self.screenSharingStream=null;},outgoingCallProgress:function outgoingCallProgress(call,response){console.log('phone>>> outgoing call progress');},callTerminated:function callTerminated(call,message,cause,redirectTo){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#rejectPhone").show();console.log('phone>>> call terminated callback, cause=%o',cause);if(call!==self.activeCall){console.log('terminated no active call');return;}self.activeCall=null;console.warn('Call terminated: '+cause);self.phone.deinit();// Disconnect from SBC server.
console.log('call_terminated_panel');self.callAccepted=false;self.callMuted=false;self.showPhonePanel=false;self.showVideo=false;self.screenSharingStream=null;_self.callTerminated();},callConfirmed:function callConfirmed(call,message,cause){_self.callConnected(_self.callDetails.videoCall,_self.callDetails.firstName);console.log('phone>>> callConfirmed ',new Date(),call.hasReceiveVideo());var remoteVideoStream=call.getRTCRemoteStream();if(!self.callDetails.videoCall){//self.activeCall.stopSendingVideo();
_self.sendVideo(true);}console.log('call established');},callShowStreams:function callShowStreams(call,localStream,remoteStream){console.log('phone>>> callShowStreams');var remoteVideo=document.getElementById('kore_remote_video');console.log('remoteVideo',remoteVideo);remoteVideo.srcObject=remoteStream;// to play audio and optional video
remoteVideo["volume"]=0.5;console.log('remoteStream',remoteStream);var localVideo=document.getElementById('kore_local_video');localVideo.srcObject=localStream;// to play audio and optional video
localVideo.volume=0.0;localVideo.mute=false;var checkExist=setInterval(function(){if(document.getElementById("kore_remote_video_tmp")){var _remoteVideo=document.getElementById('kore_remote_video');_remoteVideo.srcObject=remoteStream;var remoteVideoTmp=document.getElementById('kore_remote_video_tmp');remoteVideoTmp.srcObject=_remoteVideo.srcObject;remoteVideoTmp["volume"]=0.5;clearInterval(checkExist);}},100);// check every 100ms
},incomingCall:function incomingCall(call,invite,replacedCall,hasSDP){console.log('phone>>> incomingCall',call,invite,replacedCall,hasSDP);call.data['incoming_invite_hasSDP']=hasSDP;call.reject();},callHoldStateChanged:function callHoldStateChanged(call,isHold,isRemote){console.log('phone>>> callHoldStateChanged '+isHold?'hold':0);}});console.log('Connecting...');self.phone.init(true);};this.sendControlMessage=function(msg){var sipURI=_self.callDetails.sipURI;var sipUser=sipURI.substring(sipURI.indexOf(':')+1,sipURI.indexOf('@'));_self.phone.sendMessage(sipUser,msg);};this.callAgent=function(){console.log('this.callDetails',this.callDetails);var sipURI=this.callDetails.sipURI;var sipUser=sipURI.substring(sipURI.indexOf(':')+1,sipURI.indexOf('@'));console.log('sipURI',sipURI,'sipUser',sipUser,this.phone.VIDEO);var serverConfig={};serverConfig.addresses=this.callDetails.addresses;serverConfig.domain=this.callDetails.domain;serverConfig.iceServers=[this.callDetails.domain];me.initSipStack({user:uuId,displayName:uuId,password:''},serverConfig);};this._makeCall=function(){var _this4=this;var sipURI=this.callDetails.sipURI;var sipUser=sipURI.substring(sipURI.indexOf(':')+1,sipURI.indexOf('@'));navigator.mediaDevices.getUserMedia({audio:true,video:true}).then(function(stream){stream.getTracks().forEach(function(track){track.stop();});_this4.activeCall=_this4.phone.call(_this4.phone.VIDEO,sipUser);});};this.toggleButtons=function(){if(!this.callAccepted){if(this.callDetails&&!this.callDetails.videoCall){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#acceptPhone").html('<i id="mic-icon" class="fas fa-phone-volume"></i>');}else{_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#acceptPhone").html('<i id="mic-icon" class="fas fa-video"></i>');}_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#mutePhone").show();}else{if(this.callDetails&&!this.callDetails.videoCall){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#acceptPhone").html('<i id="mic-icon" class="fas fa-phone-slash"></i>');}else{_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#acceptPhone").html('<i id="mic-icon" class="fas fa-video-slash"></i>');}_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#rejectPhone").hide();_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#mutePhone").show();}if(!this.callMuted){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#mutePhone").html('<i id="mic-icon" class="fas fa-microphone">');}else{_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#mutePhone").html('<i id="mic-icon" class="fas fa-microphone-slash">');}};this.updateGui=function(){this.toggleButtons();if(!this.showPhonePanel){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#phonepanel").hide();}else{_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#phonepanel").show();}if(!this.showVideo){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#video_view").hide();}else{_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#video_view").show();}};_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__('#acceptPhone').off('click').on('click',function(event){_self.callAccepted=!_self.callAccepted;_self.showVideo=!_self.showVideo;if(_self.callAccepted){_self.callAgent();}else{if(_self.activeCall){_self.activeCall.terminate();}_self.showPhonePanel=false;}_self.updateGui();});_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__('#rejectPhone').off('click').on('click',function(event){if(_self.activeCall){_self.activeCall.terminate();}_self.callAccepted=false;_self.showPhonePanel=false;_self.updateGui();});_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__('#mutePhone').off('click').on('click',function(event){_self.callMuted=!_self.callMuted;var muted=_self.activeCall.isAudioMuted();_self.activeCall.muteAudio(!muted);_self.updateGui();});if(!_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#toast").length){_libs_korejquery__WEBPACK_IMPORTED_MODULE_3__("#chatContainer").append("<div id=\"toast\"></div>");}});_defineProperty(this,"noControlImage","data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMDAwMDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciICB2aWV3Qm94PSIwIDAgNTAgNTAiIHdpZHRoPSI1MHB4IiBoZWlnaHQ9IjUwcHgiPjxwYXRoIGQ9Ik0gOSAzIEMgNi4yNTM5MDYgMyA0IDUuMjUzOTA2IDQgOCBMIDQgMzQgQyA0IDM2Ljc0NjA5NCA2LjI1MzkwNiAzOSA5IDM5IEwgMTIuOTE3OTY5IDM5IEMgMTIuODk4NDM4IDQwLjEyMTA5NCAxMi45MDYyNSA0MS4yNjE3MTkgMTIuNjU2MjUgNDIuMTkxNDA2IEMgMTIuMzMyMDMxIDQzLjQxNDA2MyAxMS43NjE3MTkgNDQuMzc4OTA2IDEwLjQ4NDM3NSA0NS4xNDA2MjUgQyAxMC4xMDE1NjMgNDUuMzc1IDkuOTE3OTY5IDQ1LjgzMjAzMSAxMC4wMzkwNjMgNDYuMjY1NjI1IEMgMTAuMTU2MjUgNDYuNjk5MjE5IDEwLjU1MDc4MSA0NyAxMSA0NyBDIDE1LjIzODI4MSA0NyAxOS40MTQwNjMgNDQuNzIyNjU2IDIxLjYxMzI4MSAzOSBMIDQxIDM5IEMgNDMuNzQ2MDk0IDM5IDQ2IDM2Ljc0NjA5NCA0NiAzNCBMIDQ2IDggQyA0NiA1LjI1MzkwNiA0My43NDYwOTQgMyA0MSAzIFogTSA5IDUgTCA0MSA1IEMgNDIuNjU2MjUgNSA0NCA2LjM0Mzc1IDQ0IDggTCA0NCAzNCBDIDQ0IDM1LjY1NjI1IDQyLjY1NjI1IDM3IDQxIDM3IEwgMjEgMzcgQyAyMC41NzAzMTMgMzcgMjAuMTg3NSAzNy4yNzM0MzggMjAuMDUwNzgxIDM3LjY4MzU5NCBDIDE4LjYxNzE4OCA0MS45ODA0NjkgMTYuMzQzNzUgNDMuOTUzMTI1IDEzLjY4NzUgNDQuNjY0MDYzIEMgMTQuMDgyMDMxIDQ0LjAzOTA2MyAxNC40MTAxNTYgNDMuMzg2NzE5IDE0LjU5Mzc1IDQyLjcwNzAzMSBDIDE1LjAxNTYyNSA0MS4xMjg5MDYgMTUgMzkuNSAxNSAzOCBDIDE1IDM3LjQ0OTIxOSAxNC41NTA3ODEgMzcgMTQgMzcgTCA5IDM3IEMgNy4zNDM3NSAzNyA2IDM1LjY1NjI1IDYgMzQgTCA2IDggQyA2IDYuMzQzNzUgNy4zNDM3NSA1IDkgNSBaIE0gMTQuNDI5Njg4IDkgTCAxMyAxMC40Mjk2ODggTCAxNS4xNDA2MjUgMTQgTCAxNi41ODU5MzggMTQgTCAyMS4xMDkzNzUgMTguNTI3MzQ0IEwgMjIuNTI3MzQ0IDE3LjEwOTM3NSBMIDE4IDEyLjU4NTkzOCBMIDE4IDExLjE0MDYyNSBaIE0gMzEgOSBDIDI3LjY4NzUgOSAyNSAxMS42ODc1IDI1IDE1IEMgMjUgMTUuNzM0Mzc1IDI1LjE0MDYyNSAxNi40Mzc1IDI1LjM3ODkwNiAxNy4wODU5MzggTCAxMy43MzQzNzUgMjguNzM0Mzc1IEMgMTMuNjE3MTg4IDI4Ljg0NzY1NiAxMy41MTE3MTkgMjguOTc2NTYzIDEzLjQyMTg3NSAyOS4xMTMyODEgQyAxMy4zODI4MTMgMjkuMTc1NzgxIDEzLjM1MTU2MyAyOS4yNDIxODggMTMuMzE2NDA2IDI5LjMwODU5NCBDIDEzLjI3MzQzOCAyOS4zODI4MTMgMTMuMjI2NTYzIDI5LjQ2MDkzOCAxMy4xOTE0MDYgMjkuNTQyOTY5IEMgMTMuMTU2MjUgMjkuNjI1IDEzLjEzNjcxOSAyOS43MTA5MzggMTMuMTA5Mzc1IDI5Ljc5Njg3NSBDIDEzLjA4OTg0NCAyOS44NjcxODggMTMuMDYyNSAyOS45Mzc1IDEzLjA0Njg3NSAzMC4wMTE3MTkgQyAxMi45ODQzNzUgMzAuMzMyMDMxIDEyLjk4NDM3NSAzMC42NjQwNjMgMTMuMDQ2ODc1IDMwLjk4ODI4MSBDIDEzLjA2MjUgMzEuMDYyNSAxMy4wODk4NDQgMzEuMTI4OTA2IDEzLjEwOTM3NSAzMS4yMDMxMjUgQyAxMy4xMzY3MTkgMzEuMjg1MTU2IDEzLjE1NjI1IDMxLjM3NSAxMy4xOTE0MDYgMzEuNDUzMTI1IEMgMTMuMjI2NTYzIDMxLjUzOTA2MyAxMy4yNjk1MzEgMzEuNjEzMjgxIDEzLjMxMjUgMzEuNjg3NSBDIDEzLjM0NzY1NiAzMS43NTM5MDYgMTMuMzc4OTA2IDMxLjgyMDMxMyAxMy40MjE4NzUgMzEuODg2NzE5IEMgMTMuNjA1NDY5IDMyLjE2MDE1NiAxMy44Mzk4NDQgMzIuMzk0NTMxIDE0LjExMzI4MSAzMi41NzgxMjUgQyAxNC4xNzU3ODEgMzIuNjE3MTg4IDE0LjI0MjE4OCAzMi42NDg0MzggMTQuMzA4NTk0IDMyLjY4MzU5NCBDIDE0LjM4NjcxOSAzMi43MjY1NjMgMTQuNDYwOTM4IDMyLjc3MzQzOCAxNC41NDY4NzUgMzIuODA4NTk0IEMgMTQuNjI4OTA2IDMyLjg0Mzc1IDE0LjcxNDg0NCAzMi44NjMyODEgMTQuNzk2ODc1IDMyLjg4NjcxOSBDIDE0Ljg3MTA5NCAzMi45MDYyNSAxNC45Mzc1IDMyLjkzMzU5NCAxNS4wMTE3MTkgMzIuOTQ5MjE5IEMgMTUuMzM1OTM4IDMzLjAxMTcxOSAxNS42Njc5NjkgMzMuMDExNzE5IDE1Ljk4ODI4MSAzMi45NDkyMTkgQyAxNi4wNjI1IDMyLjkzMzU5NCAxNi4xMzI4MTMgMzIuOTA2MjUgMTYuMjAzMTI1IDMyLjg4NjcxOSBDIDE2LjI4OTA2MyAzMi44NjMyODEgMTYuMzc1IDMyLjg0Mzc1IDE2LjQ1NzAzMSAzMi44MDg1OTQgQyAxNi41MzkwNjMgMzIuNzczNDM4IDE2LjYxNzE4OCAzMi43MjY1NjMgMTYuNjkxNDA2IDMyLjY4MzU5NCBDIDE2Ljc1NzgxMyAzMi42NDg0MzggMTYuODI0MjE5IDMyLjYxNzE4OCAxNi44ODY3MTkgMzIuNTc4MTI1IEMgMTcuMDIzNDM4IDMyLjQ4NDM3NSAxNy4xNTIzNDQgMzIuMzgyODEzIDE3LjI2NTYyNSAzMi4yNjU2MjUgTCAyOC45MTQwNjMgMjAuNjIxMDk0IEMgMjkuNTYyNSAyMC44NTkzNzUgMzAuMjY1NjI1IDIxIDMxIDIxIEMgMzQuMzEyNSAyMSAzNyAxOC4zMTI1IDM3IDE1IEMgMzcgMTQuMDc0MjE5IDM2Ljc4NTE1NiAxMy4xOTkyMTkgMzYuNDEwMTU2IDEyLjQxNzk2OSBMIDMxLjkxNDA2MyAxNi45MTQwNjMgTCAyOS4wODU5MzggMTQuMDg1OTM4IEwgMzMuNTgyMDMxIDkuNTg5ODQ0IEMgMzIuODAwNzgxIDkuMjE0ODQ0IDMxLjkyNTc4MSA5IDMxIDkgWiBNIDI5Ljk0OTIxOSAyMi40MTQwNjMgTCAyNi40MTQwNjMgMjUuOTUzMTI1IEwgMzIuNzM0Mzc1IDMyLjI2OTUzMSBDIDMyLjg0NzY1NiAzMi4zODY3MTkgMzIuOTc2NTYzIDMyLjQ4ODI4MSAzMy4xMTMyODEgMzIuNTc4MTI1IEMgMzMuMTc1NzgxIDMyLjYyMTA5NCAzMy4yNDIxODggMzIuNjUyMzQ0IDMzLjMwODU5NCAzMi42ODc1IEMgMzMuMzgyODEzIDMyLjczMDQ2OSAzMy40NjA5MzggMzIuNzc3MzQ0IDMzLjU0Mjk2OSAzMi44MTI1IEMgMzMuNjI1IDMyLjg0Mzc1IDMzLjcxMDkzOCAzMi44NjMyODEgMzMuNzk2ODc1IDMyLjg5MDYyNSBDIDMzLjg2NzE4OCAzMi45MTAxNTYgMzMuOTM3NSAzMi45Mzc1IDM0LjAxMTcxOSAzMi45NTMxMjUgQyAzNC4zMzIwMzEgMzMuMDE1NjI1IDM0LjY2NDA2MyAzMy4wMTU2MjUgMzQuOTg4MjgxIDMyLjk1MzEyNSBDIDM1LjA2MjUgMzIuOTM3NSAzNS4xMjg5MDYgMzIuOTEwMTU2IDM1LjIwMzEyNSAzMi44OTA2MjUgQyAzNS4yODUxNTYgMzIuODYzMjgxIDM1LjM3MTA5NCAzMi44NDM3NSAzNS40NTMxMjUgMzIuODEyNSBDIDM1LjUzOTA2MyAzMi43NzczNDQgMzUuNjEzMjgxIDMyLjczMDQ2OSAzNS42OTE0MDYgMzIuNjg3NSBDIDM1Ljc1NzgxMyAzMi42NTIzNDQgMzUuODI0MjE5IDMyLjYyMTA5NCAzNS44ODY3MTkgMzIuNTc4MTI1IEMgMzYuMTYwMTU2IDMyLjM5ODQzOCAzNi4zOTQ1MzEgMzIuMTYwMTU2IDM2LjU3ODEyNSAzMS44ODY3MTkgQyAzNi42MjEwOTQgMzEuODI0MjE5IDM2LjY0ODQzOCAzMS43NTc4MTMgMzYuNjg3NSAzMS42OTE0MDYgQyAzNi43MjY1NjMgMzEuNjEzMjgxIDM2Ljc3MzQzOCAzMS41MzkwNjMgMzYuODA4NTk0IDMxLjQ1MzEyNSBDIDM2Ljg0Mzc1IDMxLjM3MTA5NCAzNi44NjMyODEgMzEuMjg1MTU2IDM2Ljg5MDYyNSAzMS4yMDMxMjUgQyAzNi45MTAxNTYgMzEuMTI4OTA2IDM2LjkzNzUgMzEuMDYyNSAzNi45NTMxMjUgMzAuOTg4MjgxIEMgMzcuMDE1NjI1IDMwLjY2Nzk2OSAzNy4wMTU2MjUgMzAuMzM1OTM4IDM2Ljk1MzEyNSAzMC4wMTE3MTkgQyAzNi45Mzc1IDI5LjkzNzUgMzYuOTEwMTU2IDI5Ljg3MTA5NCAzNi44OTA2MjUgMjkuNzk2ODc1IEMgMzYuODYzMjgxIDI5LjcxNDg0NCAzNi44NDM3NSAyOS42Mjg5MDYgMzYuODA4NTk0IDI5LjU0Njg3NSBDIDM2Ljc3MzQzOCAyOS40NjA5MzggMzYuNzI2NTYzIDI5LjM4NjcxOSAzNi42ODM1OTQgMjkuMzA4NTk0IEMgMzYuNjQ4NDM4IDI5LjI0MjE4OCAzNi42MTcxODggMjkuMTc1NzgxIDM2LjU3ODEyNSAyOS4xMTMyODEgQyAzNi40ODQzNzUgMjguOTc2NTYzIDM2LjM4MjgxMyAyOC44NDc2NTYgMzYuMjY1NjI1IDI4LjczNDM3NSBaIi8+PC9zdmc+");_defineProperty(this,"releaseControlImage","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTkgM0M2LjI1MzkxIDMgNCA1LjI1MzkxIDQgOFYzNEM0IDM2Ljc0NjEgNi4yNTM5MSAzOSA5IDM5SDEyLjkxOEMxMi44OTg0IDQwLjEyMTEgMTIuOTA2MiA0MS4yNjE3IDEyLjY1NjIgNDIuMTkxNEMxMi4zMzIgNDMuNDE0MSAxMS43NjE3IDQ0LjM3ODkgMTAuNDg0NCA0NS4xNDA2QzEwLjEwMTYgNDUuMzc1IDkuOTE3OTcgNDUuODMyIDEwLjAzOTEgNDYuMjY1NkMxMC4xNTYzIDQ2LjY5OTIgMTAuNTUwOCA0NyAxMSA0N0MxNS4yMzgzIDQ3IDE5LjQxNDEgNDQuNzIyNyAyMS42MTMzIDM5SDQxQzQzLjc0NjEgMzkgNDYgMzYuNzQ2MSA0NiAzNFY4QzQ2IDUuMjUzOTEgNDMuNzQ2MSAzIDQxIDNIOVpNOSA1SDQxQzQyLjY1NjIgNSA0NCA2LjM0Mzc1IDQ0IDhWMzRDNDQgMzUuNjU2MiA0Mi42NTYyIDM3IDQxIDM3SDIxQzIwLjU3MDMgMzcgMjAuMTg3NSAzNy4yNzM0IDIwLjA1MDggMzcuNjgzNkMxOC42MTcyIDQxLjk4MDUgMTYuMzQzOCA0My45NTMxIDEzLjY4NzUgNDQuNjY0MUMxNC4wODIgNDQuMDM5MSAxNC40MTAyIDQzLjM4NjcgMTQuNTkzOCA0Mi43MDdDMTUuMDE1NiA0MS4xMjg5IDE1IDM5LjUgMTUgMzhDMTUgMzcuNDQ5MiAxNC41NTA4IDM3IDE0IDM3SDlDNy4zNDM3NSAzNyA2IDM1LjY1NjIgNiAzNFY4QzYgNi4zNDM3NSA3LjM0Mzc1IDUgOSA1Wk0xNC40Mjk3IDlMMTMgMTAuNDI5N0wxNS4xNDA2IDE0SDE2LjU4NTlMMjEuMTA5NCAxOC41MjczTDIyLjUyNzMgMTcuMTA5NEwxOCAxMi41ODU5VjExLjE0MDZMMTQuNDI5NyA5Wk0zMSA5QzI3LjY4NzUgOSAyNSAxMS42ODc1IDI1IDE1QzI1IDE1LjczNDQgMjUuMTQwNiAxNi40Mzc1IDI1LjM3ODkgMTcuMDg1OUwxMy43MzQ0IDI4LjczNDRDMTMuNjE3MiAyOC44NDc3IDEzLjUxMTcgMjguOTc2NiAxMy40MjE5IDI5LjExMzNDMTMuMzgyOCAyOS4xNzU4IDEzLjM1MTYgMjkuMjQyMiAxMy4zMTY0IDI5LjMwODZDMTMuMjczNCAyOS4zODI4IDEzLjIyNjYgMjkuNDYwOSAxMy4xOTE0IDI5LjU0M0MxMy4xNTYzIDI5LjYyNSAxMy4xMzY3IDI5LjcxMDkgMTMuMTA5NCAyOS43OTY5QzEzLjA4OTggMjkuODY3MiAxMy4wNjI1IDI5LjkzNzUgMTMuMDQ2OSAzMC4wMTE3QzEyLjk4NDQgMzAuMzMyIDEyLjk4NDQgMzAuNjY0MSAxMy4wNDY5IDMwLjk4ODNDMTMuMDYyNSAzMS4wNjI1IDEzLjA4OTggMzEuMTI4OSAxMy4xMDk0IDMxLjIwMzFDMTMuMTM2NyAzMS4yODUyIDEzLjE1NjMgMzEuMzc1IDEzLjE5MTQgMzEuNDUzMUMxMy4yMjY2IDMxLjUzOTEgMTMuMjY5NSAzMS42MTMzIDEzLjMxMjUgMzEuNjg3NUMxMy4zNDc3IDMxLjc1MzkgMTMuMzc4OSAzMS44MjAzIDEzLjQyMTkgMzEuODg2N0MxMy42MDU1IDMyLjE2MDIgMTMuODM5OCAzMi4zOTQ1IDE0LjExMzMgMzIuNTc4MUMxNC4xNzU4IDMyLjYxNzIgMTQuMjQyMiAzMi42NDg0IDE0LjMwODYgMzIuNjgzNkMxNC4zODY3IDMyLjcyNjYgMTQuNDYwOSAzMi43NzM0IDE0LjU0NjkgMzIuODA4NkMxNC42Mjg5IDMyLjg0MzcgMTQuNzE0OCAzMi44NjMzIDE0Ljc5NjkgMzIuODg2N0MxNC44NzExIDMyLjkwNjIgMTQuOTM3NSAzMi45MzM2IDE1LjAxMTcgMzIuOTQ5MkMxNS4zMzU5IDMzLjAxMTcgMTUuNjY4IDMzLjAxMTcgMTUuOTg4MyAzMi45NDkyQzE2LjA2MjUgMzIuOTMzNiAxNi4xMzI4IDMyLjkwNjIgMTYuMjAzMSAzMi44ODY3QzE2LjI4OTEgMzIuODYzMyAxNi4zNzUgMzIuODQzNyAxNi40NTcgMzIuODA4NkMxNi41MzkxIDMyLjc3MzQgMTYuNjE3MiAzMi43MjY2IDE2LjY5MTQgMzIuNjgzNkMxNi43NTc4IDMyLjY0ODQgMTYuODI0MiAzMi42MTcyIDE2Ljg4NjcgMzIuNTc4MUMxNy4wMjM0IDMyLjQ4NDQgMTcuMTUyMyAzMi4zODI4IDE3LjI2NTYgMzIuMjY1NkwyOC45MTQxIDIwLjYyMTFDMjkuNTYyNSAyMC44NTk0IDMwLjI2NTYgMjEgMzEgMjFDMzQuMzEyNSAyMSAzNyAxOC4zMTI1IDM3IDE1QzM3IDE0LjA3NDIgMzYuNzg1MiAxMy4xOTkyIDM2LjQxMDIgMTIuNDE4TDMxLjkxNDEgMTYuOTE0MUwyOS4wODU5IDE0LjA4NTlMMzMuNTgyIDkuNTg5ODRDMzIuODAwOCA5LjIxNDg0IDMxLjkyNTggOSAzMSA5Wk0yOS45NDkyIDIyLjQxNDFMMjYuNDE0MSAyNS45NTMxTDMyLjczNDQgMzIuMjY5NUMzMi44NDc3IDMyLjM4NjcgMzIuOTc2NiAzMi40ODgzIDMzLjExMzMgMzIuNTc4MUMzMy4xNzU4IDMyLjYyMTEgMzMuMjQyMiAzMi42NTIzIDMzLjMwODYgMzIuNjg3NUMzMy4zODI4IDMyLjczMDUgMzMuNDYwOSAzMi43NzczIDMzLjU0MyAzMi44MTI1QzMzLjYyNSAzMi44NDM4IDMzLjcxMDkgMzIuODYzMyAzMy43OTY5IDMyLjg5MDZDMzMuODY3MiAzMi45MTAyIDMzLjkzNzUgMzIuOTM3NSAzNC4wMTE3IDMyLjk1MzFDMzQuMzMyIDMzLjAxNTYgMzQuNjY0MSAzMy4wMTU2IDM0Ljk4ODMgMzIuOTUzMUMzNS4wNjI1IDMyLjkzNzUgMzUuMTI4OSAzMi45MTAyIDM1LjIwMzEgMzIuODkwNkMzNS4yODUyIDMyLjg2MzMgMzUuMzcxMSAzMi44NDM4IDM1LjQ1MzEgMzIuODEyNUMzNS41MzkxIDMyLjc3NzMgMzUuNjEzMyAzMi43MzA1IDM1LjY5MTQgMzIuNjg3NUMzNS43NTc4IDMyLjY1MjMgMzUuODI0MiAzMi42MjExIDM1Ljg4NjcgMzIuNTc4MUMzNi4xNjAyIDMyLjM5ODQgMzYuMzk0NSAzMi4xNjAyIDM2LjU3ODEgMzEuODg2N0MzNi42MjExIDMxLjgyNDIgMzYuNjQ4NCAzMS43NTc4IDM2LjY4NzUgMzEuNjkxNEMzNi43MjY2IDMxLjYxMzMgMzYuNzczNCAzMS41MzkxIDM2LjgwODYgMzEuNDUzMUMzNi44NDM3IDMxLjM3MTEgMzYuODYzMyAzMS4yODUyIDM2Ljg5MDYgMzEuMjAzMUMzNi45MTAyIDMxLjEyODkgMzYuOTM3NSAzMS4wNjI1IDM2Ljk1MzEgMzAuOTg4M0MzNy4wMTU2IDMwLjY2OCAzNy4wMTU2IDMwLjMzNTkgMzYuOTUzMSAzMC4wMTE3QzM2LjkzNzUgMjkuOTM3NSAzNi45MTAyIDI5Ljg3MTEgMzYuODkwNiAyOS43OTY5QzM2Ljg2MzMgMjkuNzE0OCAzNi44NDM3IDI5LjYyODkgMzYuODA4NiAyOS41NDY5QzM2Ljc3MzQgMjkuNDYwOSAzNi43MjY2IDI5LjM4NjcgMzYuNjgzNiAyOS4zMDg2QzM2LjY0ODQgMjkuMjQyMiAzNi42MTcyIDI5LjE3NTggMzYuNTc4MSAyOS4xMTMzQzM2LjQ4NDQgMjguOTc2NiAzNi4zODI4IDI4Ljg0NzcgMzYuMjY1NiAyOC43MzQ0TDI5Ljk0OTIgMjIuNDE0MVoiIGZpbGw9IiMwMDlEQUIiLz4KPC9zdmc+Cg==");_defineProperty(this,"pickColorImage","data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciICB2aWV3Qm94PSIwIDAgNDggNDgiIHdpZHRoPSI0OHB4IiBoZWlnaHQ9IjQ4cHgiPjxwYXRoIGZpbGw9IiNlOTFlNjMiIGQ9Ik0yNCw0djIwTDE0LDYuNjgxTDI0LDR6Ii8+PHBhdGggZmlsbD0iI2ZmNTcyMiIgZD0iTTM0LDYuNjgxTDQxLjMxOSwxNEwyNCwyNEwzNCw2LjY4MXoiLz48cGF0aCBmaWxsPSIjZjQ0MzM2IiBkPSJNMjQsNGwxMCwyLjY4MUwyNCwyNFY0eiIvPjxwYXRoIGZpbGw9IiM4YmMzNGEiIGQ9Ik0yNCw0NFYyNGwxMCwxNy4zMTlMMjQsNDR6Ii8+PHBhdGggZmlsbD0iIzAzYTlmNCIgZD0iTTE0LDQxLjMxOUw2LjY4MSwzNEwyNCwyNEwxNCw0MS4zMTl6Ii8+PHBhdGggZmlsbD0iIzRjYWY1MCIgZD0iTTI0LDQ0bC0xMC0yLjY4MUwyNCwyNFY0NHoiLz48cGF0aCBmaWxsPSIjZmY5ODAwIiBkPSJNNDQsMjRIMjRsMTcuMzE5LTEwTDQ0LDI0eiIvPjxwYXRoIGZpbGw9IiNmZmViM2IiIGQ9Ik00MS4zMTksMzRMMzQsNDEuMzE5TDI0LDI0TDQxLjMxOSwzNHoiLz48cGF0aCBmaWxsPSIjZmZjMTA3IiBkPSJNNDQsMjRsLTIuNjgxLDEwTDI0LDI0SDQ0eiIvPjxwYXRoIGZpbGw9IiMzZjUxYjUiIGQ9Ik00LDI0aDIwTDYuNjgxLDM0TDQsMjR6Ii8+PHBhdGggZmlsbD0iIzljMjdiMCIgZD0iTTYuNjgxLDE0TDE0LDYuNjgxTDI0LDI0TDYuNjgxLDE0eiIvPjxwYXRoIGZpbGw9IiM2NzNhYjciIGQ9Ik00LDI0bDIuNjgxLTEwTDI0LDI0SDR6Ii8+PC9zdmc+");_defineProperty(this,"drawEnabledImage","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzUiIHZpZXdCb3g9IjAgMCAzMiAzNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZCkiPgo8cGF0aCBkPSJNMjMuODI4MSAzQzIzLjMxNjQgMyAyMi44MDQ2IDMuMTk1NDQgMjIuNDE0MSAzLjU4NTk0TDIxIDVMMjYgMTBMMjcuNDE0MSA4LjU4NTk0QzI4LjE5NTEgNy44MDQ5NCAyOC4xOTUxIDYuNTM4ODEgMjcuNDE0MSA1Ljc1NzgxTDI1LjI0MjIgMy41ODU5NEMyNC44NTE3IDMuMTk1NDQgMjQuMzM5OSAzIDIzLjgyODEgM1pNMTkgN0w3LjAwMDAxIDE5TDguNTAwMDEgMTkuNUw5LjAwMDAxIDIyTDExLjUgMjIuNUwxMiAyNEwyNCAxMkwxOSA3Wk01LjE1MjM1IDIzLjE1MjNMNC4wMzcxMSAyNi4zMDg2QzQuMDEyMyAyNi4zNjkzIDMuOTk5NyAyNi40MzQ0IDQuMDAwMDEgMjYuNUM0LjAwMDAxIDI2LjYzMjYgNC4wNTI2OCAyNi43NTk4IDQuMTQ2NDUgMjYuODUzNkM0LjI0MDIyIDI2Ljk0NzMgNC4zNjc0IDI3IDQuNTAwMDEgMjdDNC41NjIwOSAyNy4wMDAzIDQuNjIzNjkgMjYuOTg5IDQuNjgxNjUgMjYuOTY2OEw3Ljg0NzY2IDI1Ljg0NzdMNS4xNTIzNSAyMy4xNTIzWiIgZmlsbD0iIzAwOURBQiIvPgo8L2c+CjxkZWZzPgo8ZmlsdGVyIGlkPSJmaWx0ZXIwX2QiIHg9Ii0zIiB5PSIwIiB3aWR0aD0iMzgiIGhlaWdodD0iMzgiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeT0iNCIvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIyIi8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9Im91dCIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4yNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8L2RlZnM+Cjwvc3ZnPgo=");_defineProperty(this,"drawDisabledImage","data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+PHN2ZyBmaWxsPSIjMDAwMDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciICB2aWV3Qm94PSIwIDAgMzAgMzAiIHdpZHRoPSIzMHB4IiBoZWlnaHQ9IjMwcHgiPiAgICA8cGF0aCBkPSJNIDIyLjgyODEyNSAzIEMgMjIuMzE2Mzc1IDMgMjEuODA0NTYyIDMuMTk1NDM3NSAyMS40MTQwNjIgMy41ODU5Mzc1IEwgMjAgNSBMIDI1IDEwIEwgMjYuNDE0MDYyIDguNTg1OTM3NSBDIDI3LjE5NTA2MiA3LjgwNDkzNzUgMjcuMTk1MDYyIDYuNTM4ODEyNSAyNi40MTQwNjIgNS43NTc4MTI1IEwgMjQuMjQyMTg4IDMuNTg1OTM3NSBDIDIzLjg1MTY4OCAzLjE5NTQzNzUgMjMuMzM5ODc1IDMgMjIuODI4MTI1IDMgeiBNIDE4IDcgTCA2IDE5IEwgNy41IDE5LjUgTCA4IDIyIEwgMTAuNSAyMi41IEwgMTEgMjQgTCAyMyAxMiBMIDE4IDcgeiBNIDQuMTUyMzQzOCAyMy4xNTIzNDQgTCAzLjAzNzEwOTQgMjYuMzA4NTk0IEEgMC41IDAuNSAwIDAgMCAzIDI2LjUgQSAwLjUgMC41IDAgMCAwIDMuNSAyNyBBIDAuNSAwLjUgMCAwIDAgMy42ODE2NDA2IDI2Ljk2Njc5NyBMIDYuODQ3NjU2MiAyNS44NDc2NTYgTCA0LjE1MjM0MzggMjMuMTUyMzQ0IHoiLz48L3N2Zz4=");_defineProperty(this,"eraserImage","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTciIGhlaWdodD0iMTciIHZpZXdCb3g9IjAgMCAxNyAxNyIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTExLjY2NjkgMC4zNDM3NUMxMS4wNzg2IDAuMzQzNzUgMTAuNDkwOSAwLjU2NjY3OSAxMC4wNDU4IDEuMDExNzJMMS4wMTMyNiAxMC4wNDU2QzAuMTIzMTgzIDEwLjkzNTcgMC4xMjMxODMgMTIuMzk5IDEuMDEzMjYgMTMuMjg5MUw0LjA0NTgxIDE2LjMyMTZDNC40MzkyNyAxNi43MTUxIDQuOTQ1NDcgMTYuOTI0NSA1LjQ2Mzc4IDE2Ljk3MDFDNS41Mjk1NCAxNi45OTA1IDUuNTk4MDYgMTcuMDAwNiA1LjY2NjkxIDE3SDExLjAwMDJDMTEuMDg4NiAxNy4wMDEyIDExLjE3NjMgMTYuOTg0OSAxMS4yNTgzIDE2Ljk1MkMxMS4zNDAyIDE2LjkxOSAxMS40MTQ5IDE2Ljg3MDEgMTEuNDc3OCAxNi44MDgxQzExLjU0MDcgMTYuNzQ2MSAxMS41OTA2IDE2LjY3MjIgMTEuNjI0NyAxNi41OTA3QzExLjY1ODggMTYuNTA5MiAxMS42NzY0IDE2LjQyMTcgMTEuNjc2NCAxNi4zMzMzQzExLjY3NjQgMTYuMjQ1IDExLjY1ODggMTYuMTU3NSAxMS42MjQ3IDE2LjA3NkMxMS41OTA2IDE1Ljk5NDUgMTEuNTQwNyAxNS45MjA2IDExLjQ3NzggMTUuODU4NkMxMS40MTQ5IDE1Ljc5NjUgMTEuMzQwMiAxNS43NDc2IDExLjI1ODMgMTUuNzE0N0MxMS4xNzYzIDE1LjY4MTcgMTEuMDg4NiAxNS42NjU0IDExLjAwMDIgMTUuNjY2N0g3Ljk0Mjk1TDE2LjMyMTkgNy4yODc3NkMxNy4yMTE5IDYuMzk3NjggMTcuMjExOSA0LjkzNDM1IDE2LjMyMTkgNC4wNDQyN0wxMy4yODkzIDEuMDExNzJDMTIuODQ0MyAwLjU2NjY3OSAxMi4yNTUzIDAuMzQzNzUgMTEuNjY2OSAwLjM0Mzc1Wk02LjEzODI2IDYuODA0NjlMMTAuNTI4OSAxMS4xOTUzTDYuMzQ1MjkgMTUuMzc4OUM1Ljk2NDU0IDE1Ljc1OTcgNS4zNjkyOCAxNS43NTk3IDQuOTg4NTIgMTUuMzc4OUwxLjk1NTk3IDEyLjM0NjRDMS41NzUzOCAxMS45NjU4IDEuNTc1MzggMTEuMzY4OSAxLjk1NTk3IDEwLjk4ODNMNi4xMzgyNiA2LjgwNDY5Wk0xMy42NjY5IDE1LjY2NjdDMTMuNDkwMSAxNS42NjY3IDEzLjMyMDUgMTUuNzM2OSAxMy4xOTU1IDE1Ljg2MTlDMTMuMDcwNSAxNS45ODcgMTMuMDAwMiAxNi4xNTY1IDEzLjAwMDIgMTYuMzMzM0MxMy4wMDAyIDE2LjUxMDEgMTMuMDcwNSAxNi42Nzk3IDEzLjE5NTUgMTYuODA0N0MxMy4zMjA1IDE2LjkyOTggMTMuNDkwMSAxNyAxMy42NjY5IDE3QzEzLjg0MzcgMTcgMTQuMDEzMyAxNi45Mjk4IDE0LjEzODMgMTYuODA0N0MxNC4yNjMzIDE2LjY3OTcgMTQuMzMzNiAxNi41MTAxIDE0LjMzMzYgMTYuMzMzM0MxNC4zMzM2IDE2LjE1NjUgMTQuMjYzMyAxNS45ODcgMTQuMTM4MyAxNS44NjE5QzE0LjAxMzMgMTUuNzM2OSAxMy44NDM3IDE1LjY2NjcgMTMuNjY2OSAxNS42NjY3Wk0xNi4zMzM2IDE1LjY2NjdDMTYuMTU2OCAxNS42NjY3IDE1Ljk4NzIgMTUuNzM2OSAxNS44NjIyIDE1Ljg2MTlDMTUuNzM3MSAxNS45ODcgMTUuNjY2OSAxNi4xNTY1IDE1LjY2NjkgMTYuMzMzM0MxNS42NjY5IDE2LjUxMDEgMTUuNzM3MSAxNi42Nzk3IDE1Ljg2MjIgMTYuODA0N0MxNS45ODcyIDE2LjkyOTggMTYuMTU2OCAxNyAxNi4zMzM2IDE3QzE2LjUxMDQgMTcgMTYuNjggMTYuOTI5OCAxNi44MDUgMTYuODA0N0MxNi45MyAxNi42Nzk3IDE3LjAwMDIgMTYuNTEwMSAxNy4wMDAyIDE2LjMzMzNDMTcuMDAwMiAxNi4xNTY1IDE2LjkzIDE1Ljk4NyAxNi44MDUgMTUuODYxOUMxNi42OCAxNS43MzY5IDE2LjUxMDQgMTUuNjY2NyAxNi4zMzM2IDE1LjY2NjdaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K");_defineProperty(this,"closeImage","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEuNzU1NTMgMC41NzgxMjVMMC41NzcxNDggMS43NTY1MUw1LjgyMTI5IDcuMDAwNjVMMC41NzcxNDggMTIuMjQ0OEwxLjc1NTUzIDEzLjQyMzJMNi45OTk2NyA4LjE3OTAzTDEyLjI0MzggMTMuNDIzMkwxMy40MjIyIDEyLjI0NDhMOC4xNzgwNiA3LjAwMDY1TDEzLjQyMjIgMS43NTY1MUwxMi4yNDM4IDAuNTc4MTI1TDYuOTk5NjcgNS44MjIyN0wxLjc1NTUzIDAuNTc4MTI1WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==");_defineProperty(this,"reconnectImage","data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTNweCIgaGVpZ2h0PSIxNHB4IiB2aWV3Qm94PSIwIDAgMTMgMTQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjMgKDY3Mjk3KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5yZWxvYWQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iQXJ0Ym9hcmQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zNTcuMDAwMDAwLCAtMjQxLjAwMDAwMCkiIGZpbGw9IiM4QTk1OUYiIHN0cm9rZT0iIzhBOTU5RiI+CiAgICAgICAgICAgIDxnIGlkPSJyZWxvYWQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM1OC4wMDAwMDAsIDI0Mi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44LDUuMjczNTc2NTggQzEwLjgsMi4zNjU3MTQyIDguMzc3NTg1NzEsMCA1LjQwMDAyMzg3LDAgQzIuNDIyNDYyMDMsMCAwLDIuMzY1NzE0MiAwLDUuMjczNTc2NTggQzAsNS40NDYzMTE0MiAwLjE0MzQwNjM1Myw1LjU4NjM1OTc2IDAuMzIwMjgyOTQyLDUuNTg2MzU5NzYgQzAuNDk3MTU5NTMsNS41ODYzNTk3NiAwLjY0MDU2NTg4Myw1LjQ0NjI4ODEgMC42NDA1NjU4ODMsNS4yNzM1NzY1OCBDMC42NDA1NjU4ODMsMi43MTA2NDc2NSAyLjc3NTY0MjI2LDAuNjI1NTg5NjY4IDUuNCwwLjYyNTU4OTY2OCBDOC4wMjQzNTc3NCwwLjYyNTU4OTY2OCAxMC4xNTk0MzQxLDIuNzEwNjcwOTYgMTAuMTU5NDM0MSw1LjI3MzU3NjU4IEMxMC4xNTk0MzQxLDcuODM2NDU4ODkgOC4wMjQzNTc3NCw5LjkyMTU0MDE4IDUuNCw5LjkyMTU0MDE4IEw0Ljg0NDMyNzI0LDkuOTIxNTQwMTggTDUuNjM4ODc1MzEsOS4wNTI5NzAwMyBDNS43NTY3MzczMyw4LjkyNDE1OTEyIDUuNzQ1MzAyMDYsOC43MjY0MDgxNiA1LjYxMzQwMjYsOC42MTEzMDYgQzUuNDgxNTAzMTMsOC40OTYyMDM4NSA1LjI3ODk4NjcyLDguNTA3Mzk0NjYgNS4xNjExNDg1Nyw4LjYzNjIwNTU2IEw0LjAyNTM1Njg4LDkuODc3ODAyNzYgQzMuODM5NDMyMzUsMTAuMDgxMDU1OSAzLjgzOTQzMjM1LDEwLjM4NzU5MDggNC4wMjUzNTY4OCwxMC41OTA4NDQgTDUuMTYxMTQ4NTcsMTEuODMyNDQxMiBDNS4yMjQ0MzY0NCwxMS45MDE2Mzc3IDUuMzEyMDc0OTgsMTEuOTM2ODQyMSA1LjQwMDExOTM3LDExLjkzNjg0MjEgQzUuNDc2MDYwMDQsMTEuOTM2ODQyMSA1LjU1MjMxMTA2LDExLjkxMDU5MDMgNS42MTM0MDI2LDExLjg1NzM0MDcgQzUuNzQ1MzI1OTQsMTEuNzQyMjM4NiA1Ljc1NjczNzMzLDExLjU0NDQ4NzYgNS42Mzg4NzUzMSwxMS40MTU2NzY3IEw0Ljg0NDMyNzI0LDEwLjU0NzEwNjUgTDUuNCwxMC41NDcxMDY1IEM4LjM3NzU4NTcxLDEwLjU0NzEwNjUgMTAuOCw4LjE4MTM5MjM0IDEwLjgsNS4yNzM1NzY1OCBaIiBpZD0iUGF0aCI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=");_defineProperty(this,"visibilityOffImage","data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6bTAgMGgyNHYyNEgwVjB6bTAgMGgyNHYyNEgwVjB6bTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEyIDZjMy43OSAwIDcuMTcgMi4xMyA4LjgyIDUuNS0uNTkgMS4yMi0xLjQyIDIuMjctMi40MSAzLjEybDEuNDEgMS40MWMxLjM5LTEuMjMgMi40OS0yLjc3IDMuMTgtNC41M0MyMS4yNyA3LjExIDE3IDQgMTIgNGMtMS4yNyAwLTIuNDkuMi0zLjY0LjU3bDEuNjUgMS42NUMxMC42NiA2LjA5IDExLjMyIDYgMTIgNnptLTEuMDcgMS4xNEwxMyA5LjIxYy41Ny4yNSAxLjAzLjcxIDEuMjggMS4yOGwyLjA3IDIuMDdjLjA4LS4zNC4xNC0uNy4xNC0xLjA3QzE2LjUgOS4wMSAxNC40OCA3IDEyIDdjLS4zNyAwLS43Mi4wNS0xLjA3LjE0ek0yLjAxIDMuODdsMi42OCAyLjY4QzMuMDYgNy44MyAxLjc3IDkuNTMgMSAxMS41IDIuNzMgMTUuODkgNyAxOSAxMiAxOWMxLjUyIDAgMi45OC0uMjkgNC4zMi0uODJsMy40MiAzLjQyIDEuNDEtMS40MUwzLjQyIDIuNDUgMi4wMSAzLjg3em03LjUgNy41bDIuNjEgMi42MWMtLjA0LjAxLS4wOC4wMi0uMTIuMDItMS4zOCAwLTIuNS0xLjEyLTIuNS0yLjUgMC0uMDUuMDEtLjA4LjAxLS4xM3ptLTMuNC0zLjRsMS43NSAxLjc1Yy0uMjMuNTUtLjM2IDEuMTUtLjM2IDEuNzggMCAyLjQ4IDIuMDIgNC41IDQuNSA0LjUuNjMgMCAxLjIzLS4xMyAxLjc3LS4zNmwuOTguOThjLS44OC4yNC0xLjguMzgtMi43NS4zOC0zLjc5IDAtNy4xNy0yLjEzLTguODItNS41LjctMS40MyAxLjcyLTIuNjEgMi45My0zLjUzeiIvPjwvc3ZnPg==");_defineProperty(this,"visibilityOnImage","data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAwIDI0IDI0IiB3aWR0aD0iMjRweCIgZmlsbD0iIzAwMDAwMCI+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PHBhdGggZD0iTTEyIDZjMy43OSAwIDcuMTcgMi4xMyA4LjgyIDUuNUMxOS4xNyAxNC44NyAxNS43OSAxNyAxMiAxN3MtNy4xNy0yLjEzLTguODItNS41QzQuODMgOC4xMyA4LjIxIDYgMTIgNm0wLTJDNyA0IDIuNzMgNy4xMSAxIDExLjUgMi43MyAxNS44OSA3IDE5IDEyIDE5czkuMjctMy4xMSAxMS03LjVDMjEuMjcgNy4xMSAxNyA0IDEyIDR6bTAgNWMxLjM4IDAgMi41IDEuMTIgMi41IDIuNVMxMy4zOCAxNCAxMiAxNHMtMi41LTEuMTItMi41LTIuNVMxMC42MiA5IDEyIDltMC0yYy0yLjQ4IDAtNC41IDIuMDItNC41IDQuNVM5LjUyIDE2IDEyIDE2czQuNS0yLjAyIDQuNS00LjVTMTQuNDggNyAxMiA3eiIvPjwvc3ZnPg==");_defineProperty(this,"socket",null);_defineProperty(this,"stopFn",null);_defineProperty(this,"peer",null);_defineProperty(this,"dataChannel",null);_defineProperty(this,"requestAccepted",false);_defineProperty(this,"releasebtn",void 0);_defineProperty(this,"reconnectbtn",void 0);_defineProperty(this,"reconnectbtnimg",void 0);_defineProperty(this,"releasebtnimg",void 0);_defineProperty(this,"drawbtn",void 0);_defineProperty(this,"drawbtnimg",void 0);_defineProperty(this,"erasebtn",void 0);_defineProperty(this,"erasebtnimg",void 0);_defineProperty(this,"colorbtn",void 0);_defineProperty(this,"colorbtnimg",void 0);_defineProperty(this,"stopbtn",void 0);_defineProperty(this,"stopbtnimg",void 0);_defineProperty(this,"voffbtn",void 0);_defineProperty(this,"voffbtnimg",void 0);_defineProperty(this,"vonbtn",void 0);_defineProperty(this,"vonbtnimg",void 0);_defineProperty(this,"drawEnabled",false);_defineProperty(this,"stopCoBrowse",function(){var sendMessageFlag=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var removeFromStorage=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;console.log("cobrowse >>> stopping cobrowse");_this5.agentDrawPaths=[];_this5.userDrawPaths=[];_this5.removeTooltip();_this5.drawEnabled=false;_this5.requestAccepted=false;if(removeFromStorage){localStorage.removeItem("cobrowseRequest");}var kaMousePointer=document.getElementById("kamousepointer");if(kaMousePointer){kaMousePointer.style.display='none';}if(sendMessageFlag){var RESPONSE_MESSAGE={"type":"terminate_cobrowse"};_this5.sendDCMessage(JSON.stringify(RESPONSE_MESSAGE));}setTimeout(function(){_this5.closeChannel();if(_this5.socket!==null){_this5.socket.disconnect();}_this5.socket=null;},1000);_this5.removeCanvas();_this5.removeMousePointer();_this5.removeTooltip();var cobrowsetoolbar=document.getElementById("cobrowse-toolbar");if(cobrowsetoolbar){cobrowsetoolbar.remove();}console.log("cobrowse >>> koreCoBrowseUnMakingFields");if(_this5.maskClassList){for(var i=0;i<_this5.maskClassList.length>0;i++){if(_this5["this"].maskClassList[i]!==''){document.querySelectorAll('.'+_this5.maskClassList[i]).forEach(function(item){item.classList.remove('rr-block');});}}}_this5.maskClassList=[];_this5.maskPatternList=[];});_defineProperty(this,"closeChannel",function(){if(this.dataChannel&&this.dataChannel.readyState==='open'){console.log("cobrowse >>> closing channel");this.dataChannel.close();}this.dataChannel=null;if(this.stopFn){this.stopFn();}});_defineProperty(this,"koreGenerateUUID",function(){console.info("generating UUID");var d=new Date().getTime();if(window.performance&&typeof window.performance.now==="function"){d+=performance.now();//use high-precision timer if available
}var uuid='u-xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=='x'?r:r&0x3|0x8).toString(16);});return uuid;});_defineProperty(this,"createTooltip",function(e,text){var _tooltipTextStyle;if(document.getElementById('cobrowse-tooltip')){return;}var doc=document.documentElement;var x=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0)+e.x;var y=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0)+e.y;var tooltipStyle={position:'absolute',display:'inline-block',borderBottom:'1px dotted black',zIndex:100000,left:"".concat(x+20,"px"),top:"".concat(y-20,"px"),padding:'10px, 15px',height:'36px',backgroundColor:'#202124',borderRadius:'4px',width:'auto',whitespace:'nowrap'};if(x+100>document.body.clientWidth){tooltipStyle.left="".concat(x-100,"px");}var tooltip=document.createElement("div");tooltip.setAttribute("do-not-mutate",true);tooltip.id="cobrowse-tooltip";Object.assign(tooltip.style,tooltipStyle);document.getElementsByTagName("BODY")[0].append(tooltip);var tooltipTextStyle=(_tooltipTextStyle={color:'#fff',textAlign:'center',padding:'10px',borderRadius:'6px',position:'absolute',zIndex:1,height:'14px',lineHeight:'0px'},_defineProperty(_tooltipTextStyle,"textAlign",'center'),_defineProperty(_tooltipTextStyle,"width",'max-content'),_defineProperty(_tooltipTextStyle,"backgroundColor",'black'),_defineProperty(_tooltipTextStyle,"whitespace",'nowrap'),_defineProperty(_tooltipTextStyle,"display",'inline-block'),_defineProperty(_tooltipTextStyle,"fontStyle",'normal'),_defineProperty(_tooltipTextStyle,"fontWeight",600),_defineProperty(_tooltipTextStyle,"fontSize",'10px'),_tooltipTextStyle);var tooltiptext=document.createElement("div");tooltiptext.id="cobrowse-tooltip-text";Object.assign(tooltiptext.style,tooltipTextStyle);tooltip.append(tooltiptext);tooltiptext.textContent=text;});_defineProperty(this,"removeTooltip",function(){var obj=document.getElementById("cobrowse-tooltip");if(obj){obj.remove();}obj=document.getElementById('cobrowse-tooltip-text');if(obj){obj.remove();}});_defineProperty(this,"userDrawPaths",[]);_defineProperty(this,"agentDrawPaths",[]);_defineProperty(this,"drawAllLines",function(drawPaths){var doc=document;var canvas=doc.getElementById("cb-canvas");if(!canvas){return;}var ctx=canvas.getContext('2d');if(drawPaths.length>0){for(var j=0;j<drawPaths.length;j++){var subPathColor=drawPaths[j].color;var subPath=drawPaths[j].subPath;for(var i=0;i<subPath.length-1;i++){var p=subPath[i];var np=subPath[i+1];ctx.beginPath();ctx.moveTo(p.x,p.y);ctx.lineTo(np.x,np.y);ctx.strokeStyle=subPathColor;ctx.lineWidth=this.lineWidth;ctx.stroke();}}}});_defineProperty(this,"drawLines",function(drawPaths){var doc=document;var canvas=doc.getElementById("cb-canvas");if(!canvas){return;}var ctx=canvas.getContext('2d');//ctx.clearRect(0, 0, canvas.width, canvas.height);
if(drawPaths&&drawPaths.length>0){for(var j=0;j<drawPaths.length;j++){var subPathColor=drawPaths[j].color;var subPath=drawPaths[j].subPath;for(var i=0;i<subPath.length-1;i++){var p=subPath[i];var np=subPath[i+1];ctx.beginPath();ctx.moveTo(p.x,p.y);ctx.lineTo(np.x,np.y);ctx.strokeStyle=subPathColor;ctx.lineWidth=3;ctx.stroke();}}}});_defineProperty(this,"createDrawingBoard",function(){var doc=document;var win=window;var height=doc.documentElement.scrollHeight;var width=doc.documentElement.scrollWidth;if(doc.getElementById("cb-canvas")){return;}var canvas=doc.createElement('canvas');canvas.id="cb-canvas";canvas.className='rr-ignore';canvas.setAttribute("do-not-mutate","true");canvas["width"]=width;canvas["height"]=height;canvas.style.backgroundColor='transparent';canvas.style.top='0px';canvas.style.left='0px';canvas.style.position='absolute';canvas.style.zIndex='10000';doc.body.append(canvas);/*var evtPayload = {
            type:"set_canvas_size",
            height : height,
            width : width
          }
        sendDCMessage(JSON.stringify(evtPayload));*/});_defineProperty(this,"prevDrawX",void 0);_defineProperty(this,"prevDrawY",void 0);_defineProperty(this,"subPaths",[]);_defineProperty(this,"sketchColor",'black');_defineProperty(this,"drawStarted",false);_defineProperty(this,"drawLine",function(canvas,x1,y1,x2,y2){var ctx=canvas.getContext("2d");ctx.strokeStyle=this.sketchColor;ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.lineWidth=this.lineWidth;ctx.stroke();this.prevDrawX=x2;this.prevDrawY=y2;});_defineProperty(this,"lineWidth",3);_defineProperty(this,"eraseLastDrawing",function(){var canvas=document.getElementById("cb-canvas");if(!canvas){return;}if(this.userDrawPaths.length>0){this.userDrawPaths.splice(this.userDrawPaths.length-1,1);}this.clearCanvas();this.drawAllLines(this.userDrawPaths);this.drawAllLines(this.agentDrawPaths);if(this.dataChannel&&this.dataChannel.readyState==='open'){var evtPayload={type:"target_draw",drawPaths:this.userDrawPaths};this.sendDCMessage(JSON.stringify(evtPayload));}});_defineProperty(this,"handleDraw",function(e){var _this6=this;if(this.drawEnabled){this.drawbtnimg.src=this.drawDisabledImage;}else{this.drawbtnimg.src=this.drawEnabledImage;}this.drawEnabled=!this.drawEnabled;this.removeTooltip();if(this.drawEnabled){this.createTooltip(e,"Draw Mode On");this.createDrawingBoard();var canvas=document.getElementById("cb-canvas");canvas.onmousemove=function(evt){if(_this6.drawEnabled&&_this6.drawStarted){var curDrawX=evt.offsetX;var curDrawY=evt.offsetY;_this6.subPaths.push({x:curDrawX,y:curDrawY});_this6.drawLine(canvas,_this6.prevDrawX,_this6.prevDrawY,curDrawX,curDrawY);}};canvas.onmousedown=function(evt){if(_this6.drawEnabled){_this6.prevDrawX=evt.offsetX;_this6.prevDrawY=evt.offsetY;_this6.subPaths.push({x:evt.offsetX,y:evt.offsetY});_this6.drawStarted=true;}};canvas.onmouseup=function(evt){if(_this6.drawEnabled){if(_this6.subPaths.length>0){_this6.userDrawPaths.push({"color":_this6.sketchColor,"subPath":_this6.subPaths});var evtPayload={type:"target_draw",drawPaths:_this6.userDrawPaths};_this6.sendDCMessage(JSON.stringify(evtPayload));}_this6.drawStarted=false;}_this6.subPaths=[];};}else{this.userDrawPaths=[];this.clearCanvas();if(this.agentDrawPaths.length<1){this.removeCanvas();}else{this.drawLines(this.agentDrawPaths);}if(this.dataChannel&&this.dataChannel.readyState==='open'){var evtPayload={type:"target_stop_draw"};this.sendDCMessage(JSON.stringify(evtPayload));}}if(!this.drawEnabled){this.createTooltip(e,"Draw Mode Off");}});_defineProperty(this,"createCobrowseToolBar",function(){var _this7=this;var cobrowsetoolbar=document.getElementById("cobrowse-toolbar");if(cobrowsetoolbar){return;}cobrowsetoolbar=document.createElement("DIV");cobrowsetoolbar.id="cobrowse-toolbar";cobrowsetoolbar.style.display='table';cobrowsetoolbar.style.alignItems="flex-start";cobrowsetoolbar.style.zIndex=100000;cobrowsetoolbar.style.cursor='move';cobrowsetoolbar.style.height='172px';cobrowsetoolbar.style.width='40px';cobrowsetoolbar.style.background='#FFFFFF';cobrowsetoolbar.style.boxShadow='0px 2px 5px rgba(0, 0, 0, 0.25)';cobrowsetoolbar.style.borderRadius='2px';cobrowsetoolbar.style.left='calc(100% - 50px)';cobrowsetoolbar.style.top='40%';cobrowsetoolbar.style.fontWeight='normal';cobrowsetoolbar.style.fontSize='14px';cobrowsetoolbar.style.lineHeight='20px';cobrowsetoolbar.style.color='#FFFFFF';cobrowsetoolbar.style.position='fixed';cobrowsetoolbar.style.paddingBottom='5px';cobrowsetoolbar.classList.add("rr-block");cobrowsetoolbar.style.border='none';cobrowsetoolbar.setAttribute("do-not-mutate","true");var btnDivStyle={cursor:'pointer',width:'30px',height:'30px',borderRadius:'2px',marginTop:'5px',marginLeft:'5px',alignItems:'center',display:'flex'};var btnImgStyle={width:'20px',height:'20px',marginLeft:'5px'};this.releasebtn=document.createElement("div");Object.assign(this.releasebtn.style,btnDivStyle);this.releasebtn.style.backgroundColor='#F5F8FA';this.releasebtn.setAttribute("do-not-mutate","true");this.releasebtnimg=document.createElement("img");Object.assign(this.releasebtnimg.style,btnImgStyle);this.releasebtnimg.src=this.noControlImage;this.releasebtn.append(this.releasebtnimg);this.releasebtn.onmouseover=function(e){if(_this7.requestAccepted){_this7.createTooltip(e,"Release Control");}if(!_this7.requestAccepted){_this7.createTooltip(e,"Control-Off");}};this.releasebtn.onmouseout=function(e){_this7.removeTooltip();};this.releasebtn.onclick=function(e){if(_this7.requestAccepted){_this7.createTooltip(e,"Release Control");_this7.releasebtnimg.src=_this7.noControlImage;_this7.releaseControl();_this7.requestAccepted=false;}else{_this7.createTooltip(e,"Agent Not in Control");_this7.releasebtnimg.src=_this7.noControlImage;}};cobrowsetoolbar.append(this.releasebtn);this.reconnectbtn=document.createElement("div");Object.assign(this.reconnectbtn.style,btnDivStyle);this.reconnectbtn.style.backgroundColor='#F5F8FA';this.reconnectbtn.setAttribute("do-not-mutate","true");this.reconnectbtnimg=document.createElement("img");Object.assign(this.reconnectbtnimg.style,btnImgStyle);this.reconnectbtnimg.src=this.reconnectImage;this.reconnectbtn.append(this.reconnectbtnimg);this.reconnectbtn.onmouseover=function(e){_this7.createTooltip(e,"Reconnect");};this.reconnectbtn.onmouseout=function(e){_this7.removeTooltip();};this.reconnectbtn.onclick=function(e){_this7.closeChannel();setTimeout(function(){_this7.autoStartCobrowse();},1000);};cobrowsetoolbar.append(this.reconnectbtn);this.drawbtn=document.createElement("div");Object.assign(this.drawbtn.style,btnDivStyle);this.drawbtn.style.backgroundColor='#F5F8FA';this.drawbtn.setAttribute("do-not-mutate","true");this.drawbtnimg=document.createElement("img");Object.assign(this.drawbtnimg.style,btnImgStyle);this.drawbtnimg.src=this.drawDisabledImage;this.drawbtn.append(this.drawbtnimg);this.drawbtn.onclick=function(e){_this7.handleDraw(e);};this.drawbtn.onmouseover=function(e){if(_this7.drawEnabled){_this7.createTooltip(e,"Draw Mode On");}if(!_this7.drawEnabled){_this7.createTooltip(e,"Draw Mode Off");}};this.drawbtn.onmouseout=function(e){_this7.removeTooltip();};cobrowsetoolbar.append(this.drawbtn);this.erasebtn=document.createElement("div");Object.assign(this.erasebtn.style,btnDivStyle);this.erasebtn.style.backgroundColor='#F5F8FA';this.erasebtn.setAttribute("do-not-mutate","true");this.erasebtnimg=document.createElement("img");Object.assign(this.erasebtnimg.style,btnImgStyle);this.erasebtnimg.src=this.eraserImage;this.erasebtn.append(this.erasebtnimg);this.erasebtn.onmouseover=function(e){_this7.createTooltip(e,"Undo last draw");};this.erasebtn.onmouseout=function(e){_this7.removeTooltip();};this.erasebtn.onclick=function(e){_this7.eraseLastDrawing();};cobrowsetoolbar.append(this.erasebtn);this.colorbtn=document.createElement("div");Object.assign(this.colorbtn.style,btnDivStyle);this.colorbtn.style.backgroundColor='#F5F8FA';this.colorbtn.setAttribute("do-not-mutate","true");this.colorbtnimg=document.createElement("img");Object.assign(this.colorbtnimg.style,btnImgStyle);this.colorbtnimg.src=this.pickColorImage;this.colorbtn.append(this.colorbtnimg);var colorInput=document.createElement("INPUT");colorInput.id="colorId";colorInput.type='color';colorInput.value="#00000";colorInput.style.visibility='hidden';colorInput.onchange=function(e){var csEl=document.getElementById("colorId");_this7.sketchColor=csEl.value;};this.colorbtn.append(colorInput);this.colorbtn.onmouseover=function(e){_this7.createTooltip(e,"Pick color");};this.colorbtn.onmouseout=function(e){_this7.removeTooltip();};this.colorbtn.onclick=function(e){var csEl=document.getElementById("colorId");csEl.click();};cobrowsetoolbar.append(this.colorbtn);//////////////////////////////////////////////////
this.vonbtn=document.createElement("div");Object.assign(this.vonbtn.style,btnDivStyle);this.vonbtn.style.backgroundColor='#F5F8FA';this.vonbtn.setAttribute("do-not-mutate","true");this.vonbtnimg=document.createElement("img");Object.assign(this.vonbtnimg.style,btnImgStyle);Object.assign(this.vonbtnimg.style,{height:'12.85px',width:'12.85px',marginLeft:'9px'});this.vonbtnimg.src=this.visibilityOnImage;this.vonbtn.append(this.vonbtnimg);this.vonbtn.onmouseover=function(e){if(document.activeElement.classList.contains("rr-block")){_this7.createTooltip(e,"Show Input");}else{_this7.createTooltip(e,"Block Input");}};this.vonbtn.onmouseout=function(e){_this7.removeTooltip();};this.vonbtn.onclick=function(e){var activeElement=document.activeElement;if(document.activeElement.classList.contains("rr-block")){activeElement.classList.remove('rr-block');_this7.vonbtnimg.src=_this7.visibilityOffImage;_this7.createTooltip(e,"Show Input");}else{activeElement.classList.add('rr-block');_this7.vonbtnimg.src=_this7.visibilityOnImage;_this7.createTooltip(e,"Block Input");}if(_this7.rrweb&&_this7.stopFn){_this7.rrweb.record.takeFullSnapshot(true);}};cobrowsetoolbar.append(this.vonbtn);///////////////////////////////////////////////////////
this.stopbtn=document.createElement("div");Object.assign(this.stopbtn.style,btnDivStyle);this.stopbtn.style.backgroundColor='rgb(255, 38, 97)';this.stopbtn.setAttribute("do-not-mutate","true");this.stopbtnimg=document.createElement("img");Object.assign(this.stopbtnimg.style,btnImgStyle);Object.assign(this.stopbtnimg.style,{height:'12.85px',width:'12.85px',marginLeft:'9px'});this.stopbtnimg.src=this.closeImage;this.stopbtn.append(this.stopbtnimg);this.stopbtn.onmouseover=function(e){_this7.createTooltip(e,"Stop CoBrowse");};this.stopbtn.onmouseout=function(e){_this7.removeTooltip();};cobrowsetoolbar.append(this.stopbtn);//////////////////////////////////
var bodyContainer=document.getElementsByTagName("BODY")[0];bodyContainer.append(cobrowsetoolbar);setTimeout(function(){_this7.dragElement(cobrowsetoolbar);_this7.stopbtn.onclick=function(e){_this7.terminateCobrowse();};},1000);});_defineProperty(this,"dragElement",function(elmnt){var pos1=0,pos2=0,pos3=0,pos4=0;if(document.getElementById(elmnt.id)){// if present, the header is where you move the DIV from:
document.getElementById(elmnt.id).onmousedown=dragMouseDown;}else{// otherwise, move the DIV from anywhere inside the DIV:
elmnt.onmousedown=dragMouseDown;}function dragMouseDown(e){e=e||window.event;e.preventDefault();// get the mouse cursor position at startup:
pos3=e.clientX;pos4=e.clientY;document.onmouseup=closeDragElement;// call a function whenever the cursor moves:
document.onmousemove=elementDrag;}function elementDrag(e){e=e||window.event;e.preventDefault();// calculate the new cursor position:
pos1=pos3-e.clientX;pos2=pos4-e.clientY;pos3=e.clientX;pos4=e.clientY;// set the element's new position:
elmnt.style.top=elmnt.offsetTop-pos2+"px";elmnt.style.left=elmnt.offsetLeft-pos1+"px";}function closeDragElement(e){// stop moving when mouse button is released:
e=e||window.event;e.preventDefault();e.stopPropagation();document.onmouseup=null;document.onmousemove=null;}});_defineProperty(this,"removeCanvas",function(){var canvas=document.getElementById("cb-canvas");if(canvas){this.clearCanvas();canvas.remove();}});_defineProperty(this,"imageMousePointer",null);_defineProperty(this,"removeMousePointer",function(){this.imageMousePointer=document.getElementById("kamousepointer");if(this.imageMousePointer){this.imageMousePointer.remove();}});_defineProperty(this,"clearCanvas",function(){var doc=document;var canvas=doc.getElementById("cb-canvas");if(!canvas){return;}var ctx=canvas.getContext('2d');ctx.clearRect(0,0,canvas.width,canvas.height);});_defineProperty(this,"createMousePointer",function(){this.imageMousePointer=document.getElementById("kamousepointer");if(!this.imageMousePointer){this.imageMousePointer=document.createElement("div");this.imageMousePointer.id="kamousepointer";this.imageMousePointer.style.top=-100;this.imageMousePointer.setAttribute('do-not-mutate',"true");this.imageMousePointer.style.left=-100;this.imageMousePointer.style.display='none';this.imageMousePointer.style.zIndex=10000;this.imageMousePointer.style.position='absolute';this.imageMousePointer.style.width='20px';this.imageMousePointer.style.height='20px';this.imageMousePointer.style.transition='left .05s linear,top .05s linear';this.imageMousePointer.style.backgroundSize='contain';this.imageMousePointer.style.backgroundPosition='50%';this.imageMousePointer.style.backgroundRepeat='no-repeat';this.imageMousePointer.style.backgroundImage='url("data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg==")';this.imageMousePointer.style.borderColor='transparent';this.imageMousePointer.className='rr-ignore agent-mouse';var circleDiv=document.createElement("div");circleDiv.style.content="";circleDiv.style.display='inline-block';circleDiv.style.width='20px';circleDiv.style.height='20px';circleDiv.style.background='#4950f6';circleDiv.style.borderRadius='100%';circleDiv.style.transform='translate(-50%,-50%)';circleDiv.style.opacity='.3';circleDiv.className="rr-block agent-mouse-circle";this.imageMousePointer.appendChild(circleDiv);document.body.appendChild(this.imageMousePointer);}else{this.imageMousePointer.setAttribute('do-not-mutate',"true");}});_defineProperty(this,"sendDCMessage",function(str){if(this.dataChannel&&this.dataChannel.readyState==='open'){this.dataChannel.send(str);}});_defineProperty(this,"releaseControl",function(){var RESPONSE_MESSAGE={"type":"request_control","response":"released"};this.sendDCMessage(JSON.stringify(RESPONSE_MESSAGE));});_defineProperty(this,"cobrowseInitialize",function(cobrowseRequest){var me=_this5;me.createCobrowseToolBar();var cobrowseEventMsg="";_this5.requestAccepted=false;if(_this5.releasebtnimg){_this5.releasebtnimg.src=_this5.noControlImage;}console.log("cobrowse >>> cobrowseRequest",cobrowseRequest);if(!cobrowseRequest.userId){cobrowseRequest.userId=me.koreGenerateUUID();}if(_this5.socket===null){_this5.socket=io(cobrowseRequest.cobrowseUrl+"/cobrowse",{"query":{"userId":_this5.authResponse.userInfo.userId,"authToken":_this5.authResponse.authorization.accessToken,"accountId":_this5.authResponse.userInfo.accountId},"path":"/agentassist/api/v1/chat",transports:['websocket','polling','flashsocket']});}else{initialize(me);}_this5.socket.on("connect",function(){initialize(me);});function addCobrowseAttribute(me){var all=document.getElementsByTagName("*");for(var i=0,max=all.length;i<max;i++){var el=all[i];me.rrweb.createCbId(el);}}function initialize(me){console.log("cobrowse >>> joining room ",cobrowseRequest.conversationId);addCobrowseAttribute(me);me.socket.emit("start_cobrowse",{"conversationId":cobrowseRequest.conversationId});me.socket.on("ice-candidate",handleNewICECandidateMsg);me.socket.on("offer",handleOffer);me.socket.on("stop_cobrowse",me.stopCoBrowse);me.peer=createPeer();me.peer.onicecandidate=function(e){if(e.candidate){var payload={conversationId:cobrowseRequest.conversationId,candidate:e.candidate};console.log("cobrowse >>> emitting ice-candidate",payload);me.socket.emit("ice-candidate",payload);}};function handleOffer(incoming){console.log("cobrowse >>> handlingOffer ",incoming);var desc=new RTCSessionDescription(incoming.sdp);me.peer.setRemoteDescription(desc).then(function(){}).then(function(){return me.peer.createAnswer();}).then(function(answer){return me.peer.setLocalDescription(answer);}).then(function(){var payload={conversationId:incoming.caller,sdp:me.peer.localDescription};me.socket.emit("answer",payload);})["catch"](function(err){console.log(err);});me.peer.ondatachannel=function(dc){console.log("cobrowse >>>  datachannel from source",dc);if(me.dataChannel!==null){me.dataChannel.close();me.dataChannel=null;}if(me.dataChannel===null){me.dataChannel=dc.channel;me.dataChannel.onmessage=function(m){//console.log('cobrowse >>> received message from source', m);
handleMessage(m);};me.dataChannel.onclose=function(){if(me.peer&&me.peer.connectionState==='connected'){console.log("cobrowse >>> stopping peer connection");me.peer.close();me.peer=null;}me.stopCoBrowse(false,false);};me.dataChannel.onopen=function(){console.log("cobrowse >>> start recording");me.stopFn=me.rrweb.record(_defineProperty({emit:function emit(evt){//console.log("record event", evt);
processEvent(evt);},collectFonts:true,userTriggeredOnInput:true,maskTextClass:'rr-mask'},"collectFonts",true));};}};}function handleMessage(m){var obj=JSON.parse(m.data);if(obj.type==='start_event_msg'){cobrowseEventMsg='';}else if(obj.type==='message'){if(obj.data&&obj.data!=='undefined'&&_typeof(obj.data)!=undefined){cobrowseEventMsg+=obj.data;}}else if(obj.type==='stop_event_msg'){try{if(cobrowseEventMsg&&cobrowseEventMsg!=='undefined'&&_typeof(cobrowseEventMsg)!=undefined){var objMsg=JSON.parse(cobrowseEventMsg);handleMessageInternal(objMsg);}}catch(err){console.log('error msg',err,cobrowseEventMsg);}}else if(obj.type==='fullsnapshot'){console.log("taking fullsnapshot");me.ACKrrweb.record.takeFullSnapshot(true);}else if(obj.type==='set_request_control'){me.requestAccepted=obj.data;if(me.releasebtnimg){if(obj.data===true){me.releasebtnimg.src=me.releaseControlImage;}else{me.releasebtnimg.src=me.noControlImage;}}me.createMousePointer();}}function handleMessageInternal(obj){if(obj.type==='target_mouse_move'){positionMousePointer(obj);}else if(obj.type==='target_key_up'&&obj.tagName==='INPUT'&&(obj.targetType==='text'||obj.targetType==='email')){processKeyUpText(obj);}else if((obj.type==='target_key_down'||obj.type==='target_key_up')&&obj.tagName==='DIV'){processKeyDownDiv(obj);}else if(obj.type==='target_mouse_click'){processMouseClick(obj);}else if(obj.type==='target_mouse_over'){processMouseOver(obj);}else if(obj.type==='target_scroll'){processScroll(obj);}else if(obj.type==='target_draw'){me.createDrawingBoard();me.clearCanvas();me.agentDrawPaths=obj.drawPaths;me.drawLines(obj.drawPaths);me.drawLines(userDrawPaths);}else if(obj.type==="target_stop_draw"){me.agentDrawPaths=[];me.clearCanvas();me.drawAllLines(me.userDrawPaths);if(me.userDrawPaths.length<1){me.removeCanvas();}}else if(obj.type==="request_control"){requestControl(obj.data);}else if(obj.type==="release_control"){me.requestAccepted=false;if(me.releasebtnimg)me.releasebtnimg.src=me.noControlImage;if(me.userDrawPaths.length<1){me.removeCanvas();}}}function requestControl(data){var _self=me;var userIcon='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAu6SURBVHgB7Z3PbxvHFcff7HIp6pdL90eMomlLFz0WMA20coscTB/aUwtbf4Hlooe2F4u33mzdeiN1DxD5L7CNognQi+hD0EYJEObYooCZoEWaNLZpixLFH7sv83a5Eknzxy65P95Q+wEiSiRjDve7782bN29mBCwApY8xC52jHICeF0K/AghZ+bT8G3O9t2R7/w1TAxB1+VgHxDqC9Qk9gi6qkMpUi1ft15RGgIKUPmwWwEQS87r8BnmwxQyFmrxZqojmExK9+LPlCiiGEgLbFtpqbvUELcBoa4wCaelQQWE9BhMqxV8s14A5bAU+FVVL3ZSutgAsERUE8wEYmUdc3Tk7gcn9CtBvyr5wC+Kz1BkQewjt3eLGWhUYwUZgW1jU7/G1Vq84Vl3cWN4DBsQu8OII+xo1GZXvxC10bAIvsLDD1GRQdieuCDxygUt/b+aEppXkJ9+Cc4Xso01zJ+rIW4MI2T1o3xW69vH5E5fALfrupX+cbEOERGLBttXq+jvnwB17pYamdSMKaw7dgk+tNhG3n1xU1hyaBVOiQnQ79+R4NlKXpBwoytvX0kUIiVAE7rnkh7L1eUjwQmguO3AXXXq/kZfuZz8R1xfksvfJMCBgAhW49FHrljAMKW5oszuLjNMvf9AKdIQRmMC7H3VvCwukW1Ypf8yOrBDwkK4lBEQgfTA1CC1zDxICQ2j61t2fph7AnMwtcCJueAQh8lwC232u45YTQgIRNovXlh7BjMwssDMUogRG0ueGTB07nRvFt2abZ54pyOqJS9FyIm74ZOXI5OGsQ6iZBO6Jm4OEqLATR3YZk098C1z+sF2CRNwYwLxoy9SvT3wJTBMHSW45RgRu+52g8BxkJUEVG+oyb33Va97aswUnQRUbss7cujc8WTC5ZgQsgyJYCPCyhXDSReiYAM0uPYdg4tl7DE1AWgfIpABWDQHLKQGGDsqAFhaLP89M1WSqwKq4ZhL1+QnCoRT2qIMwCyR0NiNgzVBCbE+uOgVTkOJS5MZWXBL2q2OEZ01rwEJngW4M9+YgoS+taJyFztrFiwCbk9400YKd0la772XJsybCl0fzCzsOcuHZJQ3eWOW7hKtXKFAZ9/rEIEuK67kzjxLqV5/WLfi8EZ64RFt+zpfHFvzruWl/JkdkwDVxbDxW4NJBcwsYJjSO2gj/fmHO3M/OAgn99KUJr1rRfaZ3sCDjpMK4V8cKLEDznTUJm7oMop6+DNdqx0Eif/bKstvAjUlWPFJgjtZLF/Y/hxbEDbWBn8jjrXikwAL0wEpGguCkCyzEdaG2RNlFeGGcFb8mcOmgnedUpN6xXSO/COcz2VXwCrxGW/FrAgvAu8AIspY2wwiW4gBOXsVGF69VZA4M8OzVCJ32C2DCC9nX/ZfbRRzie+saXMywGSfX0Uhf7t9OYtCCOyesVv39/5i3uMT/GvFE9WPIQqu11f/EgMCcgiuyXo6ueRgS9xmjG1GmL2/2/30qsFPzwye4UsF6XShlygcZbPWV9pxZsG7vP8WCV201rNeFrJjVsKnPTZ8KLMSgaccJz5TgZJglPwruL2cWjHws+FBBgTndlEIT193fbYHtvR+ZzPlS1opRVOoZajO1nQlZN+nhWLDJZy3vUUed4GqYozajtgtha2oLLPOY14EJKgVXw3DSF3r9sGPBCGwsWGEDZpWblv3wFfuRW3qSKjW4zdR4hYr2Lmcj3XpsIjJteVGD7kmyl8aicnyU0zgFWAkBY+h5TUZbyWqFhUXkNZmcvgKMMPh0Yb7RmVXXCtC+oQHysuC0QstHhslMXUYQObIPFshKYIObGfggk+LWdpQCIy+BLyypK/AyO4HtRIfIASPIgGnln2pkdJYL1hiNyvu4mAHlWE0DR3gKfGFJvVD628s828yyVe6ibFVYZbyemK2pcF6yOQzntpLALI9kI6tQwYovpHm3UwqMbI9QfXNdY5cdGua7a6zjhRrr1lG/9sYq3yaSa2a+l0ddXj2tBoz51jJPF7guEzJvrHCP9kVdQzQ/Beb8QKbMOSU/qC3fX+c/lEPLeknTheyPMad++EdZHiJTG6gtSiTbBFZpwp/VebfjoL4ubpFpMsFugyozXihdNOi6EgITdGF//E3N3sMqaugzlRKXQKymwDBq0GmDKpC7puHTcgrtDdA6VrgFepoQcGmVgj0FKxEymaptCuWDk6fcZpW8QGWqXxyHtymKArvdTaK2vbF02alBEKIKqN4m33ThyZovrQQnNFkszWbRvLRK+fBh0MJP6NEWGE3zidB0Zc/07Reaaqpp+Wmj7eww6wUSdTnliErbMSg4HT2KCv1wLBiFMoHWJEjorC5OgzDaTpiWk5z0CundVRMkYFp3hFxLq1lgMBV0Rken36x80KLVDUkJ7WJQl/3vRfrlLDQUjkknqI/sf5+4v58KTP0wJCwGGp6elHZmwUvLe5CwGJhn3vhUYGfzLFGBBMURlf5t/gfSM2h1H0OC0iCYA6eVDubfHDfNfnYpYQJGZuCk0gGByU0j4Fzn1SbEidjr36eSeD2DbuLMZ9UmxAt22rvDz41M4ZQP2vuctjWch05vTyZ6cLdnohkpt5hP5cVug4jK9kb6xvCzIxc8yjHxjtC1AigCpSTpdLNJJ51Nwl4PJX+kNSfdSZMMzqlo6og/HFy5jP0GnK2YTl5pms6OeCRqWBunkfAkMhXYrRmsBbenBke9MHbJMjcrJlFploimBKPaCc/dZNTd9YesesVwZpw4TSUiWDvjXpvYyrit2D22jvaODrtywy8k9ndWNA7nHI61XmLipgNxWTH1o181rUit1S+0I5973ECclR9oWncmvT7Vz5Q/aD2U74qkGCDsEpywiV5osScj54kCT902BC2r2LPi0OaKyft+ceScIKoydGPWT8yohK6Th532pqmlgpS4lvOLU/+hWaHt8P/5zFRe3H6cI/hMO3YIC9LEyzHvnkPBoAMucsccTxALGoq2qV4sYGueGFj147nYV7oD8vWBTETQHR71CaJxQd8xYGumk79veH2zZ4GDctWfN5xDJlXc1X1W3IibzjueF6+u2cX3aL10cFIWIHwff+eeQdjks+19LFA27IcXZnPZcqZvt7iR2fbz//hfj2Es3Zc/fZXZdnoHLJ93cQlKrdK1mGHz8JpfcQnfAttzxqa1SR/o5f10UAX1typv1R807oniJLZHan763X5mTqiW3m/khWHIyHr8+JjEfVo3z1V/6weazKAd4qdMYpBBXfXT7/Yz85K54ltrVTkjNzaLkog7Hbo2dITBJEumazyruMRcayKL15YejcqF2n1uIq4nXJFH9clylugOXWOYg7kXvcq7a69fZDegSsT1ji3yUOBli7sxf616IKuaXZGtXkOTgMo/dM0+feXkB4ISlwhs2TqJ/LzV3eyaSdntrDS7Vv1QXsOgxCUCL0vYeq+Z0y3cl/9wDhI8Iw23tm5Ym+VfrQW6lDeUuhMSeQlw37QSkb2g61C9uCQ2/3xj9mh5HKEWFv3+3Ua5i5rvtOZ5Qs637/7kzdX7wwXrQRF65dgf3j3eloHDPStZXD6AzCvX19Nip/zLlTKESCSlgeSyswbsN1qYgwRSt9LtiDt7m8G75GEirf0879ZMVitQ7Lz963Cttp/Ii3vtKNu07gshbsM5QgZSj2QgVQwjkJpEbNXbf9pvFl618B05wM/BIiPdMaC58/Zv1isQA7GX5//2r40tAdq9hRs3xyysC5v1F398r7HVNvXbIBRf1chEWBd2q6m2/9bIH7bFtq5pt73uVBc3aJ97IR4Iy3zERVgXtsvlth5iVksf3dKQsVVLa7U067HVWt3b2+S5sboSC2Ap8tYss6CDdtMCLAiI50hcslQNRCUlrCdNxqL2o84K5z5+95fDgqWLvI7adTmmzocVoKFzLE3VlIJqJla5uV8vKCnwMOTOU6lG3pCid0yRFZq4gvbB11YWhfx7xA3Q6zdtC5TJh5oQUJPe4aWci63qUtROe7WmgoVO42tTkUVXGt3SOQAAAABJRU5ErkJggg==';var rejectIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMCSURBVHgBxZjPaxNBFMffzG43oFCSo1gwMW3BUxPwR/HSBKwUT/XeYIX2asV/IO1/YC+CtFBLejdHaYXGW7ViVy8e2pL14k0SCoLdpDu+t/lhkmbNTDY/vpDsJHmb/fDezLz3hoGi8tOJsFPW50FjUyBYAgQEgeGLJKCIYwtHFjjOB7tczt4yc5bK/zNZw5M7s4sc4IlgCKEmUwixPn6490bGuCPQ8e0HCc75Fg7D4E8Wgq11AvMEOoolgsERI+0weA69lGAvz0rna3EzVwRZoO+xRNgwjLc4jEF/ZNm2nWw3v5gHzD74D1FXUE1AFKZRwzgaAExN5hlCNYaPN/5Kc2aAMKTY6Egg3fhF3UO0rBljWzAEOY6TnPj8PkfjuocQJg1DUnVbqYzpjbwDgw1Vq8JVhgoQemdF9k5jMiprqmRLWcC90jIHyf0mMHkTxjKvILSc6mgbWl5wbWWhKCX9vP/ohvZibHwRXTQnc9PFr0L1YSlyK/z58s0TJrSUgsLGDvzey4GsbCF+6KDxGczS0ips7vyDos8bGU+YwmYGVIRhm9IRJgyK8oLyA+NKiEQFSLoI8YaiYsgXTEVBvV5cdaHLnvIF4wJx8CvmMe5SerXs7MpLjXPGDZnHRFdQkUJGmVYZyGsC+4ISYGnPrkfjTLEQ84Kp7Uud9ilPHgYftZVrkbDsxvg/mF5A4W79mnNdz8reQKlDZmnT6qOQhZYWlPKZzljWXRcn92b3mZBrbwITUTg/PpUxVbLF+WNGD3fjlWXvwDZISvoBirYCxDpd6zvH6d2HeRheTWRFP+1GaFDfGLGMfApDEjWQtXEdiGpaanlhwGpts5tSh1YqrWIMTRicLO1qabXxiyagCPZHjPPHZAgDgMHiPhnJNbfUl5Jr5OCda9hnKNOFwWe1/tA227tQth3vx5yi/+RX7LYwpI4FQ7WB7EVHa9FKrjWEXlI6sKq2S0qJGD2Sw8t2zw6sWpWfnsMjvfI8tpszQF6rlMCNR3r4QogL8ZXr5WzkQO1I7y91mFsdhEgKrAAAAABJRU5ErkJggg==";var acceptIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMfSURBVHgBxZg/TBNRHMe/v1cQCTGpCerg4AHGlEXEwZWDiDLS4GBjohJjIokJRF2IA7Az2NGpEmM6GRwN/isxDsACLt6kNyhBoqYJktIW7vl+154tWuiV67Xfpb+7+11/n7zfu997v0eoUKGYrlFTw6Ak6gJIJ2kFlR3kZyRl0hJkKssUljUvafuFEUmYlfw/uXUMPeu/CYEbytRRgSRhmXYQNa69euLGvyxQ6OlFHQ0UU6YGbzJhYaoc2J5AWkwPNjcfmpBSjqGKIqJHqVRmyhxOJEs+L3UzFNc1SY2zJHEO/sgEsr2l5heVggEa38F7ig4EJYovOE01grHDcRZyMfcA4jlTIxhbPCXyMQv3HCP/WcdQF0mVutcJtgojJDCBuoliBQzkR6eGqSohLc+QA1LVdBT1Vm4VgODPnMi3eoOTLSewODSLULC9nKve+bzvlCDZMAifxDAzfdN48/UDjOTn8i+kRVhYAj3wQQ7M0voKxhemXb3DOwgBizRUWQeByUsXAlJDFeUBRi28CApnc7WfjjS24MLxs+XcPMGwpFRAbhw7j562A4Xb+uEXjKPAsaH2MTVWh/dz+rb53V5jxs+PYCPzGys/DV9gVMqSgdYrHXeUXTZti+sfbah7Xbfs6yV1XQzDoLfnH8KL1ObNCLQOdXTDZWFkKA58Pw+1qkbOgbn+9gEyVhZeJEELnDJNoQ24fYnTtbq5Zqcv3H4ZP1K/bJiN7Ca8Skj5WKXszJpiq2jfzFWXoZoCh3D3/WRVYGxRw4i9HwrF+3mXqKOOUvNn+dPVuW7ns59BnaW6myj/FnaM8UtfUOWq7V5kGpG5NraKCqM1jLpJTjnWXyDe06o+PYoaSy0XUSNS6GZ3LR2p9M6kclhGzURmOp2dLL6zC4jbW6JAmB1RAxgVvvfflvq/xdWIvLQd/YTiExGOkYu1WyVXe3bc2sp0+zGneM6kU9mSMKzyxzFxbk9owntJ4BG3hp2GcE8vuBSDqeI1qipqhR2KTKgwM8VfUlWACmADGsntQZXsHsuCJkDq0AD5Iz0kla0mqaVKCK0c5EjvD7WHTOQEQMMGAAAAAElFTkSuQmCC";var agentName=data===null||data===void 0?void 0:data.firstName;var cobrowseRequestHML="\n                <div class=\"initial-video-audio-container\" do-not-mutate=\"true\">\n                    <div class=\"ad-img-block\">\n                        <img src=\"".concat(_self.agentProfileIcon,"\" />\n                    </div>\n                    <div class=\"content-desc\">\n                        <div class=\"name\">").concat(agentName,"</div>\n                        <div class=\"type-text\">").concat(data.confirmMessage,"</div>\n                    </div>\n                    <div class=\"controls-v-a\">\n                        <img id=\"rejectcall\" src=\"").concat(rejectIcon,"\"/>\n                        <img id=\"acceptcall\" src= \"").concat(acceptIcon,"\"/>\n                    </div>\n                </div>");var toastContainer=document.getElementById("toast");if(!toastContainer){toastContainer=document.createElement("div");toastContainer.id="toast";document.body.appendChild(toastContainer);}toastContainer.innerHTML=cobrowseRequestHML;var rejectCall=document.getElementById("rejectcall");var acceptCall=document.getElementById("acceptcall");rejectCall.onclick=function(e){toastContainer.innerHTML='';me.requestAccepted=false;if(me.releasebtnimg)me.releasebtnimg.src=me.noControlImage;var RESPONSE_MESSAGE={"type":"request_control","response":"rejected"};me.sendDCMessage(JSON.stringify(RESPONSE_MESSAGE));};acceptCall.onclick=function(e){me.requestAccepted=true;if(me.releasebtnimg)me.releasebtnimg.src=me.releaseControlImage;toastContainer.innerHTML='';var RESPONSE_MESSAGE={"type":"request_control","response":"accepted"};me.createMousePointer();me.sendDCMessage(JSON.stringify(RESPONSE_MESSAGE));};}function processScroll(obj){var cbId=obj.cbId;me.rrweb.scrollByAgent=true;if(cbId==='fullDocument'){window.scrollTo(obj.scrollLeft,obj.scrollTop);}else{var elements=document.querySelectorAll("[cb-id=\"".concat(cbId,"\"]"));if(elements&&elements.length>0){console.log("scrolling",obj.scrollLeft,obj.scrollTop);elements[0].scrollTo(obj.scrollLeft,obj.scrollTop);}}setTimeout(function(){me.rrweb.scrollByAgent=false;},500);}function processMouseOver(obj){var cbId=obj.cbId;var elements=document.querySelectorAll("[cb-id=\"".concat(cbId,"\"]"));if(elements&&elements.length>0){simulate(elements[0],"mouseover",obj);}}function processMouseClick(obj){var cbId=obj.cbId;var elements=document.querySelectorAll("[cb-id=\"".concat(cbId,"\"]"));if(elements&&elements.length>0){simulate(elements[0],"click",obj);}}function simulate(element,eventName){var options=extend(defaultOptions,arguments[2]||{});var oEvent,eventType=null;for(var name in eventMatchers){if(eventMatchers[name].test(eventName)){eventType=name;break;}}if(!eventType)throw new SyntaxError('Only HTMLEvents and MouseEvents interfaces are supported');if(document.createEvent){oEvent=document.createEvent(eventType);if(eventType=='HTMLEvents'){oEvent.initEvent(eventName,options.bubbles,options.cancelable);}else{oEvent.initMouseEvent(eventName,options.bubbles,options.cancelable,document.defaultView,options.button,options.x,options.y,options.x,options.y,options.ctrlKey,options.altKey,options.shiftKey,options.metaKey,options.button,element);}element.dispatchEvent(oEvent);}else{options.clientX=options.x;options.clientY=options.y;var evt=document.createEventObject();oEvent=extend(evt,options);element.fireEvent('on'+eventName,oEvent);}return element;}function extend(destination,source){for(var property in source){destination[property]=source[property];}return destination;}var eventMatchers={'HTMLEvents':/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,'MouseEvents':/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/};var defaultOptions={pointerX:0,pointerY:0,button:0,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,bubbles:true,cancelable:true};function processKeyUpDiv(obj){var cbId=obj.cbId;var value=obj.which;var elements=document.querySelectorAll("[cb-id=\"".concat(cbId,"\"]"));if(elements&&elements.length>0){elements[0].textContent=obj.textContent;}}function processKeyDownDiv(obj){var _this8=this;var cbId=obj.cbId;var elements=document.querySelectorAll("[cb-id=\"".concat(cbId,"\"]"));if(elements&&elements.length>0){if(!(obj.which>=0&&obj.which<=46)){elements[0].setAttribute("do-not-mutate","true");elements[0].textContent=obj.textContent;setTimeout(function(){elements[0].removeAttribute("do-not-mutate");},200);return;}else{if([8,9,8,13,46].includes(obj.which)){if(obj.which!==13){elements[0].setAttribute("do-not-mutate","true");elements[0].textContent=obj.textContent;return;}elements[0].removeAttribute("do-not-mutate");setTimeout(function(){var e=new KeyboardEvent('keydown',{bubbles:true,cancelBubble:false,cancelable:true,charCode:obj.charCode,code:obj.code,composed:true,ctrlKey:obj.ctrlKey,currentTarget:null,isTrusted:true,key:obj.key,keyCode:obj.keyCode,shiftKey:obj.shiftKey,altKey:obj.altKey,type:"keydown",which:obj.which});elements[0].dispatchEvent(e);var ENTER_KEY_MSG={"type":"enterkey_dispatched"};_this8.sendDCMessage(JSON.stringify(ENTER_KEY_MSG));},100);}}}}function processKeyUpText(obj){var cbId=obj.cbId;var value=obj.value;var elements=document.querySelectorAll("[cb-id=\"".concat(cbId,"\"]"));if(elements&&elements.length>0){elements[0].value=value;}}function positionMousePointer(payload){var x=payload.x;var y=payload.y;if(!me.imageMousePointer){me.createMousePointer();}me.imageMousePointer.style.top=y+'px';me.imageMousePointer.style.left=x+'px';me.imageMousePointer.style.display='block';}function processEvent(evt){var limit=16*1024;var START_MESSAGE={"type":"start_event_msg"};var STOP_MESSAGE={"type":"stop_event_msg"};//dataChannel.send(JSON.stringify(START_MESSAGE));
me.sendDCMessage(JSON.stringify(START_MESSAGE));var str=JSON.stringify(evt);if(str.length>limit){var noOfChunks=Math.floor(str.length/limit);var remainingChunks=str.length%limit;//console.log("noOfLines", noOfLines, remaining)
for(var i=0;i<noOfChunks;i++){var msg=str.substring(i*limit,i*limit+limit);//dataChannel.send(JSON.stringify({"type" : "message", data : msg}));
me.sendDCMessage(JSON.stringify({"type":"message",data:msg}));}if(remainingChunks>0){var msg=str.substring(str.length-remainingChunks,str.length);//dataChannel.send(JSON.stringify({"type" : "message", data : msg}));
me.sendDCMessage(JSON.stringify({"type":"message",data:msg}));}}else{//dataChannel.send(JSON.stringify({"type" : "message", data : str}));
me.sendDCMessage(JSON.stringify({"type":"message",data:str}));}//dataChannel.send(JSON.stringify(STOP_MESSAGE));
me.sendDCMessage(JSON.stringify(STOP_MESSAGE));}function createPeer(){var peerConn=new RTCPeerConnection({iceServers:[{urls:['stun:stun.l.google.com:19302','stun:stun1.l.google.com:19302','stun:stun2.l.google.com:19302','stun:stun.l.google.com:19302?transport=udp']}]});return peerConn;}function handleNewICECandidateMsg(incoming){console.log("cobrowse >>> handlingIceCandidate ",incoming);var candidate=new RTCIceCandidate(incoming.candidate);me.peer.addIceCandidate(incoming.candidate)["catch"](function(e){return console.log(e);});}}});_defineProperty(this,"autoStartCobrowse",function(){var me=this;if(this.authResponse&&this.authResponse.userInfo){console.log("cobrowse >>> starting cobrowse");var cobrowseRequest=localStorage.getItem("cobrowseRequest");console.log(cobrowseRequest);if(this.socket&&this.socket.connected){this.socket.disconnect();this.socket=null;}if(cobrowseRequest){setTimeout(function(){me.cobrowseInitialize(JSON.parse(cobrowseRequest));},500);}document.body.addEventListener('focus',me.focusHandler,true);//Non-IE   
document.body.onfocusin=me.focusHandler;//IE
}});_defineProperty(this,"terminateCobrowse",function(){this.stopCoBrowse();});_defineProperty(this,"focusHandler",function(e){if(this.vonbtnimg){var activeElement=document.activeElement;if(activeElement.classList.contains('rr-block')){this.vonbtnimg.src=visibilityOnImage;}else{this.vonbtnimg.src=visibilityOffImage;}}});_defineProperty(this,"cobrowseMaskFields",function(e){console.log("cobrowse >>> koreCoBrowseMakingFields initialize");for(var i=0;i<e.blockClasses.length>0;i++){if(e.blockClasses[i]===''){return false;}document.querySelectorAll('.'+e.blockClasses[i]).forEach(function(item){item.classList.add('rr-block');});}});_defineProperty(this,"scanElement",function(element,patternArray){var children=element.childNodes;if(!children||children.length===0){return;}console.log("children===",children);for(var i=0;i<children.length;i++){var value="";var childElement=children[i];if(childElement.nodeName==='TEXTAREA'||childElement.nodeName==='INPUT'){value=childElement.value;}else if(childElement&&childElement.childNodes&&childElement.childNodes.length){value=childElement.childNodes[0].data;}else if(childElement&&childElement.childNodes&&childElement.childNodes.length===0){value=childElement.data;}if(value){// compare the value with patternArray
console.log('value>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>',value);for(var j=0;j<patternArray.length;j++){var resExp=_this5.strToRegEx(patternArray[j]);var matchedStrings=value.match(resExp);console.log(matchedStrings);if(matchedStrings&&matchedStrings.length>0){var _childElement$childNo;// console.log("value===", value, childElement.classList);
if(childElement.nodeName==='TEXTAREA'||childElement.nodeName==='INPUT'){childElement.classList.add("rr-block");}else if(childElement&&((_childElement$childNo=childElement.childNodes)===null||_childElement$childNo===void 0?void 0:_childElement$childNo.length)===0){childElement.parentElement.classList.add("rr-mask");}else{childElement.classList.add("rr-mask");}}}}_this5.scanElement(childElement,patternArray);}});_defineProperty(this,"strToRegEx",function(str){var i1=str.indexOf("/");if(i1!=-1){str=str.substr(i1+1);}var i2=str.lastIndexOf("/");if(i2!=-1){str=str.substr(0,i2);}return new RegExp(str);});_defineProperty(this,"koreCoBrowseInit",function(exports){var me=this;exports.agentclient=me.AgentDesktop;exports.initialize=me.cobrowseInitialize;Object.defineProperty(exports,'__esModule',{value:true});// check if cobroseRequest is present in local storage
console.log("cobrowse >>> koreCoBrowse initialize");var body=document.getElementsByTagName("BODY")[0];if(body&&body.readyState==="loaded"){me.autoStartCobrowse();}else{if(window.addEventListener){window.addEventListener("load",me.autoStartCobrowse,false);}else{window.attachEvent("onload",me.autoStartCobrowse);}}return exports;});_defineProperty(this,"rrwebInit",function(exports){'use strict';/*! *****************************************************************************
        Copyright (c) Microsoft Corporation.
    
        Permission to use, copy, modify, and/or distribute this software for any
        purpose with or without fee is hereby granted.
    
        THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
        PERFORMANCE OF THIS SOFTWARE.
        ***************************************************************************** */var me=this;var _assign=function __assign(){_assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s){if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p];}}return t;};return _assign.apply(this,arguments);};function __values(o){var s=typeof Symbol==="function"&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&typeof o.length==="number")return{next:function next(){if(o&&i>=o.length)o=void 0;return{value:o&&o[i++],done:!o};}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.");}function __read(o,n){var m=typeof Symbol==="function"&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),r,ar=[],e;try{while((n===void 0||n-->0)&&!(r=i.next()).done){ar.push(r.value);}}catch(error){e={error:error};}finally{try{if(r&&!r.done&&(m=i["return"]))m.call(i);}finally{if(e)throw e.error;}}return ar;}function __spread(){for(var ar=[],i=0;i<arguments.length;i++){ar=ar.concat(__read(arguments[i]));}return ar;}var NodeType;(function(NodeType){NodeType[NodeType["Document"]=0]="Document";NodeType[NodeType["DocumentType"]=1]="DocumentType";NodeType[NodeType["Element"]=2]="Element";NodeType[NodeType["Text"]=3]="Text";NodeType[NodeType["CDATA"]=4]="CDATA";NodeType[NodeType["Comment"]=5]="Comment";})(NodeType||(NodeType={}));function isElement(n){return n.nodeType===n.ELEMENT_NODE;}function isShadowRoot(n){var _a;var host=(_a=n)===null||_a===void 0?void 0:_a.host;return Boolean(host&&host.shadowRoot&&host.shadowRoot===n);}function maskInputValue(_a){var maskInputOptions=_a.maskInputOptions,tagName=_a.tagName,type=_a.type,value=_a.value,maskInputFn=_a.maskInputFn;var text=value||'';if(maskInputOptions[tagName.toLowerCase()]||maskInputOptions[type]){if(maskInputFn){text=maskInputFn(text);}else{text='*'.repeat(text.length);}}return text;}var _id=1;var tagNameRegex=RegExp('[^a-z0-9-_:]');var IGNORED_NODE=-2;function genId(){return _id++;}function getValidTagName(element){if(element instanceof HTMLFormElement){return'form';}var processedTagName=element.tagName.toLowerCase().trim();if(tagNameRegex.test(processedTagName)){return'div';}return processedTagName;}function getCssRulesString(s){try{var rules=s.rules||s.cssRules;return rules?Array.from(rules).map(getCssRuleString).join(''):null;}catch(error){return null;}}function getCssRuleString(rule){return isCSSImportRule(rule)?getCssRulesString(rule.styleSheet)||'':rule.cssText;}function isCSSImportRule(rule){return'styleSheet'in rule;}function extractOrigin(url){var origin;if(url.indexOf('//')>-1){origin=url.split('/').slice(0,3).join('/');}else{origin=url.split('/')[0];}origin=origin.split('?')[0];return origin;}var URL_IN_CSS_REF=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm;var RELATIVE_PATH=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/;var DATA_URI=/^(data:)([^,]*),(.*)/i;function absoluteToStylesheet(cssText,href){return(cssText||'').replace(URL_IN_CSS_REF,function(origin,quote1,path1,quote2,path2,path3){var filePath=path1||path2||path3;var maybeQuote=quote1||quote2||'';if(!filePath){return origin;}if(!RELATIVE_PATH.test(filePath)){return"url("+maybeQuote+filePath+maybeQuote+")";}if(DATA_URI.test(filePath)){return"url("+maybeQuote+filePath+maybeQuote+")";}if(filePath[0]==='/'){return"url("+maybeQuote+(extractOrigin(href)+filePath)+maybeQuote+")";}var stack=href.split('/');var parts=filePath.split('/');stack.pop();for(var _i=0,parts_1=parts;_i<parts_1.length;_i++){var part=parts_1[_i];if(part==='.'){continue;}else if(part==='..'){stack.pop();}else{stack.push(part);}}return"url("+maybeQuote+stack.join('/')+maybeQuote+")";});}var SRCSET_NOT_SPACES=/^[^ \t\n\r\u000c]+/;var SRCSET_COMMAS_OR_SPACES=/^[, \t\n\r\u000c]+/;function getAbsoluteSrcsetString(doc,attributeValue){if(attributeValue.trim()===''){return attributeValue;}var pos=0;function collectCharacters(regEx){var chars,match=regEx.exec(attributeValue.substring(pos));if(match){chars=match[0];pos+=chars.length;return chars;}return'';}var output=[];while(true){collectCharacters(SRCSET_COMMAS_OR_SPACES);if(pos>=attributeValue.length){break;}var url=collectCharacters(SRCSET_NOT_SPACES);if(url.slice(-1)===','){url=absoluteToDoc(doc,url.substring(0,url.length-1));output.push(url);}else{var descriptorsStr='';url=absoluteToDoc(doc,url);var inParens=false;while(true){var c=attributeValue.charAt(pos);if(c===''){output.push((url+descriptorsStr).trim());break;}else if(!inParens){if(c===','){pos+=1;output.push((url+descriptorsStr).trim());break;}else if(c==='('){inParens=true;}}else{if(c===')'){inParens=false;}}descriptorsStr+=c;pos+=1;}}}return output.join(', ');}function absoluteToDoc(doc,attributeValue){if(!attributeValue||attributeValue.trim()===''){return attributeValue;}var a=doc.createElement('a');a.href=attributeValue;createCbId(a);return a.href;}function isSVGElement(el){return el.tagName==='svg'||el instanceof SVGElement;}function getHref(){var a=document.createElement('a');a.href='';createCbId(a);return a.href;}function transformAttribute(doc,tagName,name,value){if(name==='src'||(name==='href'||name==='xlink:href')&&value){return absoluteToDoc(doc,value);}else if(name==='background'&&value&&(tagName==='table'||tagName==='td'||tagName==='th')){return absoluteToDoc(doc,value);}else if(name==='srcset'&&value){return getAbsoluteSrcsetString(doc,value);}else if(name==='style'&&value){return absoluteToStylesheet(value,getHref());}else{return value;}}function _isBlockedElement(element,blockClass,blockSelector){if(typeof blockClass==='string'){if(element.classList.contains(blockClass)){return true;}}else{for(var eIndex=0;eIndex<element.classList.length;eIndex++){var className=element.classList[eIndex];if(blockClass.test(className)){return true;}}}if(blockSelector){return element.matches(blockSelector);}return false;}function needMaskingText(node,maskTextClass,maskTextSelector){if(!node){return false;}if(node.nodeType===node.ELEMENT_NODE){if(typeof maskTextClass==='string'){if(node.classList.contains(maskTextClass)){return true;}}else{node.classList.forEach(function(className){if(maskTextClass.test(className)){return true;}});}if(maskTextSelector){if(node.matches(maskTextSelector)){return true;}}return needMaskingText(node.parentNode,maskTextClass,maskTextSelector);}if(node.nodeType===node.TEXT_NODE){return needMaskingText(node.parentNode,maskTextClass,maskTextSelector);}return needMaskingText(node.parentNode,maskTextClass,maskTextSelector);}function onceIframeLoaded(iframeEl,listener,iframeLoadTimeout){var win=iframeEl.contentWindow;if(!win){return;}var fired=false;var readyState;try{readyState=win.document.readyState;}catch(error){return;}if(readyState!=='complete'){var timer_1=setTimeout(function(){if(!fired){listener();fired=true;}},iframeLoadTimeout);iframeEl.addEventListener('load',function(){clearTimeout(timer_1);fired=true;listener();});return;}var blankUrl='about:blank';if(win.location.href!==blankUrl||iframeEl.src===blankUrl||iframeEl.src===''){setTimeout(listener,0);return;}iframeEl.addEventListener('load',listener);}function serializeNode(n,options){var doc=options.doc,blockClass=options.blockClass,blockSelector=options.blockSelector,maskTextClass=options.maskTextClass,maskTextSelector=options.maskTextSelector,inlineStylesheet=options.inlineStylesheet,_a=options.maskInputOptions,maskInputOptions=_a===void 0?{}:_a,maskTextFn=options.maskTextFn,maskInputFn=options.maskInputFn,recordCanvas=options.recordCanvas,keepIframeSrcFn=options.keepIframeSrcFn;var rootId;if(doc.__sn){var docId=doc.__sn.id;rootId=docId===1?undefined:docId;}switch(n.nodeType){case n.DOCUMENT_NODE:return{type:NodeType.Document,childNodes:[],rootId:rootId};case n.DOCUMENT_TYPE_NODE:return{type:NodeType.DocumentType,name:n.name,publicId:n.publicId,systemId:n.systemId,rootId:rootId};case n.ELEMENT_NODE:if(n.getAttribute&&n.getAttribute("do-not-mutate")==='true'){console.log("got do-not-mutate",n);return false;}var needBlock=_isBlockedElement(n,blockClass,blockSelector);var tagName=getValidTagName(n);var attributes_1={};for(var _i=0,_b=Array.from(n.attributes);_i<_b.length;_i++){var _c=_b[_i],name=_c.name,value=_c.value;attributes_1[name]=transformAttribute(doc,tagName,name,value);}if(tagName==='link'&&inlineStylesheet){var stylesheet=Array.from(doc.styleSheets).find(function(s){return s.href===n.href;});var cssText=getCssRulesString(stylesheet);if(cssText){delete attributes_1.rel;delete attributes_1.href;attributes_1._cssText=absoluteToStylesheet(cssText,stylesheet.href);}}if(tagName==='style'&&n.sheet&&!(n.innerText||n.textContent||'').trim().length){var cssText=getCssRulesString(n.sheet);if(cssText){attributes_1._cssText=absoluteToStylesheet(cssText,getHref());}}if(tagName==='input'||tagName==='textarea'||tagName==='select'){var value=n.value;if(attributes_1.type==='text'){console.log("text");}if(attributes_1.type!=='radio'&&attributes_1.type!=='checkbox'&&attributes_1.type!=='submit'&&attributes_1.type!=='button'&&value){attributes_1.value=maskInputValue({type:attributes_1.type,tagName:tagName,value:value,maskInputOptions:maskInputOptions,maskInputFn:maskInputFn});}else if(n.checked){attributes_1.checked=n.checked;}}if(tagName==='option'){if(n.selected){attributes_1.selected=true;}else{delete attributes_1.selected;}}if(tagName==='canvas'&&recordCanvas){attributes_1.rr_dataURL=n.toDataURL();}if(tagName==='audio'||tagName==='video'){attributes_1.rr_mediaState=n.paused?'paused':'played';attributes_1.rr_mediaCurrentTime=n.currentTime;}if(n.scrollLeft){attributes_1.rr_scrollLeft=n.scrollLeft;}if(n.scrollTop){attributes_1.rr_scrollTop=n.scrollTop;}if(needBlock){var _d=n.getBoundingClientRect(),width=_d.width,height=_d.height;attributes_1={"class":attributes_1["class"],rr_width:width+"px",rr_height:height+"px"};}if(tagName==='iframe'&&!keepIframeSrcFn(attributes_1.src)){delete attributes_1.src;}return{type:NodeType.Element,tagName:tagName,attributes:attributes_1,childNodes:[],isSVG:isSVGElement(n)||undefined,needBlock:needBlock,rootId:rootId};case n.TEXT_NODE:var parentTagName=n.parentNode&&n.parentNode.tagName;var textContent=n.textContent;var isStyle=parentTagName==='STYLE'?true:undefined;var isScript=parentTagName==='SCRIPT'?true:undefined;if(isStyle&&textContent){textContent=absoluteToStylesheet(textContent,getHref());}if(isScript){textContent='SCRIPT_PLACEHOLDER';}if(!isStyle&&!isScript&&needMaskingText(n,maskTextClass,maskTextSelector)&&textContent){textContent=maskTextFn?maskTextFn(textContent):textContent.replace(/[\S]/g,'*');}return{type:NodeType.Text,textContent:textContent||'',isStyle:isStyle,rootId:rootId};case n.CDATA_SECTION_NODE:return{type:NodeType.CDATA,textContent:'',rootId:rootId};case n.COMMENT_NODE:return{type:NodeType.Comment,textContent:n.textContent||'',rootId:rootId};default:return false;}}function lowerIfExists(maybeAttr){if(maybeAttr===undefined){return'';}else{return maybeAttr.toLowerCase();}}function slimDOMExcluded(sn,slimDOMOptions){if(slimDOMOptions.comment&&sn.type===NodeType.Comment){return true;}else if(sn.type===NodeType.Element){if(slimDOMOptions.script&&(sn.tagName==='script'||sn.tagName==='link'&&sn.attributes.rel==='preload'&&sn.attributes.as==='script'||sn.tagName==='link'&&sn.attributes.rel==='prefetch'&&typeof sn.attributes.href==='string'&&sn.attributes.href.endsWith('.js'))){return true;}else if(slimDOMOptions.headFavicon&&(sn.tagName==='link'&&sn.attributes.rel==='shortcut icon'||sn.tagName==='meta'&&(lowerIfExists(sn.attributes.name).match(/^msapplication-tile(image|color)$/)||lowerIfExists(sn.attributes.name)==='application-name'||lowerIfExists(sn.attributes.rel)==='icon'||lowerIfExists(sn.attributes.rel)==='apple-touch-icon'||lowerIfExists(sn.attributes.rel)==='shortcut icon'))){return true;}else if(sn.tagName==='meta'){if(slimDOMOptions.headMetaDescKeywords&&lowerIfExists(sn.attributes.name).match(/^description|keywords$/)){return true;}else if(slimDOMOptions.headMetaSocial&&(lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/)||lowerIfExists(sn.attributes.name).match(/^(og|twitter):/)||lowerIfExists(sn.attributes.name)==='pinterest')){return true;}else if(slimDOMOptions.headMetaRobots&&(lowerIfExists(sn.attributes.name)==='robots'||lowerIfExists(sn.attributes.name)==='googlebot'||lowerIfExists(sn.attributes.name)==='bingbot')){return true;}else if(slimDOMOptions.headMetaHttpEquiv&&sn.attributes['http-equiv']!==undefined){return true;}else if(slimDOMOptions.headMetaAuthorship&&(lowerIfExists(sn.attributes.name)==='author'||lowerIfExists(sn.attributes.name)==='generator'||lowerIfExists(sn.attributes.name)==='framework'||lowerIfExists(sn.attributes.name)==='publisher'||lowerIfExists(sn.attributes.name)==='progid'||lowerIfExists(sn.attributes.property).match(/^article:/)||lowerIfExists(sn.attributes.property).match(/^product:/))){return true;}else if(slimDOMOptions.headMetaVerification&&(lowerIfExists(sn.attributes.name)==='google-site-verification'||lowerIfExists(sn.attributes.name)==='yandex-verification'||lowerIfExists(sn.attributes.name)==='csrf-token'||lowerIfExists(sn.attributes.name)==='p:domain_verify'||lowerIfExists(sn.attributes.name)==='verify-v1'||lowerIfExists(sn.attributes.name)==='verification'||lowerIfExists(sn.attributes.name)==='shopify-checkout-api-token')){return true;}}}return false;}function serializeNodeWithId(n,options){var doc=options.doc,map=options.map,blockClass=options.blockClass,blockSelector=options.blockSelector,maskTextClass=options.maskTextClass,maskTextSelector=options.maskTextSelector,_a=options.skipChild,skipChild=_a===void 0?false:_a,_b=options.inlineStylesheet,inlineStylesheet=_b===void 0?true:_b,_c=options.maskInputOptions,maskInputOptions=_c===void 0?{}:_c,maskTextFn=options.maskTextFn,maskInputFn=options.maskInputFn,slimDOMOptions=options.slimDOMOptions,_d=options.recordCanvas,recordCanvas=_d===void 0?false:_d,onSerialize=options.onSerialize,onIframeLoad=options.onIframeLoad,_e=options.iframeLoadTimeout,iframeLoadTimeout=_e===void 0?5000:_e,_f=options.keepIframeSrcFn,keepIframeSrcFn=_f===void 0?function(){return false;}:_f;var _g=options.preserveWhiteSpace,preserveWhiteSpace=_g===void 0?true:_g;var _serializedNode=serializeNode(n,{doc:doc,blockClass:blockClass,blockSelector:blockSelector,maskTextClass:maskTextClass,maskTextSelector:maskTextSelector,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskTextFn:maskTextFn,maskInputFn:maskInputFn,recordCanvas:recordCanvas,keepIframeSrcFn:keepIframeSrcFn});if(!_serializedNode){//console.warn(n, 'not serialized');
return null;}var id;if('__sn'in n){id=n.__sn.id;}else if(slimDOMExcluded(_serializedNode,slimDOMOptions)||!preserveWhiteSpace&&_serializedNode.type===NodeType.Text&&!_serializedNode.isStyle&&!_serializedNode.textContent.replace(/^\s+|\s+$/gm,'').length){id=IGNORED_NODE;}else{id=genId();}var serializedNode=Object.assign(_serializedNode,{id:id});n.__sn=serializedNode;if(id===IGNORED_NODE){return null;}map[id]=n;if(onSerialize){onSerialize(n);}var recordChild=!skipChild;if(serializedNode.type===NodeType.Element){recordChild=recordChild&&!serializedNode.needBlock;delete serializedNode.needBlock;}if((serializedNode.type===NodeType.Document||serializedNode.type===NodeType.Element)&&recordChild){if(slimDOMOptions.headWhitespace&&_serializedNode.type===NodeType.Element&&_serializedNode.tagName==='head'){preserveWhiteSpace=false;}var bypassOptions={doc:doc,map:map,blockClass:blockClass,blockSelector:blockSelector,maskTextClass:maskTextClass,maskTextSelector:maskTextSelector,skipChild:skipChild,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskTextFn:maskTextFn,maskInputFn:maskInputFn,slimDOMOptions:slimDOMOptions,recordCanvas:recordCanvas,preserveWhiteSpace:preserveWhiteSpace,onSerialize:onSerialize,onIframeLoad:onIframeLoad,iframeLoadTimeout:iframeLoadTimeout,keepIframeSrcFn:keepIframeSrcFn};for(var _i=0,_h=Array.from(n.childNodes);_i<_h.length;_i++){var childN=_h[_i];var serializedChildNode=serializeNodeWithId(childN,bypassOptions);if(serializedChildNode){serializedNode.childNodes.push(serializedChildNode);}}if(isElement(n)&&n.shadowRoot){serializedNode.isShadowHost=true;for(var _j=0,_k=Array.from(n.shadowRoot.childNodes);_j<_k.length;_j++){var childN=_k[_j];var serializedChildNode=serializeNodeWithId(childN,bypassOptions);if(serializedChildNode){serializedChildNode.isShadow=true;serializedNode.childNodes.push(serializedChildNode);}}}}if(n.parentNode&&isShadowRoot(n.parentNode)){serializedNode.isShadow=true;}if(serializedNode.type===NodeType.Element&&serializedNode.tagName==='iframe'){onceIframeLoaded(n,function(){var iframeDoc=n.contentDocument;if(iframeDoc&&onIframeLoad){var serializedIframeNode=serializeNodeWithId(iframeDoc,{doc:iframeDoc,map:map,blockClass:blockClass,blockSelector:blockSelector,maskTextClass:maskTextClass,maskTextSelector:maskTextSelector,skipChild:false,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskTextFn:maskTextFn,maskInputFn:maskInputFn,slimDOMOptions:slimDOMOptions,recordCanvas:recordCanvas,preserveWhiteSpace:preserveWhiteSpace,onSerialize:onSerialize,onIframeLoad:onIframeLoad,iframeLoadTimeout:iframeLoadTimeout,keepIframeSrcFn:keepIframeSrcFn});if(serializedIframeNode){onIframeLoad(n,serializedIframeNode);}}},iframeLoadTimeout);}return serializedNode;}function snapshot(n,options){var _a=options||{},_b=_a.blockClass,blockClass=_b===void 0?'rr-block':_b,_c=_a.blockSelector,blockSelector=_c===void 0?null:_c,_d=_a.maskTextClass,maskTextClass=_d===void 0?'rr-mask':_d,_e=_a.maskTextSelector,maskTextSelector=_e===void 0?null:_e,_f=_a.inlineStylesheet,inlineStylesheet=_f===void 0?true:_f,_g=_a.recordCanvas,recordCanvas=_g===void 0?false:_g,_h=_a.maskAllInputs,maskAllInputs=_h===void 0?false:_h,maskTextFn=_a.maskTextFn,maskInputFn=_a.maskInputFn,_j=_a.slimDOM,slimDOM=_j===void 0?false:_j,preserveWhiteSpace=_a.preserveWhiteSpace,onSerialize=_a.onSerialize,onIframeLoad=_a.onIframeLoad,iframeLoadTimeout=_a.iframeLoadTimeout,_k=_a.keepIframeSrcFn,keepIframeSrcFn=_k===void 0?function(){return false;}:_k;var idNodeMap={};var maskInputOptions=maskAllInputs===true?{color:true,date:true,'datetime-local':true,email:true,month:true,number:true,range:true,search:true,tel:true,text:true,time:true,url:true,week:true,textarea:true,select:true,password:true}:maskAllInputs===false?{password:true}:maskAllInputs;var slimDOMOptions=slimDOM===true||slimDOM==='all'?{script:true,comment:true,headFavicon:true,headWhitespace:true,headMetaDescKeywords:slimDOM==='all',headMetaSocial:true,headMetaRobots:true,headMetaHttpEquiv:true,headMetaAuthorship:true,headMetaVerification:true}:slimDOM===false?{}:slimDOM;return[serializeNodeWithId(n,{doc:n,map:idNodeMap,blockClass:blockClass,blockSelector:blockSelector,maskTextClass:maskTextClass,maskTextSelector:maskTextSelector,skipChild:false,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskTextFn:maskTextFn,maskInputFn:maskInputFn,slimDOMOptions:slimDOMOptions,recordCanvas:recordCanvas,preserveWhiteSpace:preserveWhiteSpace,onSerialize:onSerialize,onIframeLoad:onIframeLoad,iframeLoadTimeout:iframeLoadTimeout,keepIframeSrcFn:keepIframeSrcFn}),idNodeMap];}var commentre=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function parse(css,options){if(options===void 0){options={};}var lineno=1;var column=1;function updatePosition(str){var lines=str.match(/\n/g);if(lines){lineno+=lines.length;}var i=str.lastIndexOf('\n');column=i===-1?column+str.length:str.length-i;}function position(){var start={line:lineno,column:column};return function(node){node.position=new Position(start);whitespace();return node;};}var Position=function(){function Position(start){this.start=start;this.end={line:lineno,column:column};this.source=options.source;}return Position;}();Position.prototype.content=css;var errorsList=[];function error(msg){var err=new Error(options.source+':'+lineno+':'+column+': '+msg);err.reason=msg;err.filename=options.source;err.line=lineno;err.column=column;err.source=css;if(options.silent){errorsList.push(err);}else{throw err;}}function stylesheet(){var rulesList=rules();return{type:'stylesheet',stylesheet:{source:options.source,rules:rulesList,parsingErrors:errorsList}};}function open(){return match(/^{\s*/);}function close(){return match(/^}/);}function rules(){var node;var rules=[];whitespace();comments(rules);while(css.length&&css.charAt(0)!=='}'&&(node=atrule()||rule())){if(node!==false){rules.push(node);comments(rules);}}return rules;}function match(re){var m=re.exec(css);if(!m){return;}var str=m[0];updatePosition(str);css=css.slice(str.length);return m;}function whitespace(){match(/^\s*/);}function comments(rules){if(rules===void 0){rules=[];}var c;while(c=comment()){if(c!==false){rules.push(c);}c=comment();}return rules;}function comment(){var pos=position();if('/'!==css.charAt(0)||'*'!==css.charAt(1)){return;}var i=2;while(''!==css.charAt(i)&&('*'!==css.charAt(i)||'/'!==css.charAt(i+1))){++i;}i+=2;if(''===css.charAt(i-1)){return error('End of comment missing');}var str=css.slice(2,i-2);column+=2;updatePosition(str);css=css.slice(i);column+=2;return pos({type:'comment',comment:str});}function selector(){var m=match(/^([^{]+)/);if(!m){return;}return trim(m[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,'').replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(m){return m.replace(/,/g,"\u200C");}).split(/\s*(?![^(]*\)),\s*/).map(function(s){return s.replace(/\u200C/g,',');});}function declaration(){var pos=position();var propMatch=match(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!propMatch){return;}var prop=trim(propMatch[0]);if(!match(/^:\s*/)){return error("property missing ':'");}var val=match(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/);var ret=pos({type:'declaration',property:prop.replace(commentre,''),value:val?trim(val[0]).replace(commentre,''):''});match(/^[;\s]*/);return ret;}function declarations(){var decls=[];if(!open()){return error("missing '{'");}comments(decls);var decl;while(decl=declaration()){if(decl!==false){decls.push(decl);comments(decls);}decl=declaration();}if(!close()){return error("missing '}'");}return decls;}function keyframe(){var m;var vals=[];var pos=position();while(m=match(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/)){vals.push(m[1]);match(/^,\s*/);}if(!vals.length){return;}return pos({type:'keyframe',values:vals,declarations:declarations()});}function atkeyframes(){var pos=position();var m=match(/^@([-\w]+)?keyframes\s*/);if(!m){return;}var vendor=m[1];m=match(/^([-\w]+)\s*/);if(!m){return error('@keyframes missing name');}var name=m[1];if(!open()){return error("@keyframes missing '{'");}var frame;var frames=comments();while(frame=keyframe()){frames.push(frame);frames=frames.concat(comments());}if(!close()){return error("@keyframes missing '}'");}return pos({type:'keyframes',name:name,vendor:vendor,keyframes:frames});}function atsupports(){var pos=position();var m=match(/^@supports *([^{]+)/);if(!m){return;}var supports=trim(m[1]);if(!open()){return error("@supports missing '{'");}var style=comments().concat(rules());if(!close()){return error("@supports missing '}'");}return pos({type:'supports',supports:supports,rules:style});}function athost(){var pos=position();var m=match(/^@host\s*/);if(!m){return;}if(!open()){return error("@host missing '{'");}var style=comments().concat(rules());if(!close()){return error("@host missing '}'");}return pos({type:'host',rules:style});}function atmedia(){var pos=position();var m=match(/^@media *([^{]+)/);if(!m){return;}var media=trim(m[1]);if(!open()){return error("@media missing '{'");}var style=comments().concat(rules());if(!close()){return error("@media missing '}'");}return pos({type:'media',media:media,rules:style});}function atcustommedia(){var pos=position();var m=match(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(!m){return;}return pos({type:'custom-media',name:trim(m[1]),media:trim(m[2])});}function atpage(){var pos=position();var m=match(/^@page */);if(!m){return;}var sel=selector()||[];if(!open()){return error("@page missing '{'");}var decls=comments();var decl;while(decl=declaration()){decls.push(decl);decls=decls.concat(comments());}if(!close()){return error("@page missing '}'");}return pos({type:'page',selectors:sel,declarations:decls});}function atdocument(){var pos=position();var m=match(/^@([-\w]+)?document *([^{]+)/);if(!m){return;}var vendor=trim(m[1]);var doc=trim(m[2]);if(!open()){return error("@document missing '{'");}var style=comments().concat(rules());if(!close()){return error("@document missing '}'");}return pos({type:'document',document:doc,vendor:vendor,rules:style});}function atfontface(){var pos=position();var m=match(/^@font-face\s*/);if(!m){return;}if(!open()){return error("@font-face missing '{'");}var decls=comments();var decl;while(decl=declaration()){decls.push(decl);decls=decls.concat(comments());}if(!close()){return error("@font-face missing '}'");}return pos({type:'font-face',declarations:decls});}var atimport=_compileAtrule('import');var atcharset=_compileAtrule('charset');var atnamespace=_compileAtrule('namespace');function _compileAtrule(name){var re=new RegExp('^@'+name+'\\s*([^;]+);');return function(){var pos=position();var m=match(re);if(!m){return;}var ret={type:name};ret[name]=m[1].trim();return pos(ret);};}function atrule(){if(css[0]!=='@'){return;}return atkeyframes()||atmedia()||atcustommedia()||atsupports()||atimport()||atcharset()||atnamespace()||atdocument()||atpage()||athost()||atfontface();}function rule(){var pos=position();var sel=selector();if(!sel){return error('selector missing');}comments();return pos({type:'rule',selectors:sel,declarations:declarations()});}return addParent(stylesheet());}function trim(str){return str?str.replace(/^\s+|\s+$/g,''):'';}function addParent(obj,parent){var isNode=obj&&typeof obj.type==='string';var childParent=isNode?obj:parent;for(var _i=0,_a=Object.keys(obj);_i<_a.length;_i++){var k=_a[_i];var value=obj[k];if(Array.isArray(value)){value.forEach(function(v){addParent(v,childParent);});}else if(value&&_typeof(value)==='object'){addParent(value,childParent);}}if(isNode){Object.defineProperty(obj,'parent',{configurable:true,writable:true,enumerable:false,value:parent||null});}return obj;}var tagMap={script:'noscript',altglyph:'altGlyph',altglyphdef:'altGlyphDef',altglyphitem:'altGlyphItem',animatecolor:'animateColor',animatemotion:'animateMotion',animatetransform:'animateTransform',clippath:'clipPath',feblend:'feBlend',fecolormatrix:'feColorMatrix',fecomponenttransfer:'feComponentTransfer',fecomposite:'feComposite',feconvolvematrix:'feConvolveMatrix',fediffuselighting:'feDiffuseLighting',fedisplacementmap:'feDisplacementMap',fedistantlight:'feDistantLight',fedropshadow:'feDropShadow',feflood:'feFlood',fefunca:'feFuncA',fefuncb:'feFuncB',fefuncg:'feFuncG',fefuncr:'feFuncR',fegaussianblur:'feGaussianBlur',feimage:'feImage',femerge:'feMerge',femergenode:'feMergeNode',femorphology:'feMorphology',feoffset:'feOffset',fepointlight:'fePointLight',fespecularlighting:'feSpecularLighting',fespotlight:'feSpotLight',fetile:'feTile',feturbulence:'feTurbulence',foreignobject:'foreignObject',glyphref:'glyphRef',lineargradient:'linearGradient',radialgradient:'radialGradient'};function getTagName(n){var tagName=tagMap[n.tagName]?tagMap[n.tagName]:n.tagName;if(tagName==='link'&&n.attributes._cssText){tagName='style';}return tagName;}function escapeRegExp(str){return str.replace(/[.*+?^${}()|[\]\\]/g,'\\$&');}var HOVER_SELECTOR=/([^\\]):hover/;var HOVER_SELECTOR_GLOBAL=new RegExp(HOVER_SELECTOR,'g');function addHoverClass(cssText,cache){var cachedStyle=cache===null||cache===void 0?void 0:cache.stylesWithHoverClass.get(cssText);if(cachedStyle)return cachedStyle;var ast=parse(cssText,{silent:true});if(!ast.stylesheet){return cssText;}var selectors=[];ast.stylesheet.rules.forEach(function(rule){if('selectors'in rule){(rule.selectors||[]).forEach(function(selector){if(HOVER_SELECTOR.test(selector)){selectors.push(selector);}});}});if(selectors.length===0){return cssText;}var selectorMatcher=new RegExp(selectors.filter(function(selector,index){return selectors.indexOf(selector)===index;}).sort(function(a,b){return b.length-a.length;}).map(function(selector){return escapeRegExp(selector);}).join('|'),'g');var result=cssText.replace(selectorMatcher,function(selector){var newSelector=selector.replace(HOVER_SELECTOR_GLOBAL,'$1.\\:hover');return selector+", "+newSelector;});cache===null||cache===void 0?void 0:cache.stylesWithHoverClass.set(cssText,result);return result;}function createCache(){var stylesWithHoverClass=new Map();return{stylesWithHoverClass:stylesWithHoverClass};}function buildNode(n,options){var doc=options.doc,hackCss=options.hackCss,cache=options.cache;switch(n.type){case NodeType.Document:return doc.implementation.createDocument(null,'',null);case NodeType.DocumentType:return doc.implementation.createDocumentType(n.name||'html',n.publicId,n.systemId);case NodeType.Element:var tagName=getTagName(n);var node_1;if(n.isSVG){node_1=doc.createElementNS('http://www.w3.org/2000/svg',tagName);}else{node_1=doc.createElement(tagName);}createCbId(node_1);var _loop_1=function _loop_1(name){if(!n.attributes.hasOwnProperty(name)){return"continue";}var value=n.attributes[name];if(tagName==='option'&&name==='selected'&&value===false){return"continue";}value=typeof value==='boolean'||typeof value==='number'?'':value;if(!name.startsWith('rr_')){var isTextarea=tagName==='textarea'&&name==='value';var isRemoteOrDynamicCss=tagName==='style'&&name==='_cssText';if(isRemoteOrDynamicCss&&hackCss){value=addHoverClass(value,cache);}if(isTextarea||isRemoteOrDynamicCss){var child=doc.createTextNode(value);for(var _i=0,_a=Array.from(node_1.childNodes);_i<_a.length;_i++){var c=_a[_i];if(c.nodeType===node_1.TEXT_NODE){node_1.removeChild(c);}}node_1.appendChild(child);return"continue";}try{if(n.isSVG&&name==='xlink:href'){node_1.setAttributeNS('http://www.w3.org/1999/xlink',name,value);}else if(name==='onload'||name==='onclick'||name.substring(0,7)==='onmouse'){node_1.setAttribute('_'+name,value);}else if(tagName==='meta'&&n.attributes['http-equiv']==='Content-Security-Policy'&&name==='content'){node_1.setAttribute('csp-content',value);return"continue";}else if(tagName==='link'&&n.attributes.rel==='preload'&&n.attributes.as==='script');else if(tagName==='link'&&n.attributes.rel==='prefetch'&&typeof n.attributes.href==='string'&&n.attributes.href.endsWith('.js'));else{node_1.setAttribute(name,value);}}catch(error){}}else{if(tagName==='canvas'&&name==='rr_dataURL'){var image_1=document.createElement('img');image_1.src=value;image_1.onload=function(){var ctx=node_1.getContext('2d');if(ctx){ctx.drawImage(image_1,0,0,image_1.width,image_1.height);}};createCbId(image_1);}if(name==='rr_width'){node_1.style.width=value;}if(name==='rr_height'){node_1.style.height=value;}if(name==='rr_mediaCurrentTime'){node_1.currentTime=n.attributes.rr_mediaCurrentTime;}if(name==='rr_mediaState'){switch(value){case'played':node_1.play()["catch"](function(e){return console.warn('media playback error',e);});break;case'paused':node_1.pause();break;}}}};for(var name in n.attributes){_loop_1(name);}if(n.isShadowHost){if(!node_1.shadowRoot){node_1.attachShadow({mode:'open'});}else{while(node_1.shadowRoot.firstChild){node_1.shadowRoot.removeChild(node_1.shadowRoot.firstChild);}}}return node_1;case NodeType.Text:return doc.createTextNode(n.isStyle&&hackCss?addHoverClass(n.textContent,cache):n.textContent);case NodeType.CDATA:return doc.createCDATASection(n.textContent);case NodeType.Comment:return doc.createComment(n.textContent);default:return null;}}function buildNodeWithSN(n,options){var doc=options.doc,map=options.map,_a=options.skipChild,skipChild=_a===void 0?false:_a,_b=options.hackCss,hackCss=_b===void 0?true:_b,afterAppend=options.afterAppend,cache=options.cache;var node=buildNode(n,{doc:doc,hackCss:hackCss,cache:cache});if(!node){return null;}if(n.rootId){console.assert(map[n.rootId]===doc,'Target document should has the same root id.');}if(n.type===NodeType.Document){doc.close();doc.open();node=doc;}node.__sn=n;map[n.id]=node;if((n.type===NodeType.Document||n.type===NodeType.Element)&&!skipChild){for(var _i=0,_c=n.childNodes;_i<_c.length;_i++){var childN=_c[_i];var childNode=buildNodeWithSN(childN,{doc:doc,map:map,skipChild:false,hackCss:hackCss,afterAppend:afterAppend,cache:cache});if(!childNode){console.warn('Failed to rebuild',childN);continue;}if(childN.isShadow&&isElement(node)&&node.shadowRoot){node.shadowRoot.appendChild(childNode);}else{node.appendChild(childNode);}if(afterAppend){afterAppend(childNode);}}}return node;}function visit(idNodeMap,onVisit){function walk(node){onVisit(node);}for(var key in idNodeMap){if(idNodeMap[key]){walk(idNodeMap[key]);}}}function handleScroll(node){var n=node.__sn;if(n.type!==NodeType.Element){return;}var el=node;for(var name in n.attributes){if(!(n.attributes.hasOwnProperty(name)&&name.startsWith('rr_'))){continue;}var value=n.attributes[name];if(name==='rr_scrollLeft'){el.scrollLeft=value;}if(name==='rr_scrollTop'){el.scrollTop=value;}}}function rebuild(n,options){var doc=options.doc,onVisit=options.onVisit,_a=options.hackCss,hackCss=_a===void 0?true:_a,afterAppend=options.afterAppend,cache=options.cache;var idNodeMap={};var node=buildNodeWithSN(n,{doc:doc,map:idNodeMap,skipChild:false,hackCss:hackCss,afterAppend:afterAppend,cache:cache});visit(idNodeMap,function(visitedNode){if(onVisit){onVisit(visitedNode);}handleScroll(visitedNode);});return[node,idNodeMap];}exports.EventType=void 0;(function(EventType){EventType[EventType["DomContentLoaded"]=0]="DomContentLoaded";EventType[EventType["Load"]=1]="Load";EventType[EventType["FullSnapshot"]=2]="FullSnapshot";EventType[EventType["IncrementalSnapshot"]=3]="IncrementalSnapshot";EventType[EventType["Meta"]=4]="Meta";EventType[EventType["Custom"]=5]="Custom";EventType[EventType["Plugin"]=6]="Plugin";})(exports.EventType||(exports.EventType={}));exports.IncrementalSource=void 0;(function(IncrementalSource){IncrementalSource[IncrementalSource["Mutation"]=0]="Mutation";IncrementalSource[IncrementalSource["MouseMove"]=1]="MouseMove";IncrementalSource[IncrementalSource["MouseInteraction"]=2]="MouseInteraction";IncrementalSource[IncrementalSource["Scroll"]=3]="Scroll";IncrementalSource[IncrementalSource["ViewportResize"]=4]="ViewportResize";IncrementalSource[IncrementalSource["Input"]=5]="Input";IncrementalSource[IncrementalSource["TouchMove"]=6]="TouchMove";IncrementalSource[IncrementalSource["MediaInteraction"]=7]="MediaInteraction";IncrementalSource[IncrementalSource["StyleSheetRule"]=8]="StyleSheetRule";IncrementalSource[IncrementalSource["CanvasMutation"]=9]="CanvasMutation";IncrementalSource[IncrementalSource["Font"]=10]="Font";IncrementalSource[IncrementalSource["Log"]=11]="Log";IncrementalSource[IncrementalSource["Drag"]=12]="Drag";IncrementalSource[IncrementalSource["StyleDeclaration"]=13]="StyleDeclaration";})(exports.IncrementalSource||(exports.IncrementalSource={}));exports.MouseInteractions=void 0;(function(MouseInteractions){MouseInteractions[MouseInteractions["MouseUp"]=0]="MouseUp";MouseInteractions[MouseInteractions["MouseDown"]=1]="MouseDown";MouseInteractions[MouseInteractions["Click"]=2]="Click";MouseInteractions[MouseInteractions["ContextMenu"]=3]="ContextMenu";MouseInteractions[MouseInteractions["DblClick"]=4]="DblClick";MouseInteractions[MouseInteractions["Focus"]=5]="Focus";MouseInteractions[MouseInteractions["Blur"]=6]="Blur";MouseInteractions[MouseInteractions["TouchStart"]=7]="TouchStart";MouseInteractions[MouseInteractions["TouchMove_Departed"]=8]="TouchMove_Departed";MouseInteractions[MouseInteractions["TouchEnd"]=9]="TouchEnd";MouseInteractions[MouseInteractions["TouchCancel"]=10]="TouchCancel";})(exports.MouseInteractions||(exports.MouseInteractions={}));var MediaInteractions;(function(MediaInteractions){MediaInteractions[MediaInteractions["Play"]=0]="Play";MediaInteractions[MediaInteractions["Pause"]=1]="Pause";MediaInteractions[MediaInteractions["Seeked"]=2]="Seeked";})(MediaInteractions||(MediaInteractions={}));exports.ReplayerEvents=void 0;(function(ReplayerEvents){ReplayerEvents["Start"]="start";ReplayerEvents["Pause"]="pause";ReplayerEvents["Resume"]="resume";ReplayerEvents["Resize"]="resize";ReplayerEvents["Finish"]="finish";ReplayerEvents["FullsnapshotRebuilded"]="fullsnapshot-rebuilded";ReplayerEvents["LoadStylesheetStart"]="load-stylesheet-start";ReplayerEvents["LoadStylesheetEnd"]="load-stylesheet-end";ReplayerEvents["SkipStart"]="skip-start";ReplayerEvents["SkipEnd"]="skip-end";ReplayerEvents["MouseInteraction"]="mouse-interaction";ReplayerEvents["EventCast"]="event-cast";ReplayerEvents["CustomEvent"]="custom-event";ReplayerEvents["Flush"]="flush";ReplayerEvents["StateChange"]="state-change";ReplayerEvents["PlayBack"]="play-back";})(exports.ReplayerEvents||(exports.ReplayerEvents={}));function on(type,fn,target){if(target===void 0){target=document;}var options={capture:true,passive:true};target.addEventListener(type,fn,options);return function(){return target.removeEventListener(type,fn,options);};}function createMirror(){return{map:{},getId:function getId(n){if(!n||!n.__sn){return-1;}return n.__sn.id;},getNode:function getNode(id){return this.map[id]||null;},removeNodeFromMap:function removeNodeFromMap(n){var _this=this;var id=n.__sn&&n.__sn.id;delete this.map[id];if(n.childNodes){n.childNodes.forEach(function(child){return _this.removeNodeFromMap(child);});}},has:function has(id){return this.map.hasOwnProperty(id);},reset:function reset(){this.map={};}};}var DEPARTED_MIRROR_ACCESS_WARNING='Please stop import mirror directly. Instead of that,'+'\r\n'+'now you can use replayer.getMirror() to access the mirror instance of a replayer,'+'\r\n'+'or you can use record.mirror to access the mirror instance during recording.';exports.mirror={map:{},getId:function getId(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return-1;},getNode:function getNode(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return null;},removeNodeFromMap:function removeNodeFromMap(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);},has:function has(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);return false;},reset:function reset(){console.error(DEPARTED_MIRROR_ACCESS_WARNING);}};if(typeof window!=='undefined'&&window.Proxy&&window.Reflect){exports.mirror=new Proxy(exports.mirror,{get:function get(target,prop,receiver){if(prop==='map'){console.error(DEPARTED_MIRROR_ACCESS_WARNING);}return Reflect.get(target,prop,receiver);}});}function throttle(func,wait,options){if(options===void 0){options={};}var timeout=null;var previous=0;return function(arg){var now=Date.now();if(!previous&&options.leading===false){previous=now;}var remaining=wait-(now-previous);var context=this;var args=arguments;if(remaining<=0||remaining>wait){if(timeout){window.clearTimeout(timeout);timeout=null;}previous=now;func.apply(context,args);}else if(!timeout&&options.trailing!==false){timeout=window.setTimeout(function(){previous=options.leading===false?0:Date.now();timeout=null;func.apply(context,args);},remaining);}};}function hookSetter(target,key,d,isRevoked,win){if(win===void 0){win=window;}var original=win.Object.getOwnPropertyDescriptor(target,key);win.Object.defineProperty(target,key,isRevoked?d:{set:function set(value){var _this=this;setTimeout(function(){d.set.call(_this,value);},0);if(original&&original.set){original.set.call(this,value);}}});return function(){return hookSetter(target,key,original||{},true);};}function patch(source,name,replacement){try{if(!(name in source)){return function(){};}var original_1=source[name];var wrapped=replacement(original_1);if(typeof wrapped==='function'){wrapped.prototype=wrapped.prototype||{};Object.defineProperties(wrapped,{__rrweb_original__:{enumerable:false,value:original_1}});}source[name]=wrapped;return function(){source[name]=original_1;};}catch(_a){return function(){};}}function getWindowHeight(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight;}function getWindowWidth(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth;}function isBlocked(node,blockClass){if(!node){return false;}if(node.nodeType===node.ELEMENT_NODE){var needBlock_1=false;if(typeof blockClass==='string'){needBlock_1=node.classList.contains(blockClass);}else{node.classList.forEach(function(className){if(blockClass.test(className)){needBlock_1=true;}});}return needBlock_1||isBlocked(node.parentNode,blockClass);}if(node.nodeType===node.TEXT_NODE){return isBlocked(node.parentNode,blockClass);}return isBlocked(node.parentNode,blockClass);}function isIgnored(n){if('__sn'in n){return n.__sn.id===IGNORED_NODE;}return false;}function isAncestorRemoved(target,mirror){if(isShadowRoot(target)){return false;}var id=mirror.getId(target);if(!mirror.has(id)){return true;}if(target.parentNode&&target.parentNode.nodeType===target.DOCUMENT_NODE){return false;}if(!target.parentNode){return true;}return isAncestorRemoved(target.parentNode,mirror);}function isTouchEvent(event){return Boolean(event.changedTouches);}function polyfill$1(win){if(win===void 0){win=window;}if('NodeList'in win&&!win.NodeList.prototype.forEach){win.NodeList.prototype.forEach=Array.prototype.forEach;}if('DOMTokenList'in win&&!win.DOMTokenList.prototype.forEach){win.DOMTokenList.prototype.forEach=Array.prototype.forEach;}if(!Node.prototype.contains){Node.prototype.contains=function contains(node){if(!(0 in arguments)){throw new TypeError('1 argument is required');}do{if(this===node){return true;}}while(node=node&&node.parentNode);return false;};}}var TreeIndex=function(){function TreeIndex(){this.reset();}TreeIndex.prototype.add=function(mutation){var parentTreeNode=this.indexes.get(mutation.parentId);var treeNode={id:mutation.node.id,mutation:mutation,children:[],texts:[],attributes:[]};if(!parentTreeNode){this.tree[treeNode.id]=treeNode;}else{treeNode.parent=parentTreeNode;parentTreeNode.children[treeNode.id]=treeNode;}this.indexes.set(treeNode.id,treeNode);};TreeIndex.prototype.remove=function(mutation,mirror){var _this=this;var parentTreeNode=this.indexes.get(mutation.parentId);var treeNode=this.indexes.get(mutation.id);var deepRemoveFromMirror=function deepRemoveFromMirror(id){_this.removeIdSet.add(id);var node=mirror.getNode(id);node===null||node===void 0?void 0:node.childNodes.forEach(function(childNode){if('__sn'in childNode){deepRemoveFromMirror(childNode.__sn.id);}});};var deepRemoveFromTreeIndex=function deepRemoveFromTreeIndex(node){_this.removeIdSet.add(node.id);Object.values(node.children).forEach(function(n){return deepRemoveFromTreeIndex(n);});var _treeNode=_this.indexes.get(node.id);if(_treeNode){var _parentTreeNode=_treeNode.parent;if(_parentTreeNode){delete _treeNode.parent;delete _parentTreeNode.children[_treeNode.id];_this.indexes["delete"](mutation.id);}}};if(!treeNode){this.removeNodeMutations.push(mutation);deepRemoveFromMirror(mutation.id);}else if(!parentTreeNode){delete this.tree[treeNode.id];this.indexes["delete"](treeNode.id);deepRemoveFromTreeIndex(treeNode);}else{delete treeNode.parent;delete parentTreeNode.children[treeNode.id];this.indexes["delete"](mutation.id);deepRemoveFromTreeIndex(treeNode);}};TreeIndex.prototype.text=function(mutation){var treeNode=this.indexes.get(mutation.id);if(treeNode){treeNode.texts.push(mutation);}else{this.textMutations.push(mutation);}};TreeIndex.prototype.attribute=function(mutation){var treeNode=this.indexes.get(mutation.id);if(treeNode){treeNode.attributes.push(mutation);}else{this.attributeMutations.push(mutation);}};TreeIndex.prototype.scroll=function(d){this.scrollMap.set(d.id,d);};TreeIndex.prototype.input=function(d){this.inputMap.set(d.id,d);};TreeIndex.prototype.flush=function(){var e_1,_a,e_2,_b;var _this=this;var _c=this,tree=_c.tree,removeNodeMutations=_c.removeNodeMutations,textMutations=_c.textMutations,attributeMutations=_c.attributeMutations;var batchMutationData={source:exports.IncrementalSource.Mutation,removes:removeNodeMutations,texts:textMutations,attributes:attributeMutations,adds:[]};var walk=function walk(treeNode,removed){if(removed){_this.removeIdSet.add(treeNode.id);}batchMutationData.texts=batchMutationData.texts.concat(removed?[]:treeNode.texts).filter(function(m){return!_this.removeIdSet.has(m.id);});batchMutationData.attributes=batchMutationData.attributes.concat(removed?[]:treeNode.attributes).filter(function(m){return!_this.removeIdSet.has(m.id);});if(!_this.removeIdSet.has(treeNode.id)&&!_this.removeIdSet.has(treeNode.mutation.parentId)&&!removed){batchMutationData.adds.push(treeNode.mutation);if(treeNode.children){Object.values(treeNode.children).forEach(function(n){return walk(n,false);});}}else{Object.values(treeNode.children).forEach(function(n){return walk(n,true);});}};Object.values(tree).forEach(function(n){return walk(n,false);});try{for(var _d=__values(this.scrollMap.keys()),_e=_d.next();!_e.done;_e=_d.next()){var id=_e.value;if(this.removeIdSet.has(id)){this.scrollMap["delete"](id);}}}catch(e_1_1){e_1={error:e_1_1};}finally{try{if(_e&&!_e.done&&(_a=_d["return"]))_a.call(_d);}finally{if(e_1)throw e_1.error;}}try{for(var _f=__values(this.inputMap.keys()),_g=_f.next();!_g.done;_g=_f.next()){var id=_g.value;if(this.removeIdSet.has(id)){this.inputMap["delete"](id);}}}catch(e_2_1){e_2={error:e_2_1};}finally{try{if(_g&&!_g.done&&(_b=_f["return"]))_b.call(_f);}finally{if(e_2)throw e_2.error;}}var scrollMap=new Map(this.scrollMap);var inputMap=new Map(this.inputMap);this.reset();return{mutationData:batchMutationData,scrollMap:scrollMap,inputMap:inputMap};};TreeIndex.prototype.reset=function(){this.tree=[];this.indexes=new Map();this.removeNodeMutations=[];this.textMutations=[];this.attributeMutations=[];this.removeIdSet=new Set();this.scrollMap=new Map();this.inputMap=new Map();};TreeIndex.prototype.idRemoved=function(id){return this.removeIdSet.has(id);};return TreeIndex;}();function queueToResolveTrees(queue){var e_3,_a;var queueNodeMap={};var putIntoMap=function putIntoMap(m,parent){var nodeInTree={value:m,parent:parent,children:[]};queueNodeMap[m.node.id]=nodeInTree;return nodeInTree;};var queueNodeTrees=[];try{for(var queue_1=__values(queue),queue_1_1=queue_1.next();!queue_1_1.done;queue_1_1=queue_1.next()){var mutation=queue_1_1.value;var nextId=mutation.nextId,parentId=mutation.parentId;if(nextId&&nextId in queueNodeMap){var nextInTree=queueNodeMap[nextId];if(nextInTree.parent){var idx=nextInTree.parent.children.indexOf(nextInTree);nextInTree.parent.children.splice(idx,0,putIntoMap(mutation,nextInTree.parent));}else{var idx=queueNodeTrees.indexOf(nextInTree);queueNodeTrees.splice(idx,0,putIntoMap(mutation,null));}continue;}if(parentId in queueNodeMap){var parentInTree=queueNodeMap[parentId];parentInTree.children.push(putIntoMap(mutation,parentInTree));continue;}queueNodeTrees.push(putIntoMap(mutation,null));}}catch(e_3_1){e_3={error:e_3_1};}finally{try{if(queue_1_1&&!queue_1_1.done&&(_a=queue_1["return"]))_a.call(queue_1);}finally{if(e_3)throw e_3.error;}}return queueNodeTrees;}function iterateResolveTree(tree,cb){cb(tree.value);for(var i=tree.children.length-1;i>=0;i--){iterateResolveTree(tree.children[i],cb);}}function isIframeINode(node){if('__sn'in node){return node.__sn.type===NodeType.Element&&node.__sn.tagName==='iframe';}return false;}function getBaseDimension(node,rootIframe){var _a,_b;var frameElement=(_b=(_a=node.ownerDocument)===null||_a===void 0?void 0:_a.defaultView)===null||_b===void 0?void 0:_b.frameElement;if(!frameElement||frameElement===rootIframe){return{x:0,y:0,relativeScale:1,absoluteScale:1};}var frameDimension=frameElement.getBoundingClientRect();var frameBaseDimension=getBaseDimension(frameElement,rootIframe);var relativeScale=frameDimension.height/frameElement.clientHeight;return{x:frameDimension.x*frameBaseDimension.relativeScale+frameBaseDimension.x,y:frameDimension.y*frameBaseDimension.relativeScale+frameBaseDimension.y,relativeScale:relativeScale,absoluteScale:frameBaseDimension.absoluteScale*relativeScale};}function hasShadowRoot(n){var _a;return Boolean((_a=n)===null||_a===void 0?void 0:_a.shadowRoot);}var utils=/*#__PURE__*/Object.freeze({__proto__:null,on:on,createMirror:createMirror,get _mirror(){return exports.mirror;},throttle:throttle,hookSetter:hookSetter,patch:patch,getWindowHeight:getWindowHeight,getWindowWidth:getWindowWidth,isBlocked:isBlocked,isIgnored:isIgnored,isAncestorRemoved:isAncestorRemoved,isTouchEvent:isTouchEvent,polyfill:polyfill$1,TreeIndex:TreeIndex,queueToResolveTrees:queueToResolveTrees,iterateResolveTree:iterateResolveTree,isIframeINode:isIframeINode,getBaseDimension:getBaseDimension,hasShadowRoot:hasShadowRoot});function isNodeInLinkedList(n){return'__ln'in n;}var DoubleLinkedList=function(){function DoubleLinkedList(){this.length=0;this.head=null;}DoubleLinkedList.prototype.get=function(position){if(position>=this.length){throw new Error('Position outside of list range');}var current=this.head;for(var index=0;index<position;index++){current=(current===null||current===void 0?void 0:current.next)||null;}return current;};DoubleLinkedList.prototype.addNode=function(n){var node={value:n,previous:null,next:null};n.__ln=node;if(n.previousSibling&&isNodeInLinkedList(n.previousSibling)){var current=n.previousSibling.__ln.next;node.next=current;node.previous=n.previousSibling.__ln;n.previousSibling.__ln.next=node;if(current){current.previous=node;}}else if(n.nextSibling&&isNodeInLinkedList(n.nextSibling)&&n.nextSibling.__ln.previous){var current=n.nextSibling.__ln.previous;node.previous=current;node.next=n.nextSibling.__ln;n.nextSibling.__ln.previous=node;if(current){current.next=node;}}else{if(this.head){this.head.previous=node;}node.next=this.head;this.head=node;}this.length++;};DoubleLinkedList.prototype.removeNode=function(n){var current=n.__ln;if(!this.head){return;}if(!current.previous){this.head=current.next;if(this.head){this.head.previous=null;}}else{current.previous.next=current.next;if(current.next){current.next.previous=current.previous;}}if(n.__ln){delete n.__ln;}this.length--;};return DoubleLinkedList;}();var moveKey=function moveKey(id,parentId){return id+"@"+parentId;};function isINode(n){return'__sn'in n;}var MutationBuffer=function(){function MutationBuffer(){var _this=this;this.frozen=false;this.locked=false;this.texts=[];this.attributes=[];this.removes=[];this.mapRemoves=[];this.movedMap={};this.addedSet=new Set();this.movedSet=new Set();this.droppedSet=new Set();this.processMutations=function(mutations){mutations.forEach(_this.processMutation);_this.emit();};this.emit=function(){var e_1,_a,e_2,_b;if(_this.frozen||_this.locked){return;}var adds=[];var addList=new DoubleLinkedList();var getNextId=function getNextId(n){var ns=n;var nextId=IGNORED_NODE;while(nextId===IGNORED_NODE){ns=ns&&ns.nextSibling;nextId=ns&&_this.mirror.getId(ns);}if(nextId===-1&&isBlocked(n.nextSibling,_this.blockClass)){nextId=null;}return nextId;};var pushAdd=function pushAdd(n){var _a;var shadowHost=n.getRootNode?(_a=n.getRootNode())===null||_a===void 0?void 0:_a.host:null;var notInDoc=!_this.doc.contains(n)&&(!(shadowHost instanceof Node)||!_this.doc.contains(shadowHost));if(!n.parentNode||notInDoc){return;}var parentId=isShadowRoot(n.parentNode)?_this.mirror.getId(shadowHost):_this.mirror.getId(n.parentNode);var nextId=getNextId(n);if(parentId===-1||nextId===-1){return addList.addNode(n);}var sn=serializeNodeWithId(n,{doc:_this.doc,map:_this.mirror.map,blockClass:_this.blockClass,blockSelector:_this.blockSelector,maskTextClass:_this.maskTextClass,maskTextSelector:_this.maskTextSelector,skipChild:true,inlineStylesheet:_this.inlineStylesheet,maskInputOptions:_this.maskInputOptions,maskTextFn:_this.maskTextFn,maskInputFn:_this.maskInputFn,slimDOMOptions:_this.slimDOMOptions,recordCanvas:_this.recordCanvas,onSerialize:function onSerialize(currentN){if(isIframeINode(currentN)){_this.iframeManager.addIframe(currentN);}if(hasShadowRoot(n)){_this.shadowDomManager.addShadowRoot(n.shadowRoot,document);}},onIframeLoad:function onIframeLoad(iframe,childSn){_this.iframeManager.attachIframe(iframe,childSn);}});if(sn){adds.push({parentId:parentId,nextId:nextId,node:sn});}};while(_this.mapRemoves.length){_this.mirror.removeNodeFromMap(_this.mapRemoves.shift());}try{for(var _c=__values(_this.movedSet),_d=_c.next();!_d.done;_d=_c.next()){var n=_d.value;if(isParentRemoved(_this.removes,n,_this.mirror)&&!_this.movedSet.has(n.parentNode)){continue;}pushAdd(n);}}catch(e_1_1){e_1={error:e_1_1};}finally{try{if(_d&&!_d.done&&(_a=_c["return"]))_a.call(_c);}finally{if(e_1)throw e_1.error;}}try{for(var _e=__values(_this.addedSet),_f=_e.next();!_f.done;_f=_e.next()){var n=_f.value;if(!isAncestorInSet(_this.droppedSet,n)&&!isParentRemoved(_this.removes,n,_this.mirror)){pushAdd(n);}else if(isAncestorInSet(_this.movedSet,n)){pushAdd(n);}else{_this.droppedSet.add(n);}}}catch(e_2_1){e_2={error:e_2_1};}finally{try{if(_f&&!_f.done&&(_b=_e["return"]))_b.call(_e);}finally{if(e_2)throw e_2.error;}}var candidate=null;while(addList.length){var node=null;if(candidate){var parentId=_this.mirror.getId(candidate.value.parentNode);var nextId=getNextId(candidate.value);if(parentId!==-1&&nextId!==-1){node=candidate;}}if(!node){for(var index=addList.length-1;index>=0;index--){var _node=addList.get(index);if(_node){var parentId=_this.mirror.getId(_node.value.parentNode);var nextId=getNextId(_node.value);if(parentId!==-1&&nextId!==-1){node=_node;break;}}}}if(!node){while(addList.head){addList.removeNode(addList.head.value);}break;}candidate=node.previous;addList.removeNode(node.value);pushAdd(node.value);}var payload={texts:_this.texts.map(function(text){return{id:_this.mirror.getId(text.node),value:text.value};}).filter(function(text){return _this.mirror.has(text.id);}),attributes:_this.attributes.map(function(attribute){return{id:_this.mirror.getId(attribute.node),attributes:attribute.attributes};}).filter(function(attribute){return _this.mirror.has(attribute.id);}),removes:_this.removes,adds:adds};if(!payload.texts.length&&!payload.attributes.length&&!payload.removes.length&&!payload.adds.length){return;}_this.texts=[];_this.attributes=[];_this.removes=[];_this.addedSet=new Set();_this.movedSet=new Set();_this.droppedSet=new Set();_this.movedMap={};_this.emissionCallback(payload);};this.processMutation=function(m){if(isIgnored(m.target)){return;}switch(m.type){case'characterData':{var value=m.target.textContent;if(!isBlocked(m.target,_this.blockClass)&&value!==m.oldValue){_this.texts.push({value:needMaskingText(m.target,_this.maskTextClass,_this.maskTextSelector)&&value?_this.maskTextFn?_this.maskTextFn(value):value.replace(/[\S]/g,'*'):value,node:m.target});}break;}case'attributes':{var target=m.target;var value=m.target.getAttribute(m.attributeName);if(m.attributeName==='value'){value=maskInputValue({maskInputOptions:_this.maskInputOptions,tagName:m.target.tagName,type:m.target.getAttribute('type'),value:value,maskInputFn:_this.maskInputFn});}if(isBlocked(m.target,_this.blockClass)||value===m.oldValue){return;}var item=_this.attributes.find(function(a){return a.node===m.target;});if(!item){item={node:m.target,attributes:{}};_this.attributes.push(item);}if(m.attributeName==='style'){var old=_this.doc.createElement('span');createCbId(old);if(m.oldValue){old.setAttribute('style',m.oldValue);}if(item.attributes['style']===undefined||item.attributes['style']===null){item.attributes['style']={};}var styleObj=item.attributes['style'];for(var i=0;i<target.style.length;i++){var pname=target.style[i];var newValue=target.style.getPropertyValue(pname);var newPriority=target.style.getPropertyPriority(pname);if(newValue!=old.style.getPropertyValue(pname)||newPriority!=old.style.getPropertyPriority(pname)){if(newPriority==''){styleObj[pname]=newValue;}else{styleObj[pname]=[newValue,newPriority];}}}for(var i=0;i<old.style.length;i++){var pname=old.style[i];if(target.style.getPropertyValue(pname)===''||!target.style.getPropertyValue(pname)){styleObj[pname]=false;}}}else{item.attributes[m.attributeName]=transformAttribute(_this.doc,m.target.tagName,m.attributeName,value);}break;}case'childList':{m.addedNodes.forEach(function(n){return _this.genAdds(n,m.target);});m.removedNodes.forEach(function(n){var nodeId=_this.mirror.getId(n);var parentId=isShadowRoot(m.target)?_this.mirror.getId(m.target.host):_this.mirror.getId(m.target);if(isBlocked(n,_this.blockClass)||isBlocked(m.target,_this.blockClass)||isIgnored(n)){return;}if(_this.addedSet.has(n)){deepDelete(_this.addedSet,n);_this.droppedSet.add(n);}else if(_this.addedSet.has(m.target)&&nodeId===-1);else if(isAncestorRemoved(m.target,_this.mirror));else if(_this.movedSet.has(n)&&_this.movedMap[moveKey(nodeId,parentId)]){deepDelete(_this.movedSet,n);}else{_this.removes.push({parentId:parentId,id:nodeId,isShadow:isShadowRoot(m.target)?true:undefined});}_this.mapRemoves.push(n);});break;}}};this.genAdds=function(n,target){for(var i=0;i<me.maskClassList.length>0;i++){if(me.maskClassList[i]!==''){if(n&&n.classList&&n.classList.contains(me.maskClassList[i])){n.classList.add('rr-block');takeFullSnapshot(false);return;}if(target&&target.classList&&target.classList.contains(me.maskClassList[i])){target.classList.add('rr-block');takeFullSnapshot(false);return;}}}if(me.maskPatternList){me.scanElement(n,me.maskPatternList);}if(n&&n.getAttribute&&n.getAttribute('do-not-mutate')==='true'){return;}if(target&&target.getAttribute&&target.getAttribute('do-not-mutate')==='true'){return;}if(isBlocked(n,_this.blockClass)){return;}if(target&&isBlocked(target,_this.blockClass)){return;}if(isINode(n)){if(isIgnored(n)){return;}_this.movedSet.add(n);var targetId=null;if(target&&isINode(target)){targetId=target.__sn.id;}if(targetId){_this.movedMap[moveKey(n.__sn.id,targetId)]=true;}}else{_this.addedSet.add(n);_this.droppedSet["delete"](n);}n.childNodes.forEach(function(childN){return _this.genAdds(childN);});};}MutationBuffer.prototype.init=function(cb,blockClass,blockSelector,maskTextClass,maskTextSelector,inlineStylesheet,maskInputOptions,maskTextFn,maskInputFn,recordCanvas,slimDOMOptions,doc,mirror,iframeManager,shadowDomManager){this.blockClass=blockClass;this.blockSelector=blockSelector;this.maskTextClass=maskTextClass;this.maskTextSelector=maskTextSelector;this.inlineStylesheet=inlineStylesheet;this.maskInputOptions=maskInputOptions;this.maskTextFn=maskTextFn;this.maskInputFn=maskInputFn;this.recordCanvas=recordCanvas;this.slimDOMOptions=slimDOMOptions;this.emissionCallback=cb;this.doc=doc;this.mirror=mirror;this.iframeManager=iframeManager;this.shadowDomManager=shadowDomManager;};MutationBuffer.prototype.freeze=function(){this.frozen=true;};MutationBuffer.prototype.unfreeze=function(){this.frozen=false;this.emit();};MutationBuffer.prototype.isFrozen=function(){return this.frozen;};MutationBuffer.prototype.lock=function(){this.locked=true;};MutationBuffer.prototype.unlock=function(){this.locked=false;this.emit();};return MutationBuffer;}();function deepDelete(addsSet,n){addsSet["delete"](n);n.childNodes.forEach(function(childN){return deepDelete(addsSet,childN);});}function isParentRemoved(removes,n,mirror){var parentNode=n.parentNode;if(!parentNode){return false;}var parentId=mirror.getId(parentNode);if(removes.some(function(r){return r.id===parentId;})){return true;}return isParentRemoved(removes,parentNode,mirror);}function isAncestorInSet(set,n){var parentNode=n.parentNode;if(!parentNode){return false;}if(set.has(parentNode)){return true;}return isAncestorInSet(set,parentNode);}var mutationBuffers=[];var isCSSGroupingRuleSupported=typeof CSSGroupingRule!=="undefined";function getEventTarget(event){try{if('composedPath'in event){var path=event.composedPath();if(path.length){return path[0];}}else if('path'in event&&event.path.length){return event.path[0];}return event.target;}catch(_a){return event.target;}}function initMutationObserver(cb,doc,blockClass,blockSelector,maskTextClass,maskTextSelector,inlineStylesheet,maskInputOptions,maskTextFn,maskInputFn,recordCanvas,slimDOMOptions,mirror,iframeManager,shadowDomManager,rootEl){var _a,_b,_c;var mutationBuffer=new MutationBuffer();mutationBuffers.push(mutationBuffer);mutationBuffer.init(cb,blockClass,blockSelector,maskTextClass,maskTextSelector,inlineStylesheet,maskInputOptions,maskTextFn,maskInputFn,recordCanvas,slimDOMOptions,doc,mirror,iframeManager,shadowDomManager);var mutationObserverCtor=window.MutationObserver||window.__rrMutationObserver;var angularZoneSymbol=(_c=(_b=(_a=window)===null||_a===void 0?void 0:_a.Zone)===null||_b===void 0?void 0:_b.__symbol__)===null||_c===void 0?void 0:_c.call(_b,'MutationObserver');if(angularZoneSymbol&&window[angularZoneSymbol]){mutationObserverCtor=window[angularZoneSymbol];}var observer=new mutationObserverCtor(mutationBuffer.processMutations.bind(mutationBuffer));observer.observe(rootEl,{attributes:true,attributeOldValue:true,characterData:true,characterDataOldValue:true,childList:true,subtree:true});return observer;}function initMoveObserver(cb,sampling,doc,mirror){if(sampling.mousemove===false){return function(){};}var threshold=typeof sampling.mousemove==='number'?sampling.mousemove:50;var callbackThreshold=typeof sampling.mousemoveCallback==='number'?sampling.mousemoveCallback:500;var positions=[];var timeBaseline;var wrappedCb=throttle(function(source){var totalOffset=Date.now()-timeBaseline;cb(positions.map(function(p){p.timeOffset-=totalOffset;return p;}),source);positions=[];timeBaseline=null;},callbackThreshold);var updatePosition=throttle(function(evt){var target=getEventTarget(evt);var _a=isTouchEvent(evt)?evt.changedTouches[0]:evt,clientX=_a.clientX,clientY=_a.clientY;if(!timeBaseline){timeBaseline=Date.now();}positions.push({x:clientX,y:clientY,id:mirror.getId(target),timeOffset:Date.now()-timeBaseline});wrappedCb(typeof DragEvent!=='undefined'&&evt instanceof DragEvent?exports.IncrementalSource.Drag:evt instanceof MouseEvent?exports.IncrementalSource.MouseMove:exports.IncrementalSource.TouchMove);},threshold,{trailing:false});var handlers=[on('mousemove',updatePosition,doc),on('touchmove',updatePosition,doc),on('drag',updatePosition,doc)];return function(){handlers.forEach(function(h){return h();});};}function initMouseInteractionObserver(cb,doc,mirror,blockClass,sampling){if(sampling.mouseInteraction===false){return function(){};}var disableMap=sampling.mouseInteraction===true||sampling.mouseInteraction===undefined?{}:sampling.mouseInteraction;var handlers=[];var getHandler=function getHandler(eventKey){return function(event){var target=getEventTarget(event);if(isBlocked(target,blockClass)){return;}var e=isTouchEvent(event)?event.changedTouches[0]:event;if(!e){return;}var id=mirror.getId(target);var clientX=e.clientX,clientY=e.clientY;cb({type:exports.MouseInteractions[eventKey],id:id,x:clientX,y:clientY});};};Object.keys(exports.MouseInteractions).filter(function(key){return Number.isNaN(Number(key))&&!key.endsWith('_Departed')&&disableMap[key]!==false;}).forEach(function(eventKey){var eventName=eventKey.toLowerCase();var handler=getHandler(eventKey);handlers.push(on(eventName,handler,doc));});return function(){handlers.forEach(function(h){return h();});};}function initScrollObserver(cb,doc,mirror,blockClass,sampling){var updatePosition=throttle(function(evt){var target=getEventTarget(evt);if(!target||isBlocked(target,blockClass)){return;}var id=mirror.getId(target);if(target===doc){var scrollEl=doc.scrollingElement||doc.documentElement;cb({id:id,x:scrollEl.scrollLeft,y:scrollEl.scrollTop});}else{cb({id:id,x:target.scrollLeft,y:target.scrollTop});}},sampling.scroll||100);return on('scroll',updatePosition,doc);}function initViewportResizeObserver(cb){var lastH=-1;var lastW=-1;var updateDimension=throttle(function(){var height=getWindowHeight();var width=getWindowWidth();if(lastH!==height||lastW!==width){cb({width:Number(width),height:Number(height)});lastH=height;lastW=width;}},200);return on('resize',updateDimension,window);}function wrapEventWithUserTriggeredFlag(v,enable){var value=_assign({},v);if(!enable)delete value.userTriggered;return value;}var INPUT_TAGS=['INPUT','TEXTAREA','SELECT'];var lastInputValueMap=new WeakMap();function initInputObserver(cb,doc,mirror,blockClass,ignoreClass,maskInputOptions,maskInputFn,sampling,userTriggeredOnInput){function eventHandler(event){var target=getEventTarget(event);var userTriggered=event.isTrusted;if(!target||!target.tagName||INPUT_TAGS.indexOf(target.tagName)<0||isBlocked(target,blockClass)){return;}var type=target.type;if(target.classList.contains(ignoreClass)){return;}var text=target.value;var isChecked=false;if(type==='radio'||type==='checkbox'){isChecked=target.checked;}else if(maskInputOptions[target.tagName.toLowerCase()]||maskInputOptions[type]){text=maskInputValue({maskInputOptions:maskInputOptions,tagName:target.tagName,type:type,value:text,maskInputFn:maskInputFn});}cbWithDedup(target,wrapEventWithUserTriggeredFlag({text:text,isChecked:isChecked,userTriggered:userTriggered},userTriggeredOnInput));var name=target.name;if(type==='radio'&&name&&isChecked){doc.querySelectorAll("input[type=\"radio\"][name=\""+name+"\"]").forEach(function(el){if(el!==target){cbWithDedup(el,wrapEventWithUserTriggeredFlag({text:el.value,isChecked:!isChecked,userTriggered:false},userTriggeredOnInput));}});}}function cbWithDedup(target,v){var lastInputValue=lastInputValueMap.get(target);if(!lastInputValue||lastInputValue.text!==v.text||lastInputValue.isChecked!==v.isChecked){lastInputValueMap.set(target,v);var id=mirror.getId(target);cb(_assign(_assign({},v),{id:id}));}}var events=sampling.input==='last'?['change']:['input','change'];var handlers=events.map(function(eventName){return on(eventName,eventHandler,doc);});var propertyDescriptor=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,'value');var hookProperties=[[HTMLInputElement.prototype,'value'],[HTMLInputElement.prototype,'checked'],[HTMLSelectElement.prototype,'value'],[HTMLTextAreaElement.prototype,'value'],[HTMLSelectElement.prototype,'selectedIndex']];if(propertyDescriptor&&propertyDescriptor.set){handlers.push.apply(handlers,__spread(hookProperties.map(function(p){return hookSetter(p[0],p[1],{set:function set(){eventHandler({target:this});}});})));}return function(){handlers.forEach(function(h){return h();});};}function getNestedCSSRulePositions(rule){var positions=[];function recurse(childRule,pos){if(isCSSGroupingRuleSupported&&childRule.parentRule instanceof CSSGroupingRule){var rules=Array.from(childRule.parentRule.cssRules);var index=rules.indexOf(childRule);pos.unshift(index);}else{var rules=Array.from(childRule.parentStyleSheet.cssRules);var index=rules.indexOf(childRule);pos.unshift(index);}return pos;}return recurse(rule,positions);}function initStyleSheetObserver(cb,mirror){var insertRule=CSSStyleSheet.prototype.insertRule;CSSStyleSheet.prototype.insertRule=function(rule,index){var id=mirror.getId(this.ownerNode);if(id!==-1){cb({id:id,adds:[{rule:rule,index:index}]});}return insertRule.apply(this,arguments);};var deleteRule=CSSStyleSheet.prototype.deleteRule;CSSStyleSheet.prototype.deleteRule=function(index){var id=mirror.getId(this.ownerNode);if(id!==-1){cb({id:id,removes:[{index:index}]});}return deleteRule.apply(this,arguments);};if(!isCSSGroupingRuleSupported){return function(){CSSStyleSheet.prototype.insertRule=insertRule;CSSStyleSheet.prototype.deleteRule=deleteRule;};}var groupingInsertRule=CSSGroupingRule.prototype.insertRule;CSSGroupingRule.prototype.insertRule=function(rule,index){var id=mirror.getId(this.parentStyleSheet.ownerNode);if(id!==-1){cb({id:id,adds:[{rule:rule,index:__spread(getNestedCSSRulePositions(this),[index||0])}]});}return groupingInsertRule.apply(this,arguments);};var groupingDeleteRule=CSSGroupingRule.prototype.deleteRule;CSSGroupingRule.prototype.deleteRule=function(index){var id=mirror.getId(this.parentStyleSheet.ownerNode);if(id!==-1){cb({id:id,removes:[{index:__spread(getNestedCSSRulePositions(this),[index])}]});}return groupingDeleteRule.apply(this,arguments);};return function(){CSSStyleSheet.prototype.insertRule=insertRule;CSSStyleSheet.prototype.deleteRule=deleteRule;CSSGroupingRule.prototype.insertRule=groupingInsertRule;CSSGroupingRule.prototype.deleteRule=groupingDeleteRule;};}function initStyleDeclarationObserver(cb,mirror){var setProperty=CSSStyleDeclaration.prototype.setProperty;CSSStyleDeclaration.prototype.setProperty=function(property,value,priority){var _a,_b;var id=mirror.getId((_b=(_a=this.parentRule)===null||_a===void 0?void 0:_a.parentStyleSheet)===null||_b===void 0?void 0:_b.ownerNode);if(id!==-1){cb({id:id,set:{property:property,value:value,priority:priority},index:getNestedCSSRulePositions(this.parentRule)});}return setProperty.apply(this,arguments);};var removeProperty=CSSStyleDeclaration.prototype.removeProperty;CSSStyleDeclaration.prototype.removeProperty=function(property){var _a,_b;var id=mirror.getId((_b=(_a=this.parentRule)===null||_a===void 0?void 0:_a.parentStyleSheet)===null||_b===void 0?void 0:_b.ownerNode);if(id!==-1){cb({id:id,remove:{property:property},index:getNestedCSSRulePositions(this.parentRule)});}return removeProperty.apply(this,arguments);};return function(){CSSStyleDeclaration.prototype.setProperty=setProperty;CSSStyleDeclaration.prototype.removeProperty=removeProperty;};}function initMediaInteractionObserver(mediaInteractionCb,blockClass,mirror){var handler=function handler(type){return function(event){var target=getEventTarget(event);if(!target||isBlocked(target,blockClass)){return;}mediaInteractionCb({type:type,id:mirror.getId(target),currentTime:target.currentTime});};};var handlers=[on('play',handler(MediaInteractions.Play)),on('pause',handler(MediaInteractions.Pause)),on('seeked',handler(MediaInteractions.Seeked))];return function(){handlers.forEach(function(h){return h();});};}function initCanvasMutationObserver(cb,blockClass,mirror){var e_1,_a;var props=Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype);var handlers=[];var _loop_1=function _loop_1(prop){try{if(typeof CanvasRenderingContext2D.prototype[prop]!=='function'){return"continue";}var restoreHandler=patch(CanvasRenderingContext2D.prototype,prop,function(original){return function(){var _this=this;var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(!isBlocked(this.canvas,blockClass)){setTimeout(function(){var recordArgs=__spread(args);if(prop==='drawImage'){if(recordArgs[0]&&recordArgs[0]instanceof HTMLCanvasElement){var canvas=recordArgs[0];var ctx=canvas.getContext('2d');var imgd=ctx===null||ctx===void 0?void 0:ctx.getImageData(0,0,canvas.width,canvas.height);var pix=imgd===null||imgd===void 0?void 0:imgd.data;recordArgs[0]=JSON.stringify(pix);}}cb({id:mirror.getId(_this.canvas),property:prop,args:recordArgs});},0);}return original.apply(this,args);};});handlers.push(restoreHandler);}catch(_a){var hookHandler=hookSetter(CanvasRenderingContext2D.prototype,prop,{set:function set(v){cb({id:mirror.getId(this.canvas),property:prop,args:[v],setter:true});}});handlers.push(hookHandler);}};try{for(var props_1=__values(props),props_1_1=props_1.next();!props_1_1.done;props_1_1=props_1.next()){var prop=props_1_1.value;_loop_1(prop);}}catch(e_1_1){e_1={error:e_1_1};}finally{try{if(props_1_1&&!props_1_1.done&&(_a=props_1["return"]))_a.call(props_1);}finally{if(e_1)throw e_1.error;}}return function(){handlers.forEach(function(h){return h();});};}function initFontObserver(cb){var handlers=[];var fontMap=new WeakMap();var originalFontFace=FontFace;window.FontFace=function FontFace(family,source,descriptors){var fontFace=new originalFontFace(family,source,descriptors);fontMap.set(fontFace,{family:family,buffer:typeof source!=='string',descriptors:descriptors,fontSource:typeof source==='string'?source:JSON.stringify(Array.from(new Uint8Array(source)))});return fontFace;};var restoreHandler=patch(document.fonts,'add',function(original){return function(fontFace){setTimeout(function(){var p=fontMap.get(fontFace);if(p){cb(p);fontMap["delete"](fontFace);}},0);return original.apply(this,[fontFace]);};});handlers.push(function(){window.FonFace=originalFontFace;});handlers.push(restoreHandler);return function(){handlers.forEach(function(h){return h();});};}function mergeHooks(o,hooks){var mutationCb=o.mutationCb,mousemoveCb=o.mousemoveCb,mouseInteractionCb=o.mouseInteractionCb,scrollCb=o.scrollCb,viewportResizeCb=o.viewportResizeCb,inputCb=o.inputCb,mediaInteractionCb=o.mediaInteractionCb,styleSheetRuleCb=o.styleSheetRuleCb,styleDeclarationCb=o.styleDeclarationCb,canvasMutationCb=o.canvasMutationCb,fontCb=o.fontCb;o.mutationCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.mutation){hooks.mutation.apply(hooks,__spread(p));}mutationCb.apply(void 0,__spread(p));};o.mousemoveCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.mousemove){hooks.mousemove.apply(hooks,__spread(p));}mousemoveCb.apply(void 0,__spread(p));};o.mouseInteractionCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.mouseInteraction){hooks.mouseInteraction.apply(hooks,__spread(p));}mouseInteractionCb.apply(void 0,__spread(p));};o.scrollCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.scroll){hooks.scroll.apply(hooks,__spread(p));}scrollCb.apply(void 0,__spread(p));};o.viewportResizeCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.viewportResize){hooks.viewportResize.apply(hooks,__spread(p));}viewportResizeCb.apply(void 0,__spread(p));};o.inputCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.input){hooks.input.apply(hooks,__spread(p));}inputCb.apply(void 0,__spread(p));};o.mediaInteractionCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.mediaInteaction){hooks.mediaInteaction.apply(hooks,__spread(p));}mediaInteractionCb.apply(void 0,__spread(p));};o.styleSheetRuleCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.styleSheetRule){hooks.styleSheetRule.apply(hooks,__spread(p));}styleSheetRuleCb.apply(void 0,__spread(p));};o.styleDeclarationCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.styleDeclaration){hooks.styleDeclaration.apply(hooks,__spread(p));}styleDeclarationCb.apply(void 0,__spread(p));};o.canvasMutationCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.canvasMutation){hooks.canvasMutation.apply(hooks,__spread(p));}canvasMutationCb.apply(void 0,__spread(p));};o.fontCb=function(){var p=[];for(var _i=0;_i<arguments.length;_i++){p[_i]=arguments[_i];}if(hooks.font){hooks.font.apply(hooks,__spread(p));}fontCb.apply(void 0,__spread(p));};}function initObservers(o,hooks){var e_2,_a;if(hooks===void 0){hooks={};}mergeHooks(o,hooks);var mutationObserver=initMutationObserver(o.mutationCb,o.doc,o.blockClass,o.blockSelector,o.maskTextClass,o.maskTextSelector,o.inlineStylesheet,o.maskInputOptions,o.maskTextFn,o.maskInputFn,o.recordCanvas,o.slimDOMOptions,o.mirror,o.iframeManager,o.shadowDomManager,o.doc);var mousemoveHandler=initMoveObserver(o.mousemoveCb,o.sampling,o.doc,o.mirror);var mouseInteractionHandler=initMouseInteractionObserver(o.mouseInteractionCb,o.doc,o.mirror,o.blockClass,o.sampling);var scrollHandler=initScrollObserver(o.scrollCb,o.doc,o.mirror,o.blockClass,o.sampling);var viewportResizeHandler=initViewportResizeObserver(o.viewportResizeCb);var inputHandler=initInputObserver(o.inputCb,o.doc,o.mirror,o.blockClass,o.ignoreClass,o.maskInputOptions,o.maskInputFn,o.sampling,o.userTriggeredOnInput);var mediaInteractionHandler=initMediaInteractionObserver(o.mediaInteractionCb,o.blockClass,o.mirror);var styleSheetObserver=initStyleSheetObserver(o.styleSheetRuleCb,o.mirror);var styleDeclarationObserver=initStyleDeclarationObserver(o.styleDeclarationCb,o.mirror);var canvasMutationObserver=o.recordCanvas?initCanvasMutationObserver(o.canvasMutationCb,o.blockClass,o.mirror):function(){};var fontObserver=o.collectFonts?initFontObserver(o.fontCb):function(){};var pluginHandlers=[];try{for(var _b=__values(o.plugins),_c=_b.next();!_c.done;_c=_b.next()){var plugin=_c.value;pluginHandlers.push(plugin.observer(plugin.callback,plugin.options));}}catch(e_2_1){e_2={error:e_2_1};}finally{try{if(_c&&!_c.done&&(_a=_b["return"]))_a.call(_b);}finally{if(e_2)throw e_2.error;}}return function(){mutationObserver.disconnect();mousemoveHandler();mouseInteractionHandler();scrollHandler();viewportResizeHandler();inputHandler();mediaInteractionHandler();styleSheetObserver();styleDeclarationObserver();canvasMutationObserver();fontObserver();pluginHandlers.forEach(function(h){return h();});};}var IframeManager=function(){function IframeManager(options){this.iframes=new WeakMap();this.mutationCb=options.mutationCb;}IframeManager.prototype.addIframe=function(iframeEl){this.iframes.set(iframeEl,true);};IframeManager.prototype.addLoadListener=function(cb){this.loadListener=cb;};IframeManager.prototype.attachIframe=function(iframeEl,childSn){var _a;this.mutationCb({adds:[{parentId:iframeEl.__sn.id,nextId:null,node:childSn}],removes:[],texts:[],attributes:[],isAttachIframe:true});(_a=this.loadListener)===null||_a===void 0?void 0:_a.call(this,iframeEl);};return IframeManager;}();var ShadowDomManager=function(){function ShadowDomManager(options){this.mutationCb=options.mutationCb;this.scrollCb=options.scrollCb;this.bypassOptions=options.bypassOptions;this.mirror=options.mirror;}ShadowDomManager.prototype.addShadowRoot=function(shadowRoot,doc){initMutationObserver(this.mutationCb,doc,this.bypassOptions.blockClass,this.bypassOptions.blockSelector,this.bypassOptions.maskTextClass,this.bypassOptions.maskTextSelector,this.bypassOptions.inlineStylesheet,this.bypassOptions.maskInputOptions,this.bypassOptions.maskTextFn,this.bypassOptions.maskInputFn,this.bypassOptions.recordCanvas,this.bypassOptions.slimDOMOptions,this.mirror,this.bypassOptions.iframeManager,this,shadowRoot);initScrollObserver(this.scrollCb,shadowRoot,this.mirror,this.bypassOptions.blockClass,this.bypassOptions.sampling);};return ShadowDomManager;}();function wrapEvent(e){return _assign(_assign({},e),{timestamp:Date.now()});}var wrappedEmit;var takeFullSnapshot;var mirror=createMirror();function record(options){if(options===void 0){options={};}var emit=options.emit,checkoutEveryNms=options.checkoutEveryNms,checkoutEveryNth=options.checkoutEveryNth,_a=options.blockClass,blockClass=_a===void 0?'rr-block':_a,_b=options.blockSelector,blockSelector=_b===void 0?null:_b,_c=options.ignoreClass,ignoreClass=_c===void 0?'rr-ignore':_c,_d=options.maskTextClass,maskTextClass=_d===void 0?'rr-mask':_d,_e=options.maskTextSelector,maskTextSelector=_e===void 0?null:_e,_f=options.inlineStylesheet,inlineStylesheet=_f===void 0?true:_f,maskAllInputs=options.maskAllInputs,_maskInputOptions=options.maskInputOptions,_slimDOMOptions=options.slimDOMOptions,maskInputFn=options.maskInputFn,maskTextFn=options.maskTextFn,hooks=options.hooks,packFn=options.packFn,_g=options.sampling,sampling=_g===void 0?{}:_g,mousemoveWait=options.mousemoveWait,_h=options.recordCanvas,recordCanvas=_h===void 0?false:_h,_j=options.userTriggeredOnInput,userTriggeredOnInput=_j===void 0?false:_j,_k=options.collectFonts,collectFonts=_k===void 0?false:_k,plugins=options.plugins,_l=options.keepIframeSrcFn,keepIframeSrcFn=_l===void 0?function(){return false;}:_l;if(!emit){throw new Error('emit function is required');}if(mousemoveWait!==undefined&&sampling.mousemove===undefined){sampling.mousemove=mousemoveWait;}var maskInputOptions=maskAllInputs===true?{color:true,date:true,'datetime-local':true,email:true,month:true,number:true,range:true,search:true,tel:true,text:true,time:true,url:true,week:true,textarea:true,select:true,password:true}:_maskInputOptions!==undefined?_maskInputOptions:{password:true};var slimDOMOptions=_slimDOMOptions===true||_slimDOMOptions==='all'?{script:true,comment:true,headFavicon:true,headWhitespace:true,headMetaSocial:true,headMetaRobots:true,headMetaHttpEquiv:true,headMetaVerification:true,headMetaAuthorship:_slimDOMOptions==='all',headMetaDescKeywords:_slimDOMOptions==='all'}:_slimDOMOptions?_slimDOMOptions:{};polyfill$1();var lastFullSnapshotEvent;var incrementalSnapshotCount=0;wrappedEmit=function wrappedEmit(e,isCheckout){var _a;if(((_a=mutationBuffers[0])===null||_a===void 0?void 0:_a.isFrozen())&&e.type!==exports.EventType.FullSnapshot&&!(e.type===exports.EventType.IncrementalSnapshot&&e.data.source===exports.IncrementalSource.Mutation)){mutationBuffers.forEach(function(buf){return buf.unfreeze();});}emit(packFn?packFn(e):e,isCheckout);if(e.type===exports.EventType.FullSnapshot){lastFullSnapshotEvent=e;incrementalSnapshotCount=0;}else if(e.type===exports.EventType.IncrementalSnapshot){if(e.data.source===exports.IncrementalSource.Mutation&&e.data.isAttachIframe){return;}incrementalSnapshotCount++;var exceedCount=checkoutEveryNth&&incrementalSnapshotCount>=checkoutEveryNth;var exceedTime=checkoutEveryNms&&e.timestamp-lastFullSnapshotEvent.timestamp>checkoutEveryNms;if(exceedCount||exceedTime){takeFullSnapshot(true);}}};var wrappedMutationEmit=function wrappedMutationEmit(m){wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.Mutation},m)}));};var wrappedScrollEmit=function wrappedScrollEmit(p){if(!scrollByAgent){var obj=wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.Scroll},p)});return wrappedEmit(obj);}};var iframeManager=new IframeManager({mutationCb:wrappedMutationEmit});var shadowDomManager=new ShadowDomManager({mutationCb:wrappedMutationEmit,scrollCb:wrappedScrollEmit,bypassOptions:{blockClass:blockClass,blockSelector:blockSelector,maskTextClass:maskTextClass,maskTextSelector:maskTextSelector,inlineStylesheet:inlineStylesheet,maskInputOptions:maskInputOptions,maskTextFn:maskTextFn,maskInputFn:maskInputFn,recordCanvas:recordCanvas,sampling:sampling,slimDOMOptions:slimDOMOptions,iframeManager:iframeManager},mirror:mirror});takeFullSnapshot=function takeFullSnapshot(isCheckout){var _a,_b,_c,_d;if(isCheckout===void 0){isCheckout=false;}wrappedEmit(wrapEvent({type:exports.EventType.Meta,data:{href:window.location.href,width:getWindowWidth(),height:getWindowHeight()}}),isCheckout);mutationBuffers.forEach(function(buf){return buf.lock();});var _e=__read(snapshot(document,{blockClass:blockClass,blockSelector:blockSelector,maskTextClass:maskTextClass,maskTextSelector:maskTextSelector,inlineStylesheet:inlineStylesheet,maskAllInputs:maskInputOptions,maskTextFn:maskTextFn,slimDOM:slimDOMOptions,recordCanvas:recordCanvas,onSerialize:function onSerialize(n){if(isIframeINode(n)){iframeManager.addIframe(n);}if(hasShadowRoot(n)){shadowDomManager.addShadowRoot(n.shadowRoot,document);}},onIframeLoad:function onIframeLoad(iframe,childSn){iframeManager.attachIframe(iframe,childSn);},keepIframeSrcFn:keepIframeSrcFn}),2),node=_e[0],idNodeMap=_e[1];if(!node){return console.warn('Failed to snapshot the document');}mirror.map=idNodeMap;wrappedEmit(wrapEvent({type:exports.EventType.FullSnapshot,data:{node:node,initialOffset:{left:window.pageXOffset!==undefined?window.pageXOffset:(document===null||document===void 0?void 0:document.documentElement.scrollLeft)||((_b=(_a=document===null||document===void 0?void 0:document.body)===null||_a===void 0?void 0:_a.parentElement)===null||_b===void 0?void 0:_b.scrollLeft)||(document===null||document===void 0?void 0:document.body.scrollLeft)||0,top:window.pageYOffset!==undefined?window.pageYOffset:(document===null||document===void 0?void 0:document.documentElement.scrollTop)||((_d=(_c=document===null||document===void 0?void 0:document.body)===null||_c===void 0?void 0:_c.parentElement)===null||_d===void 0?void 0:_d.scrollTop)||(document===null||document===void 0?void 0:document.body.scrollTop)||0}}}));mutationBuffers.forEach(function(buf){return buf.unlock();});};try{var handlers_1=[];handlers_1.push(on('DOMContentLoaded',function(){wrappedEmit(wrapEvent({type:exports.EventType.DomContentLoaded,data:{}}));}));var observe_1=function observe_1(doc){return initObservers({mutationCb:wrappedMutationEmit,mousemoveCb:function mousemoveCb(positions,source){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:{source:source,positions:positions}}));},mouseInteractionCb:function mouseInteractionCb(d){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.MouseInteraction},d)}));},scrollCb:wrappedScrollEmit,viewportResizeCb:function viewportResizeCb(d){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.ViewportResize},d)}));},inputCb:function inputCb(v){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.Input},v)}));},mediaInteractionCb:function mediaInteractionCb(p){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.MediaInteraction},p)}));},styleSheetRuleCb:function styleSheetRuleCb(r){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.StyleSheetRule},r)}));},styleDeclarationCb:function styleDeclarationCb(r){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.StyleDeclaration},r)}));},canvasMutationCb:function canvasMutationCb(p){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.CanvasMutation},p)}));},fontCb:function fontCb(p){return wrappedEmit(wrapEvent({type:exports.EventType.IncrementalSnapshot,data:_assign({source:exports.IncrementalSource.Font},p)}));},blockClass:blockClass,ignoreClass:ignoreClass,maskTextClass:maskTextClass,maskTextSelector:maskTextSelector,maskInputOptions:maskInputOptions,inlineStylesheet:inlineStylesheet,sampling:sampling,recordCanvas:recordCanvas,userTriggeredOnInput:userTriggeredOnInput,collectFonts:collectFonts,doc:doc,maskInputFn:maskInputFn,maskTextFn:maskTextFn,blockSelector:blockSelector,slimDOMOptions:slimDOMOptions,mirror:mirror,iframeManager:iframeManager,shadowDomManager:shadowDomManager,plugins:(plugins===null||plugins===void 0?void 0:plugins.map(function(p){return{observer:p.observer,options:p.options,callback:function callback(payload){return wrappedEmit(wrapEvent({type:exports.EventType.Plugin,data:{plugin:p.name,payload:payload}}));}};}))||[]},hooks);};iframeManager.addLoadListener(function(iframeEl){handlers_1.push(observe_1(iframeEl.contentDocument));});var init_1=function init_1(){takeFullSnapshot();handlers_1.push(observe_1(document));};if(document.readyState==='interactive'||document.readyState==='complete'){init_1();}else{handlers_1.push(on('load',function(){wrappedEmit(wrapEvent({type:exports.EventType.Load,data:{}}));init_1();},window));}return function(){handlers_1.forEach(function(h){return h();});};}catch(error){console.warn(error);}}record.addCustomEvent=function(tag,payload){if(!wrappedEmit){throw new Error('please add custom event after start recording');}wrappedEmit(wrapEvent({type:exports.EventType.Custom,data:{tag:tag,payload:payload}}));};record.freezePage=function(){mutationBuffers.forEach(function(buf){return buf.freeze();});};record.takeFullSnapshot=function(isCheckout){if(!takeFullSnapshot){throw new Error('please take full snapshot after start recording');}takeFullSnapshot(isCheckout);};record.mirror=mirror;//      
// An event handler can take an optional event argument
// and should not return a value
// An array of all currently registered event handlers for a type
// A map of event types and their corresponding event handlers.
/** Mitt: Tiny (~200b) functional event emitter / pubsub.
         *  @name mitt
         *  @returns {Mitt}
         */function mitt$1(all){all=all||Object.create(null);return{/**
                 * Register an event handler for the given type.
                 *
                 * @param  {String} type	Type of event to listen for, or `"*"` for all events
                 * @param  {Function} handler Function to call in response to given event
                 * @memberOf mitt
                 */on:function on(type,handler){(all[type]||(all[type]=[])).push(handler);},/**
                 * Remove an event handler for the given type.
                 *
                 * @param  {String} type	Type of event to unregister `handler` from, or `"*"`
                 * @param  {Function} handler Handler function to remove
                 * @memberOf mitt
                 */off:function off(type,handler){if(all[type]){all[type].splice(all[type].indexOf(handler)>>>0,1);}},/**
                 * Invoke all handlers for the given type.
                 * If present, `"*"` handlers are invoked after type-matched handlers.
                 *
                 * @param {String} type  The event type to invoke
                 * @param {Any} [evt]  Any value (object is recommended and powerful), passed to each handler
                 * @memberOf mitt
                 */emit:function emit(type,evt){(all[type]||[]).slice().map(function(handler){handler(evt);});(all['*']||[]).slice().map(function(handler){handler(type,evt);});}};}var mittProxy=/*#__PURE__*/Object.freeze({__proto__:null,'default':mitt$1});function polyfill(w,d){if(w===void 0){w=window;}if(d===void 0){d=document;}if('scrollBehavior'in d.documentElement.style&&w.__forceSmoothScrollPolyfill__!==true){return;}var Element=w.HTMLElement||w.Element;var SCROLL_TIME=468;var original={scroll:w.scroll||w.scrollTo,scrollBy:w.scrollBy,elementScroll:Element.prototype.scroll||scrollElement,scrollIntoView:Element.prototype.scrollIntoView};var now=w.performance&&w.performance.now?w.performance.now.bind(w.performance):Date.now;function isMicrosoftBrowser(userAgent){var userAgentPatterns=['MSIE ','Trident/','Edge/'];return new RegExp(userAgentPatterns.join('|')).test(userAgent);}var ROUNDING_TOLERANCE=isMicrosoftBrowser(w.navigator.userAgent)?1:0;function scrollElement(x,y){this.scrollLeft=x;this.scrollTop=y;}function ease(k){return 0.5*(1-Math.cos(Math.PI*k));}function shouldBailOut(firstArg){if(firstArg===null||_typeof(firstArg)!=='object'||firstArg.behavior===undefined||firstArg.behavior==='auto'||firstArg.behavior==='instant'){return true;}if(_typeof(firstArg)==='object'&&firstArg.behavior==='smooth'){return false;}throw new TypeError('behavior member of ScrollOptions '+firstArg.behavior+' is not a valid value for enumeration ScrollBehavior.');}function hasScrollableSpace(el,axis){if(axis==='Y'){return el.clientHeight+ROUNDING_TOLERANCE<el.scrollHeight;}if(axis==='X'){return el.clientWidth+ROUNDING_TOLERANCE<el.scrollWidth;}}function canOverflow(el,axis){var overflowValue=w.getComputedStyle(el,null)['overflow'+axis];return overflowValue==='auto'||overflowValue==='scroll';}function isScrollable(el){var isScrollableY=hasScrollableSpace(el,'Y')&&canOverflow(el,'Y');var isScrollableX=hasScrollableSpace(el,'X')&&canOverflow(el,'X');return isScrollableY||isScrollableX;}function findScrollableParent(el){while(el!==d.body&&isScrollable(el)===false){el=el.parentNode||el.host;}return el;}function step(context){var time=now();var value;var currentX;var currentY;var elapsed=(time-context.startTime)/SCROLL_TIME;elapsed=elapsed>1?1:elapsed;value=ease(elapsed);currentX=context.startX+(context.x-context.startX)*value;currentY=context.startY+(context.y-context.startY)*value;context.method.call(context.scrollable,currentX,currentY);if(currentX!==context.x||currentY!==context.y){w.requestAnimationFrame(step.bind(w,context));}}function smoothScroll(el,x,y){var scrollable;var startX;var startY;var method;var startTime=now();if(el===d.body){scrollable=w;startX=w.scrollX||w.pageXOffset;startY=w.scrollY||w.pageYOffset;method=original.scroll;}else{scrollable=el;startX=el.scrollLeft;startY=el.scrollTop;method=scrollElement;}step({scrollable:scrollable,method:method,startTime:startTime,startX:startX,startY:startY,x:x,y:y});}w.scroll=w.scrollTo=function(){if(arguments[0]===undefined){return;}if(shouldBailOut(arguments[0])===true){original.scroll.call(w,arguments[0].left!==undefined?arguments[0].left:_typeof(arguments[0])!=='object'?arguments[0]:w.scrollX||w.pageXOffset,arguments[0].top!==undefined?arguments[0].top:arguments[1]!==undefined?arguments[1]:w.scrollY||w.pageYOffset);return;}smoothScroll.call(w,d.body,arguments[0].left!==undefined?~~arguments[0].left:w.scrollX||w.pageXOffset,arguments[0].top!==undefined?~~arguments[0].top:w.scrollY||w.pageYOffset);};w.scrollBy=function(){if(arguments[0]===undefined){return;}if(shouldBailOut(arguments[0])){original.scrollBy.call(w,arguments[0].left!==undefined?arguments[0].left:_typeof(arguments[0])!=='object'?arguments[0]:0,arguments[0].top!==undefined?arguments[0].top:arguments[1]!==undefined?arguments[1]:0);return;}smoothScroll.call(w,d.body,~~arguments[0].left+(w.scrollX||w.pageXOffset),~~arguments[0].top+(w.scrollY||w.pageYOffset));};Element.prototype.scroll=Element.prototype.scrollTo=function(){if(arguments[0]===undefined){return;}if(shouldBailOut(arguments[0])===true){if(typeof arguments[0]==='number'&&arguments[1]===undefined){throw new SyntaxError('Value could not be converted');}original.elementScroll.call(this,arguments[0].left!==undefined?~~arguments[0].left:_typeof(arguments[0])!=='object'?~~arguments[0]:this.scrollLeft,arguments[0].top!==undefined?~~arguments[0].top:arguments[1]!==undefined?~~arguments[1]:this.scrollTop);return;}var left=arguments[0].left;var top=arguments[0].top;smoothScroll.call(this,this,typeof left==='undefined'?this.scrollLeft:~~left,typeof top==='undefined'?this.scrollTop:~~top);};Element.prototype.scrollBy=function(){if(arguments[0]===undefined){return;}if(shouldBailOut(arguments[0])===true){original.elementScroll.call(this,arguments[0].left!==undefined?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==undefined?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return;}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior});};Element.prototype.scrollIntoView=function(){if(shouldBailOut(arguments[0])===true){original.scrollIntoView.call(this,arguments[0]===undefined?true:arguments[0]);return;}var scrollableParent=findScrollableParent(this);var parentRects=scrollableParent.getBoundingClientRect();var clientRects=this.getBoundingClientRect();if(scrollableParent!==d.body){smoothScroll.call(this,scrollableParent,scrollableParent.scrollLeft+clientRects.left-parentRects.left,scrollableParent.scrollTop+clientRects.top-parentRects.top);if(w.getComputedStyle(scrollableParent).position!=='fixed'){w.scrollBy({left:parentRects.left,top:parentRects.top,behavior:'smooth'});}}else{w.scrollBy({left:clientRects.left,top:clientRects.top,behavior:'smooth'});}};}var Timer=function(){function Timer(actions,speed){if(actions===void 0){actions=[];}this.timeOffset=0;this.raf=null;this.actions=actions;this.speed=speed;}Timer.prototype.addAction=function(action){var index=this.findActionIndex(action);this.actions.splice(index,0,action);};Timer.prototype.addActions=function(actions){this.actions=this.actions.concat(actions);};Timer.prototype.start=function(){this.timeOffset=0;var lastTimestamp=performance.now();var actions=this.actions;var self=this;function check(){var time=performance.now();self.timeOffset+=(time-lastTimestamp)*self.speed;lastTimestamp=time;while(actions.length){var action=actions[0];if(self.timeOffset>=action.delay){actions.shift();action.doAction();}else{break;}}if(actions.length>0||self.liveMode){self.raf=requestAnimationFrame(check);}}this.raf=requestAnimationFrame(check);};Timer.prototype.clear=function(){if(this.raf){cancelAnimationFrame(this.raf);this.raf=null;}this.actions.length=0;};Timer.prototype.setSpeed=function(speed){this.speed=speed;};Timer.prototype.toggleLiveMode=function(mode){this.liveMode=mode;};Timer.prototype.isActive=function(){return this.raf!==null;};Timer.prototype.findActionIndex=function(action){var start=0;var end=this.actions.length-1;while(start<=end){var mid=Math.floor((start+end)/2);if(this.actions[mid].delay<action.delay){start=mid+1;}else if(this.actions[mid].delay>action.delay){end=mid-1;}else{return mid+1;}}return start;};return Timer;}();function addDelay(event,baselineTime){if(event.type===exports.EventType.IncrementalSnapshot&&event.data.source===exports.IncrementalSource.MouseMove){var firstOffset=event.data.positions[0].timeOffset;var firstTimestamp=event.timestamp+firstOffset;event.delay=firstTimestamp-baselineTime;return firstTimestamp-baselineTime;}event.delay=event.timestamp-baselineTime;return event.delay;}/*! *****************************************************************************
        Copyright (c) Microsoft Corporation.
    
        Permission to use, copy, modify, and/or distribute this software for any
        purpose with or without fee is hereby granted.
    
        THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
        PERFORMANCE OF THIS SOFTWARE.
        ***************************************************************************** */function t(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,i=e.call(t),a=[];try{for(;(void 0===n||n-->0)&&!(r=i.next()).done;){a.push(r.value);}}catch(t){o={error:t};}finally{try{r&&!r.done&&(e=i["return"])&&e.call(i);}finally{if(o)throw o.error;}}return a;}var n;!function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped";}(n||(n={}));var e={type:"xstate.init"};function r(t){return void 0===t?[]:[].concat(t);}function o(t){return{type:"xstate.assign",assignment:t};}function i(t,n){return"string"==typeof(t="string"==typeof t&&n&&n[t]?n[t]:t)?{type:t}:"function"==typeof t?{type:t.name,exec:t}:t;}function a(t){return function(n){return t===n;};}function u(t){return"string"==typeof t?{type:t}:t;}function c(t,n){return{value:t,context:n,actions:[],changed:!1,matches:a(t)};}function f(t,n,e){var r=n,o=!1;return[t.filter(function(t){if("xstate.assign"===t.type){o=!0;var n=Object.assign({},r);return"function"==typeof t.assignment?n=t.assignment(r,e):Object.keys(t.assignment).forEach(function(o){n[o]="function"==typeof t.assignment[o]?t.assignment[o](r,e):t.assignment[o];}),r=n,!1;}return!0;}),r,o];}function s(n,o){void 0===o&&(o={});var s=t(f(r(n.states[n.initial].entry).map(function(t){return i(t,o.actions);}),n.context,e),2),l=s[0],v=s[1],y={config:n,_options:o,initialState:{value:n.initial,actions:l,context:v,matches:a(n.initial)},transition:function transition(e,o){var s,l,v="string"==typeof e?{value:e,context:n.context}:e,p=v.value,g=v.context,d=u(o),x=n.states[p];if(x.on){var m=r(x.on[d.type]);try{for(var h=function(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function next(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t};}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.");}(m),b=h.next();!b.done;b=h.next()){var S=b.value;if(void 0===S)return c(p,g);var w="string"==typeof S?{target:S}:S,j=w.target,E=w.actions,R=void 0===E?[]:E,N=w.cond,O=void 0===N?function(){return!0;}:N,_=void 0===j,k=null!=j?j:p,T=n.states[k];if(O(g,d)){var q=t(f((_?r(R):[].concat(x.exit,R,T.entry).filter(function(t){return t;})).map(function(t){return i(t,y._options.actions);}),g,d),3),z=q[0],A=q[1],B=q[2],C=null!=j?j:p;return{value:C,context:A,actions:z,changed:j!==p||z.length>0||B,matches:a(C)};}}}catch(t){s={error:t};}finally{try{b&&!b.done&&(l=h["return"])&&l.call(h);}finally{if(s)throw s.error;}}}return c(p,g);}};return y;}var l=function l(t,n){return t.actions.forEach(function(e){var r=e.exec;return r&&r(t.context,n);});};function v(t){var r=t.initialState,o=n.NotStarted,i=new Set(),c={_machine:t,send:function send(e){o===n.Running&&(r=t.transition(r,e),l(r,u(e)),i.forEach(function(t){return t(r);}));},subscribe:function subscribe(t){return i.add(t),t(r),{unsubscribe:function unsubscribe(){return i["delete"](t);}};},start:function start(i){if(i){var u="object"==_typeof(i)?i:{context:t.config.context,value:i};r={value:u.value,actions:[],context:u.context,matches:a(u.value)};}return o=n.Running,l(r,e),c;},stop:function stop(){return o=n.Stopped,i.clear(),c;},get state(){return r;},get status(){return o;}};return c;}function discardPriorSnapshots(events,baselineTime){for(var idx=events.length-1;idx>=0;idx--){var event=events[idx];if(event.type===exports.EventType.Meta){if(event.timestamp<=baselineTime){return events.slice(idx);}}}return events;}function createPlayerService(context,_a){var getCastFn=_a.getCastFn,applyEventsSynchronously=_a.applyEventsSynchronously,emitter=_a.emitter;var playerMachine=s({id:'player',context:context,initial:'paused',states:{playing:{on:{PAUSE:{target:'paused',actions:['pause']},CAST_EVENT:{target:'playing',actions:'castEvent'},END:{target:'paused',actions:['resetLastPlayedEvent','pause']},ADD_EVENT:{target:'playing',actions:['addEvent']}}},paused:{on:{PLAY:{target:'playing',actions:['recordTimeOffset','play']},CAST_EVENT:{target:'paused',actions:'castEvent'},TO_LIVE:{target:'live',actions:['startLive']},ADD_EVENT:{target:'paused',actions:['addEvent']}}},live:{on:{ADD_EVENT:{target:'live',actions:['addEvent']},CAST_EVENT:{target:'live',actions:['castEvent']}}}}},{actions:{castEvent:o({lastPlayedEvent:function lastPlayedEvent(ctx,event){if(event.type==='CAST_EVENT'){return event.payload.event;}return ctx.lastPlayedEvent;}}),recordTimeOffset:o(function(ctx,event){var timeOffset=ctx.timeOffset;if('payload'in event&&'timeOffset'in event.payload){timeOffset=event.payload.timeOffset;}return _assign(_assign({},ctx),{timeOffset:timeOffset,baselineTime:ctx.events[0].timestamp+timeOffset});}),play:function play(ctx){var e_1,_a,e_2,_b;var _c;var timer=ctx.timer,events=ctx.events,baselineTime=ctx.baselineTime,lastPlayedEvent=ctx.lastPlayedEvent;timer.clear();try{for(var events_1=__values(events),events_1_1=events_1.next();!events_1_1.done;events_1_1=events_1.next()){var event=events_1_1.value;addDelay(event,baselineTime);}}catch(e_1_1){e_1={error:e_1_1};}finally{try{if(events_1_1&&!events_1_1.done&&(_a=events_1["return"]))_a.call(events_1);}finally{if(e_1)throw e_1.error;}}var neededEvents=discardPriorSnapshots(events,baselineTime);var lastPlayedTimestamp=lastPlayedEvent===null||lastPlayedEvent===void 0?void 0:lastPlayedEvent.timestamp;if((lastPlayedEvent===null||lastPlayedEvent===void 0?void 0:lastPlayedEvent.type)===exports.EventType.IncrementalSnapshot&&lastPlayedEvent.data.source===exports.IncrementalSource.MouseMove){lastPlayedTimestamp=lastPlayedEvent.timestamp+((_c=lastPlayedEvent.data.positions[0])===null||_c===void 0?void 0:_c.timeOffset);}if(baselineTime<(lastPlayedTimestamp||0)){emitter.emit(exports.ReplayerEvents.PlayBack);}var syncEvents=new Array();var actions=new Array();var _loop_1=function _loop_1(event){if(lastPlayedTimestamp&&lastPlayedTimestamp<baselineTime&&(event.timestamp<=lastPlayedTimestamp||event===lastPlayedEvent)){return"continue";}if(event.timestamp<baselineTime){syncEvents.push(event);}else{var castFn_1=getCastFn(event,false);actions.push({doAction:function doAction(){castFn_1();emitter.emit(exports.ReplayerEvents.EventCast,event);},delay:event.delay});}};try{for(var neededEvents_1=__values(neededEvents),neededEvents_1_1=neededEvents_1.next();!neededEvents_1_1.done;neededEvents_1_1=neededEvents_1.next()){var event=neededEvents_1_1.value;_loop_1(event);}}catch(e_2_1){e_2={error:e_2_1};}finally{try{if(neededEvents_1_1&&!neededEvents_1_1.done&&(_b=neededEvents_1["return"]))_b.call(neededEvents_1);}finally{if(e_2)throw e_2.error;}}applyEventsSynchronously(syncEvents);emitter.emit(exports.ReplayerEvents.Flush);timer.addActions(actions);timer.start();},pause:function pause(ctx){ctx.timer.clear();},resetLastPlayedEvent:o(function(ctx){return _assign(_assign({},ctx),{lastPlayedEvent:null});}),startLive:o({baselineTime:function baselineTime(ctx,event){ctx.timer.toggleLiveMode(true);ctx.timer.start();if(event.type==='TO_LIVE'&&event.payload.baselineTime){return event.payload.baselineTime;}return Date.now();}}),addEvent:o(function(ctx,machineEvent){var baselineTime=ctx.baselineTime,timer=ctx.timer,events=ctx.events;if(machineEvent.type==='ADD_EVENT'){var event_1=machineEvent.payload.event;addDelay(event_1,baselineTime);var end=events.length-1;if(!events[end]||events[end].timestamp<=event_1.timestamp){events.push(event_1);}else{var insertionIndex=-1;var start=0;while(start<=end){var mid=Math.floor((start+end)/2);if(events[mid].timestamp<=event_1.timestamp){start=mid+1;}else{end=mid-1;}}if(insertionIndex===-1){insertionIndex=start;}events.splice(insertionIndex,0,event_1);}var isSync=event_1.timestamp<baselineTime;var castFn_2=getCastFn(event_1,isSync);if(isSync){castFn_2();}else if(timer.isActive()){timer.addAction({doAction:function doAction(){castFn_2();emitter.emit(exports.ReplayerEvents.EventCast,event_1);},delay:event_1.delay});}}return _assign(_assign({},ctx),{events:events});})}});return v(playerMachine);}function createSpeedService(context){var speedMachine=s({id:'speed',context:context,initial:'normal',states:{normal:{on:{FAST_FORWARD:{target:'skipping',actions:['recordSpeed','setSpeed']},SET_SPEED:{target:'normal',actions:['setSpeed']}}},skipping:{on:{BACK_TO_NORMAL:{target:'normal',actions:['restoreSpeed']},SET_SPEED:{target:'normal',actions:['setSpeed']}}}}},{actions:{setSpeed:function setSpeed(ctx,event){if('payload'in event){ctx.timer.setSpeed(event.payload.speed);}},recordSpeed:o({normalSpeed:function normalSpeed(ctx){return ctx.timer.speed;}}),restoreSpeed:function restoreSpeed(ctx){ctx.timer.setSpeed(ctx.normalSpeed);}}});return v(speedMachine);}var rules=function rules(blockClass){return["."+blockClass+" { background: #ccc }",'noscript { display: none !important; }'];};var StyleRuleType;(function(StyleRuleType){StyleRuleType[StyleRuleType["Insert"]=0]="Insert";StyleRuleType[StyleRuleType["Remove"]=1]="Remove";StyleRuleType[StyleRuleType["Snapshot"]=2]="Snapshot";StyleRuleType[StyleRuleType["SetProperty"]=3]="SetProperty";StyleRuleType[StyleRuleType["RemoveProperty"]=4]="RemoveProperty";})(StyleRuleType||(StyleRuleType={}));function getNestedRule(rules,position){var rule=rules[position[0]];if(position.length===1){return rule;}else{return getNestedRule(rule.cssRules[position[1]].cssRules,position.slice(2));}}function getPositionsAndIndex(nestedIndex){var positions=__spread(nestedIndex);var index=positions.pop();return{positions:positions,index:index};}function applyVirtualStyleRulesToNode(storedRules,styleNode){storedRules.forEach(function(rule){var _a,_b;if(rule.type===StyleRuleType.Insert){try{if(Array.isArray(rule.index)){var _c=getPositionsAndIndex(rule.index),positions=_c.positions,index=_c.index;var nestedRule=getNestedRule(styleNode.sheet.cssRules,positions);nestedRule.insertRule(rule.cssText,index);}else{(_a=styleNode.sheet)===null||_a===void 0?void 0:_a.insertRule(rule.cssText,rule.index);}}catch(e){}}else if(rule.type===StyleRuleType.Remove){try{if(Array.isArray(rule.index)){var _d=getPositionsAndIndex(rule.index),positions=_d.positions,index=_d.index;var nestedRule=getNestedRule(styleNode.sheet.cssRules,positions);nestedRule.deleteRule(index||0);}else{(_b=styleNode.sheet)===null||_b===void 0?void 0:_b.deleteRule(rule.index);}}catch(e){}}else if(rule.type===StyleRuleType.Snapshot){restoreSnapshotOfStyleRulesToNode(rule.cssTexts,styleNode);}else if(rule.type===StyleRuleType.SetProperty){var nativeRule=getNestedRule(styleNode.sheet.cssRules,rule.index);nativeRule.style.setProperty(rule.property,rule.value,rule.priority);}else if(rule.type===StyleRuleType.RemoveProperty){var nativeRule=getNestedRule(styleNode.sheet.cssRules,rule.index);nativeRule.style.removeProperty(rule.property);}});}function restoreSnapshotOfStyleRulesToNode(cssTexts,styleNode){var _a;try{var existingRules=Array.from(((_a=styleNode.sheet)===null||_a===void 0?void 0:_a.cssRules)||[]).map(function(rule){return rule.cssText;});var existingRulesReversed=Object.entries(existingRules).reverse();var lastMatch_1=existingRules.length;existingRulesReversed.forEach(function(_a){var _b;var _c=__read(_a,2),index=_c[0],rule=_c[1];var indexOf=cssTexts.indexOf(rule);if(indexOf===-1||indexOf>lastMatch_1){try{(_b=styleNode.sheet)===null||_b===void 0?void 0:_b.deleteRule(Number(index));}catch(e){}}lastMatch_1=indexOf;});cssTexts.forEach(function(cssText,index){var _a,_b,_c;try{if(((_b=(_a=styleNode.sheet)===null||_a===void 0?void 0:_a.cssRules[index])===null||_b===void 0?void 0:_b.cssText)!==cssText){(_c=styleNode.sheet)===null||_c===void 0?void 0:_c.insertRule(cssText,index);}}catch(e){}});}catch(e){}}function storeCSSRules(parentElement,virtualStyleRulesMap){var _a;try{var cssTexts=Array.from(((_a=parentElement.sheet)===null||_a===void 0?void 0:_a.cssRules)||[]).map(function(rule){return rule.cssText;});virtualStyleRulesMap.set(parentElement,[{type:StyleRuleType.Snapshot,cssTexts:cssTexts}]);}catch(e){}}var SKIP_TIME_THRESHOLD=10*1000;var SKIP_TIME_INTERVAL=5*1000;var mitt=mitt$1||mittProxy;var REPLAY_CONSOLE_PREFIX='[replayer]';var defaultMouseTailConfig={duration:500,lineCap:'round',lineWidth:3,strokeStyle:'red'};function indicatesTouchDevice(e){return e.type==exports.EventType.IncrementalSnapshot&&(e.data.source==exports.IncrementalSource.TouchMove||e.data.source==exports.IncrementalSource.MouseInteraction&&e.data.type==exports.MouseInteractions.TouchStart);}var Replayer=function(){function Replayer(events,config){var _this=this;this.mouseTail=null;this.tailPositions=[];this.emitter=mitt();this.legacy_missingNodeRetryMap={};this.cache=createCache();this.imageMap=new Map();this.mirror=createMirror();this.firstFullSnapshot=null;this.newDocumentQueue=[];this.mousePos=null;this.touchActive=null;if(!(config===null||config===void 0?void 0:config.liveMode)&&events.length<2){throw new Error('Replayer need at least 2 events.');}var defaultConfig={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:false,showWarning:true,showDebug:false,blockClass:'rr-block',liveMode:false,insertStyleRules:[],triggerFocus:true,UNSAFE_replayCanvas:false,pauseAnimation:true,mouseTail:defaultMouseTailConfig};this.config=Object.assign({},defaultConfig,config);this.handleResize=this.handleResize.bind(this);this.getCastFn=this.getCastFn.bind(this);this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this);this.emitter.on(exports.ReplayerEvents.Resize,this.handleResize);this.setupDom();this.treeIndex=new TreeIndex();this.fragmentParentMap=new Map();this.elementStateMap=new Map();this.virtualStyleRulesMap=new Map();this.emitter.on(exports.ReplayerEvents.Flush,function(){var e_1,_a,e_2,_b,e_3,_c;var _d=_this.treeIndex.flush(),scrollMap=_d.scrollMap,inputMap=_d.inputMap;_this.fragmentParentMap.forEach(function(parent,frag){return _this.restoreRealParent(frag,parent);});try{for(var _e=__values(_this.virtualStyleRulesMap.keys()),_f=_e.next();!_f.done;_f=_e.next()){var node=_f.value;_this.restoreNodeSheet(node);}}catch(e_1_1){e_1={error:e_1_1};}finally{try{if(_f&&!_f.done&&(_a=_e["return"]))_a.call(_e);}finally{if(e_1)throw e_1.error;}}_this.fragmentParentMap.clear();_this.elementStateMap.clear();_this.virtualStyleRulesMap.clear();try{for(var _g=__values(scrollMap.values()),_h=_g.next();!_h.done;_h=_g.next()){var d=_h.value;_this.applyScroll(d);}}catch(e_2_1){e_2={error:e_2_1};}finally{try{if(_h&&!_h.done&&(_b=_g["return"]))_b.call(_g);}finally{if(e_2)throw e_2.error;}}try{for(var _j=__values(inputMap.values()),_k=_j.next();!_k.done;_k=_j.next()){var d=_k.value;_this.applyInput(d);}}catch(e_3_1){e_3={error:e_3_1};}finally{try{if(_k&&!_k.done&&(_c=_j["return"]))_c.call(_j);}finally{if(e_3)throw e_3.error;}}});this.emitter.on(exports.ReplayerEvents.PlayBack,function(){_this.firstFullSnapshot=null;_this.mirror.reset();});var timer=new Timer([],(config===null||config===void 0?void 0:config.speed)||defaultConfig.speed);this.service=createPlayerService({events:events.map(function(e){if(config&&config.unpackFn){return config.unpackFn(e);}return e;}).sort(function(a1,a2){return a1.timestamp-a2.timestamp;}),timer:timer,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter});this.service.start();this.service.subscribe(function(state){_this.emitter.emit(exports.ReplayerEvents.StateChange,{player:state});});this.speedService=createSpeedService({normalSpeed:-1,timer:timer});this.speedService.start();this.speedService.subscribe(function(state){_this.emitter.emit(exports.ReplayerEvents.StateChange,{speed:state});});var firstMeta=this.service.state.context.events.find(function(e){return e.type===exports.EventType.Meta;});var firstFullsnapshot=this.service.state.context.events.find(function(e){return e.type===exports.EventType.FullSnapshot;});if(firstMeta){var _a=firstMeta.data,width_1=_a.width,height_1=_a.height;setTimeout(function(){_this.emitter.emit(exports.ReplayerEvents.Resize,{width:width_1,height:height_1});},0);}if(firstFullsnapshot){setTimeout(function(){if(_this.firstFullSnapshot){return;}_this.firstFullSnapshot=firstFullsnapshot;_this.rebuildFullSnapshot(firstFullsnapshot);_this.iframe.contentWindow.scrollTo(firstFullsnapshot.data.initialOffset);},1);}if(this.service.state.context.events.find(indicatesTouchDevice)){this.mouse.classList.add('touch-device');}}Object.defineProperty(Replayer.prototype,"timer",{get:function get(){return this.service.state.context.timer;},enumerable:false,configurable:true});Replayer.prototype.on=function(event,handler){this.emitter.on(event,handler);return this;};Replayer.prototype.off=function(event,handler){this.emitter.off(event,handler);return this;};Replayer.prototype.setConfig=function(config){var _this=this;Object.keys(config).forEach(function(key){_this.config[key]=config[key];});if(!this.config.skipInactive){this.backToNormal();}if(typeof config.speed!=='undefined'){this.speedService.send({type:'SET_SPEED',payload:{speed:config.speed}});}if(typeof config.mouseTail!=='undefined'){if(config.mouseTail===false){if(this.mouseTail){this.mouseTail.style.display='none';}}else{if(!this.mouseTail){this.mouseTail=document.createElement('canvas');this.mouseTail.width=Number.parseFloat(this.iframe.width);this.mouseTail.height=Number.parseFloat(this.iframe.height);this.mouseTail.classList.add('replayer-mouse-tail');this.wrapper.insertBefore(this.mouseTail,this.iframe);}this.mouseTail.style.display='inherit';}}};Replayer.prototype.getMetaData=function(){var firstEvent=this.service.state.context.events[0];var lastEvent=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:firstEvent.timestamp,endTime:lastEvent.timestamp,totalTime:lastEvent.timestamp-firstEvent.timestamp};};Replayer.prototype.getCurrentTime=function(){return this.timer.timeOffset+this.getTimeOffset();};Replayer.prototype.getTimeOffset=function(){var _a=this.service.state.context,baselineTime=_a.baselineTime,events=_a.events;return baselineTime-events[0].timestamp;};Replayer.prototype.getMirror=function(){return this.mirror;};Replayer.prototype.play=function(timeOffset){var _a;if(timeOffset===void 0){timeOffset=0;}if(this.service.state.matches('paused')){this.service.send({type:'PLAY',payload:{timeOffset:timeOffset}});}else{this.service.send({type:'PAUSE'});this.service.send({type:'PLAY',payload:{timeOffset:timeOffset}});}(_a=this.iframe.contentDocument)===null||_a===void 0?void 0:_a.getElementsByTagName('html')[0].classList.remove('rrweb-paused');this.emitter.emit(exports.ReplayerEvents.Start);};Replayer.prototype.pause=function(timeOffset){var _a;if(timeOffset===undefined&&this.service.state.matches('playing')){this.service.send({type:'PAUSE'});}if(typeof timeOffset==='number'){this.play(timeOffset);this.service.send({type:'PAUSE'});}(_a=this.iframe.contentDocument)===null||_a===void 0?void 0:_a.getElementsByTagName('html')[0].classList.add('rrweb-paused');this.emitter.emit(exports.ReplayerEvents.Pause);};Replayer.prototype.resume=function(timeOffset){if(timeOffset===void 0){timeOffset=0;}console.warn("The 'resume' will be departed in 1.0. Please use 'play' method which has the same interface.");this.play(timeOffset);this.emitter.emit(exports.ReplayerEvents.Resume);};Replayer.prototype.startLive=function(baselineTime){this.service.send({type:'TO_LIVE',payload:{baselineTime:baselineTime}});};Replayer.prototype.addEvent=function(rawEvent){var _this=this;var event=this.config.unpackFn?this.config.unpackFn(rawEvent):rawEvent;if(indicatesTouchDevice(event)){this.mouse.classList.add('touch-device');}Promise.resolve().then(function(){return _this.service.send({type:'ADD_EVENT',payload:{event:event}});});};Replayer.prototype.enableInteract=function(){this.iframe.setAttribute('scrolling','auto');this.iframe.style.pointerEvents='auto';};Replayer.prototype.disableInteract=function(){this.iframe.setAttribute('scrolling','no');this.iframe.style.pointerEvents='none';};Replayer.prototype.resetCache=function(){this.cache=createCache();};Replayer.prototype.setupDom=function(){this.wrapper=document.createElement('div');this.wrapper.classList.add('replayer-wrapper');this.config.root.appendChild(this.wrapper);this.mouse=document.createElement('div');this.mouse.classList.add('replayer-mouse');this.wrapper.appendChild(this.mouse);if(this.config.mouseTail!==false){this.mouseTail=document.createElement('canvas');this.mouseTail.classList.add('replayer-mouse-tail');this.mouseTail.style.display='inherit';this.wrapper.appendChild(this.mouseTail);}this.iframe=document.createElement('iframe');var attributes=['allow-same-origin'];if(this.config.UNSAFE_replayCanvas){attributes.push('allow-scripts');}this.iframe.style.display='none';this.iframe.setAttribute('sandbox',attributes.join(' '));this.disableInteract();this.wrapper.appendChild(this.iframe);if(this.iframe.contentWindow&&this.iframe.contentDocument){polyfill(this.iframe.contentWindow,this.iframe.contentDocument);polyfill$1(this.iframe.contentWindow);}};Replayer.prototype.handleResize=function(dimension){var e_4,_a;this.iframe.style.display='inherit';try{for(var _b=__values([this.mouseTail,this.iframe]),_c=_b.next();!_c.done;_c=_b.next()){var el=_c.value;if(!el){continue;}el.setAttribute('width',String(dimension.width));el.setAttribute('height',String(dimension.height));}}catch(e_4_1){e_4={error:e_4_1};}finally{try{if(_c&&!_c.done&&(_a=_b["return"]))_a.call(_b);}finally{if(e_4)throw e_4.error;}}};Replayer.prototype.applyEventsSynchronously=function(events){var e_5,_a;try{for(var events_1=__values(events),events_1_1=events_1.next();!events_1_1.done;events_1_1=events_1.next()){var event=events_1_1.value;switch(event.type){case exports.EventType.DomContentLoaded:case exports.EventType.Load:case exports.EventType.Custom:continue;case exports.EventType.FullSnapshot:case exports.EventType.Meta:case exports.EventType.Plugin:break;case exports.EventType.IncrementalSnapshot:switch(event.data.source){case exports.IncrementalSource.MediaInteraction:continue;default:break;}break;default:break;}var castFn=this.getCastFn(event,true);castFn();}}catch(e_5_1){e_5={error:e_5_1};}finally{try{if(events_1_1&&!events_1_1.done&&(_a=events_1["return"]))_a.call(events_1);}finally{if(e_5)throw e_5.error;}}if(this.mousePos){this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,true,this.mousePos.debugData);}this.mousePos=null;if(this.touchActive===true){this.mouse.classList.add('touch-active');}else if(this.touchActive===false){this.mouse.classList.remove('touch-active');}this.touchActive=null;};Replayer.prototype.getCastFn=function(event,isSync){var _this=this;if(isSync===void 0){isSync=false;}var castFn;switch(event.type){case exports.EventType.DomContentLoaded:case exports.EventType.Load:break;case exports.EventType.Custom:castFn=function castFn(){_this.emitter.emit(exports.ReplayerEvents.CustomEvent,event);};break;case exports.EventType.Meta:castFn=function castFn(){return _this.emitter.emit(exports.ReplayerEvents.Resize,{width:event.data.width,height:event.data.height});};break;case exports.EventType.FullSnapshot:castFn=function castFn(){if(_this.firstFullSnapshot){if(_this.firstFullSnapshot===event){_this.firstFullSnapshot=true;return;}}else{_this.firstFullSnapshot=true;}_this.rebuildFullSnapshot(event,isSync);_this.iframe.contentWindow.scrollTo(event.data.initialOffset);};break;case exports.EventType.IncrementalSnapshot:castFn=function castFn(){var e_6,_a;_this.applyIncremental(event,isSync);if(isSync){return;}if(event===_this.nextUserInteractionEvent){_this.nextUserInteractionEvent=null;_this.backToNormal();}if(_this.config.skipInactive&&!_this.nextUserInteractionEvent){try{for(var _b=__values(_this.service.state.context.events),_c=_b.next();!_c.done;_c=_b.next()){var _event=_c.value;if(_event.timestamp<=event.timestamp){continue;}if(_this.isUserInteraction(_event)){if(_event.delay-event.delay>SKIP_TIME_THRESHOLD*_this.speedService.state.context.timer.speed){_this.nextUserInteractionEvent=_event;}break;}}}catch(e_6_1){e_6={error:e_6_1};}finally{try{if(_c&&!_c.done&&(_a=_b["return"]))_a.call(_b);}finally{if(e_6)throw e_6.error;}}if(_this.nextUserInteractionEvent){var skipTime=_this.nextUserInteractionEvent.delay-event.delay;var payload={speed:Math.min(Math.round(skipTime/SKIP_TIME_INTERVAL),_this.config.maxSpeed)};_this.speedService.send({type:'FAST_FORWARD',payload:payload});_this.emitter.emit(exports.ReplayerEvents.SkipStart,payload);}}};break;}var wrappedCastFn=function wrappedCastFn(){var e_7,_a;if(castFn){castFn();}try{for(var _b=__values(_this.config.plugins||[]),_c=_b.next();!_c.done;_c=_b.next()){var plugin=_c.value;plugin.handler(event,isSync,{replayer:_this});}}catch(e_7_1){e_7={error:e_7_1};}finally{try{if(_c&&!_c.done&&(_a=_b["return"]))_a.call(_b);}finally{if(e_7)throw e_7.error;}}_this.service.send({type:'CAST_EVENT',payload:{event:event}});var last_index=_this.service.state.context.events.length-1;if(event===_this.service.state.context.events[last_index]){var finish_1=function finish_1(){if(last_index<_this.service.state.context.events.length-1){return;}_this.backToNormal();_this.service.send('END');_this.emitter.emit(exports.ReplayerEvents.Finish);};if(event.type===exports.EventType.IncrementalSnapshot&&event.data.source===exports.IncrementalSource.MouseMove&&event.data.positions.length){setTimeout(function(){finish_1();},Math.max(0,-event.data.positions[0].timeOffset+50));}else{finish_1();}}};return wrappedCastFn;};Replayer.prototype.rebuildFullSnapshot=function(event,isSync){var e_8,_a;var _this=this;if(isSync===void 0){isSync=false;}if(!this.iframe.contentDocument){return console.warn('Looks like your replayer has been destroyed.');}if(Object.keys(this.legacy_missingNodeRetryMap).length){console.warn('Found unresolved missing node map',this.legacy_missingNodeRetryMap);}this.legacy_missingNodeRetryMap={};var collected=[];this.mirror.map=rebuild(event.data.node,{doc:this.iframe.contentDocument,afterAppend:function afterAppend(builtNode){_this.collectIframeAndAttachDocument(collected,builtNode);},cache:this.cache})[1];var _loop_1=function _loop_1(mutationInQueue,builtNode){this_1.attachDocumentToIframe(mutationInQueue,builtNode);this_1.newDocumentQueue=this_1.newDocumentQueue.filter(function(m){return m!==mutationInQueue;});if(builtNode.contentDocument){var _a=builtNode.contentDocument,documentElement_1=_a.documentElement,head_1=_a.head;this_1.insertStyleRules(documentElement_1,head_1);}};var this_1=this;try{for(var collected_1=__values(collected),collected_1_1=collected_1.next();!collected_1_1.done;collected_1_1=collected_1.next()){var _b=collected_1_1.value,mutationInQueue=_b.mutationInQueue,builtNode=_b.builtNode;_loop_1(mutationInQueue,builtNode);}}catch(e_8_1){e_8={error:e_8_1};}finally{try{if(collected_1_1&&!collected_1_1.done&&(_a=collected_1["return"]))_a.call(collected_1);}finally{if(e_8)throw e_8.error;}}var _c=this.iframe.contentDocument,documentElement=_c.documentElement,head=_c.head;this.insertStyleRules(documentElement,head);if(!this.service.state.matches('playing')){this.iframe.contentDocument.getElementsByTagName('html')[0].classList.add('rrweb-paused');}this.emitter.emit(exports.ReplayerEvents.FullsnapshotRebuilded,event);if(!isSync){this.waitForStylesheetLoad();}if(this.config.UNSAFE_replayCanvas){this.preloadAllImages();}};Replayer.prototype.insertStyleRules=function(documentElement,head){var styleEl=document.createElement('style');documentElement.insertBefore(styleEl,head);var injectStylesRules=rules(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation){injectStylesRules.push('html.rrweb-paused * { animation-play-state: paused !important; }');}for(var idx=0;idx<injectStylesRules.length;idx++){styleEl.sheet.insertRule(injectStylesRules[idx],idx);}};Replayer.prototype.attachDocumentToIframe=function(mutation,iframeEl){var e_9,_a;var _this=this;var collected=[];if(!iframeEl.contentDocument){var parent=iframeEl.parentNode;while(parent){if(this.fragmentParentMap.has(parent)){var frag=parent;var realParent=this.fragmentParentMap.get(frag);this.restoreRealParent(frag,realParent);break;}parent=parent.parentNode;}}buildNodeWithSN(mutation.node,{doc:iframeEl.contentDocument,map:this.mirror.map,hackCss:true,skipChild:false,afterAppend:function afterAppend(builtNode){_this.collectIframeAndAttachDocument(collected,builtNode);},cache:this.cache});var _loop_2=function _loop_2(mutationInQueue,builtNode){this_2.attachDocumentToIframe(mutationInQueue,builtNode);this_2.newDocumentQueue=this_2.newDocumentQueue.filter(function(m){return m!==mutationInQueue;});if(builtNode.contentDocument){var _a=builtNode.contentDocument,documentElement=_a.documentElement,head=_a.head;this_2.insertStyleRules(documentElement,head);}};var this_2=this;try{for(var collected_2=__values(collected),collected_2_1=collected_2.next();!collected_2_1.done;collected_2_1=collected_2.next()){var _b=collected_2_1.value,mutationInQueue=_b.mutationInQueue,builtNode=_b.builtNode;_loop_2(mutationInQueue,builtNode);}}catch(e_9_1){e_9={error:e_9_1};}finally{try{if(collected_2_1&&!collected_2_1.done&&(_a=collected_2["return"]))_a.call(collected_2);}finally{if(e_9)throw e_9.error;}}};Replayer.prototype.collectIframeAndAttachDocument=function(collected,builtNode){if(isIframeINode(builtNode)){var mutationInQueue=this.newDocumentQueue.find(function(m){return m.parentId===builtNode.__sn.id;});if(mutationInQueue){collected.push({mutationInQueue:mutationInQueue,builtNode:builtNode});}}};Replayer.prototype.waitForStylesheetLoad=function(){var _this=this;var _a;var head=(_a=this.iframe.contentDocument)===null||_a===void 0?void 0:_a.head;if(head){var unloadSheets_1=new Set();var timer_1;var beforeLoadState_1=this.service.state;var stateHandler_1=function stateHandler_1(){beforeLoadState_1=_this.service.state;};this.emitter.on(exports.ReplayerEvents.Start,stateHandler_1);this.emitter.on(exports.ReplayerEvents.Pause,stateHandler_1);var unsubscribe_1=function unsubscribe_1(){_this.emitter.off(exports.ReplayerEvents.Start,stateHandler_1);_this.emitter.off(exports.ReplayerEvents.Pause,stateHandler_1);};head.querySelectorAll('link[rel="stylesheet"]').forEach(function(css){if(!css.sheet){unloadSheets_1.add(css);css.addEventListener('load',function(){unloadSheets_1["delete"](css);if(unloadSheets_1.size===0&&timer_1!==-1){if(beforeLoadState_1.matches('playing')){_this.play(_this.getCurrentTime());}_this.emitter.emit(exports.ReplayerEvents.LoadStylesheetEnd);if(timer_1){window.clearTimeout(timer_1);}unsubscribe_1();}});}});if(unloadSheets_1.size>0){this.service.send({type:'PAUSE'});this.emitter.emit(exports.ReplayerEvents.LoadStylesheetStart);timer_1=window.setTimeout(function(){if(beforeLoadState_1.matches('playing')){_this.play(_this.getCurrentTime());}timer_1=-1;unsubscribe_1();},this.config.loadTimeout);}}};Replayer.prototype.preloadAllImages=function(){var e_10,_a;var _this=this;this.service.state;var stateHandler=function stateHandler(){_this.service.state;};this.emitter.on(exports.ReplayerEvents.Start,stateHandler);this.emitter.on(exports.ReplayerEvents.Pause,stateHandler);try{for(var _b=__values(this.service.state.context.events),_c=_b.next();!_c.done;_c=_b.next()){var event=_c.value;if(event.type===exports.EventType.IncrementalSnapshot&&event.data.source===exports.IncrementalSource.CanvasMutation&&event.data.property==='drawImage'&&typeof event.data.args[0]==='string'&&!this.imageMap.has(event)){var canvas=document.createElement('canvas');var ctx=canvas.getContext('2d');var imgd=ctx===null||ctx===void 0?void 0:ctx.createImageData(canvas.width,canvas.height);var d=imgd===null||imgd===void 0?void 0:imgd.data;d=JSON.parse(event.data.args[0]);ctx===null||ctx===void 0?void 0:ctx.putImageData(imgd,0,0);}}}catch(e_10_1){e_10={error:e_10_1};}finally{try{if(_c&&!_c.done&&(_a=_b["return"]))_a.call(_b);}finally{if(e_10)throw e_10.error;}}};Replayer.prototype.applyIncremental=function(e,isSync){var _this=this;var _a,_b;var d=e.data;switch(d.source){case exports.IncrementalSource.Mutation:{if(isSync){d.adds.forEach(function(m){return _this.treeIndex.add(m);});d.texts.forEach(function(m){return _this.treeIndex.text(m);});d.attributes.forEach(function(m){return _this.treeIndex.attribute(m);});d.removes.forEach(function(m){return _this.treeIndex.remove(m,_this.mirror);});}try{this.applyMutation(d,isSync);}catch(error){this.warn("Exception in mutation "+(error.message||error),d);}break;}case exports.IncrementalSource.Drag:case exports.IncrementalSource.TouchMove:case exports.IncrementalSource.MouseMove:if(isSync){var lastPosition=d.positions[d.positions.length-1];this.mousePos={x:lastPosition.x,y:lastPosition.y,id:lastPosition.id,debugData:d};}else{d.positions.forEach(function(p){var action={doAction:function doAction(){_this.moveAndHover(p.x,p.y,p.id,isSync,d);},delay:p.timeOffset+e.timestamp-_this.service.state.context.baselineTime};_this.timer.addAction(action);});this.timer.addAction({doAction:function doAction(){},delay:e.delay-((_a=d.positions[0])===null||_a===void 0?void 0:_a.timeOffset)});}break;case exports.IncrementalSource.MouseInteraction:{if(d.id===-1){break;}var event=new Event(exports.MouseInteractions[d.type].toLowerCase());var target=this.mirror.getNode(d.id);if(!target){return this.debugNodeNotFound(d,d.id);}this.emitter.emit(exports.ReplayerEvents.MouseInteraction,{type:d.type,target:target});var triggerFocus=this.config.triggerFocus;switch(d.type){case exports.MouseInteractions.Blur:if('blur'in target){target.blur();}break;case exports.MouseInteractions.Focus:if(triggerFocus&&target.focus){target.focus({preventScroll:true});}break;case exports.MouseInteractions.Click:case exports.MouseInteractions.TouchStart:case exports.MouseInteractions.TouchEnd:if(isSync){if(d.type===exports.MouseInteractions.TouchStart){this.touchActive=true;}else if(d.type===exports.MouseInteractions.TouchEnd){this.touchActive=false;}this.mousePos={x:d.x,y:d.y,id:d.id,debugData:d};}else{if(d.type===exports.MouseInteractions.TouchStart){this.tailPositions.length=0;}this.moveAndHover(d.x,d.y,d.id,isSync,d);if(d.type===exports.MouseInteractions.Click){this.mouse.classList.remove('active');void this.mouse.offsetWidth;this.mouse.classList.add('active');}else if(d.type===exports.MouseInteractions.TouchStart){void this.mouse.offsetWidth;this.mouse.classList.add('touch-active');}else if(d.type===exports.MouseInteractions.TouchEnd){this.mouse.classList.remove('touch-active');}}break;case exports.MouseInteractions.TouchCancel:if(isSync){this.touchActive=false;}else{this.mouse.classList.remove('touch-active');}break;default:target.dispatchEvent(event);}break;}case exports.IncrementalSource.Scroll:{if(d.id===-1){break;}if(isSync){this.treeIndex.scroll(d);break;}this.applyScroll(d);break;}case exports.IncrementalSource.ViewportResize:this.emitter.emit(exports.ReplayerEvents.Resize,{width:d.width,height:d.height});break;case exports.IncrementalSource.Input:{if(d.id===-1){break;}if(isSync){this.treeIndex.input(d);break;}this.applyInput(d);break;}case exports.IncrementalSource.MediaInteraction:{var target=this.mirror.getNode(d.id);if(!target){return this.debugNodeNotFound(d,d.id);}var mediaEl=target;try{if(d.currentTime){mediaEl.currentTime=d.currentTime;}if(d.type===MediaInteractions.Pause){mediaEl.pause();}if(d.type===MediaInteractions.Play){mediaEl.play();}}catch(error){if(this.config.showWarning){console.warn("Failed to replay media interactions: "+(error.message||error));}}break;}case exports.IncrementalSource.StyleSheetRule:{var target=this.mirror.getNode(d.id);if(!target){return this.debugNodeNotFound(d,d.id);}var styleEl=target;var parent=target.parentNode;var usingVirtualParent_1=this.fragmentParentMap.has(parent);var styleSheet_1=usingVirtualParent_1?null:styleEl.sheet;var rules_1;if(!styleSheet_1){if(this.virtualStyleRulesMap.has(target)){rules_1=this.virtualStyleRulesMap.get(target);}else{rules_1=[];this.virtualStyleRulesMap.set(target,rules_1);}}if(d.adds){d.adds.forEach(function(_a){var rule=_a.rule,nestedIndex=_a.index;if(styleSheet_1){try{if(Array.isArray(nestedIndex)){var _b=getPositionsAndIndex(nestedIndex),positions=_b.positions,index=_b.index;var nestedRule=getNestedRule(styleSheet_1.cssRules,positions);nestedRule.insertRule(rule,index);}else{var index=nestedIndex===undefined?undefined:Math.min(nestedIndex,styleSheet_1.cssRules.length);styleSheet_1.insertRule(rule,index);}}catch(e){}}else{rules_1===null||rules_1===void 0?void 0:rules_1.push({cssText:rule,index:nestedIndex,type:StyleRuleType.Insert});}});}if(d.removes){d.removes.forEach(function(_a){var nestedIndex=_a.index;if(usingVirtualParent_1){rules_1===null||rules_1===void 0?void 0:rules_1.push({index:nestedIndex,type:StyleRuleType.Remove});}else{try{if(Array.isArray(nestedIndex)){var _b=getPositionsAndIndex(nestedIndex),positions=_b.positions,index=_b.index;var nestedRule=getNestedRule(styleSheet_1.cssRules,positions);nestedRule.deleteRule(index||0);}else{styleSheet_1===null||styleSheet_1===void 0?void 0:styleSheet_1.deleteRule(nestedIndex);}}catch(e){}}});}break;}case exports.IncrementalSource.StyleDeclaration:{var target=this.mirror.getNode(d.id);if(!target){return this.debugNodeNotFound(d,d.id);}var styleEl=target;var parent=target.parentNode;var usingVirtualParent=this.fragmentParentMap.has(parent);var styleSheet=usingVirtualParent?null:styleEl.sheet;var rules=[];if(!styleSheet){if(this.virtualStyleRulesMap.has(target)){rules=this.virtualStyleRulesMap.get(target);}else{rules=[];this.virtualStyleRulesMap.set(target,rules);}}if(d.set){if(styleSheet){var rule=getNestedRule(styleSheet.rules,d.index);rule.style.setProperty(d.set.property,d.set.value,d.set.priority);}else{rules.push(_assign({type:StyleRuleType.SetProperty,index:d.index},d.set));}}if(d.remove){if(styleSheet){var rule=getNestedRule(styleSheet.rules,d.index);rule.style.removeProperty(d.remove.property);}else{rules.push(_assign({type:StyleRuleType.RemoveProperty,index:d.index},d.remove));}}break;}case exports.IncrementalSource.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas){return;}var target=this.mirror.getNode(d.id);if(!target){return this.debugNodeNotFound(d,d.id);}try{var ctx=target.getContext('2d');if(d.setter){ctx[d.property]=d.args[0];return;}var original=ctx[d.property];if(d.property==='drawImage'&&typeof d.args[0]==='string'){var image=this.imageMap.get(e);d.args[0]=image;original.apply(ctx,d.args);}else{original.apply(ctx,d.args);}}catch(error){this.warnCanvasMutationFailed(d,d.id,error);}break;}case exports.IncrementalSource.Font:{try{var fontFace=new FontFace(d.family,d.buffer?new Uint8Array(JSON.parse(d.fontSource)):d.fontSource,d.descriptors);(_b=this.iframe.contentDocument)===null||_b===void 0?void 0:_b.fonts.add(fontFace);}catch(error){if(this.config.showWarning){console.warn(error);}}break;}}};Replayer.prototype.applyMutation=function(d,useVirtualParent){var e_11,_a;var _this=this;d.removes.forEach(function(mutation){var target=_this.mirror.getNode(mutation.id);if(!target){if(d.removes.find(function(r){return r.id===mutation.parentId;})){return;}return _this.warnNodeNotFound(d,mutation.id);}var parent=_this.mirror.getNode(mutation.parentId);if(!parent){return _this.warnNodeNotFound(d,mutation.parentId);}if(mutation.isShadow&&hasShadowRoot(parent)){parent=parent.shadowRoot;}_this.mirror.removeNodeFromMap(target);if(parent){var realTarget=null;var realParent='__sn'in parent?_this.fragmentParentMap.get(parent):undefined;if(realParent&&realParent.contains(target)){parent=realParent;}else if(_this.fragmentParentMap.has(target)){realTarget=_this.fragmentParentMap.get(target);_this.fragmentParentMap["delete"](target);target=realTarget;}try{parent.removeChild(target);}catch(error){if(error instanceof DOMException){_this.warn('parent could not remove child in mutation',parent,realParent,target,realTarget,d);}else{throw error;}}}});var legacy_missingNodeMap=_assign({},this.legacy_missingNodeRetryMap);var queue=[];var nextNotInDOM=function nextNotInDOM(mutation){var next=null;if(mutation.nextId){next=_this.mirror.getNode(mutation.nextId);}if(mutation.nextId!==null&&mutation.nextId!==undefined&&mutation.nextId!==-1&&!next){return true;}return false;};var appendNode=function appendNode(mutation){var _a,_b;if(!_this.iframe.contentDocument){return console.warn('Looks like your replayer has been destroyed.');}var parent=_this.mirror.getNode(mutation.parentId);if(!parent){if(mutation.node.type===NodeType.Document){return _this.newDocumentQueue.push(mutation);}return queue.push(mutation);}var parentInDocument=null;if(_this.iframe.contentDocument.contains){parentInDocument=_this.iframe.contentDocument.contains(parent);}else if(_this.iframe.contentDocument.body.contains){parentInDocument=_this.iframe.contentDocument.body.contains(parent);}var hasIframeChild=((_b=(_a=parent).getElementsByTagName)===null||_b===void 0?void 0:_b.call(_a,'iframe').length)>0;if(useVirtualParent&&parentInDocument&&!isIframeINode(parent)&&!hasIframeChild){var virtualParent=document.createDocumentFragment();_this.mirror.map[mutation.parentId]=virtualParent;_this.fragmentParentMap.set(virtualParent,parent);_this.storeState(parent);while(parent.firstChild){virtualParent.appendChild(parent.firstChild);}parent=virtualParent;}if(mutation.node.isShadow&&hasShadowRoot(parent)){parent=parent.shadowRoot;}var previous=null;var next=null;if(mutation.previousId){previous=_this.mirror.getNode(mutation.previousId);}if(mutation.nextId){next=_this.mirror.getNode(mutation.nextId);}if(nextNotInDOM(mutation)){return queue.push(mutation);}if(mutation.node.rootId&&!_this.mirror.getNode(mutation.node.rootId)){return;}var targetDoc=mutation.node.rootId?_this.mirror.getNode(mutation.node.rootId):_this.iframe.contentDocument;if(isIframeINode(parent)){_this.attachDocumentToIframe(mutation,parent);return;}var target=buildNodeWithSN(mutation.node,{doc:targetDoc,map:_this.mirror.map,skipChild:true,hackCss:true,cache:_this.cache});if(mutation.previousId===-1||mutation.nextId===-1){legacy_missingNodeMap[mutation.node.id]={node:target,mutation:mutation};return;}if(previous&&previous.nextSibling&&previous.nextSibling.parentNode){parent.insertBefore(target,previous.nextSibling);}else if(next&&next.parentNode){parent.contains(next)?parent.insertBefore(target,next):parent.insertBefore(target,null);}else{if(parent===targetDoc){while(targetDoc.firstChild){targetDoc.removeChild(targetDoc.firstChild);}}parent.appendChild(target);}if(isIframeINode(target)){var mutationInQueue_1=_this.newDocumentQueue.find(function(m){return m.parentId===target.__sn.id;});if(mutationInQueue_1){_this.attachDocumentToIframe(mutationInQueue_1,target);_this.newDocumentQueue=_this.newDocumentQueue.filter(function(m){return m!==mutationInQueue_1;});}if(target.contentDocument){var _c=target.contentDocument,documentElement=_c.documentElement,head=_c.head;_this.insertStyleRules(documentElement,head);}}if(mutation.previousId||mutation.nextId){_this.legacy_resolveMissingNode(legacy_missingNodeMap,parent,target,mutation);}};d.adds.forEach(function(mutation){appendNode(mutation);});var startTime=Date.now();while(queue.length){var resolveTrees=queueToResolveTrees(queue);queue.length=0;if(Date.now()-startTime>500){this.warn('Timeout in the loop, please check the resolve tree data:',resolveTrees);break;}try{for(var resolveTrees_1=(e_11=void 0,__values(resolveTrees)),resolveTrees_1_1=resolveTrees_1.next();!resolveTrees_1_1.done;resolveTrees_1_1=resolveTrees_1.next()){var tree=resolveTrees_1_1.value;var parent=this.mirror.getNode(tree.value.parentId);if(!parent){this.debug('Drop resolve tree since there is no parent for the root node.',tree);}else{iterateResolveTree(tree,function(mutation){appendNode(mutation);});}}}catch(e_11_1){e_11={error:e_11_1};}finally{try{if(resolveTrees_1_1&&!resolveTrees_1_1.done&&(_a=resolveTrees_1["return"]))_a.call(resolveTrees_1);}finally{if(e_11)throw e_11.error;}}}if(Object.keys(legacy_missingNodeMap).length){Object.assign(this.legacy_missingNodeRetryMap,legacy_missingNodeMap);}d.texts.forEach(function(mutation){var target=_this.mirror.getNode(mutation.id);if(!target){if(d.removes.find(function(r){return r.id===mutation.id;})){return;}return _this.warnNodeNotFound(d,mutation.id);}if(_this.fragmentParentMap.has(target)){target=_this.fragmentParentMap.get(target);}target.textContent=mutation.value;});d.attributes.forEach(function(mutation){var target=_this.mirror.getNode(mutation.id);if(!target){if(d.removes.find(function(r){return r.id===mutation.id;})){return;}return _this.warnNodeNotFound(d,mutation.id);}if(_this.fragmentParentMap.has(target)){target=_this.fragmentParentMap.get(target);}for(var attributeName in mutation.attributes){if(typeof attributeName==='string'){var value=mutation.attributes[attributeName];if(value===null){target.removeAttribute(attributeName);}else if(typeof value==='string'){try{target.setAttribute(attributeName,value);}catch(error){if(_this.config.showWarning){console.warn('An error occurred may due to the checkout feature.',error);}}}else if(attributeName==='style'){var styleValues=value;var targetEl=target;for(var s in styleValues){if(styleValues[s]===false){targetEl.style.removeProperty(s);}else if(styleValues[s]instanceof Array){var svp=styleValues[s];targetEl.style.setProperty(s,svp[0],svp[1]);}else{var svs=styleValues[s];targetEl.style.setProperty(s,svs);}}}}}});};Replayer.prototype.applyScroll=function(d){var target=this.mirror.getNode(d.id);if(!target){return this.debugNodeNotFound(d,d.id);}if(target===this.iframe.contentDocument){this.iframe.contentWindow.scrollTo({top:d.y,left:d.x,behavior:'smooth'});}else{try{target.scrollTop=d.y;target.scrollLeft=d.x;}catch(error){}}};Replayer.prototype.applyInput=function(d){var target=this.mirror.getNode(d.id);if(!target){return this.debugNodeNotFound(d,d.id);}try{target.checked=d.isChecked;target.value=d.text;}catch(error){}};Replayer.prototype.legacy_resolveMissingNode=function(map,parent,target,targetMutation){var previousId=targetMutation.previousId,nextId=targetMutation.nextId;var previousInMap=previousId&&map[previousId];var nextInMap=nextId&&map[nextId];if(previousInMap){var _a=previousInMap,node=_a.node,mutation=_a.mutation;parent.insertBefore(node,target);delete map[mutation.node.id];delete this.legacy_missingNodeRetryMap[mutation.node.id];if(mutation.previousId||mutation.nextId){this.legacy_resolveMissingNode(map,parent,node,mutation);}}if(nextInMap){var _b=nextInMap,node=_b.node,mutation=_b.mutation;parent.insertBefore(node,target.nextSibling);delete map[mutation.node.id];delete this.legacy_missingNodeRetryMap[mutation.node.id];if(mutation.previousId||mutation.nextId){this.legacy_resolveMissingNode(map,parent,node,mutation);}}};Replayer.prototype.moveAndHover=function(x,y,id,isSync,debugData){var target=this.mirror.getNode(id);if(!target){return this.debugNodeNotFound(debugData,id);}var base=getBaseDimension(target,this.iframe);var _x=x*base.absoluteScale+base.x;var _y=y*base.absoluteScale+base.y;this.mouse.style.left=_x+"px";this.mouse.style.top=_y+"px";if(!isSync){this.drawMouseTail({x:_x,y:_y});}this.hoverElements(target);};Replayer.prototype.drawMouseTail=function(position){var _this=this;if(!this.mouseTail){return;}var _a=this.config.mouseTail===true?defaultMouseTailConfig:Object.assign({},defaultMouseTailConfig,this.config.mouseTail),lineCap=_a.lineCap,lineWidth=_a.lineWidth,strokeStyle=_a.strokeStyle,duration=_a.duration;var draw=function draw(){if(!_this.mouseTail){return;}var ctx=_this.mouseTail.getContext('2d');if(!ctx||!_this.tailPositions.length){return;}ctx.clearRect(0,0,_this.mouseTail.width,_this.mouseTail.height);ctx.beginPath();ctx.lineWidth=lineWidth;ctx.lineCap=lineCap;ctx.strokeStyle=strokeStyle;ctx.moveTo(_this.tailPositions[0].x,_this.tailPositions[0].y);_this.tailPositions.forEach(function(p){return ctx.lineTo(p.x,p.y);});ctx.stroke();};this.tailPositions.push(position);draw();setTimeout(function(){_this.tailPositions=_this.tailPositions.filter(function(p){return p!==position;});draw();},duration/this.speedService.state.context.timer.speed);};Replayer.prototype.hoverElements=function(el){var _a;(_a=this.iframe.contentDocument)===null||_a===void 0?void 0:_a.querySelectorAll('.\\:hover').forEach(function(hoveredEl){hoveredEl.classList.remove(':hover');});var currentEl=el;while(currentEl){if(currentEl.classList){currentEl.classList.add(':hover');}currentEl=currentEl.parentElement;}};Replayer.prototype.isUserInteraction=function(event){if(event.type!==exports.EventType.IncrementalSnapshot){return false;}return event.data.source>exports.IncrementalSource.Mutation&&event.data.source<=exports.IncrementalSource.Input;};Replayer.prototype.backToNormal=function(){this.nextUserInteractionEvent=null;if(this.speedService.state.matches('normal')){return;}this.speedService.send({type:'BACK_TO_NORMAL'});this.emitter.emit(exports.ReplayerEvents.SkipEnd,{speed:this.speedService.state.context.normalSpeed});};Replayer.prototype.restoreRealParent=function(frag,parent){this.mirror.map[parent.__sn.id]=parent;if(parent.__sn.type===NodeType.Element&&parent.__sn.tagName==='textarea'&&frag.textContent){parent.value=frag.textContent;}parent.appendChild(frag);this.restoreState(parent);};Replayer.prototype.storeState=function(parent){var e_12,_a;if(parent){if(parent.nodeType===parent.ELEMENT_NODE){var parentElement=parent;if(parentElement.scrollLeft||parentElement.scrollTop){this.elementStateMap.set(parent,{scroll:[parentElement.scrollLeft,parentElement.scrollTop]});}if(parentElement.tagName==='STYLE')storeCSSRules(parentElement,this.virtualStyleRulesMap);var children=parentElement.children;try{for(var _b=__values(Array.from(children)),_c=_b.next();!_c.done;_c=_b.next()){var child=_c.value;this.storeState(child);}}catch(e_12_1){e_12={error:e_12_1};}finally{try{if(_c&&!_c.done&&(_a=_b["return"]))_a.call(_b);}finally{if(e_12)throw e_12.error;}}}}};Replayer.prototype.restoreState=function(parent){var e_13,_a;if(parent.nodeType===parent.ELEMENT_NODE){var parentElement=parent;if(this.elementStateMap.has(parent)){var storedState=this.elementStateMap.get(parent);if(storedState.scroll){parentElement.scrollLeft=storedState.scroll[0];parentElement.scrollTop=storedState.scroll[1];}this.elementStateMap["delete"](parent);}var children=parentElement.children;try{for(var _b=__values(Array.from(children)),_c=_b.next();!_c.done;_c=_b.next()){var child=_c.value;this.restoreState(child);}}catch(e_13_1){e_13={error:e_13_1};}finally{try{if(_c&&!_c.done&&(_a=_b["return"]))_a.call(_b);}finally{if(e_13)throw e_13.error;}}}};Replayer.prototype.restoreNodeSheet=function(node){var storedRules=this.virtualStyleRulesMap.get(node);if(node.nodeName!=='STYLE'){return;}if(!storedRules){return;}var styleNode=node;applyVirtualStyleRulesToNode(storedRules,styleNode);};Replayer.prototype.warnNodeNotFound=function(d,id){if(this.treeIndex.idRemoved(id)){this.warn("Node with id '"+id+"' was previously removed. ",d);}else{this.warn("Node with id '"+id+"' not found. ",d);}};Replayer.prototype.warnCanvasMutationFailed=function(d,id,error){this.warn("Has error on update canvas '"+id+"'",d,error);};Replayer.prototype.debugNodeNotFound=function(d,id){if(this.treeIndex.idRemoved(id)){this.debug(REPLAY_CONSOLE_PREFIX,"Node with id '"+id+"' was previously removed. ",d);}else{this.debug(REPLAY_CONSOLE_PREFIX,"Node with id '"+id+"' not found. ",d);}};Replayer.prototype.warn=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(!this.config.showWarning){return;}console.warn.apply(console,__spread([REPLAY_CONSOLE_PREFIX],args));};Replayer.prototype.debug=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}if(!this.config.showDebug){return;}console.log.apply(console,__spread([REPLAY_CONSOLE_PREFIX],args));};return Replayer;}();var addCustomEvent=record.addCustomEvent;var freezePage=record.freezePage;var cbIdCount=0;var scrollByAgent=false;function createCbId(element){if(element&&element.getAttribute&&element.getAttribute("cb-id")===null){element.setAttribute("cb-id",cbIdCount);cbIdCount++;}}exports.Replayer=Replayer;exports.addCustomEvent=addCustomEvent;exports.freezePage=freezePage;exports.record=record;exports.utils=utils;exports.createCbId=createCbId;exports.cbIdCount=cbIdCount;exports.scrollByAgent=scrollByAgent;Object.defineProperty(exports,'__esModule',{value:true});return exports;});this.config=_objectSpread(_objectSpread({},this.config),_config);this.AgentDesktop(this.config.userInfo.userId,this.config);this.koreCoBrowse=this.koreCoBrowseInit({});this.rrweb=this.rrwebInit({});}// onHostCreate() {
//     let me = this;
//     let cwInstance = me.hostInstance;
//     cwInstance.on("jwtGrantSuccess", (response) => {
//         me.onInit();
//         me.AgentDesktop(response.userInfo.userId, response)
//     });
// }
// onInit() {
//     let me = this;
//     this.appendVideoAudioElemnts()
//     this.koreCoBrowse = me.koreCoBrowseInit({});
//     this.rrweb = me.rrwebInit({});
// }
// appendVideoAudioElemnts(){
//     let me = this;
//     let cwInstance = me.hostInstance;
//     let chatEle = cwInstance.chatEle;
//     let localVideoElement ='<video id="kore_local_video" autoplay="autoplay" playsinline style="width:0px;height:0px"></video>';
//     let remoteVideoElement ='<video id="kore_remote_video" autoplay="autoplay" playsinline style="width:0px;height:0px"></video>';
//     chatEle.append(localVideoElement);
//     chatEle.append(remoteVideoElement);
// }
);/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AgentDesktopPluginScript);

/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/plugins/agentDesktop/agentdesktop.css":
/*!**************************************************************************************************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/plugins/agentDesktop/agentdesktop.css ***!
  \**************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/sourceMaps.js */ "./node_modules/css-loader/dist/runtime/sourceMaps.js");
/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/getUrl.js */ "./node_modules/css-loader/dist/runtime/getUrl.js");
/* harmony import */ var _node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2__);
// Imports



var ___CSS_LOADER_URL_IMPORT_0___ = new URL(/* asset import */ __webpack_require__(/*! data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg== */ "data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg=="), __webpack_require__.b);
var ___CSS_LOADER_URL_IMPORT_1___ = new URL(/* asset import */ __webpack_require__(/*! data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iMy4yNSIgc3Ryb2tlPSJ1cmwoI3BhaW50MF9hbmd1bGFyXzEwNzJfNTIzNDMpIiBzdHJva2Utd2lkdGg9IjEuNSIvPgo8ZGVmcz4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDBfYW5ndWxhcl8xMDcyXzUyMzQzIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkgcm90YXRlKC0xODApIHNjYWxlKDQpIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzlBQTRCMiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5QUE0QjIiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo= */ "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iMy4yNSIgc3Ryb2tlPSJ1cmwoI3BhaW50MF9hbmd1bGFyXzEwNzJfNTIzNDMpIiBzdHJva2Utd2lkdGg9IjEuNSIvPgo8ZGVmcz4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDBfYW5ndWxhcl8xMDcyXzUyMzQzIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkgcm90YXRlKC0xODApIHNjYWxlKDQpIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzlBQTRCMiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5QUE0QjIiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo="), __webpack_require__.b);
var ___CSS_LOADER_URL_IMPORT_2___ = new URL(/* asset import */ __webpack_require__(/*! data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzlBQTRCMiIvPgo8L3N2Zz4K */ "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzlBQTRCMiIvPgo8L3N2Zz4K"), __webpack_require__.b);
var ___CSS_LOADER_URL_IMPORT_3___ = new URL(/* asset import */ __webpack_require__(/*! data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzIyQzU1RSIvPgo8L3N2Zz4K */ "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzIyQzU1RSIvPgo8L3N2Zz4K"), __webpack_require__.b);
var ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));
var ___CSS_LOADER_URL_REPLACEMENT_0___ = _node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2___default()(___CSS_LOADER_URL_IMPORT_0___);
var ___CSS_LOADER_URL_REPLACEMENT_1___ = _node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2___default()(___CSS_LOADER_URL_IMPORT_1___);
var ___CSS_LOADER_URL_REPLACEMENT_2___ = _node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2___default()(___CSS_LOADER_URL_IMPORT_2___);
var ___CSS_LOADER_URL_REPLACEMENT_3___ = _node_modules_css_loader_dist_runtime_getUrl_js__WEBPACK_IMPORTED_MODULE_2___default()(___CSS_LOADER_URL_IMPORT_3___);
// Module
___CSS_LOADER_EXPORT___.push([module.id, ".header-sec-sdk- {\n  font-family: \"Lato\", sans-serif;\n  background: #FFFFFF;\n  box-shadow: 0px 0px 6px #a8c8dd;\n  display: flex;\n  align-items: center;\n  padding: 15px 20px;\n}\n\n.header-sec-sdk- .name-agent {\n  font-family: \"Lato\", sans-serif;\n  font-weight: bold;\n  font-size: 16px;\n  color: #26344A;\n  line-height: 19px;\n  padding-left: 15px;\n}\n\n.initial-video-audio-container {\n  font-family: \"Lato\", sans-serif;\n  display: flex;\n  align-items: center;\n  padding: 15px;\n  background: rgba(38, 52, 74, 0.7);\n  border: 1px solid #26344A;\n  box-sizing: border-box;\n  border-radius: 10px;\n  position: fixed;\n  right: 28px;\n  z-index: 100000;\n  top: 25%;\n  width: 360px;\n}\n\n.initial-video-audio-container .ad-img-block img {\n  width: 48px;\n  height: 48px;\n  border: 1px solid #fff;\n  border-radius: 100%;\n}\n\n.initial-video-audio-container .content-desc {\n  padding-left: 15px;\n  width: 164px;\n}\n\n.initial-video-audio-container .content-desc .name {\n  letter-spacing: -0.24px;\n  color: #FFFFFF;\n  font-weight: bold;\n  font-size: 14px;\n  line-height: 20px;\n  margin-bottom: 4px;\n}\n\n.initial-video-audio-container .content-desc .type-text {\n  font-weight: normal;\n  font-size: 10px;\n  line-height: 14px;\n  color: #FFFFFF;\n}\n\n.initial-video-audio-container .controls-v-a {\n  display: flex;\n  align-items: center;\n}\n\n.initial-video-audio-container .controls-v-a img {\n  margin: 0 7px;\n  cursor: pointer;\n}\n\n.cobrowse-toolbar {\n  font-family: \"Lato\", sans-serif;\n  display: flex;\n  align-items: flex-start;\n  z-index: 100000;\n  cursor: move;\n  width: 40px;\n  height: 172px;\n  background: #FFFFFF;\n  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.25);\n  border-radius: 2px;\n}\n\n.cobrowse-btn {\n  cursor: pointer;\n  width: 30px;\n  height: 30px;\n  background: #F5F8FA;\n  border-radius: 2px;\n}\n\n.cobrowse-btn :hover {\n  background: #E9EFF4;\n}\n\n.toolbar-image {\n  width: 30px;\n  height: 30px;\n}\n\n#callcontainer {\n  position: relative;\n  height: 99%;\n  width: 98%;\n  margin-left: 1%;\n  padding: 0;\n  top: 1%;\n}\n\n.video-audio-chat-container {\n  font-family: \"Lato\", sans-serif;\n  background: #FFFFFF;\n  border: 1px solid #A8C8DD;\n  box-sizing: border-box;\n  box-shadow: 0px 0px 0px #a8c8dd;\n  border-radius: 0px 0px 0px 0px;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 99999;\n  left: 0px;\n  top: 0px;\n  padding: 10px;\n}\n\n.video-audio-chat-container .video-chat- {\n  height: 60%;\n}\n\n.video-audio-chat-container .video-chat- .video-view- {\n  width: 100%;\n  height: 100%;\n}\n\n.video-audio-chat-container .video-chat- .video-view-.audio-view- {\n  height: calc(100% - 60px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n}\n\n.video-audio-chat-container .video-chat- .video-view-.audio-view- .agent-profile-img {\n  height: 30px;\n  width: 30px;\n  top: 30%;\n  position: absolute;\n  border-radius: 50%;\n}\n\n.video-audio-chat-container .video-chat- .video-view-.audio-view- .title {\n  color: #3C4043;\n  font-weight: normal;\n  font-size: 12px;\n  line-height: 20px;\n  margin-bottom: 8px;\n  position: absolute;\n  top: 55%;\n}\n\n.video-audio-chat-container .video-chat- .video-view-.audio-view- .audio-info {\n  color: #8A959F;\n  font-weight: normal;\n  font-size: 10px;\n  line-height: 20px;\n  position: absolute;\n  top: 70%;\n}\n\n.video-audio-chat-container .video-chat- .video-view- video {\n  width: 100%;\n  height: 100%;\n}\n\n.video-audio-chat-container .video-chat- .video-name-title {\n  background: #FFFFFF;\n  border-bottom: 0px solid #A8C8DD;\n  box-sizing: border-box;\n  border-radius: 0px 0px 0px 0px;\n  padding: 0px 0px;\n  height: 14px;\n  display: flex;\n  align-items: center;\n  letter-spacing: -0.24px;\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 20px;\n  color: #202124;\n  cursor: default;\n  top: 8%;\n  position: absolute;\n  z-index: 1;\n}\n\n.video-audio-chat-container .self-video-container {\n  position: absolute;\n  width: 25%;\n  height: 30%;\n  cursor: move;\n  border-radius: 5px;\n  background: #A8C8DD;\n  z-index: 1;\n}\n\n.video-audio-chat-container .self-video-container .self-video {\n  height: 70%;\n  left: 6%;\n  top: 17%;\n  position: absolute;\n}\n\n.video-audio-chat-container .self-video-container .self-video video {\n  width: 100%;\n  height: 100%;\n}\n\n.video-audio-chat-container .self-video-container .self-video img {\n  width: 100%;\n  height: 100%;\n}\n\n.video-audio-chat-container .self-video-container .self-video .video-user-alphabet {\n  width: 35px;\n  height: 35px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #FFBEB6;\n  border: 2px solid #fff;\n  border-radius: 100%;\n  color: #000000;\n  font-weight: bold;\n  font-size: 10px;\n  line-height: 29px;\n  margin: 0 auto;\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 10px;\n  bottom: 0;\n}\n\n.video-audio-chat-container .self-video-container.minimize-video {\n  width: 40px !important;\n  height: 43px !important;\n}\n\n.video-audio-chat-container .self-video-container .close-video {\n  position: absolute;\n  top: 10px;\n  right: 5px;\n  cursor: pointer;\n}\n\n.video-audio-chat-container .self-video-container .turn-off-video {\n  position: absolute;\n  bottom: 5px;\n  width: 34px;\n  height: 34px;\n  background: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 100%;\n  margin: 0 auto;\n  left: 0;\n  right: 0;\n  cursor: pointer;\n}\n\n.video-audio-chat-container .self-video-container .turn-off-video .t-off {\n  display: none;\n}\n\n.video-audio-chat-container .self-video-container .turn-off-video .t-on {\n  display: block;\n}\n\n.video-audio-chat-container .self-video-container .turn-off-video.off-on-action .t-off {\n  display: block;\n}\n\n.video-audio-chat-container .self-video-container .turn-off-video.off-on-action .t-on {\n  display: none;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 5px 0;\n  position: relative;\n  background: #FFFFFF;\n  border: 1px solid #A8C8DD;\n  box-sizing: border-box;\n  border-radius: 0px 0px 0px 0px;\n  border-left: 0;\n  border-right: 0;\n  position: absolute;\n  top: 2%;\n  width: 94%;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions {\n  /* background: #BDC1C6;\n  border: 1px solid #BDC1C6; */\n  background: #DE0742;\n  border: 1px solid #DE0742;\n  width: 24px;\n  height: 24px;\n  border-radius: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin: 0 10px;\n  cursor: pointer;\n}\n\n.action-minimize-audio-control {\n  position: absolute;\n  top: 10%;\n  right: 5%;\n}\n\n.maximize-video {\n  width: 34px;\n  height: 34px;\n  background: #FFFFFF;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 100%;\n  cursor: pointer;\n  margin-bottom: 15px;\n}\n\n.show-self-video {\n  width: 34px;\n  height: 34px;\n  background: #FFFFFF;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 100%;\n  cursor: pointer;\n  margin-bottom: 15px;\n}\n\n.show-self-video-container {\n  position: absolute;\n  top: 30%;\n  right: 5%;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video.active- {\n  /* background: #DE0742;\n  border: 1px solid #DE0742; */\n  background: #BDC1C6;\n  border: 1px solid #BDC1C6;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video.active- .video-unmute {\n  display: block;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video.active- .video-mute {\n  display: none;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video .video-unmute {\n  display: none;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.close-audio {\n  background: #DE0742;\n  border: 1px solid transparent;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio.active- {\n  background: #DE0742;\n  border: 1px solid #DE0742;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio.active- .un-mute {\n  display: block;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio.active- .mute-img {\n  display: none;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio .un-mute {\n  display: none;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.screen-share.active- {\n  background: #85B7FE;\n  border: 1px solid transparent;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-audio {\n  background: #DE0742;\n  border: 1px solid transparent;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .lablel-video-switch {\n  position: absolute;\n  right: 0;\n  top: 39px;\n  color: #009DAB;\n  text-decoration-line: underline;\n  font-weight: normal;\n  font-size: 12px;\n  line-height: 15px;\n  padding-right: 35px;\n  cursor: pointer;\n}\n\n.video-audio-chat-container .footer-btn-a-v-attch .lablel-audio-switch {\n  position: absolute;\n  left: 0;\n  top: 39px;\n  color: #009DAB;\n  text-decoration-line: underline;\n  font-weight: normal;\n  font-size: 12px;\n  line-height: 15px;\n  padding-left: 35px;\n  cursor: pointer;\n}\n\n.system-template {\n  position: relative;\n  border-bottom: 1px solid var(--sdk-chat-widow-primary-border-color);\n  margin-bottom: 30px;\n  font-weight: 400;\n  margin-top: 20px;\n  text-align: center;\n}\n\n.system-template-msg {\n  position: relative;\n  top: 8px;\n  background: var(--sdk-chat-widow-default-white);\n  padding: 0px 10px;\n  display: initial;\n  width: 137px;\n  color: #333;\n  margin-left: 0;\n  margin-top: 43x;\n  font-weight: bold;\n  font-size: 12px;\n}\n\n.agent-mouse {\n  position: absolute;\n  z-index: 10000;\n  width: 20px;\n  height: 20px;\n  transition: left 0.05s linear, top 0.05s linear;\n  background-size: contain;\n  background-position: 50%;\n  background-repeat: no-repeat;\n  background-image: url(" + ___CSS_LOADER_URL_REPLACEMENT_0___ + ");\n  border-color: transparent;\n}\n\n.agent-mouse-circle {\n  content: \"\";\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  background: #4950f6;\n  border-radius: 100%;\n  transform: translate(-50%, -50%);\n  opacity: 0.3;\n}\n\n/* .rr-block { \n    border-color: red !important;\n    border-width: 1px;\n    border-style: solid;\n } */\n.agent-bot {\n  display: block;\n  background: #009dab;\n  -webkit-border-radius: 50%;\n  -moz-border-radius: 50%;\n  border-radius: 50%;\n  padding: 6px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n  position: fixed;\n  right: 0;\n}\n\n/*********************** rrweb css ******************************************/\n.replayer-wrapper {\n  position: relative;\n}\n\n.replayer-mouse {\n  position: absolute;\n  width: 20px;\n  height: 20px;\n  transition: left 0.05s linear, top 0.05s linear;\n  background-size: contain;\n  background-position: 50%;\n  background-repeat: no-repeat;\n  background-image: url(" + ___CSS_LOADER_URL_REPLACEMENT_0___ + ");\n  border-color: transparent;\n}\n\n.replayer-mouse:after {\n  content: \"\";\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  background: #4950f6;\n  border-radius: 100%;\n  transform: translate(-50%, -50%);\n  opacity: 0.3;\n}\n\n.replayer-mouse.active:after {\n  animation: click 0.2s ease-in-out 1;\n}\n\n.replayer-mouse.touch-device {\n  background-image: none;\n  width: 70px;\n  height: 70px;\n  border-radius: 100%;\n  margin-left: -37px;\n  margin-top: -37px;\n  border: 4px solid rgba(73, 80, 246, 0);\n  transition: left 0s linear, top 0s linear, border-color 0.2s ease-in-out;\n}\n\n.replayer-mouse.touch-device.touch-active {\n  border-color: #4950f6;\n  transition: left 0.25s linear, top 0.25s linear, border-color 0.2s ease-in-out;\n}\n\n.replayer-mouse.touch-device:after {\n  opacity: 0;\n}\n\n.replayer-mouse.touch-device.active:after {\n  animation: touch-click 0.2s ease-in-out 1;\n}\n\n.replayer-mouse-tail {\n  position: absolute;\n  pointer-events: none;\n}\n\n@keyframes click {\n  0% {\n    opacity: 0.3;\n    width: 20px;\n    height: 20px;\n  }\n  50% {\n    opacity: 0.5;\n    width: 10px;\n    height: 10px;\n  }\n}\n@keyframes touch-click {\n  0% {\n    opacity: 0;\n    width: 20px;\n    height: 20px;\n  }\n  50% {\n    opacity: 0.5;\n    width: 10px;\n    height: 10px;\n  }\n}\n/*# sourceMappingURL=rrweb.min.css.map */\n.kore-chat-window ul.chat-container li.fromCurrentUser .extra-info {\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-start;\n  flex-direction: row-reverse;\n}\n\nli.fromCurrentUser .sentIndicator {\n  position: relative;\n  top: 1px;\n  margin-right: 5px;\n  width: 12px;\n  height: 12px;\n  background-size: 100%;\n  background-repeat: no-repeat;\n  background-position: center;\n  background-image: url(" + ___CSS_LOADER_URL_REPLACEMENT_1___ + ");\n}\n\nli.fromCurrentUser .sentIndicator.delivered {\n  background-image: url(" + ___CSS_LOADER_URL_REPLACEMENT_2___ + ");\n}\n\nli.fromCurrentUser .sentIndicator.read {\n  background-image: url(" + ___CSS_LOADER_URL_REPLACEMENT_3___ + ");\n}\n\n.agent-type-icon {\n  background-image: var(--sdk-chat-widow-agent-icon) !important;\n  position: relative;\n  top: 5px;\n}", "",{"version":3,"sources":["webpack://./src/plugins/agentDesktop/agentdesktop.css"],"names":[],"mappings":"AAAA;EACI,+BAAA;EACA,mBAAA;EACA,+BAAA;EACA,aAAA;EACA,mBAAA;EACA,kBAAA;AACJ;;AACA;EACI,+BAAA;EACA,iBAAA;EACA,eAAA;EACA,cAAA;EACA,iBAAA;EACA,kBAAA;AAEJ;;AACA;EACI,+BAAA;EACA,aAAA;EACA,mBAAA;EACA,aAAA;EACA,iCAAA;EACA,yBAAA;EACA,sBAAA;EACA,mBAAA;EACA,eAAA;EACA,WAAA;EACA,eAAA;EACA,QAAA;EACA,YAAA;AAEJ;;AAAA;EACI,WAAA;EACA,YAAA;EACA,sBAAA;EACA,mBAAA;AAGJ;;AADA;EACI,kBAAA;EACA,YAAA;AAIJ;;AAFA;EACI,uBAAA;EACA,cAAA;EACA,iBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;AAKJ;;AAHA;EACI,mBAAA;EACA,eAAA;EACA,iBAAA;EACA,cAAA;AAMJ;;AAJA;EACI,aAAA;EACA,mBAAA;AAOJ;;AALA;EACI,aAAA;EACA,eAAA;AAQJ;;AANA;EACI,+BAAA;EACA,aAAA;EACA,uBAAA;EACA,eAAA;EACA,YAAA;EACA,WAAA;EACA,aAAA;EACA,mBAAA;EACA,2CAAA;EACA,kBAAA;AASJ;;AAPA;EACI,eAAA;EACA,WAAA;EACA,YAAA;EAEA,mBAAA;EACA,kBAAA;AASJ;;AAPA;EACI,mBAAA;AAUJ;;AARA;EACI,WAAA;EACA,YAAA;AAWJ;;AATA;EACI,kBAAA;EACA,WAAA;EACA,UAAA;EACA,eAAA;EACA,UAAA;EACA,OAAA;AAYJ;;AAVA;EACI,+BAAA;EACA,mBAAA;EACA,yBAAA;EACA,sBAAA;EACA,+BAAA;EACA,8BAAA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,cAAA;EACA,SAAA;EACA,QAAA;EACA,aAAA;AAaJ;;AAVA;EACI,WAAA;AAaJ;;AAXA;EACI,WAAA;EACA,YAAA;AAcJ;;AAZA;EACI,yBAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,sBAAA;AAeJ;;AAbA;EACI,YAAA;EACA,WAAA;EACA,QAAA;EACA,kBAAA;EACA,kBAAA;AAgBJ;;AAbA;EACI,cAAA;EACA,mBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,kBAAA;EACA,QAAA;AAgBJ;;AAdA;EACI,cAAA;EACA,mBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,QAAA;AAiBJ;;AAfA;EACI,WAAA;EACA,YAAA;AAkBJ;;AAfA;EACI,mBAAA;EACA,gCAAA;EACA,sBAAA;EACA,8BAAA;EACA,gBAAA;EACA,YAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;EACA,eAAA;EACA,iBAAA;EACA,cAAA;EACA,eAAA;EACA,OAAA;EACA,kBAAA;EACA,UAAA;AAkBJ;;AAhBA;EACI,kBAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,mBAAA;EACA,UAAA;AAmBJ;;AAjBA;EACI,WAAA;EACA,QAAA;EACA,QAAA;EACA,kBAAA;AAoBJ;;AAlBA;EACI,WAAA;EACA,YAAA;AAqBJ;;AAnBA;EACI,WAAA;EACA,YAAA;AAsBJ;;AApBA;EACI,WAAA;EACA,YAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,mBAAA;EACA,sBAAA;EACA,mBAAA;EACA,cAAA;EACA,iBAAA;EACA,eAAA;EACA,iBAAA;EACA,cAAA;EACA,kBAAA;EACA,MAAA;EACA,QAAA;EACA,UAAA;EACA,SAAA;AAuBJ;;AArBA;EACI,sBAAA;EACA,uBAAA;AAwBJ;;AAtBA;EACI,kBAAA;EACA,SAAA;EACA,UAAA;EACA,eAAA;AAyBJ;;AAvBA;EACI,kBAAA;EACA,WAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,mBAAA;EACA,cAAA;EACA,OAAA;EACA,QAAA;EACA,eAAA;AA0BJ;;AAxBA;EACI,aAAA;AA2BJ;;AAzBA;EACI,cAAA;AA4BJ;;AA1BA;EACI,cAAA;AA6BJ;;AA3BA;EACI,aAAA;AA8BJ;;AA5BA;EACI,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,cAAA;EACA,kBAAA;EACA,mBAAA;EACA,yBAAA;EACA,sBAAA;EACA,8BAAA;EACA,cAAA;EACA,eAAA;EACA,kBAAA;EACA,OAAA;EACA,UAAA;AA+BJ;;AA7BA;EACI;8BAAA;EAEA,mBAAA;EACA,yBAAA;EACA,WAAA;EACA,YAAA;EACA,mBAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,cAAA;EACA,eAAA;AAgCJ;;AA9BA;EACI,kBAAA;EACA,QAAA;EACA,SAAA;AAiCJ;;AA/BA;EACI,WAAA;EACA,YAAA;EACA,mBAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,mBAAA;EACA,eAAA;EACA,mBAAA;AAkCJ;;AAhCA;EACI,WAAA;EACA,YAAA;EACA,mBAAA;EACA,aAAA;EACA,mBAAA;EACA,uBAAA;EACA,mBAAA;EACA,eAAA;EACA,mBAAA;AAmCJ;;AAjCA;EACI,kBAAA;EACA,QAAA;EACA,SAAA;AAoCJ;;AAlCA;EACI;8BAAA;EAEA,mBAAA;EACA,yBAAA;AAqCJ;;AAnCA;EACI,cAAA;AAsCJ;;AApCA;EACI,aAAA;AAuCJ;;AArCA;EACI,aAAA;AAwCJ;;AAtCA;EACI,mBAAA;EACA,6BAAA;AAyCJ;;AAvCA;EACI,mBAAA;EACA,yBAAA;AA0CJ;;AAxCA;EACI,cAAA;AA2CJ;;AAzCA;EACI,aAAA;AA4CJ;;AA1CA;EACI,aAAA;AA6CJ;;AA3CA;EACI,mBAAA;EACA,6BAAA;AA8CJ;;AA5CA;EACI,mBAAA;EACA,6BAAA;AA+CJ;;AA7CA;EACI,kBAAA;EACA,QAAA;EACA,SAAA;EACA,cAAA;EACA,+BAAA;EACA,mBAAA;EACA,eAAA;EACA,iBAAA;EACA,mBAAA;EACA,eAAA;AAgDJ;;AA9CA;EACI,kBAAA;EACA,OAAA;EACA,SAAA;EACA,cAAA;EACA,+BAAA;EACA,mBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,eAAA;AAiDJ;;AA9CA;EACI,kBAAA;EACA,mEAAA;EACA,mBAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;AAiDJ;;AA9CA;EACI,kBAAA;EACA,QAAA;EACA,+CAAA;EACA,iBAAA;EACA,gBAAA;EACA,YAAA;EACA,WAAA;EACA,cAAA;EACA,eAAA;EACA,iBAAA;EACA,eAAA;AAiDJ;;AA9CA;EACI,kBAAA;EACA,cAAA;EACA,WAAA;EACA,YAAA;EACA,+CAAA;EACA,wBAAA;EACA,wBAAA;EACA,4BAAA;EACA,yDAAA;EACA,yBAAA;AAiDJ;;AA/CA;EACI,WAAA;EACA,qBAAA;EACA,WAAA;EACA,YAAA;EACA,mBAAA;EACA,mBAAA;EACA,gCAAA;EACA,YAAA;AAkDJ;;AAhDA;;;;IAAA;AAMA;EACI,cAAA;EACA,mBAAA;EACA,0BAAA;EACA,uBAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,YAAA;EACA,eAAA;EACA,eAAA;EACA,QAAA;AAkDJ;;AAhDA,6EAAA;AACA;EAAkB,kBAAA;AAoDlB;;AApDoC;EAAgB,kBAAA;EAAkB,WAAA;EAAW,YAAA;EAAY,+CAAA;EAA4C,wBAAA;EAAwB,wBAAA;EAAwB,4BAAA;EAA4B,yDAAA;EAAmkB,yBAAA;AAgExxB;;AAhEizB;EAAsB,WAAA;EAAW,qBAAA;EAAqB,WAAA;EAAW,YAAA;EAAY,mBAAA;EAAmB,mBAAA;EAAmB,gCAAA;EAA+B,YAAA;AA2En8B;;AA3E88B;EAA6B,mCAAA;AA+E3+B;;AA/E6gC;EAA6B,sBAAA;EAAsB,WAAA;EAAW,YAAA;EAAY,mBAAA;EAAmB,kBAAA;EAAkB,iBAAA;EAAiB,sCAAA;EAAmC,wEAAA;AA0FhrC;;AA1FqvC;EAA0C,qBAAA;EAAqB,8EAAA;AA+FpzC;;AA/F63C;EAAmC,UAAA;AAmGh6C;;AAnG06C;EAA0C,yCAAA;AAuGp9C;;AAvG4/C;EAAqB,kBAAA;EAAkB,oBAAA;AA4GniD;;AA5GujD;EAAiB;IAAG,YAAA;IAAW,WAAA;IAAW,YAAA;EAmH/lD;EAnH2mD;IAAI,YAAA;IAAW,WAAA;IAAW,YAAA;EAwHroD;AACF;AAzHopD;EAAuB;IAAG,UAAA;IAAU,WAAA;IAAW,YAAA;EA+HjsD;EA/H6sD;IAAI,YAAA;IAAW,WAAA;IAAW,YAAA;EAoIvuD;AACF;AApIA,wCAAA;AAEA;EACI,aAAA;EACA,uBAAA;EACA,2BAAA;EACA,2BAAA;AAqIJ;;AAlIA;EACI,kBAAA;EACA,QAAA;EACA,iBAAA;EACA,WAAA;EACA,YAAA;EACA,qBAAA;EACA,4BAAA;EACA,2BAAA;EACA,yDAAA;AAqIJ;;AAlIA;EACI,yDAAA;AAqIJ;;AAnIA;EACI,yDAAA;AAsIJ;;AAlIA;EACC,6DAAA;EACA,kBAAA;EACA,QAAA;AAqID","sourcesContent":[".header-sec-sdk-{\n    font-family: \"Lato\", sans-serif;\n    background: #FFFFFF;\n    box-shadow: 0px 0px 6px #a8c8dd;\n    display: flex;\n    align-items: center;\n    padding: 15px 20px;\n}\n.header-sec-sdk- .name-agent{\n    font-family: \"Lato\", sans-serif;\n    font-weight: bold;\n    font-size: 16px;\n    color: #26344A;\n    line-height: 19px;\n    padding-left: 15px;\n}\n\n.initial-video-audio-container{\n    font-family: \"Lato\", sans-serif;\n    display: flex;\n    align-items: center;\n    padding: 15px;\n    background: rgba(38, 52, 74, 0.7);\n    border: 1px solid #26344A;\n    box-sizing: border-box;\n    border-radius: 10px;\n    position: fixed;\n    right: 28px;\n    z-index: 100000;\n    top: 25%;\n    width: 360px;\n}\n.initial-video-audio-container .ad-img-block img{\n    width: 48px;\n    height: 48px;\n    border: 1px solid #fff;\n    border-radius: 100%;\n}\n.initial-video-audio-container .content-desc{\n    padding-left: 15px;\n    width: 164px;\n}\n.initial-video-audio-container .content-desc .name{\n    letter-spacing: -0.24px;\n    color: #FFFFFF;\n    font-weight: bold;\n    font-size: 14px;\n    line-height: 20px;\n    margin-bottom: 4px;\n}\n.initial-video-audio-container .content-desc .type-text{\n    font-weight: normal;\n    font-size: 10px;\n    line-height: 14px;\n    color: #FFFFFF;\n}\n.initial-video-audio-container .controls-v-a{\n    display: flex;\n    align-items: center;\n}\n.initial-video-audio-container .controls-v-a img{\n    margin: 0 7px;\n    cursor: pointer;\n}\n.cobrowse-toolbar {\n    font-family: \"Lato\", sans-serif;\n    display: flex;\n    align-items: flex-start;\n    z-index: 100000;\n    cursor: move;\n    width : 40px;\n    height: 172px;\n    background: #FFFFFF;\n    box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.25);\n    border-radius: 2px;\n}\n.cobrowse-btn {\n    cursor: pointer;\n    width: 30px;\n    height: 30px;\n   \n    background: #F5F8FA;\n    border-radius: 2px;\n}\n.cobrowse-btn :hover {\n    background :#E9EFF4;\n}\n.toolbar-image {\n    width : 30px;\n    height : 30px\n}\n#callcontainer {\n    position: relative;\n    height: 99%;\n    width: 98%;\n    margin-left: 1%;\n    padding: 0;\n    top: 1%;\n}\n.video-audio-chat-container{\n    font-family: \"Lato\", sans-serif;\n    background: #FFFFFF;\n    border: 1px solid #A8C8DD;\n    box-sizing: border-box;\n    box-shadow: 0px 0px 0px #a8c8dd;\n    border-radius: 0px 0px 0px 0px;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    z-index: 99999;\n    left:0px;\n    top: 0px;\n    padding:10px\n}\n\n.video-audio-chat-container .video-chat-{\n    height: 60%;\n}\n.video-audio-chat-container .video-chat- .video-view-{\n    width: 100%;\n    height: 100%;\n}\n.video-audio-chat-container .video-chat- .video-view-.audio-view-{\n    height: calc(100% - 60px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n}\n.video-audio-chat-container .video-chat- .video-view-.audio-view- .agent-profile-img{\n    height: 30px;\n    width:30px; \n    top:30%;\n    position: absolute;\n    border-radius: 50%;\n}\n\n.video-audio-chat-container .video-chat- .video-view-.audio-view- .title{\n    color: #3C4043;\n    font-weight: normal;\n    font-size: 12px;\n    line-height: 20px;\n    margin-bottom: 8px;\n    position: absolute;\n    top: 55%;\n}\n.video-audio-chat-container .video-chat- .video-view-.audio-view- .audio-info{\n    color: #8A959F;\n    font-weight: normal;\n    font-size: 10px;\n    line-height: 20px;\n    position: absolute;\n    top: 70%;\n}\n.video-audio-chat-container .video-chat- .video-view- video{\n    width: 100%;\n    height: 100%;\n}\n\n.video-audio-chat-container .video-chat- .video-name-title {\n    background: #FFFFFF;\n    border-bottom: 0px solid #A8C8DD;\n    box-sizing: border-box;\n    border-radius: 0px 0px 0px 0px;\n    padding: 0px 0px;\n    height: 14px;\n    display: flex;\n    align-items: center;\n    letter-spacing: -0.24px;\n    font-weight: 600;\n    font-size: 14px;\n    line-height: 20px;\n    color: #202124;\n    cursor: default;\n    top: 8%;\n    position: absolute;\n    z-index: 1;\n}\n.video-audio-chat-container .self-video-container {\n    position: absolute;\n    width: 25%;\n    height: 30%;\n    cursor: move;\n    border-radius: 5px;\n    background: #A8C8DD;\n    z-index: 1;\n}\n.video-audio-chat-container .self-video-container .self-video {\n    height: 70%;\n    left: 6%;\n    top: 17%;\n    position: absolute;\n}\n.video-audio-chat-container .self-video-container .self-video video {\n    width: 100%;\n    height: 100%;\n}\n.video-audio-chat-container .self-video-container .self-video img {\n    width: 100%;\n    height: 100%;\n}\n.video-audio-chat-container .self-video-container .self-video .video-user-alphabet {\n    width: 35px;\n    height: 35px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #FFBEB6;\n    border: 2px solid #fff;\n    border-radius: 100%;\n    color: #000000;\n    font-weight: bold;\n    font-size: 10px;\n    line-height: 29px;\n    margin: 0 auto;\n    position: absolute;\n    top: 0;\n    right: 0;\n    left: 10px;\n    bottom: 0;\n}\n.video-audio-chat-container .self-video-container.minimize-video {\n    width: 40px !important;\n    height: 43px !important;\n}\n.video-audio-chat-container .self-video-container .close-video {\n    position: absolute;\n    top: 10px;\n    right: 5px;\n    cursor: pointer;\n}\n.video-audio-chat-container .self-video-container .turn-off-video {\n    position: absolute;\n    bottom: 5px;\n    width: 34px;\n    height: 34px;\n    background: #fff;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 100%;\n    margin: 0 auto;\n    left: 0;\n    right: 0;\n    cursor: pointer;\n}\n.video-audio-chat-container .self-video-container .turn-off-video .t-off {\n    display: none;\n}\n.video-audio-chat-container .self-video-container .turn-off-video .t-on {\n    display: block;\n}\n.video-audio-chat-container .self-video-container .turn-off-video.off-on-action .t-off {\n    display: block;\n}\n.video-audio-chat-container .self-video-container .turn-off-video.off-on-action .t-on {\n    display: none;\n}\n.video-audio-chat-container .footer-btn-a-v-attch {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 5px 0;\n    position: relative;\n    background: #FFFFFF;\n    border: 1px solid #A8C8DD;\n    box-sizing: border-box;\n    border-radius: 0px 0px 0px 0px;\n    border-left: 0;\n    border-right: 0;\n    position: absolute;\n    top: 2%;\n    width: 94%;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions {\n    /* background: #BDC1C6;\n    border: 1px solid #BDC1C6; */\n    background: #DE0742;\n    border: 1px solid #DE0742;\n    width: 24px;\n    height: 24px;\n    border-radius: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    margin: 0 10px;\n    cursor: pointer;\n}\n.action-minimize-audio-control {\n    position: absolute;\n    top: 10%;\n    right: 5%;\n}\n.maximize-video {\n    width: 34px;\n    height: 34px;\n    background: #FFFFFF;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 100%;\n    cursor: pointer;\n    margin-bottom: 15px;\n}\n.show-self-video {\n    width: 34px;\n    height: 34px;\n    background: #FFFFFF;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 100%;\n    cursor: pointer;\n    margin-bottom: 15px;\n}\n.show-self-video-container {\n    position: absolute;\n    top: 30%;\n    right: 5%;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video.active- {\n    /* background: #DE0742;\n    border: 1px solid #DE0742; */\n    background: #BDC1C6;\n    border: 1px solid #BDC1C6;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video.active- .video-unmute {\n    display: block;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video.active- .video-mute {\n    display: none;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-video .video-unmute {\n    display: none;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.close-audio {\n    background: #DE0742;\n    border: 1px solid transparent;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio.active- {\n    background: #DE0742;\n    border: 1px solid #DE0742;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio.active- .un-mute {\n    display: block;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio.active- .mute-img {\n    display: none;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.mute-audio .un-mute {\n    display: none;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.screen-share.active- {\n    background: #85B7FE;\n    border: 1px solid transparent;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .btn_actions.enable-audio {\n    background: #DE0742;\n    border: 1px solid transparent;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .lablel-video-switch {\n    position: absolute;\n    right: 0;\n    top: 39px;\n    color: #009DAB;\n    text-decoration-line: underline;\n    font-weight: normal;\n    font-size: 12px;\n    line-height: 15px;\n    padding-right: 35px;\n    cursor: pointer;\n}\n.video-audio-chat-container .footer-btn-a-v-attch .lablel-audio-switch {\n    position: absolute;\n    left: 0;\n    top: 39px;\n    color: #009DAB;\n    text-decoration-line: underline;\n    font-weight: normal;\n    font-size: 12px;\n    line-height: 15px;\n    padding-left: 35px;\n    cursor: pointer;\n}\n\n.system-template {\n    position: relative;\n    border-bottom: 1px solid var(--sdk-chat-widow-primary-border-color);\n    margin-bottom: 30px;\n    font-weight: 400;\n    margin-top: 20px;\n    text-align: center;\n}\n\n.system-template-msg {\n    position: relative;\n    top: 8px;\n    background: var(--sdk-chat-widow-default-white);\n    padding: 0px 10px;\n    display: initial;\n    width: 137px;\n    color: #333;\n    margin-left: 0;\n    margin-top: 43x;\n    font-weight: bold;\n    font-size: 12px;\n}\n\n.agent-mouse {\n    position: absolute;\n    z-index:10000;\n    width: 20px;\n    height: 20px;\n    transition: left .05s linear,top .05s linear;\n    background-size: contain;\n    background-position: 50%;\n    background-repeat: no-repeat;\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg==\");\n    border-color: transparent;\n}\n.agent-mouse-circle {\n    content: \"\";\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    background: #4950f6;\n    border-radius: 100%;\n    transform: translate(-50%,-50%);\n    opacity: .3;\n}\n/* .rr-block { \n    border-color: red !important;\n    border-width: 1px;\n    border-style: solid;\n } */\n\n.agent-bot {\n    display: block;\n    background: #009dab;\n    -webkit-border-radius: 50%;\n    -moz-border-radius: 50%;\n    border-radius: 50%;\n    padding: 6px;\n    width: 36px;\n    height: 36px;\n    cursor: pointer;\n    position: fixed;\n    right: 0;\n}\n/*********************** rrweb css ******************************************/\n.replayer-wrapper{position:relative}.replayer-mouse{position:absolute;width:20px;height:20px;transition:left .05s linear,top .05s linear;background-size:contain;background-position:50%;background-repeat:no-repeat;background-image:url(\"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg==\");border-color:transparent}.replayer-mouse:after{content:\"\";display:inline-block;width:20px;height:20px;background:#4950f6;border-radius:100%;transform:translate(-50%,-50%);opacity:.3}.replayer-mouse.active:after{animation:click .2s ease-in-out 1}.replayer-mouse.touch-device{background-image:none;width:70px;height:70px;border-radius:100%;margin-left:-37px;margin-top:-37px;border:4px solid rgba(73,80,246,0);transition:left 0s linear,top 0s linear,border-color .2s ease-in-out}.replayer-mouse.touch-device.touch-active{border-color:#4950f6;transition:left .25s linear,top .25s linear,border-color .2s ease-in-out}.replayer-mouse.touch-device:after{opacity:0}.replayer-mouse.touch-device.active:after{animation:touch-click .2s ease-in-out 1}.replayer-mouse-tail{position:absolute;pointer-events:none}@keyframes click{0%{opacity:.3;width:20px;height:20px}50%{opacity:.5;width:10px;height:10px}}@keyframes touch-click{0%{opacity:0;width:20px;height:20px}50%{opacity:.5;width:10px;height:10px}}\n/*# sourceMappingURL=rrweb.min.css.map */\n\n.kore-chat-window ul.chat-container li.fromCurrentUser .extra-info{\n    display: flex;\n    align-items: flex-start;\n    justify-content: flex-start;\n    flex-direction: row-reverse;\n}\n\nli.fromCurrentUser .sentIndicator{\n    position: relative;\n    top: 1px;\n    margin-right: 5px;\n    width: 12px;\n    height: 12px;\n    background-size: 100%;\n    background-repeat: no-repeat;\n    background-position: center;\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iMy4yNSIgc3Ryb2tlPSJ1cmwoI3BhaW50MF9hbmd1bGFyXzEwNzJfNTIzNDMpIiBzdHJva2Utd2lkdGg9IjEuNSIvPgo8ZGVmcz4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDBfYW5ndWxhcl8xMDcyXzUyMzQzIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkgcm90YXRlKC0xODApIHNjYWxlKDQpIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzlBQTRCMiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5QUE0QjIiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo=\");\n}\n    \nli.fromCurrentUser .sentIndicator.delivered{\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzlBQTRCMiIvPgo8L3N2Zz4K\");\n}\nli.fromCurrentUser .sentIndicator.read{\n    background-image: url(\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzIyQzU1RSIvPgo8L3N2Zz4K\");\n}\n    \n\n.agent-type-icon{\n\tbackground-image: var(--sdk-chat-widow-agent-icon) !important;\n\tposition: relative;\n\ttop: 5px;\n\n}"],"sourceRoot":""}]);
// Exports
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);


/***/ }),

/***/ "./src/plugins/agentDesktop/agentdesktop.css":
/*!***************************************************!*\
  !*** ./src/plugins/agentDesktop/agentdesktop.css ***!
  \***************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! !../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! !../../../node_modules/style-loader/dist/runtime/styleDomAPI.js */ "./node_modules/style-loader/dist/runtime/styleDomAPI.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../../../node_modules/style-loader/dist/runtime/insertBySelector.js */ "./node_modules/style-loader/dist/runtime/insertBySelector.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js */ "./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! !../../../node_modules/style-loader/dist/runtime/insertStyleElement.js */ "./node_modules/style-loader/dist/runtime/insertStyleElement.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! !../../../node_modules/style-loader/dist/runtime/styleTagTransform.js */ "./node_modules/style-loader/dist/runtime/styleTagTransform.js");
/* harmony import */ var _node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! !!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./agentdesktop.css */ "./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/plugins/agentDesktop/agentdesktop.css");

      
      
      
      
      
      
      
      
      

var options = {};

options.styleTagTransform = (_node_modules_style_loader_dist_runtime_styleTagTransform_js__WEBPACK_IMPORTED_MODULE_5___default());
options.setAttributes = (_node_modules_style_loader_dist_runtime_setAttributesWithoutAttributes_js__WEBPACK_IMPORTED_MODULE_3___default());

      options.insert = _node_modules_style_loader_dist_runtime_insertBySelector_js__WEBPACK_IMPORTED_MODULE_2___default().bind(null, "head");
    
options.domAPI = (_node_modules_style_loader_dist_runtime_styleDomAPI_js__WEBPACK_IMPORTED_MODULE_1___default());
options.insertStyleElement = (_node_modules_style_loader_dist_runtime_insertStyleElement_js__WEBPACK_IMPORTED_MODULE_4___default());

var update = _node_modules_style_loader_dist_runtime_injectStylesIntoStyleTag_js__WEBPACK_IMPORTED_MODULE_0___default()(_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"], options);


if (true) {
  if (!_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals || module.hot.invalidate) {
    var isEqualLocals = function isEqualLocals(a, b, isNamedExport) {
  if (!a && b || a && !b) {
    return false;
  }

  var p;

  for (p in a) {
    if (isNamedExport && p === "default") {
      // eslint-disable-next-line no-continue
      continue;
    }

    if (a[p] !== b[p]) {
      return false;
    }
  }

  for (p in b) {
    if (isNamedExport && p === "default") {
      // eslint-disable-next-line no-continue
      continue;
    }

    if (!a[p]) {
      return false;
    }
  }

  return true;
};
    var isNamedExport = !_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals;
    var oldLocals = isNamedExport ? _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__ : _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals;

    module.hot.accept(
      /*! !!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./agentdesktop.css */ "./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/plugins/agentDesktop/agentdesktop.css",
      __WEBPACK_OUTDATED_DEPENDENCIES__ => { /* harmony import */ _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! !!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js!./agentdesktop.css */ "./node_modules/css-loader/dist/cjs.js!./node_modules/postcss-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js!./src/plugins/agentDesktop/agentdesktop.css");
(function () {
        if (!isEqualLocals(oldLocals, isNamedExport ? _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__ : _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals, isNamedExport)) {
                module.hot.invalidate();

                return;
              }

              oldLocals = isNamedExport ? _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__ : _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals;

              update(_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"]);
      })(__WEBPACK_OUTDATED_DEPENDENCIES__); }
    )
  }

  module.hot.dispose(function() {
    update();
  });
}



       /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"] && _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals ? _node_modules_css_loader_dist_cjs_js_node_modules_postcss_loader_dist_cjs_js_node_modules_sass_loader_dist_cjs_js_agentdesktop_css__WEBPACK_IMPORTED_MODULE_6__["default"].locals : undefined);


/***/ }),

/***/ "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iMy4yNSIgc3Ryb2tlPSJ1cmwoI3BhaW50MF9hbmd1bGFyXzEwNzJfNTIzNDMpIiBzdHJva2Utd2lkdGg9IjEuNSIvPgo8ZGVmcz4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDBfYW5ndWxhcl8xMDcyXzUyMzQzIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkgcm90YXRlKC0xODApIHNjYWxlKDQpIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzlBQTRCMiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5QUE0QjIiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo=":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iMy4yNSIgc3Ryb2tlPSJ1cmwoI3BhaW50MF9hbmd1bGFyXzEwNzJfNTIzNDMpIiBzdHJva2Utd2lkdGg9IjEuNSIvPgo8ZGVmcz4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDBfYW5ndWxhcl8xMDcyXzUyMzQzIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkgcm90YXRlKC0xODApIHNjYWxlKDQpIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzlBQTRCMiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5QUE0QjIiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo= ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iMy4yNSIgc3Ryb2tlPSJ1cmwoI3BhaW50MF9hbmd1bGFyXzEwNzJfNTIzNDMpIiBzdHJva2Utd2lkdGg9IjEuNSIvPgo8ZGVmcz4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDBfYW5ndWxhcl8xMDcyXzUyMzQzIiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDQgNCkgcm90YXRlKC0xODApIHNjYWxlKDQpIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzlBQTRCMiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM5QUE0QjIiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8L2RlZnM+Cjwvc3ZnPgo=";

/***/ }),

/***/ "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzIyQzU1RSIvPgo8L3N2Zz4K":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzIyQzU1RSIvPgo8L3N2Zz4K ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzIyQzU1RSIvPgo8L3N2Zz4K";

/***/ }),

/***/ "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzlBQTRCMiIvPgo8L3N2Zz4K":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzlBQTRCMiIvPgo8L3N2Zz4K ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQgOEM2LjIwOTE0IDggOCA2LjIwOTE0IDggNEM4IDEuNzkwODYgNi4yMDkxNCAwIDQgMEMxLjc5MDg2IDAgMCAxLjc5MDg2IDAgNEMwIDYuMjA5MTQgMS43OTA4NiA4IDQgOFpNNS44NTM1NSAzLjM1MzU1QzYuMDQ4ODIgMy4xNTgyOSA2LjA0ODgyIDIuODQxNzEgNS44NTM1NSAyLjY0NjQ1QzUuNjU4MjkgMi40NTExOCA1LjM0MTcxIDIuNDUxMTggNS4xNDY0NSAyLjY0NjQ1TDMuNSA0LjI5Mjg5TDIuODUzNTUgMy42NDY0NUMyLjY1ODI5IDMuNDUxMTggMi4zNDE3MSAzLjQ1MTE4IDIuMTQ2NDUgMy42NDY0NUMxLjk1MTE4IDMuODQxNzEgMS45NTExOCA0LjE1ODI5IDIuMTQ2NDUgNC4zNTM1NUwzLjE0NjQ1IDUuMzUzNTVDMy4zNDE3MSA1LjU0ODgyIDMuNjU4MjkgNS41NDg4MiAzLjg1MzU1IDUuMzUzNTVMNS44NTM1NSAzLjM1MzU1WiIgZmlsbD0iIzlBQTRCMiIvPgo8L3N2Zz4K";

/***/ }),

/***/ "data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg==":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg== ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjMwMCIgd2lkdGg9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBkYXRhLW5hbWU9IkxheWVyIDEiIHZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTQ4LjcxIDQyLjkxTDM0LjA4IDI4LjI5IDQ0LjMzIDE4YTEgMSAwIDAwLS4zMy0xLjYxTDIuMzUgMS4wNmExIDEgMCAwMC0xLjI5IDEuMjlMMTYuMzkgNDRhMSAxIDAgMDAxLjY1LjM2bDEwLjI1LTEwLjI4IDE0LjYyIDE0LjYzYTEgMSAwIDAwMS40MSAwbDQuMzgtNC4zOGExIDEgMCAwMC4wMS0xLjQyem0tNS4wOSAzLjY3TDI5IDMyYTEgMSAwIDAwLTEuNDEgMGwtOS44NSA5Ljg1TDMuNjkgMy42OWwzOC4xMiAxNEwzMiAyNy41OEExIDEgMCAwMDMyIDI5bDE0LjU5IDE0LjYyeiIvPjwvc3ZnPg==";

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("ca73b576352e1762bff6")
/******/ })();
/******/ 
/******/ /* webpack/runtime/harmony module decorator */
/******/ (() => {
/******/ 	__webpack_require__.hmd = (module) => {
/******/ 		module = Object.create(module);
/******/ 		if (!module.children) module.children = [];
/******/ 		Object.defineProperty(module, 'exports', {
/******/ 			enumerable: true,
/******/ 			set: () => {
/******/ 				throw new Error('ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: ' + module.id);
/******/ 			}
/******/ 		});
/******/ 		return module;
/******/ 	};
/******/ })();
/******/ 
/******/ }
)
//# sourceMappingURL=hot-update.js.map