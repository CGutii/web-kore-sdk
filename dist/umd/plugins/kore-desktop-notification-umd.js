!function(o,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.KoreDesktopNotificationPluginSDK=i():o.KoreDesktopNotificationPluginSDK=i()}(self,(()=>(()=>{"use strict";var o={d:(i,e)=>{for(var t in e)o.o(e,t)&&!o.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:e[t]})},o:(o,i)=>Object.prototype.hasOwnProperty.call(o,i),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},i={};o.r(i),o.d(i,{KoreDesktopNotificationPlugin:()=>e});const e=function(){function o(){this.name="KoreDesktopNotificationPlugin ",this.config={},this.isTabActive=!0,this.notificationSound="/assets/notification.mp3"}return o.prototype.onHostCreate=function(){this.onInit()},o.prototype.onInit=function(){var o=this,i=this;"default"===Notification.permission&&Notification.requestPermission(),document.addEventListener("visibilitychange",(function(o){"visible"==document.visibilityState?i.isTabActive=!0:i.isTabActive=!1})),i.hostInstance.on("onWSMessage",(function(e){var t,n,a,s,l,d,u,c,r,v,f,p,m,g,y,b,h,D,N;"agent_connected"===(null===(n=null===(t=e.messageData)||void 0===t?void 0:t.message)||void 0===n?void 0:n.type)&&new Audio(o.notificationSound).play();if("bot_response"===(null===(a=e.messageData)||void 0===a?void 0:a.type)&&"live_agent"===(null===(c=null===(u=null===(d=null===(l=null===(s=e.messageData)||void 0===s?void 0:s.message[0])||void 0===l?void 0:l.component)||void 0===d?void 0:d.payload)||void 0===u?void 0:u.payload)||void 0===c?void 0:c.template_type)&&(null===(m=null===(p=null===(f=null===(v=null===(r=e.messageData)||void 0===r?void 0:r.message[0])||void 0===v?void 0:v.component)||void 0===f?void 0:f.payload)||void 0===p?void 0:p.payload)||void 0===m?void 0:m.text)){if("granted"!==Notification.permission)return;var S,w={body:null===(D=null===(h=null===(b=null===(y=null===(g=e.messageData)||void 0===g?void 0:g.message[0])||void 0===y?void 0:y.component)||void 0===b?void 0:b.payload)||void 0===h?void 0:h.payload)||void 0===D?void 0:D.text,icon:"/assets/smartassist-logo.png",sound:o.notificationSound,requireInteraction:!1,onclick:function(o){o.target.close()}};if(!i.isTabActive){if(null===(N=e.messageData.author)||void 0===N?void 0:N.firstName){var P=e.messageData.author.firstName+" "+e.messageData.author.lastName;S=new Notification("New message from "+P,w)}else S=new Notification("You have a new notification.",w);new Audio(o.notificationSound).play()}S&&(S.onclick=function(o){window.parent.focus(),S.close()})}}))},o}();return i})()));